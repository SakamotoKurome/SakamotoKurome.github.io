<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Ubuntu Desktop | Sakamoto Kurome</title><meta name=keywords content="Unix,Linux,Ubuntu"><meta name=description content="友邦拓 乌班图 During the first ten years of this HOWTO&rsquo;s life, I reported that from a new user&rsquo;s point of view, all Linux distributions are almost equivalent. But in 2006-2007, an actual best choice emerged: Ubuntu. While other distros have their own areas of strength, Ubuntu is far and away the most accessible to Linux newbies. Beware, though, of the hideous and nigh-unusable &ldquo;Unity&rdquo; desktop interface"><meta name=author content="Sakamoto Kurome"><link rel=canonical href=https://sakamotokurome.github.io/posts/ubuntup0desktop/><link crossorigin=anonymous href=/assets/css/stylesheet.min.06402d745029223a9231706eea1dd82e107754f4ad625acbe7fd336a5e59566c.css integrity="sha256-BkAtdFApIjqSMXBu6h3YLhB3VPStYlrL5/0zal5ZVmw=" rel="preload stylesheet" as=style><script defer crossorigin=anonymous src=/assets/js/highlight.min.b95bacdc39e37a332a9f883b1e78be4abc1fdca2bc1f2641f55e3cd3dabd4d61.js integrity="sha256-uVus3DnjejMqn4g7Hni+Srwf3KK8HyZB9V4809q9TWE=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://sakamotokurome.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://sakamotokurome.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://sakamotokurome.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://sakamotokurome.github.io/apple-touch-icon.png><link rel=mask-icon href=https://sakamotokurome.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.111.3"><noscript><style>#theme-toggle,.top-link{display:none}</style></noscript><link rel=stylesheet href=https://sakamotokurome.github.io/custom.css><meta name=google-site-verification content="i2r403EffR8m-KBf7EHi6AYg7tfnMshaXTAynoYPnpE"><script async src="https://www.googletagmanager.com/gtag/js?id=G-K2Y212LPQ2"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-K2Y212LPQ2",{anonymize_ip:!1})}</script><meta property="og:title" content="Ubuntu Desktop"><meta property="og:description" content="友邦拓 乌班图 During the first ten years of this HOWTO&rsquo;s life, I reported that from a new user&rsquo;s point of view, all Linux distributions are almost equivalent. But in 2006-2007, an actual best choice emerged: Ubuntu. While other distros have their own areas of strength, Ubuntu is far and away the most accessible to Linux newbies. Beware, though, of the hideous and nigh-unusable &ldquo;Unity&rdquo; desktop interface"><meta property="og:type" content="article"><meta property="og:url" content="https://sakamotokurome.github.io/posts/ubuntup0desktop/"><meta property="og:image" content="https://sakamotokurome.github.io/Covers/ubuntu00.jpg.webp"><meta property="article:section" content="posts"><meta property="article:published_time" content="2022-03-08T15:32:00+08:00"><meta property="article:modified_time" content="2022-03-08T15:32:00+08:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://sakamotokurome.github.io/Covers/ubuntu00.jpg.webp"><meta name=twitter:title content="Ubuntu Desktop"><meta name=twitter:description content="友邦拓 乌班图 During the first ten years of this HOWTO&rsquo;s life, I reported that from a new user&rsquo;s point of view, all Linux distributions are almost equivalent. But in 2006-2007, an actual best choice emerged: Ubuntu. While other distros have their own areas of strength, Ubuntu is far and away the most accessible to Linux newbies. Beware, though, of the hideous and nigh-unusable &ldquo;Unity&rdquo; desktop interface"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://sakamotokurome.github.io/posts/"},{"@type":"ListItem","position":2,"name":"Ubuntu Desktop","item":"https://sakamotokurome.github.io/posts/ubuntup0desktop/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Ubuntu Desktop","name":"Ubuntu Desktop","description":"友邦拓 乌班图 During the first ten years of this HOWTO\u0026rsquo;s life, I reported that from a new user\u0026rsquo;s point of view, all Linux distributions are almost equivalent. But in 2006-2007, an actual best choice emerged: Ubuntu. While other distros have their own areas of strength, Ubuntu is far and away the most accessible to Linux newbies. Beware, though, of the hideous and nigh-unusable \u0026ldquo;Unity\u0026rdquo; desktop interface","keywords":["Unix","Linux","Ubuntu"],"articleBody":"友邦拓 乌班图\nDuring the first ten years of this HOWTO’s life, I reported that from a new user’s point of view, all Linux distributions are almost equivalent. But in 2006-2007, an actual best choice emerged: Ubuntu. While other distros have their own areas of strength, Ubuntu is far and away the most accessible to Linux newbies. Beware, though, of the hideous and nigh-unusable “Unity” desktop interface that Ubuntu introduced as a default a few years later; the Xubuntu or Kubuntu variants are better.\nEric Steven Raymond - How To Become A Hacker\n学习 Linux 几点忠告 不要當“傳教士”\n(這點有一個重大弊端：開放軟體沒有商業軟件那樣的宣傳，如果使用者都如此低調，用戶群不會大幅擴展。)\n很多人在討論區不斷的引起的Linux對比Windows之類的討論，甚至爭的面紅耳赤，這是沒有必要的\n這種爭論是浪費時間而沒有任何用處的。對，你花了一下午，用許多事實“捍衛”了Linux比Windows好這個說法。但是Windows的支持者並不會喜歡上Linux的，他們只是稍微退縮一下，然後找一些新的證據來跟你辯論。\n世界上的人們都在利用Linux的研究最前沿的科學，我們還在這裡討論“要不要用Linux的這種無聊的問題，什麼時候才能趕上時代前進的步伐？\n什麼叫做Window支持者，什麼叫做Linux的支持者？我們為什麼要支持某一個而反對另外一個？你不需要為 Linux的護法，不需要成為 Linux的支持者“或者”GNU的傳教士“ GNU / Linux的已經用事實向世界證明了它們的威力，已經被大多數人接受。你只需要安安靜靜享受的GNU / Linux的給你的樂趣和自由。\n你需要關心的不是你的工具是什麼，而是你用它做了什麼。精通的Linux並不說明任何問題，因為它只是一個工具而已。如果你用的Windows能很好的完成你的任務，那你就沒有必要費時間去熟悉Linux操作系統。直到有一天你發現一項任務只有Linux操作系統才能完成的時候再換也不遲，因為你身邊的的Linux的愛好者一定會很樂意的幫助你。\n如果你在使用Linux操作系統的過程中對它產生了感情，那麼你應該明白那些習慣於使用Windows的人也會對Windows產生依賴。類似的爭論還有很多：微軟 Office Word和TeX，Emacs和Vim，Wolfram Mathematica和Maple，侏儒，fvwm的和KDE的時候，狗派… …和冷靜地對自己說：“我不站在它們任何一邊。”儘管這有些不容易辦到。\n各人的需要不同，生活的環境不同。對你來說好的東西，對別人來說不一定好，我們需要尊重別人的選擇。如果你當面說別人正在用的程序不好，沒有必要。\n不要強迫自己\n喜歡電腦的人總是有某些心理強迫傾向。有的人說：“鍵盤比滑鼠快。我不要用滑鼠。這樣才有高效率。”所以他在編輯器裡無論什麼時候總是用20W的，大於 10J這樣的命令到達目的點。他甚至覺得圖形界面是多餘的，乾脆都不裝 Xwindow。\n全部用鍵盤看起來的確比讓手離開鍵盤去拿鼠標，再回來“快”多了，但是快的擊鍵頻率不等於工作的高效率，對你的健康更沒有什麼好處。這只能把你變成打鍵盤的機器。\n當你正在檢查你的文章或者程序，思維正在隨著字符的含義流動，突然為 20W，大於 10J這樣的東西出現在你的腦子裡，是不是會打斷思路？不？那說明你當時思考的問題比較簡單，這些干擾還不會起到副作用。\n其實很多人用電腦的時候，思想都受到某種教學的束縛，上面這個只是教多數種類中的一種。某些人創造了很多這種數學，用他的工作方式來要求別人，嘲笑方式跟他不一樣的人。比如有的人嘲笑其它人寫程序不按ç 8字符縮進，嘲笑別人在六裡用方向鍵，嘲笑別人不知道是什麼增值稅，嘲笑其它人用在Java，C＃這種由地方選區回收內存語言 … …\n你不用管各種各樣的教學，電腦只是你的工具，你想怎麼用就怎麼用。沒有人能夠約束你，沒有人可以嘲笑你的工作方式。電腦明天就不再是這個樣子，所以今天你不用完全了解它。你沒有必要知道別人創造的一切，因為你需要留點時間自己創造些東西。只要有樂趣！\n當你下次修改文章的時候，不妨試試悠閒的用滑鼠在你眼睛看到的地方輕輕點一下。\n如果你發現自己有類似的強迫症，建議去諮詢一下心理醫生。\n不要“玩”Linux\nLinux的很多人用的時候會感覺很迷茫，該用哪個發行版本呢？是不是我少裝了什麼？怎麼升級這麼快啊！怎麼這麼不穩定！每當遇到新的軟件他就想試用，每當新的版本出現，他就更新，然後用鼠標在新的菜單裡選擇從來沒見過的程序來用用。\n其實你是為了玩Linux而使用Linux操作系統的，而沒有找到正確的理由來利用Linux操作系統。你首先要明確用電腦的目的，你用它是為了解決你的實際問題，而不是為了學習安裝操作系統，不是為了測試哪個版本好用，不是為了“趕上潮流，更不是因為你硬盤太大了，你想多佔點空間。\n如果你啟動了電腦之後不知道應該幹什麼，那麼最好先不要用電腦，因為你可能有更重要的事情需要做。這沒什麼說的。\n不用挑剔發行版本\n很多人剛開始用linux的時候，總是在懷疑別的發行版本是否比自己正在用的這個好，總是懷疑自己以後什麼時候會失去支持，不得不換用別的發行。所以很多人今天是紅帽，明天又換成了Debian的，一會兒又是巴布亞… …甚至有的人在一台機器上裝了兩個版本的Linux操作系統，然後比較哪一個好。\n其實你完全沒有必要這樣做，任何發行，只要你熟悉了，你在上面的工作方式幾乎不會受到任何影響。我以前一直用的紅帽，當我有一天在我的一台新機器上安裝Debian時，我發現使用紅帽的經驗完全沒有浪費。我用了一個下午就配置好了Debian，使它服服貼貼的聽我的話，就跟沒有換發行版本一樣。\nDebian，拓林思，SuSE，紅帽，Gentoo… …任何一個版本都是不錯的。很多人認為自己攢一個 LFS的是高水平黑客的象徵，但是不是每個人都有精力去了解所有細節。\n不要盲目升級\n不知道這是心理作用還是什麼，有的人看到比較大的版本號，就會很想換成那個。很多人的Redhat的本來配置的很舒服了，可是一旦Redhat的發行新的版本，他們就會盡快下載過來，然後選擇升級安裝。結果很多時候把自己原來修改得很好的配置文件給沖掉了。新的軟件又帶來了新的問題，比如有一次我的rxvt的就升級到2.7.8跟miniChinput衝突了，升級到Redhat的8.0，xmms的發現居然缺省不能放了MP3播放，XFree86的是i810的模塊在啟動上有新的漏洞，Mozilla中，會導致突然退出。\n如果你已經配置好了一切，千萬別再整體升級了，這會浪費你很多很多時間的，不值得。有句話說得好：“如果沒有打破，不解決它。”如果你的程序能夠完成你需要做的事情，你何必升級呢？？？？\n是的，不論是從論壇還是其他的地方反映出來的大部分都是這個問題，要么比较SUSE和Ubuntu的好，要么比Ubuntu或者Mandriva的好等等的言論。很多人還是把Linux操作系統看成了一個表面的東西。並沒有塌下心來學習 Linux系統。\n不要配置你不需要的東西\n如果你只想做一個像我這樣的普通用戶，主要目的是用的Linux來完成自己的科研任務和日常工作，那就可以不用系統管理員或者網絡管理員的標準來要求自己，因為當一個系統和網絡管理員確實很辛苦。普通用戶學習那些不經常用到的複雜的維護系統的工具，其實是浪費時間，學了不用是會很快忘記的！\n我不是一個合格的網絡管理員，我的服務器都只設置了我自己需要的功能，設置好ssh連接的ftp已經足夠了，那樣可以省去我很多麻煩。我從來不過度考慮“安全，因為 Linux操作系統缺省已經很安全了。我沒有磁帶機，就不用管tar的那些稀奇古怪的參數了，czf，xzf，ztf已經可以滿足我所有的需要。桑達，awk的，…我也只會幾種常用的命令行。\n不要習慣的使用根帳號。在需要的時候才用！\n這是很多剛接觸的UNIX類操作系統的人常見的現象，他們不喜歡在管理系統的時候才用，而是一直用根帳號幹所有事情，配置系統，安裝程序，瀏覽網頁，玩遊戲，編程 … …\n結果有一天，他不小心在某個系統目錄使用了del * …後果不堪設想 … …\n不要用商業的眼光來看待Linux\nLinux不是商業軟件，所以不要用要求Solaris操作系統，視窗那樣的眼光來看 Linux操作系統。自由軟件的作者們從來不拉攏用戶，他們對用戶不負有任何責任。實際上在自由軟件的世界裡，開發者“和”用戶“並沒有明確的界限，大家是朋友。\n自由軟件很可能只是滿足作者和他的朋友的需要，甚至是為了好玩而創造的。自由軟件不是完美的，自由軟件承認自己有缺點，它不會自吹自擂，蒙蔽“用戶”的耳目。這種對作者責任的解脫激發了作者的創造力，他們不用過分考慮“向上兼容，他們往往比背上重重包袱的商業軟件結構更合理，技術更先進。\n所以當你用某個自由軟件遇到困難的時候，不應該埋怨軟件的作者，因為他們對你並沒有義務。你不應該把自己當成一個挑剔的顧客，而要把自己作為這個軟件的顧問和一個和藹的建議者，這樣你才能理解作者寫這個程序時的快樂，在遇到問題時向作者反映，幫助他完善這個軟件，成為一個快樂的參與者。就像你的哥哥送你一個他用舊了的自行車，你應該珍惜這份友情，而不要在車壞了，或者騎車摔了一跤的時候大罵你的哥哥。如果你真的不能使用這種合作的心態，那麼最好不要使用這個軟件。\n這是一種先進的文化，它包含了互相合作，科學創新的精神。理解這一點不是很容易，很多人往往是因為不能理解這種文化而離開自由軟件。這對於作者來說並沒有什麼損失。\n幹你的正事去\n很多人跟我說，你的網頁浪費我好多時間來配置這配置那，一會兒是fvwm的，一會兒是Mutt中… …\n嗯… …那些東西都是我有空的時候一點一點積累的，如果你想一次性搞定所有那些東西，恐怕得花你幾個星期甚至幾個月的時間！並不是一定要搞定所有這些東西你才能正常工作的。除非你真的非得利用某個程序，或者你閒著沒事，否則你可以不管這些東西。\n上面幾條僅供參考\n以上只是個人意見，不一定適合所有人。取捨由你了！\nSettings gnome-control-center\nDNS 最近经常出现 Firefox 可以打开 GitHub 网站，但是命令行 Git 无法拉取/推送代码的情况。甚至开了 VPN 也不行。运行 ping 命令发现 github.com 被解析到了 127.0.0.1，这是 DNS 被劫持了。是谁搞的鬼，相信你一定懂得。\n为啥 Firefox 可以打开 GitHub 最新的 Firefox 桌面版默认启用了 DoH（DNS over HTTPS），通过向特定的服务器发送 HTTPS 请求获取域名的 IP 地址。这就绕过了电信/联通/移动等提供的有毒 DNS 服务器。因为 DoH 采用 HTTPS 协议，不容易被劫持。另外国内用 Firefox 的很少，这个技术并不普及，所以暂时没有被老大哥盯上。\n但是很可惜，DoH 目前无法在 Linux 系统层面支持，运行命令行仍然是使用 ISP 提供的 DNS 服务器。电信/联通/移动经常抽风，甚至某些路由器都会给你下毒，让你打不开网页或者直接跳到某网址导航。\n为啥开了 VPN 也不行 因为通常是先连接本地网络，这时候已经从 ISP 获取了一个 DNS 服务器。再连接 VPN，（以 OpenVPN 为例）仍然是用的这个 DNS 服务器。\n某些商业 VPN 客户端是会在连接上 VPN 之后自动更换 DNS 服务器的。但是 Linux 自带的网络管理是没这个能力的。\n因此，如果你只用 Linux 自带的网络管理，最好的解决方法依然是手动设置一个可靠的 DNS 服务器。\nDNS 服务器哪家强 如果你去网上搜，很多老的文章会推荐这两个：\nGoogle 的 8.8.8.8 Cloudflare 的 1.1.1.1 这两个 DNS 还是能用的，但是在有些地方不太稳定，甚至直接连不上。\n目前还是推荐国内正规企业提供的 DNS 服务器：\nDNSPod/腾讯云 119.29.29.29 阿里云 223.5.5.5 并不能保证腾讯和阿里的 DNS 百分之百可靠，但是比电信/联通/移动好太多。起码 GitHub 是可以正常解析的。\n如何设置 DNS 这里就只介绍普通桌面用户用 NetworkManager 和 KDE 的用法。GNOME 基本类似。用 Wicked 的都是技术大佬，相信也不用看下面这些了。\n从系统托盘网络图标右击，打开“网络设置”。 选择你的有线或者 WiFi 链接，进行编辑。 切换到 IPv4 标签页。 将“方法”从“自动”改成“自动（仅网络地址）”。 将“DNS服务器”改成“119.29.29.29”。 点“应用”并关闭“网络设置”窗口。 点击系统托盘的网络图标，打开网络列表，断开并重新链接。 注意，如果需要频繁更换不同的 WiFi 链接，则需要对不同的 WiFi 配置添加自己的 DNS 服务器。\n如果是自己家的网络，可以在路由器上配置，方法和上面类似，都是配置 IPv4 方法和 DNS 服务器。（注意，路由器的 WAN 互联网和 LAN 局域网设置都要配一下）这样家里的设备就不用单独配置了。\nCLI\n# 显示当前网络连接 $ nmcli connection show # 修改当前网络连接对应的DNS服务器，这里的网络连接可以用名称或者UUID来标识 $ nmcli con mod ens160 ipv4.dns \"8.8.4.4 8.8.8.8\" # 配置生效 $ nmcli con up ens160 或者\n# Config File $ vi /etc/netplan/01-network-manager-all.yaml network: version: 2 renderer: NetworkManager ethernets: ens3: dhcp4: no addresses: - 192.168.100.199/24 gateway4: 192.168.100.1 nameservers: address: [8.8.4.4, 8.8.8.8] wifis: ... # Apply the changes you made in the config file $ sudo netplan apply # To check if the system successfully applied the changes $ systemd-resolve --status | grep 'DNS Servers' -A2 DNS Servers: 8.8.4.4 8.8.8.8 注意：您系统上的文件可能缺少整个以太网或 wifi 部分。 在这种情况下，添加缺少的行，确保遵守示例中提供的缩进。\nTesting the Domain Name Resolution Speed\n$ time dig @8.8.4.4 清空 DNS 缓存 因为 DNS 记录是有本地缓存的，即使你更换了 DNS 服务器，依然会优先从缓存里取 IP 地址。所以更换 DNS 之后，需要清空 DNS 缓存。\n这是一个比较头疼的问题，因为各家 Linux 发行版用来管理 DNS 的方式不一样，清空 DNS 缓存的方法也不一样。最通用的方法：重启系统。\n如果不想重启系统，那么可以参考这篇How to flush the DNS cache on Linux 。我大概总结一下，就是逐个试下面的命令：\n$ sudo systemd-resolve --flush-caches $ sudo systemctl restart nscd $ sudo systemctl restart named 如果没有用的话，还是重启系统吧。\n测试 DNS 解析 首先用 nslookup 测试一下 DNS 服务器是否能解析，如果解析出来的 Server 是你之前配的地址，Address 不是 127.0.0.1 或者 0.0.0.0 这种，应该就是好的。\n$ nslookup github.com Server: 119.29.29.29 Address: 119.29.29.29##53 Non-authoritative answer: Name: github.com Address: 20.205.243.166 但是 nslookup 能解析，并不意味着就能连上。实际连接还要看 ping 命令。注意 github.com 并不回应 ping 请求，也就是数据包都会 lost，这是正常的。只要 ping 能解析到 IP 地址就行了。\n$ ping github.com PING github.com (20.205.243.166) 56(84) 字节的数据。 ^C --- github.com ping 统计 --- 已发送 3 个包， 已接收 0 个包, 100% packet loss, time 2049ms 如果 ping 没问题，最后再试一下 git pull 命令。如果不能访问，则需要试试 VPN 了。\nOthers Bluetooth: OFF Formats: United States Night Light: ON Blank screen: 10 Touchpad: OFF Fractional Scaling SoftWare\u0026Updates software-properties-gtk or software-properties-kde (Kubuntu) and update-manager (Software Updator)\nUbuntu Software 栏 Download from 选择 USTC MIRRORS。也可以在 Official Archive Mirrors for Ubuntu 中选择。\nOther Software 栏下开启 Canonical Partner Repositories (The partner repositories offer access to proprietary and closed-source software)。\nUbuntu 自动下载并安装对你的系统至关重要的安全更新。而这个自动更新经常导致你“无法锁定管理目录”错误。在 Updates 栏下选择\nFor other packages, subscribe to: All updates Automatically check for updates: Every two weeks When there are security updates: Download and Install automatically When there are other updates: Display immediately Notify me of a new Ubuntu version: For long-term support versions 更新系统:\n$ sudo apt update $ sudo apt upgrade $ sudo apt autoremove Livepatch: 更新内核不需要 Reboot required 了\n$ sudo ua attach Ubuntu Software \u0026 Update 卡在 cache refresh\n通过 apt update 可以看见是 Connecting to security.ubuntu.com Failed，解决办法是更改 /etc/hosts 文件添加其 IP，可通过 EASYCOUNTER 查找：\n## security.ubuntu.com 91.189.88.142 security.ubuntu.com 91.189.88.152 security.ubuntu.com 91.189.91.38 security.ubuntu.com 91.189.91.39 security.ubuntu.com ## archive.canonical.com 91.189.92.150 archive.canonical.com 91.189.92.191 archive.canonical.com 91.189.91.15 archive.canonical.com ## downloads.sourceforge.net 216.105.38.13 downloads.sourceforge.net ubuntu下如何获取源码包和源码\n在 Software \u0026 Updates 中选中 Source code，不要 Reload，因为很慢，在命令行中 update。或者在软件源配置文件 /etc/apt/sources.list 中添加 deb-src 项。\n获取 xxx 源码包的详细信息\n$ sudo apt-cache showsrc xxx 获取源码包，并将源码包解压到同名目录\n$ sudo apt-get source xxx Upgrade Ubuntu version\n打开 Software Updater 更新软件 打开 Software \u0026 Updates 选择 Updates 栏，在 Notify me of a new Ubuntu Version 中选择 For any new version 。 打开 Software Updater 更新到新 Ubuntu 版本。 使用 lsb_release -a 确认 Ubuntu 版本。 Input Method Editor 首先在 Language Support (gnome-language-selector，注意不要在终端中运行这个命令，因为环境不一样) 中下载语言包。\n里面的选择输入法实质是 im-config 这个包。\nIBus ubuntu libpinyin 输入法支持云拼音，只需要开启就可以了。\nEmoji input\nIBus supports the input of emoji icons. Type Ctrl+. or Ctrl+; and you will see the input prompt change to an underlined e character. You can then type the symbol or name of the emoji you want (e.g. :) or face) and press Space to render it. If you are satisfied with the result press Enter to submit it and exit emoji input mode, or press Space for a second time to open a dialog where you can further customize your desired emoji.\nSee ibus-emoji(7) for more information.\nUnicode input\nIBus supports the input of complex Unicode characters. Type Ctrl+Shift+u and you will see the input prompt change to an underlined u character. You can then type the code of the Unicode character you want and press Space or Enter to render and submit it.\n間隔號「·」U+00B7 搜狗细胞词库\n到hslinuxextra下载sougou-phrases-full.7z。\n经过与ibus开发者协商，ibus-pinyin的词库查找规则做了一些更改，只要在词库目录（就是有一个.db文件的那个目录，一般是/usr/share/ibus-libpinyin/db/目录）把新词库复制过来并改名为local.db就可以使用了，如果感觉词库不好，直接删除掉local.db，就可以让ibus使用原来的词库。\n覆盖以后，你把ibus重启一下ibus-daemon -d -x -r，如果你能打出下面的这个词组，说明生效了：\n弗雷德霍姆行列式 这个词库，基于ibus原有的android词库文件，另外增加了搜狗的细胞词库。\nFcitx 4 在Ubuntu Wayland 桌面中使用fictx管理中文输入法\n$ sudo apt install fcitx -y 设置 fcitx：\n在 Language Support 中选择 fcitx，全局应用，并恢复 ibus 自定义切换语言快捷键设置。\n(可选）wayland桌面默认不读取/etc/profile中的环境变量，而是从/etc/environment文件中读取，这是导致fcitx不能正常工作的原因。\n$ sudo vim /etc/environment INPUT_METHOD=fcitx GTK_IM_MODULE=fcitx QT_IM_MODULE=fcitx XMODIFIERS=@im=fcitx 输入法框架：\n搜狗输入法 for Linux 百度输入法Linux版 Google拼音 其他：\n百度输入法不能安装用于更换皮肤的 fcitx-ui-qimpanel，否则乱码。需要手动安装 fcitx-libs，否则开机不自动启动。 在 fcitx 与 sogoupinyin 安装完之后，需要重启才能使用。 皮肤：\nfcitx 皮肤：/usr/share/fcitx/skin sogoupinyin 皮肤：/usr/share/sogou-qimpanel/skin。 旧：可以改名为 zip 解压 新：受版权保护 Fcitx 5 安装 配置工具 KDE 下使用 kde-config-fcitx5， Gnome 下使用 fcitx5-config-qt。\n20.04 (20220122) 官方仓库里没有 Gnome 的配置工具 kcm-fcitx5（内含 fcitx5-config-qt），因此通过 ppa:zhsj/fcitx5 来安装\n$ sudo add-apt-repository ppa:zhsj/fcitx5 $ sudo apt-get update $ sudo apt install fcitx5 fcitx5-chinese-addons 或者也可以通过**通过 flatpak 安装**。\n安装后在 Ubuntu 在 Language Support 里修改输入法系统为 fcitx5，记得点击 Apply System-Wide。\n安装报如下错\nE: Failed to fetch http://103.95.217.6/ppa.launchpad.net/zhsj/fcitx5/ubuntu/pool/main/f/fcitx5-chinese-addons/fcitx5-module-cloudpinyin_5.0.4-1~ubuntu20.04.1~ppa1_amd64.deb 503 Service Unavailable [IP: 103.95.217.6 80] E: Aborting install. 可以在浏览器中打开链接直接下载。\n肥猫百万大词库 Download latest version of “zhwiki.dict” from https://github.com/felixonmars/fcitx5-pinyin-zhwiki/releases\nCopy into ~/.local/share/fcitx5/pinyin/dictionaries/ (create the folder if it does not exist)\n可以在设置中看到是否启用，或者输入 “jinjinjin” 会出现 “鑫”。\nfcitx5 皮肤绘制简易教程 Tips 通过 Fcitx5 输入特殊字符\n将光标定位到任意一个输入框内，然后按下 Ctrl + Alt + Shift + U，然后输入 circle one，您将会看到多种形式的 ①。alpha, beta, sigma 等同理。\nemoji表情\nfcitx输入法自带的表情名都是英文的，而且以两个:包含住的，例如🌹（玫瑰rose），按下;后，输入🌹即可打出玫瑰的图标（更多内置图标名字见 Fcitx Configuration =\u003e Addons =\u003e Quick Phrase =\u003e Editor =\u003e emoji-eac)。\nRIME RIME/中州韵输入法引擎（Rime Input Method Engine），是一个跨平台的可高度定制的输入法算法框架。基于这个算法框架，Rime 開發者與其他開源社區的參與者在 Windows、macOS、Linux、Android 等平臺上創造了不同的輸入法前端實現。每个平台都有各自的名称：\n【中州韵】 ibus_rime → Linux 【小狼毫】 Weasel → Windows 【鼠须管】 Squirrel → Mac OS X 在 Linux 下有两大主要的输入法支持框架：fcitx 和 IBus。\nfcitx 是 Free Chinese Input Toy for X 的简称。 IBus 是 Intelligent Input Bus 的简称。 Rime 二者都支持，有 ibus rime 和 fcitx-rime 两个版本。值得注意的是，基于 Fcitx 输入法框架的 fcitx-rime 是第三方软件，由 Fcitx 团队开发和维护。\n# ibus $ sudo apt install ibus-rime # fcitx4 $ sudo apt install fcitx-rime # fcitx5〔方案選單〕 $ sudo apt install fcitx5-rime 按组合键 Ctrl+` 或 F4 键唤出输入方案选单，由此调整 Rime 输入〔方案選單〕 法最常用的选项。您可通过方案选单切换已经安装的输入方案。\n更多中州韵输入法配置，请阅读晦涩的官方文档：\n用户指南 · rime/home Wiki 配置指南 · rime/home Wiki 方案設計書 · rime/home Wiki 必知必会 输入法代号：ibus_rime ibus 用户资料夹： ~/.config/ibus/rime/ fcitx 用户资料夹：~/.config/fcitx/rime fcitx5 用户资料夹：~/.local/share/fcitx5/rime 共享资料夹： /usr/share/rime-data/ 共享资料夹包含预设输入方案的源文件。 这些文件属于 Rime 所发行软件的一部份，在访问权限控制较严格的系统上对用户是只读的，因此谢绝软件版本更新以外的任何修改—— 一旦用户修改这里的文件，很可能影响后续的软件升级或在升级时丢失数据。\n在「部署 Rime」操作时，将用到这里的输入方案源文件、并结合用户定制的内容来编译预设输入方案。\n「用户资料夹」数据说明\n用户资料夹则包含为用户准备的内容，如\n〔全局設定〕 default.yaml 〔發行版設定〕 ibus_rime.yaml：定制外观一般情况下会在 \u003c发行版\u003e.custom.yaml 文件中进行配置，Linux 下就是 ibus_rime.custom.yaml，macOS 下是 squirrel.custom.yaml，windows 下就是 weasel.custom.yaml 〔預設輸入方案副本〕 \u003c方案标识\u003e.schema.yaml ibus_rime.schema.yaml ※〔安裝信息〕 installation.yaml ※〔用戶狀態信息〕 user.yaml 编译输入方案所产出的二进制文件：\n〔Rime 棱鏡〕 \u003c方案标识\u003e.prism.bin 〔Rime 固態詞典〕 \u003c词典名\u003e.table.bin：由系统文本词库（一般以xxx.dict.yaml结尾）通过「重新部署/deploy」生成的固态词典（一般以xxx.table.bin结尾），这部份词库因为在输入过程是固定不変的，所以存在用大量的词彚，也不允许用戸来直接删除。 〔Rime 反查詞典〕 \u003c词典名\u003e.reverse.bin 记录用户写作习惯的文件：\n※〔用戶詞典〕 \u003c词典名\u003e.userdb.kct：记录我们用戸输入习惯的用戸词典（一般以xxx.userdb.kct）结尾。这部份词库的词彚，正常情况下是由用戸输入的时候随时生成的；其词彚可以动态调整，数量理论上来说不会特别多，也允许用戸自行删除（shift+delete）。 ※〔用戶詞典快照〕 \u003c词典名\u003e.userdb.txt、\u003c词典名\u003e.userdb.kct.snapshot 見於同步文件夾 以及用户自己设定的：\n※〔用戶對全局設定的定製信息〕 default.custom.yaml ※〔用戶對預設輸入方案的定製信息〕 \u003c方案标识\u003e.custom.yaml ※〔用戶自製輸入方案〕及配套的詞典源文件 注：以上标有 ※ 号的文件，包含用户资料，您在清理文件时要注意备份！\n关于配置的位置问题\n要更改輸入方案裏面的選項，給輸入方案打補靪；\n要更改全局選項，給 default.yaml 打補靪；\n要更改「小狼毫」專屬的選項，如界面樣式，給 weasel.yaml 打補靪。\n總地來說規則是：要修改的配置項在 x(.schema).yaml 裏，就編輯 x.custom.yaml 打補靪。\n定制 定制指南 当用户需要对 Rime 中的各种设定做小幅的调节，最直接、但不完全正确的做法是：编辑「共享资料夹」中那些 .yaml 文档（/usr/share/rime-data/ ）。\n这种方法有很大缺陷：\n当 Rime 软件升级时，也会升级各种设定档、预设输入方案。用户编辑过的文档会被覆盖为更高版本，所做调整也便丢失了。 软件升级后，你不能将备份文件直接覆盖升级后的文件。这将失去本次升级所新增和修复的功能。唯一的方法是，重新编辑升级后的文件。 因此，对于随 Rime 发行的设定档及预设输入方案，推荐的定制方法是：\n在「用户资料夹」下创建 .yaml 定制文档；比如\ndefault.yaml 的定制文件名为 default.custom.yaml luna_pinyin 的定制文件名为 luna_pinyin.custom.yaml luna_pinyin_simp 的定制文件名为 luna_pinyin_simp.custom.yaml symbols.yaml 的定制文件名为 symbols.custom.yaml 规范为在文件名主体（ID）和 .yaml 之间增加次级扩展名 .custom。定制文档的书写格式为：\npatch: \"一级设定项/二级设定项/三级设定项\": 新的设定值 \"另一个设定项\": 新的设定值 \"再一个设定项\": 新的设定值 \"含列表的设定项/@n\": 列表第n个元素新的设定值，从0开始计数 \"含列表的设定项/@last\": 列表最后一个元素新的设定值 \"含列表的设定项/@before 0\": 在列表第一个元素之前插入新的设定值（不建议在补丁中使用） \"含列表的设定项/@after last\": 在列表 \"一级设定项/二级设定项/三级设定项\": 新的设定值最后一个元素之后插入新的设定值（不建议在补丁中使用） \"含列表的设定项/@next\": 在列表最后一个元素之后插入新的设定值（不建议在补丁中使用） 就是这样：patch 定义了一组「补丁」，以源文件中的设定为基础，写入新的设定项、或以新的设定值取代现有设定项的值。\n每次修改配置文件，你需要重新部署来生效。\n重新部署的操作方法\n点击输入法的程序指示器，选择「部署」\n点击输入法状态栏上的 ⟲ (Deploy) 按钮。如果找不到状态栏，在终端输入以下命令，可触发自动部署：\n# ibus $ rm ~/.config/ibus/rime/default.yaml; ibus-daemon -drx 定制每页候选数 Rime 中，默认每页至多显示 5 个候选项，而允许的范围是 1〜9（个别 Rime 发行版可支持 10 个候选）。\n设定每页候选个数的默认值为 9，在用户目录建立定制文档 ：\n$ vi ~/.config/ibus/rime/default.custom.yaml patch: \"menu/page_size\": 9 重新部署即可生效。\n注意！ 如果 default.custom.yaml 里面已经有其他设定内容，只要以相同的缩进方式添加 patch: 以下的部分，不可重复 patch: 这一行。\n定制方案选单 $ vi ~/.config/ibus/rime/default.custom.yaml patch: # 對於列表類型，現在無有辦法指定如何添加、消除或單一修改某項，於是要在定製檔中將整個列表替換！ schema_list: - schema: luna_pinyin - schema: cangjie5 - schema: luna_pinyin_fluency - schema: luna_pinyin_simp # 這樣就啓用了未曾有過的高級輸入方案！其實這麼好的方案應該排在最前面哈。 - schema: my_coolest_ever_schema 调整方案候选顺序，增加输入法方案，或者通过 # 注释内容将不用的方案移除候选菜单。\n重新部署生效。\n定制字体字号 GNOME 桌面可以使用扩展 IBus Tweaker。\n$ vi ~/.config/fcitx/rime/default.custom.yaml patch: # 字體名稱，從記事本等處的系統字體對話框裏能看到 \"style/font_face\": \"明兰\" # 字號，只認數字的，不認「五號」、「小五」這樣的 \"style/font_point\": 16 横排与竖排候选码 在ibus_rime.custom.yaml添加如下内容：\npatch: style/horizontal: true 定制皮肤 注：ibus用户 ibus_rime.custom.yaml 不包含控制配色、字體字號等外觀樣式的設定項。\nRime 中，输入法的显示效果称为「颜色主题」(color scheme)。在网上看到一个有趣的主题，如何添加到 Rime 中使用呢？假如我们要加入这里提供的「丹青」主题，在系统 custom 设置文件中加入以下配置即可：\n# 在配色方案列表裏加入標識爲 tantsing 的新方案 \"preset_color_schemes/tantsing\": author: Mijiag back_color: 0xE3E3E3 border_color: 0x000000 candidate_text_color: 0x000000 comment_text_color: 0x474747 hilited_back_color: 0x1A0791 hilited_candidate_back_color: 0x6F0B73 hilited_candidate_text_color: 0xE3E3E3 hilited_text_color: 0xE3E3E3 name: \"丹青/Tantsing\" text_color: 0x000000 引用该主题的时候，使用名字 tantsing：\n# squirrel.custom.yaml patch: style: color_scheme: tantsing horizontal: true inline_preedit: true font_point: 16 corner_radius: 5 candidate_format: \"%c\\u2005%@ \\u2005\" 如果要自己制作 Rime 主题，「Rime 西米」是一款网页端工具，可以辅助制作，实时渲染颜色，便于查看最终显示效果。这里有一些预定义的主题可供使用。\n输入符号 符号文件 /usr/share/rime-data/symbols.yaml 开头已经说明了使用方法：\n# Usage: patch your Rime schema to enable /X symbols: # patch: # punctuator/import_preset: symbols # recognizer/patterns/punct: '^/([0-9]0?|[A-Za-z]+)$' 想在朙月拼音·简化字 luna_pinyin_simp 方案下输入符号，就新建 luna_pinyin_simp.custom.yaml：\npatch: punctuator/import_preset: symbols recognizer/patterns/punct: '^/([0-9]0?|[A-Za-z]+)$' 重新部署生效。\n输入符号请键入识别码：\n星号 /xh 箭头 /jt 數字 /1 更多符号参阅文件 symbols.yaml。 其他方案下输入符号，照葫芦画瓢。\n符号自定义 拷贝 /usr/share/rime-data/symbols.yaml 为 ~/.config/ibus/rime/symbols.custom.yaml。在末尾添加自定义符号：\n# 个人常用信息 '/yx': [ xiaoming@gmail.com, xiaoming@163.com, 1234567910 ] # 快速输入勾和叉 '/gc': [ ✓, ☑, ✗, ☒ ] 想在朙月拼音·简化字 luna_pinyin_simp 方案下输入符号，就修改 luna_pinyin_simp.custom.yaml 文件内容为：\npatch: punctuator/import_preset: symbols.custom recognizer/patterns/punct: '^/([0-9]0?|[A-Za-z]+)$' 重新部署生效。\n然后在中文模式下，输入 /gc，就会显示出自定义的符号，输入对应的数字，符号就会上屏。\n输入直角引号 有的人喜欢在写作的时候使用直角引号：「」和『』，Rime 在 symbols.yaml 里面，已经提供了这个功能，不过是在 [ 和 ] 按键上提供的，中文输入法状态下，按下[ (])，返回的结果中包含 「 (」)，如果按住 Shift 键，按下 [ (])，返回的结果中包含 『 (』)。\n但是因为这毕竟是引号，最好是按下引号的时候，能够输出直角引号，在symbols.custom.yaml 中，找到 punctuator 部分下的 hafl_shape (半角的意思)下面，把下面的映射\n'''' : { pair: [ '‘', '’' ] } '\"' : { pair: [ '“', '”' ] } 改成\n'''' : { pair: [ '『', '』' ] } '\"' : { pair: [ '「', '」' ] } 这样就可以直接输入直角引号了，另外一种方式就是在词典中添加直角引号映射，在jdhao.dict.yaml 中加入下面的映射即可：\n「」\tsyh\t1000 『』\tdyh\t1000 扩展词库 下载Rime 擴充詞庫：\nluna_pinyin.hanyu.dict.yaml luna_pinyin.cn_en.dict.yaml luna_pinyin.extended.dict.yaml luna_pinyin.poetry.dict.yaml 接着将四个文件移动到用户资料夹 ~/.config/ibus/rime 下。\n新增一個自訂的 luna_pinyin_simp.extended.dict.yaml 檔案：\n# 以下禁用了默认词库同时不启用默认的“八股文”词库及词频系统,如果您不希望候选词中的出现繁体字、方框字的话 --- name: luna_pinyin_simp.extended version: \"2022.08.21\" sort: by_weight use_preset_vocabulary: false #是否启用默认的“八股文”词库及词频系统,如需启用请设为 true import_tables: #在此导入词库 #- luna_pinyin - luna_pinyin.hanyu - lluna_pinyin.cn_en - luna_pinyin.extended - luna_pinyin.poetry ... 接着再於 luna_pinyin_simp.custom.yaml 中將 translator/dictionary 設置成此字典檔即可\npatch: translator/dictionary: luna_pinyin_simp.extended # 词典名字可自定义，保持一致即可 重新部署生效。\n其他扩展词库：\nssnhd/rime 1.5k（🗸）\nwongdean/rime-settings 1.3k\nfkxxyz/rime-cloverpinyin 1.1k（用过）\nthunlp/THUOCL 610\nayaka14732/awesome-rime 383\nLoganJC/rime-dict 289\nxiaoTaoist/rime-dict 226（用过）\nyangshann/rime-dict 48（用过）\n增加自己的词库 我们可以仿照上一步的词典文件建立自己额外的词典，增加自己的词汇。例如，建立名为 my.dict.yaml 的文件，然后参照 luna_pinyin_simp.cn_en.dict.yaml 添加几个自己常用的词汇，文件内容如下：\n# my.dict.yaml 文件内容 # Rime dictionary # encoding: utf-8 # --- name: my version: \"2020.05.28\" sort: by_weight use_preset_vocabulary: true ... GitHub\tgithub\t100 Stack Overflow\tso\t1000 词典的格式为: 词汇编码词频，各个项目之间必须用 Tab（也就是制表符 ）分割。一个最保险的方法就是，复制粘贴。词频部分可以不要。\n然后在 luna_pinyin_simp.extended.dict.yaml 的 import_tables 中加上自己建立的词汇。\nimport_tables: - my 一切添加妥当之后，重新部署生效。\n默认英文 如果经常和英语打交道，偶尔输入汉字，可以把朙月拼音初始状态设为英语，需要时再切回中文。参考 这里 给出的说明，在 luna_pinyin_simp.custom.yaml 文件中加入下面的设置：\npatch: \"switches/@0/reset\": 1 # 初始的 ascii mode 设置为「西文」 意思就是將 switcher 列表中的第一個元素（即 ascii_mode 開關）的初始值重設爲狀態1（即「英文」）。\n模糊拼音 这里是官方给的一个模板 （朙月拼音）。将模板剪贴进 ~/.config/ibus/rime/luna_pinyin_simp.custom.yaml 文件中，然后需要哪组就去掉那一行前面的 # 即可。\n# luna_pinyin.custom.yaml # # 【朙月拼音】模糊音定製模板 # 佛振配製 :-) # # 位置： # ~/.config/ibus/rime (Linux) # ~/Library/Rime (Mac OS) # %APPDATA%\\Rime (Windows) # # 於重新部署後生效 # patch: 'speller/algebra': - erase/^xx$/ # 第一行保留 # 模糊音定義 # 需要哪組就刪去行首的 # 號，單雙向任選 #- derive/^([zcs])h/$1/ # zh, ch, sh =\u003e z, c, s #- derive/^([zcs])([^h])/$1h$2/ # z, c, s =\u003e zh, ch, sh #- derive/^n/l/ # n =\u003e l #- derive/^l/n/ # l =\u003e n # 這兩組一般是單向的 #- derive/^r/l/ # r =\u003e l #- derive/^ren/yin/ # ren =\u003e yin, reng =\u003e ying #- derive/^r/y/ # r =\u003e y # 下面 hu \u003c=\u003e f 這組寫法複雜一些，分情況討論 #- derive/^hu$/fu/ # hu =\u003e fu #- derive/^hong$/feng/ # hong =\u003e feng #- derive/^hu([in])$/fe$1/ # hui =\u003e fei, hun =\u003e fen #- derive/^hu([ao])/f$1/ # hua =\u003e fa, ... #- derive/^fu$/hu/ # fu =\u003e hu #- derive/^feng$/hong/ # feng =\u003e hong #- derive/^fe([in])$/hu$1/ # fei =\u003e hui, fen =\u003e hun #- derive/^f([ao])/hu$1/ # fa =\u003e hua, ... # 韻母部份 #- derive/^([bpmf])eng$/$1ong/ # meng = mong, ... #- derive/([ei])n$/$1ng/ # en =\u003e eng, in =\u003e ing #- derive/([ei])ng$/$1n/ # eng =\u003e en, ing =\u003e in # 樣例足夠了，其他請自己總結…… # 反模糊音？ # 誰說方言沒有普通話精確、有模糊音，就能有反模糊音。 # 示例爲分尖團的中原官話： #- derive/^ji$/zii/ # 在設計者安排下鳩佔鵲巢，尖音i只好雙寫了 #- derive/^qi$/cii/ #- derive/^xi$/sii/ #- derive/^ji/zi/ #- derive/^qi/ci/ #- derive/^xi/si/ #- derive/^ju/zv/ #- derive/^qu/cv/ #- derive/^xu/sv/ # 韻母部份，只能從大面上覆蓋 #- derive/^([bpm])o$/$1eh/ # bo =\u003e beh, ... #- derive/(^|[dtnlgkhzcs]h?)e$/$1eh/ # ge =\u003e geh, se =\u003e sheh, ... #- derive/^([gkh])uo$/$1ue/ # guo =\u003e gue, ... #- derive/^([gkh])e$/$1uo/ # he =\u003e huo, ... #- derive/([uv])e$/$1o/ # jue =\u003e juo, lve =\u003e lvo, ... #- derive/^fei$/fi/ # fei =\u003e fi #- derive/^wei$/vi/ # wei =\u003e vi #- derive/^([nl])ei$/$1ui/ # nei =\u003e nui, lei =\u003e lui #- derive/^([nlzcs])un$/$1vn/ # lun =\u003e lvn, zun =\u003e zvn, ... #- derive/^([nlzcs])ong$/$1iong/ # long =\u003e liong, song =\u003e siong, ... # 這個辦法雖從拼寫上做出了區分，然而受詞典制約，候選字仍是混的。 # 只有真正的方音輸入方案纔能做到！但「反模糊音」這個玩法快速而有效！ # 模糊音定義先於簡拼定義，方可令簡拼支持以上模糊音 - abbrev/^([a-z]).+$/$1/ # 簡拼（首字母） - abbrev/^([zcs]h).+$/$1/ # 簡拼（zh, ch, sh） # 以下是一組容錯拼寫，《漢語拼音》方案以前者爲正 - derive/^([nl])ve$/$1ue/ # nve = nue, lve = lue - derive/^([jqxy])u/$1v/ # ju = jv, - derive/un$/uen/ # gun = guen, - derive/ui$/uei/ # gui = guei, - derive/iu$/iou/ # jiu = jiou, # 自動糾正一些常見的按鍵錯誤 - derive/([aeiou])ng$/$1gn/ # dagn =\u003e dang - derive/([dtngkhrzcs])o(u|ng)$/$1o/ # zho =\u003e zhong|zhou - derive/ong$/on/ # zhonguo =\u003e zhong guo - derive/ao$/oa/ # hoa =\u003e hao - derive/([iu])a(o|ng?)$/a$1$2/ # tain =\u003e tian # 分尖團後 v =\u003e ü 的改寫條件也要相應地擴充： #'translator/preedit_format': # - \"xform/([nljqxyzcs])v/$1ü/\" 同步用户资料 默认地，词典快照备份到 ~/.config/ibus/rime/sync/UUID 这个地方。我们可以设定同步的目标文件夹，直接编辑 ~/.config/ibus/rime/installation.yaml：\nsync_dir: '/DATA/Backup/RimeSync' 然后，点击输入法程序指示器选择「同步」。你的 用户配置、用户词库 等都会被放在目标文件夹。\n注意！可能有些你自己添加的文件不会被备份，注意下就行。\n我们可以借助移动存储设备，或在线存储服务如百度网盘、坚果云等，在多台电脑及不同系统之间同步用户词典和用户设定。在新电脑上配置一下 installation.yaml 文件，执行 部署 -\u003e 同步 -\u003e 部署 ，你的 用户配置、用户词库 都回来了。\n新世纪五笔 参阅 https://github.com/GuoBinyong/wubixinshiji。Rime输入法之五笔自动上屏。\n后续配置来自视频 rime 中的小狼毫输入法的安装和基础自定义 所分享的文件： https://www.lanzous.com/ia2g86h。\nEasy english 用于输入英文。拷贝下面两个文件到「用户资料夹」：\neasy_en.schema.yaml easy_en.dict.yaml vim default.custom.yaml 添加输入方案：\nschema_list: - schema: wubixinshiji # 新世纪五笔 - schema: wubixinshiji_pinyin # 新世纪五笔·拼音 - schema: luna_pinyin_simp # 朙月拼音·简化字 - schema: easy_en - schema: pinyin_simp # 袖珍简化字拼音 输入日期 将文件 rime.lua 拷贝到 ~/.config/ibus/rime/ 下，在方案配置文件比如 wubi86.schema.yaml 的 engine\\translators: 下面添加滤镜引用：\ntranslators: - lua_translator@date_translator - lua_translator@week_translator rime-emoji 下載opencc檔案夾內容，將完整檔案夾放入Rime用戶檔案夾內 將emoji_suggestion.yaml內的內容加入至想添加Emoji的方案custom檔中 我安装后，没有显示emoji，所以还是用 gnome-characters 好了。\n切换中英文 切换中英文，rime在默认情况下，输入中文时按shift键会切换为英文，但字符还在，需要按回车输出字符，有的用户可能不习惯shift这个键位，或者不习惯按shift不直接上屏，还要按一下回车，对此，我们可以做出修改 default.custom.yaml：\npatch: ascii_composer/good_old_caps_lock: true ascii_composer/switch_key: Caps_Lock: clear Shift_L: commit_code Shift_R: inline_ascii Control_L: noop Control_R: noop 注意换行前空格以及冒号后的空格，还有字母大小写，前两行代码先不看，下面五行分别代表：\ncaps_lock即为大写键，shift_L即为左shift，R是右，control_L即为左ctrl键，R为右 冒号后的字符即为这个键位的操作 clear表示按下此键后已输入的字符清除，同时rime输入状态切换为英文，大写键一定不能改为noop，否则大写英文将会无法输出，很多教程里都改为了noop，这点值得注意 commit_code即为提交代码，就是将已输入的字符上屏，同时输入法切换为英文 inline_ascii即为插入字符，就是已输入的字符为上屏前，按此键后输入法转为英文，可以接着输入，回车键再上屏 noop就是这个键在输入法里不会有任何操作 各个键位和代码的意思已经介绍完了，可以按自己的喜好，自行修改。\n不过仍有部分用户从win7开始是用的ctrl键+空格键切换中英文，且习惯输入法为默认英文。RIME的快捷键是在“default.yaml”文档中定义的，我们可以将“default.yaml”文档中相关代码直接复制过来，接上面代码：\nkey_binder: bindings: - {accept: \"Control+Shift+2\", toggle: ascii_mode, when: always} 注意到ascii_mode了吗，“字符模式”即为我们需要的中英文切换快捷键，默认快捷键为ctrl+shift+2，我们可以将其代码修改为Control+space即为ctrl+空格，注意大小写，这样我们就能让输入法默认英文同时用回习惯的操作\n至此，关于default.custom.yaml的设置基本完成，样例如下：\npatch: ascii_composer/good_old_caps_lock: true ascii_composer/switch_key: Caps_Lock: clear Shift_L: noop Shift_R: noop Control_L: noop Control_R: noop key_binder/bindings: - { when: always, accept: Control+space, toggle: ascii_mode } - { when: has_menu, accept: minus, send: Page_Up } - { when: has_menu, accept: equal, send: Page_Down } 注意：如果没有Page_Up，Page_Down两行，就没办法用 + 与 - 进行翻页了。\n清空候选词 我使用ibus-rime，有一个很大的缺点是如果输入没有完成的情况下，移动鼠标，其他的输入法未完成的内容都会被清空，而只有rime不会，而且会重复输出未完成的内容，这点很烦人，也不知道哪里能够设置。\n定制快捷键\npatch: key_binder/bindings: - { when: composing, accept: Control+g, send: Escape } 使用 Sitch input sources individually for each window\nWallpapers Gnome Background 圖形使用者介面程式\n可以透過「圖形使用者介面程式」，來更改「桌面圖片」。在桌面，按下「滑鼠右鍵」，就會出現一個選單，選擇「Change Background…」。就會出現設定更改「桌面圖片」的操作介面。\n也就是「Settings / Background」。\n$ gnome-control-center background 指令操作\n也可以透過「gsettings」這個指令，來更改「桌面圖片」。\n$ gsettings set org.gnome.desktop.background picture-uri 'file:///usr/share/backgrounds/Blue_flower_by_Elena_Stravoravdi.jpg' 在測試的過程中發現，若使用「暗色系」的「佈景主題」，則要執行下面指令\n$ gsettings set org.gnome.desktop.background picture-uri-dark 'file:///usr/share/backgrounds/Blue_flower_by_Elena_Stravoravdi.jpg' 小技巧\n切換顯示桌面的按鍵組合是「Win + d」。\n$ gsettings get org.gnome.desktop.wm.keybindings show-desktop ['d', 'd', 'd'] Apps Shotwell：在侧边栏 Photos 中 Ctrl + A，在菜单栏 File 中选择 Set as Desktop SlideShow…；这会把图片复制到 .local/share/shotwell/wallpaper，并在该目录生成 wallpaper.xml，wallpaper.xml 定义自动切换壁纸动画。 替代软件：BingWall 等。 脚本分享：styli.sh、lswc、setwall 动态壁纸：komorebi、LiveWallpaper、PlasmaVideoWallpaper\u0026org.kde.video、dynamic-wallpaper\u0026pywal、plasma5-wallpapers-dynamic(Solar Dynamic Wallpaper) Variety 默认仓库版本可能较低，导致一些 Bug，因此最好用 PPA\n$ sudo add-apt-repository ppa:variety/stable $ sudo apt update $ sudo apt install variety -y 支持 wallhaven，添加 keywords 就可以使用了，配置文件在 ~/.config/variety/variety.conf ：\nTouhou Azur Lane Genshin Impact anime girls cosplay GUWEIZ WLOP unsplash.sh 添加脚本\n$ vi $HOME/Pictures/unsplash.sh #!/usr/bin/bash UNSPLASH_DIR=$HOME/Pictures/Unsplash if [ ! -d ${UNSPLASH_DIR} ]; then mkdir -p ${UNSPLASH_DIR} fi URL_LOCATION=$(curl -I https://source.unsplash.com/daily | grep Location | cut -d' ' -f 2) WALLPAPER_NAME=$(echo $URL_LOCATION | egrep -o 'photo[a-z0-9-]+') WALLPAPER_FORMAT=$(echo $URL_LOCATION | egrep -o 'fm=[a-z]+' | cut -d'=' -f 2) wget --no-proxy -O ${UNSPLASH_DIR}/${WALLPAPER_NAME}.${WALLPAPER_FORMAT} ${URL_LOCATION} 在 Unsplash Source 查看更多 API。 Curl to grab remote filename after following location 关于 cut 获取子字符串：Extract substring in Bash 可以使用 Crontab 定时切换壁纸：\n$ crontab -e 0 12 * * * /home/vane/Pictures/unsplash.sh 除了使用 crontab 外，还可以使用 Startup Applications Preferences 添加一个启动项。\nwallhaven.sh wallhaven图片右键下载的是原图，不是缩略图。\n$ vi $HOME/.wallhaven/wallhaven.sh #!/bin/bash WORK_DIR=$HOME/.wallhaven SAVE_DIR=$HOME/Pictures/wallhaven IMG_URL=https://w.wallhaven.cc/full function GetListing() { echo 'get listing' listing=$(curl https://wallhaven.cc/api/v1/search?apikey=\u0026categories=010\u0026purity=111\u0026atleast=1920x1080\u0026ratios=16x9\u0026sorting=random\u0026order=desc\u0026page=1) echo 'save listing' echo $listing | jq -r '.data[].path' | awk -F '/' '{print $NF}' \u003e $WORK_DIR/listing echo 'save res' cat $WORK_DIR/listing | wc -l \u003e $WORK_DIR/res SetWallpaper } function SetWallpaper() { if [ -a $WORK_DIR/res ]; then echo 'read res' read res \u003c $WORK_DIR/res if [ $res -ne 0 ]; then echo 'get img' img=$(cat $WORK_DIR/listing | tail -${res} | head -1) echo \"down $img from $IMG_URL/${img:10:2}/$img\" curl -o $SAVE_DIR/$img $IMG_URL/${img:10:2}/$img if [ $? -eq 0 ]; then echo 'set wallpaper' cp $SAVE_DIR/$img $HOME/Wallpaper echo 'res-1' echo $(($res - 1)) \u003e $WORK_DIR/res echo 'exit' exit 0 else echo 'download error' SetWallpaper fi else echo 'res=0' GetListing fi else echo 'no res' GetListing fi } SetWallpaper 使用 Shell 脚本来处理 JSON，jq Manual，wallhaven API v1 Documentation\n一般文件内容开头都会有一个文件类型的标记，根据文件名后缀只是一个快捷的方法，不用读取文件内容就判断文件类型，但不是唯一的方法。\n$ crontab -e 0 12 * * * /home/vane/.wallhaven/wallhaven.sh Gsettings 无法在 Cron 中使用：出现此问题是因为 cron 仅使用一组非常有限的环境变量。 唯一一个负责在将其设置为 cron 作业时以正确方式运行问题脚本的环境变量是 DBUS_SESSION_BUS_ADDRESS。\nastronomy.sh #!/bin/bash API_KEY=zTL5rJmctXwHcsjfCSalfDRNFTeaVYa9FxgINVVU HTTP_REQUEST=https://api.nasa.gov/planetary/apod?api_key=$API_KEY HTTP_RESPONSE=$(curl $HTTP_REQUEST) IMG_HDURL=$(echo $HTTP_RESPONSE | jq -r '.hdurl') IMG_FILENAME=$(echo ${IMG_HDURL##*/}) curl -o $HOME/DataOne/Images/Astronomy/$IMG_FILENAME $IMG_HDURL cp -av $HOME/DataOne/Images/Astronomy/$IMG_FILENAME $HOME/Wallpaper Wallpaper Slideshows 2018-04-23 18:53\n使用一个简单的 XML，你就可以设置 GNOME 能够在桌面上显示一个幻灯片。\n在 GNOME 中，一个非常酷、但却鲜为人知的特性是它能够将幻灯片显示为墙纸。你可以从 GNOME 控制中心的 “背景设置” 面板中选择墙纸幻灯片。在预览的右下角显示一个小时钟标志，可以将幻灯片的墙纸与静态墙纸区别开来。\n一些发行版带有预装的幻灯片壁纸。 例如，Ubuntu 包含了库存的 GNOME 定时壁纸幻灯片，以及 Ubuntu 壁纸大赛胜出的墙纸。\n如果你想创建自己的自定义幻灯片用作壁纸怎么办？虽然 GNOME 没有为此提供一个用户界面，但是在你的主目录中使用一些简单的 XML 文件来创建一个是非常容易的。 幸运的是，GNOME 控制中心的背景选择支持一些常见的目录路径，这样就可以轻松创建幻灯片，而不必编辑你的发行版所提供的任何内容。\n开始 使用你最喜欢的文本编辑器在 $HOME/.local/share/gnome-background-properties/ 创建一个 XML 文件。 虽然文件名不重要，但目录名称很重要（你可能需要创建该目录）。 举个例子，我创建了带有以下内容的 /home/ken/.local/share/gnome-background-properties/osdc-wallpapers.xml：\n\u003c?xml version=\"1.0\" encoding=\"UTF-8\"?\u003e \u003c!DOCTYPE wallpapers SYSTEM \"gnome-wp-list.dtd\"\u003e ","wordCount":"102212","inLanguage":"en","image":"https://sakamotokurome.github.io/Covers/ubuntu00.jpg.webp","datePublished":"2022-03-08T15:32:00+08:00","dateModified":"2022-03-08T15:32:00+08:00","author":{"@type":"Person","name":"Sakamoto Kurome"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://sakamotokurome.github.io/posts/ubuntup0desktop/"},"publisher":{"@type":"Organization","name":"Sakamoto Kurome","logo":{"@type":"ImageObject","url":"https://sakamotokurome.github.io/favicon.ico"}}}</script></head><body class=dark id=top><header class=header><nav class=nav><div class=logo><a href=https://sakamotokurome.github.io/ accesskey=h title="Sakamoto Kurome (Alt + H)">Sakamoto Kurome</a>
<span class=logo-switches></span></div><ul id=menu><li><a href=https://sakamotokurome.github.io/archives/ title=Archives><span>Archives</span></a></li><li><a href=https://sakamotokurome.github.io/search/ title="Search (Alt + /)" accesskey=/><span>Search</span></a></li><li><a href=https://sakamotokurome.github.io/tags/ title=Tags><span>Tags</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Ubuntu Desktop</h1><div class=post-meta><span title='2022-03-08 15:32:00 +0800 +0800'>March 8, 2022</span>&nbsp;·&nbsp;205 min&nbsp;·&nbsp;Sakamoto Kurome</div></header><figure class=entry-cover><img loading=lazy src=https://sakamotokurome.github.io/Covers/ubuntu00.jpg.webp alt="Ubuntu Logo"><p>UbuntuDesktop</p></figure><div class=toc><details><summary accesskey=c title="(Alt + C)"><span class=details>Table of Contents</span></summary><div class=inner><ul><li><a href=#%e5%ad%a6%e4%b9%a0-linux-%e5%87%a0%e7%82%b9%e5%bf%a0%e5%91%8ahttpswikiubuntuorgcne5ada6e4b9a0_linux_e587a0e782b9e5bfa0e5918a aria-label="学习 Linux 几点忠告"><a href=https://wiki.ubuntu.org.cn/%E5%AD%A6%E4%B9%A0_Linux_%E5%87%A0%E7%82%B9%E5%BF%A0%E5%91%8A>学习 Linux 几点忠告</a></a></li><li><a href=#settings aria-label=Settings>Settings</a><ul><li><a href=#dnshttpsguoyunheme20220529linux-gfw-dns aria-label=DNS><a href=https://guoyunhe.me/2022/05/29/linux-gfw-dns/>DNS</a></a><ul><li><a href=#%e4%b8%ba%e5%95%a5-firefox-%e5%8f%af%e4%bb%a5%e6%89%93%e5%bc%80-github aria-label="为啥 Firefox 可以打开 GitHub">为啥 Firefox 可以打开 GitHub</a></li><li><a href=#%e4%b8%ba%e5%95%a5%e5%bc%80%e4%ba%86-vpn-%e4%b9%9f%e4%b8%8d%e8%a1%8c aria-label="为啥开了 VPN 也不行">为啥开了 VPN 也不行</a></li><li><a href=#dns-%e6%9c%8d%e5%8a%a1%e5%99%a8%e5%93%aa%e5%ae%b6%e5%bc%ba aria-label="DNS 服务器哪家强">DNS 服务器哪家强</a></li><li><a href=#%e5%a6%82%e4%bd%95%e8%ae%be%e7%bd%ae-dns aria-label="如何设置 DNS">如何设置 DNS</a></li><li><a href=#%e6%b8%85%e7%a9%ba-dns-%e7%bc%93%e5%ad%98 aria-label="清空 DNS 缓存">清空 DNS 缓存</a></li><li><a href=#%e6%b5%8b%e8%af%95-dns-%e8%a7%a3%e6%9e%90 aria-label="测试 DNS 解析">测试 DNS 解析</a></li></ul></li><li><a href=#others aria-label=Others>Others</a></li></ul></li><li><a href=#softwareupdates aria-label=SoftWare&amp;amp;Updates>SoftWare&amp;Updates</a></li><li><a href=#input-method-editor aria-label="Input Method Editor">Input Method Editor</a><ul><li><a href=#ibushttpswikiarchlinuxorgtitleibus aria-label=IBus><a href=https://wiki.archlinux.org/title/IBus>IBus</a></a></li><li><a href=#fcitx-4 aria-label="Fcitx 4">Fcitx 4</a></li><li><a href=#fcitx-5httpsfcitx-imorgwikifcitx_5 aria-label="Fcitx 5"><a href=https://fcitx-im.org/wiki/Fcitx_5>Fcitx 5</a></a><ul><li><a href=#%e5%ae%89%e8%a3%85httpsplumzmearchives11740 aria-label=安装><a href=https://plumz.me/archives/11740/>安装</a></a></li><li><a href=#%e8%82%a5%e7%8c%ab%e7%99%be%e4%b8%87%e5%a4%a7%e8%af%8d%e5%ba%93httpsgithubcomfelixonmarsfcitx5-pinyin-zhwiki aria-label=肥猫百万大词库><a href=https://github.com/felixonmars/fcitx5-pinyin-zhwiki>肥猫百万大词库</a></a></li><li><a href=#fcitx5-%e7%9a%ae%e8%82%a4%e7%bb%98%e5%88%b6%e7%ae%80%e6%98%93%e6%95%99%e7%a8%8bhttpsforumsuseorgcnttopic14474 aria-label="fcitx5 皮肤绘制简易教程"><a href=https://forum.suse.org.cn/t/topic/14474>fcitx5 皮肤绘制简易教程</a></a></li><li><a href=#tips aria-label=Tips>Tips</a></li></ul></li><li><a href=#rimehttpswwwcnblogscomkeatonlaop12983158html aria-label=RIME><a href=https://www.cnblogs.com/keatonlao/p/12983158.html>RIME</a></a><ul><li><a href=#%e5%bf%85%e7%9f%a5%e5%bf%85%e4%bc%9a aria-label=必知必会>必知必会</a></li><li><a href=#%e5%ae%9a%e5%88%b6 aria-label=定制>定制</a><ul><li><a href=#%e5%ae%9a%e5%88%b6%e6%8c%87%e5%8d%97 aria-label=定制指南>定制指南</a></li><li><a href=#%e5%ae%9a%e5%88%b6%e6%af%8f%e9%a1%b5%e5%80%99%e9%80%89%e6%95%b0 aria-label=定制每页候选数>定制每页候选数</a></li><li><a href=#%e5%ae%9a%e5%88%b6%e6%96%b9%e6%a1%88%e9%80%89%e5%8d%95 aria-label=定制方案选单>定制方案选单</a></li><li><a href=#%e5%ae%9a%e5%88%b6%e5%ad%97%e4%bd%93%e5%ad%97%e5%8f%b7 aria-label=定制字体字号>定制字体字号</a></li><li><a href=#%e6%a8%aa%e6%8e%92%e4%b8%8e%e7%ab%96%e6%8e%92%e5%80%99%e9%80%89%e7%a0%81httpsgithubcomrimehomewikicustomizationguidee5b08fe78bbce6afabe5a496e8a780e8a8ade5ae9a aria-label=横排与竖排候选码><a href=https://github.com/rime/home/wiki/CustomizationGuide#%E5%B0%8F%E7%8B%BC%E6%AF%AB%E5%A4%96%E8%A7%80%E8%A8%AD%E5%AE%9A>横排与竖排候选码</a></a></li><li><a href=#%e5%ae%9a%e5%88%b6%e7%9a%ae%e8%82%a4httpsjdhaogithubio20190218rime_configuration_intro aria-label=定制皮肤><a href=https://jdhao.github.io/2019/02/18/rime_configuration_intro/>定制皮肤</a></a></li><li><a href=#%e8%be%93%e5%85%a5%e7%ac%a6%e5%8f%b7 aria-label=输入符号>输入符号</a></li><li><a href=#%e7%ac%a6%e5%8f%b7%e8%87%aa%e5%ae%9a%e4%b9%89 aria-label=符号自定义>符号自定义</a></li><li><a href=#%e8%be%93%e5%85%a5%e7%9b%b4%e8%a7%92%e5%bc%95%e5%8f%b7 aria-label=输入直角引号>输入直角引号</a></li><li><a href=#%e6%89%a9%e5%b1%95%e8%af%8d%e5%ba%93httpswikiarchlinuxorgtitlefcitx5_e7ae80e4bd93e4b8ade69687e5afbce585a5e8af8de5ba93 aria-label=扩展词库><a href=https://wiki.archlinux.org/title/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E5%AF%BC%E5%85%A5%E8%AF%8D%E5%BA%93>扩展词库</a></a></li><li><a href=#%e5%a2%9e%e5%8a%a0%e8%87%aa%e5%b7%b1%e7%9a%84%e8%af%8d%e5%ba%93 aria-label=增加自己的词库>增加自己的词库</a></li><li><a href=#%e9%bb%98%e8%ae%a4%e8%8b%b1%e6%96%87 aria-label=默认英文>默认英文</a></li><li><a href=#%e6%a8%a1%e7%b3%8a%e6%8b%bc%e9%9f%b3 aria-label=模糊拼音>模糊拼音</a></li><li><a href=#%e5%90%8c%e6%ad%a5%e7%94%a8%e6%88%b7%e8%b5%84%e6%96%99 aria-label=同步用户资料>同步用户资料</a></li><li><a href=#%e6%96%b0%e4%b8%96%e7%ba%aa%e4%ba%94%e7%ac%94 aria-label=新世纪五笔>新世纪五笔</a></li><li><a href=#easy-english aria-label="Easy english">Easy english</a></li><li><a href=#%e8%be%93%e5%85%a5%e6%97%a5%e6%9c%9f aria-label=输入日期>输入日期</a></li><li><a href=#rime-emojihttpsgithubcomrimerime-emoji aria-label=rime-emoji><a href=https://github.com/rime/rime-emoji>rime-emoji</a></a></li><li><a href=#%e5%88%87%e6%8d%a2%e4%b8%ad%e8%8b%b1%e6%96%87httpszhuanlanzhihucomp91129641 aria-label=切换中英文><a href=https://zhuanlan.zhihu.com/p/91129641>切换中英文</a></a></li><li><a href=#%e6%b8%85%e7%a9%ba%e5%80%99%e9%80%89%e8%af%8d aria-label=清空候选词>清空候选词</a></li></ul></li></ul></li></ul></li><li><a href=#wallpapers aria-label=Wallpapers>Wallpapers</a><ul><li><a href=#gnome-backgroundhttpssamwhelpgithubionote-about-ubuntureadsubjectwallpaperhtml aria-label="Gnome Background"><a href=https://samwhelp.github.io/note-about-ubuntu/read/subject/wallpaper.html>Gnome Background</a></a></li><li><a href=#apps aria-label=Apps>Apps</a></li><li><a href=#varietyhttpsgithubcomvarietywallsvariety aria-label=Variety><a href=https://github.com/varietywalls/variety>Variety</a></a></li><li><a href=#unsplashshhttpsyounessnetlinuxset-random-wallpapers-unsplash-com-ubuntuv2 aria-label=unsplash.sh><a href=https://youness.net/linux/set-random-wallpapers-unsplash-com-ubuntu#v2>unsplash.sh</a></a></li><li><a href=#wallhavensh aria-label=wallhaven.sh>wallhaven.sh</a></li><li><a href=#astronomyshhttpsapinasagov aria-label=astronomy.sh><a href=https://api.nasa.gov/>astronomy.sh</a></a></li><li><a href=#wallpaper-slideshowshttpslinuxcnarticle-9571-1html aria-label="Wallpaper Slideshows"><a href=https://linux.cn/article-9571-1.html>Wallpaper Slideshows</a></a><ul><li><a href=#%e5%bc%80%e5%a7%8b aria-label=开始>开始</a></li><li><a href=#%e5%85%a8%e5%a4%a9%e6%9b%b4%e6%8d%a2%e5%a3%81%e7%ba%b8 aria-label=全天更换壁纸>全天更换壁纸</a></li><li><a href=#%e5%ae%9e%e7%94%a8%e7%a8%8b%e5%ba%8f aria-label=实用程序>实用程序</a></li><li><a href=#macos-dynamic-wallpaper-%e5%ae%9e%e4%be%8bhttpswwwomgubuntucouk201806macos-mojave-dynamic-background-linux aria-label="macOS Dynamic Wallpaper 实例"><a href=https://www.omgubuntu.co.uk/2018/06/macos-mojave-dynamic-background-linux>macOS Dynamic Wallpaper 实例</a></a></li></ul></li><li><a href=#light-and-dark-wallpaperhttpslinuxcnarticle-14471-1html aria-label="Light and Dark Wallpaper"><a href=https://linux.cn/article-14471-1.html>Light and Dark Wallpaper</a></a><ul><li><a href=#%e8%87%aa%e5%ae%9a%e4%b9%89%e7%9a%84%e6%b7%b1%e6%b5%85%e5%a3%81%e7%ba%b8 aria-label=自定义的深浅壁纸>自定义的深浅壁纸</a></li><li><a href=#%e8%8e%b7%e5%8f%96%e5%8a%a8%e6%80%81%e5%a3%81%e7%ba%b8 aria-label=获取动态壁纸>获取动态壁纸</a></li><li><a href=#convert-heic aria-label="Convert HEIC">Convert HEIC</a></li><li><a href=#heif-metadata aria-label="HEIF metadata">HEIF metadata</a></li></ul></li><li><a href=#%e8%a6%96%e9%a0%bb%e5%8b%95%e5%a3%81%e7%b4%99httpsblogmegumifoxcompublic20220201i3wm-e4b88be4bdbfe794a8e8a696e9a0bbe58b95e5a381e7b499e5b8b6e7a1ace4bbb6e58aa0e9809f aria-label=視頻動壁紙><a href=https://blog.megumifox.com/public/2022/02/01/i3wm-%E4%B8%8B%E4%BD%BF%E7%94%A8%E8%A6%96%E9%A0%BB%E5%8B%95%E5%A3%81%E7%B4%99%E5%B8%B6%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F/>視頻動壁紙</a></a></li></ul></li><li><a href=#social aria-label=Social>Social</a><ul><li><a href=#telegramhttpswwwnotionsotelegram-95a6c23f0bb1466892b55f9ec8c755fd aria-label=Telegram><a href=https://www.notion.so/Telegram-95a6c23f0bb1466892b55f9ec8c755fd>Telegram</a></a><ul><li><a href=#%e7%ae%80%e4%bb%8b aria-label=简介>简介</a></li><li><a href=#%e6%8e%a8%e8%8d%90%e8%ae%be%e7%bd%ae aria-label=推荐设置>推荐设置</a></li><li><a href=#%e9%9a%90%e7%a7%81%e4%bf%9d%e6%8a%a4%e6%b3%a8%e6%84%8f%e4%ba%8b%e9%a1%b9 aria-label=隐私保护注意事项>隐私保护注意事项</a></li><li><a href=#%e5%b8%b8%e8%a7%81%e9%97%ae%e9%a2%98%e5%8f%8a%e8%a7%a3%e7%ad%94 aria-label=常见问题及解答>常见问题及解答</a></li><li><a href=#%e8%bf%9b%e9%98%b6%e7%9f%a5%e8%af%86 aria-label=进阶知识>进阶知识</a></li><li><a href=#%e4%b8%bb%e9%a2%98%e4%b8%8e%e7%be%8e%e5%8c%96 aria-label=主题与美化>主题与美化</a></li><li><a href=#sticker-packhttpsblogphoenixlzxcom20150606make-telegram-sticker-the-lazy-way aria-label="Sticker Pack"><a href=https://blog.phoenixlzx.com/2015/06/06/make-telegram-sticker-the-lazy-way/>Sticker Pack</a></a></li><li><a href=#%e4%bd%bf%e7%94%a8efb%e6%8e%a8%e9%80%81qq%e4%b8%8e%e5%be%ae%e4%bf%a1%e6%b6%88%e6%81%afhttpswwwshawnleettttxyzpostsf1bc687a aria-label=使用EFB推送QQ与微信消息><a href=https://www.shawnleetttt.xyz/posts/f1bc687a/>使用EFB推送QQ与微信消息</a></a></li><li><a href=#%e5%af%bc%e5%87%ba-telegram-%e8%b4%b4%e5%9b%be aria-label="导出 Telegram 贴图">导出 Telegram 贴图</a></li><li><a href=#%e9%bb%98%e8%ae%a4-desktop aria-label="默认 Desktop">默认 Desktop</a></li><li><a href=#xdg-openhttpsmanpagesubuntucommanpagesfocalenman1xdg-open1html aria-label=xdg-open><a href=https://manpages.ubuntu.com/manpages/focal/en/man1/xdg-open.1.html>xdg-open</a></a></li><li><a href=#telegram-%e5%85%85%e7%95%b6%e9%9b%b2%e7%ab%af%e7%ad%86%e8%a8%98httpswwwplaypcesorcom201602telegramhtml aria-label="Telegram 充當雲端筆記"><a href=https://www.playpcesor.com/2016/02/telegram.html>Telegram 充當雲端筆記</a></a></li><li><a href=#%e4%b8%ad%e6%96%87%e6%90%9c%e7%b4%a2httpscongcong0806githubio20191104telegramsearch aria-label=中文搜索><a href=https://congcong0806.github.io/2019/11/04/TelegramSearch/>中文搜索</a></a><ul><li><a href=#%e9%97%ae%e9%a2%98%e5%9c%a8%e5%93%aa aria-label=问题在哪>问题在哪</a></li><li><a href=#%e5%a6%82%e4%bd%95%e8%a7%a3%e5%86%b3 aria-label=如何解决>如何解决</a></li></ul></li><li><a href=#%e5%86%bb%e5%b1%8f aria-label=冻屏>冻屏</a></li><li><a href=#profile-videoshttpstelegramorgblogprofile-videos-people-nearby-and-moreprofile-videos aria-label="Profile Videos"><a href=https://telegram.org/blog/profile-videos-people-nearby-and-more#profile-videos>Profile Videos</a></a></li></ul></li><li><a href=#mutthttpssegmentfaultcoma1190000018131615 aria-label=Mutt><a href=https://segmentfault.com/a/1190000018131615>Mutt</a></a><ul><li><a href=#%e6%a8%a1%e5%9d%97%e6%90%ad%e9%85%8d%e6%96%b9%e6%a1%88 aria-label=模块搭配方案>模块搭配方案</a></li><li><a href=#%e6%94%b6%e4%bb%b6%e9%85%8d%e7%bd%aefetchmailhttpswwwlinodecomdocsguidesusing-fetchmail-to-retrieve-email aria-label=收件：配置Fetchmail><a href=https://www.linode.com/docs/guides/using-fetchmail-to-retrieve-email/>收件：配置Fetchmail</a></a></li><li><a href=#%e9%82%ae%e4%bb%b6%e8%bf%87%e6%bb%a4%e9%85%8d%e7%bd%aeprocmailhttpslifegoopluskidorgwikiprocmailhtml aria-label=邮件过滤：配置Procmail><a href=https://lifegoo.pluskid.org/wiki/Procmail.html>邮件过滤：配置Procmail</a></a></li><li><a href=#%e5%8f%91%e4%bb%b6%e9%85%8d%e7%bd%aemsmtp aria-label=发件：配置msmtp>发件：配置msmtp</a></li><li><a href=#%e4%b8%bb%e7%95%8c%e9%9d%a2%e9%85%8d%e7%bd%aemutt aria-label=主界面：配置Mutt>主界面：配置Mutt</a></li><li><a href=#%e7%a1%ae%e8%ae%a4%e9%82%ae%e7%ae%b1%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label=确认邮箱服务器>确认邮箱服务器</a></li><li><a href=#%e5%9f%ba%e6%9c%ac%e6%93%8d%e4%bd%9chttpslifehackercomhow-to-use-the-fast-and-powerful-mutt-email-client-with-5574557 aria-label=基本操作><a href=https://lifehacker.com/how-to-use-the-fast-and-powerful-mutt-email-client-with-5574557>基本操作</a></a></li></ul></li><li><a href=#irchttpswwwcnblogscomsztomp11173404html aria-label=IRC><a href=https://www.cnblogs.com/sztom/p/11173404.html>IRC</a></a><ul><li><a href=#%e7%ae%80%e4%bb%8bhttpsenwikipediaorgwikiinternet_relay_chat aria-label=简介><a href=https://en.wikipedia.org/wiki/Internet_Relay_Chat>简介</a></a></li><li><a href=#%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label=服务器>服务器</a></li><li><a href=#%e5%ae%a2%e6%88%b7%e7%ab%af aria-label=客户端>客户端</a></li><li><a href=#irssihttpssegmentfaultcoma1190000018120591 aria-label=Irssi><a href=https://segmentfault.com/a/1190000018120591>Irssi</a></a></li></ul></li></ul></li><li><a href=#multimedia aria-label=Multimedia>Multimedia</a><ul><li><a href=#gstreamer aria-label=GStreamer>GStreamer</a><ul><li><a href=#gstreamer-%e5%85%a5%e9%97%a8%e6%a6%82%e5%bf%b5httpsthebigdocreadthedocsioenlatestgstreamergst-concepthtml aria-label="GStreamer 入门概念"><a href=https://thebigdoc.readthedocs.io/en/latest/gstreamer/gst-concept.html>GStreamer 入门概念</a></a><ul><li><a href=#overview aria-label=Overview>Overview</a></li><li><a href=#%e7%ae%a1%e9%81%93-pipeline aria-label=管道-pipeline>管道-pipeline</a></li><li><a href=#%e5%85%83%e7%b4%a0element aria-label=元素element>元素element</a></li><li><a href=#pad aria-label=pad>pad</a></li><li><a href=#cap aria-label=cap>cap</a></li><li><a href=#bin aria-label=bin>bin</a></li><li><a href=#ghost-pad aria-label="ghost pad">ghost pad</a></li></ul></li><li><a href=#gstreamer-%e7%b3%bb%e5%88%97httpswwwcnblogscomxlengtaggstreamer aria-label="GStreamer 系列"><a href=https://www.cnblogs.com/xleng/tag/gstreamer/>GStreamer 系列</a></a></li></ul></li><li><a href=#ffmpeghttpswwwruanyifengcomblog202001ffmpeghtml aria-label=FFmpeg><a href=https://www.ruanyifeng.com/blog/2020/01/ffmpeg.html>FFmpeg</a></a><ul><li><a href=#%e5%b8%b8%e7%94%a8%e5%8f%82%e6%95%b0 aria-label=常用参数>常用参数</a></li><li><a href=#%e6%9f%a5%e7%9c%8b%e8%a7%86%e9%a2%91%e6%96%87%e4%bb%b6%e7%9a%84%e5%85%83%e4%bf%a1%e6%81%af aria-label=查看视频文件的元信息>查看视频文件的元信息</a></li><li><a href=#%e8%bd%ac%e6%8d%a2%e7%bc%96%e7%a0%81%e6%a0%bc%e5%bc%8f aria-label=转换编码格式>转换编码格式</a></li><li><a href=#%e8%bd%ac%e6%8d%a2%e5%ae%b9%e5%99%a8%e6%a0%bc%e5%bc%8f aria-label=转换容器格式>转换容器格式</a></li><li><a href=#%e6%94%b9%e5%8f%98%e5%88%86%e8%be%a8%e7%8e%87 aria-label=改变分辨率>改变分辨率</a></li><li><a href=#%e6%8f%90%e5%8f%96%e8%a7%86%e9%a2%91 aria-label=提取视频>提取视频</a></li><li><a href=#%e6%8f%90%e5%8f%96%e9%9f%b3%e9%a2%91 aria-label=提取音频>提取音频</a></li><li><a href=#%e6%b7%bb%e5%8a%a0%e9%9f%b3%e8%bd%a8 aria-label=添加音轨>添加音轨</a></li><li><a href=#%e9%9f%b3%e8%a7%86%e9%a2%91%e5%90%88%e6%88%90 aria-label=音视频合成>音视频合成</a></li><li><a href=#%e6%88%aa%e5%9b%be aria-label=截图>截图</a></li><li><a href=#%e8%a3%81%e5%89%aa aria-label=裁剪>裁剪</a></li><li><a href=#%e6%b7%bb%e5%8a%a0%e5%ad%97%e5%b9%95httpswwwjianshucompf33910818a1c aria-label=添加字幕><a href=https://www.jianshu.com/p/f33910818a1c>添加字幕</a></a></li><li><a href=#%e4%b8%8b%e8%bd%bd-m3u8httpswww51ctocomarticle558658html aria-label="下载 m3u8"><a href=https://www.51cto.com/article/558658.html>下载 m3u8</a></a></li><li><a href=#webm-to-gifhttpsaskubuntucomquestions506670how-to-do-i-convert-an-webm-video-to-a-animated-gif-on-the-command-line aria-label="webm to gif"><a href=https://askubuntu.com/questions/506670/how-to-do-i-convert-an-webm-video-to-a-animated-gif-on-the-command-line>webm to gif</a></a></li></ul></li><li><a href=#mkvtoolnixhttpsmkvtoolnixdownloaddownloadshtml aria-label=MKVToolNix><a href=https://mkvtoolnix.download/downloads.html>MKVToolNix</a></a></li><li><a href=#rhythmboxhttpszhtweyewatedcomrhythmboxe79a84e5ae8ce695b4e68c87e58d97 aria-label=Rhythmbox><a href=https://zhtw.eyewated.com/rhythmbox%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/>Rhythmbox</a></a><ul><li><a href=#music aria-label=Music>Music</a></li><li><a href=#prodcast%e6%92%ad%e5%ae%a2 aria-label=Prodcast/播客>Prodcast/播客</a></li><li><a href=#radio%e7%94%b5%e5%8f%b0 aria-label=Radio/电台>Radio/电台</a></li><li><a href=#%e6%92%ad%e5%ae%a2%e5%92%8c%e7%94%b5%e5%8f%b0httpswwwzhihucomquestion402348857answer1293689640 aria-label=播客和电台><a href=https://www.zhihu.com/question/402348857/answer/1293689640>播客和电台</a></a></li><li><a href=#missing-plugin aria-label="Missing plugin">Missing plugin</a></li></ul></li><li><a href=#feeluownhttpsgithubcomfeeluownfeeluown aria-label=FeelUOwn><a href=https://github.com/feeluown/FeelUOwn>FeelUOwn</a></a><ul><li><a href=#clementinehttpsgithubcomclementine-playerclementine aria-label=Clementine><a href=https://github.com/clementine-player/Clementine>Clementine</a></a></li><li><a href=#cmushttpscmusgithubio aria-label=cmus><a href=https://cmus.github.io/>cmus</a></a></li><li><a href=#deadbeefhttpsdeadbeefsourceforgeio aria-label=DeaDBeeF><a href=https://deadbeef.sourceforge.io/>DeaDBeeF</a></a></li><li><a href=#jellyfinhttpsgithubcomjellyfinjellyfin aria-label=jellyfin><a href=https://github.com/jellyfin/jellyfin>jellyfin</a></a></li><li><a href=#audacioushttpsaudacious-media-playerorg aria-label=Audacious><a href=https://audacious-media-player.org/>Audacious</a></a></li><li><a href=#kde-elisahttpsgithubcomkdeelisaamarokhttpsgithubcomkdeamarok aria-label="KDE elisa/amarok">KDE <a href=https://github.com/KDE/elisa>elisa</a>/<a href=https://github.com/KDE/amarok>amarok</a></a></li><li><a href=#osdlyricshttpsgithubcomosdlyricsosdlyrics aria-label=osdlyrics><a href=https://github.com/osdlyrics/osdlyrics>osdlyrics</a></a></li><li><a href=#zonylrctoolsxhttpsgithubcomreal-zonyzonylrctoolsx aria-label=ZonyLrcToolsX><a href=https://github.com/real-zony/ZonyLrcToolsX>ZonyLrcToolsX</a></a></li></ul></li><li><a href=#neteasemusichttpsmusic163com aria-label=NeteaseMusic><a href=https://music.163.com/>NeteaseMusic</a></a><ul><li><a href=#yesplaymusichttpsgithubcomqier222yesplaymusic aria-label=YesPlayMusic><a href=https://github.com/qier222/YesPlayMusic>YesPlayMusic</a></a></li><li><a href=#netease-musicboxhttpsgithubcomdarknessomimusicbox aria-label=NetEase-MusicBox><a href=https://github.com/darknessomi/musicbox>NetEase-MusicBox</a></a></li><li><a href=#lx-music-desktophttpsgithubcomlyswhutlx-music-desktop aria-label=lx-music-desktop><a href=https://github.com/lyswhut/lx-music-desktop>lx-music-desktop</a></a></li><li><a href=#listen1_desktophttpsgithubcomlisten1listen1_desktop aria-label=listen1_desktop><a href=https://github.com/listen1/listen1_desktop>listen1_desktop</a></a></li></ul></li><li><a href=#qqmusichttpsyqqcom aria-label=QQMusic><a href=https://y.qq.com/>QQMusic</a></a></li><li><a href=#spotify aria-label=Spotify>Spotify</a><ul><li><a href=#spotifydhttpsgithubcomspotifydspotifyd aria-label=Spotifyd><a href=https://github.com/Spotifyd/spotifyd>Spotifyd</a></a></li></ul></li><li><a href=#mpvhttpshooke007githubioindexhtml aria-label=MPV><a href=https://hooke007.github.io/index.html>MPV</a></a><ul><li><a href=#%e5%bf%ab%e6%8d%b7%e9%94%aehttpswwwiplaysoftcommpvhtml aria-label=快捷键><a href=https://www.iplaysoft.com/mpv.html>快捷键</a></a></li><li><a href=#%e9%85%8d%e7%bd%ae aria-label=配置>配置</a></li><li><a href=#%e7%9b%b4%e6%92%adhttpsgithubcomimdazuitvlist-awesome-m3u-m3u8 aria-label=直播><a href=https://github.com/imDazui/Tvlist-awesome-m3u-m3u8>直播</a></a><ul><li><a href=#%e7%9b%b4%e6%92%ad%e6%ba%90 aria-label=直播源>直播源</a></li><li><a href=#epghttpswwwalltechbuzznetzh-cnepg aria-label=EPG><a href=https://www.alltechbuzz.net/zh-CN/EPG/>EPG</a></a></li></ul></li></ul></li><li><a href=#vlchttpswwwvideolanorg aria-label=VLC><a href=https://www.videolan.org/>VLC</a></a><ul><li><a href=#smplayerhttpswwwsmplayerinfo aria-label=SMPlayer><a href=https://www.smplayer.info/>SMPlayer</a></a></li><li><a href=#kodihttpskoditv aria-label=Kodi><a href=https://kodi.tv/>Kodi</a></a></li></ul></li><li><a href=#shotcuthttpswwwshotcutorgdownload aria-label=Shotcut><a href=https://www.shotcut.org/download/>Shotcut</a></a></li><li><a href=#davinci-resolvehttpwwwblackmagicdesigncomcnproductsdavinciresolve aria-label="DaVinci Resolve"><a href=http://www.blackmagicdesign.com/cn/products/davinciresolve/>DaVinci Resolve</a></a></li></ul></li><li><a href=#download aria-label=Download>Download</a><ul><li><a href=#aria2httpsaria2githubio aria-label=Aria2><a href=https://aria2.github.io/>Aria2</a></a><ul><li><a href=#usage aria-label=Usage>Usage</a></li><li><a href=#configurationhttparia2ccomusagehtml aria-label=Configuration><a href=http://aria2c.com/usage.html>Configuration</a></a></li><li><a href=#%e8%87%aa%e5%90%af%e5%8a%a8 aria-label=自启动>自启动</a></li><li><a href=#others-1 aria-label=Others>Others</a><ul><li><a href=#bt-%e4%b8%8b%e8%bd%bd%e9%a2%84%e7%83%adhttpwwwsenramesolutions-to-aria2-bt-metalink-download-slowly aria-label="BT 下载预热"><a href=http://www.senra.me/solutions-to-aria2-bt-metalink-download-slowly/>BT 下载预热</a></a></li><li><a href=#%e4%bb%80%e4%b9%88%e6%98%af-pthttpswwwcnblogscomwpjamerp4417174html aria-label="什么是 PT"><a href=https://www.cnblogs.com/wpjamer/p/4417174.html>什么是 PT</a></a></li><li><a href=#rpchttpswwwzhihucomquestion25536695 aria-label=RPC><a href=https://www.zhihu.com/question/25536695>RPC</a></a></li><li><a href=#%e5%85%b6%e4%bb%96-bt-%e4%b8%8b%e8%bd%bd%e5%b7%a5%e5%85%b7httpwwwsenrametage4b88be8bdbde5b7a5e585b7 aria-label="其他 BT 下载工具"><a href=http://www.senra.me/tag/%e4%b8%8b%e8%bd%bd%e5%b7%a5%e5%85%b7/>其他 BT 下载工具</a></a></li><li><a href=#%e6%9c%89%e6%94%af%e6%8c%81ed2k%e7%9a%84%e8%ae%a1%e5%88%92%e5%90%97httpsgithubcomaria2aria2issues986 aria-label=有支持ed2k的计划吗？><a href=https://github.com/aria2/aria2/issues/986>有支持ed2k的计划吗？</a></a></li></ul></li></ul></li><li><a href=#youtube-dlhttpsgithubcomytdl-orgyoutube-dl aria-label=youtube-dl><a href=https://github.com/ytdl-org/youtube-dl>youtube-dl</a></a><ul><li><a href=#usagehttpszhuanlanzhihucomp105141332 aria-label=Usage><a href=https://zhuanlan.zhihu.com/p/105141332>Usage</a></a></li><li><a href=#configurationhttpswwwjianshucomp5143faa6056d aria-label=Configuration><a href=https://www.jianshu.com/p/5143faa6056d>Configuration</a></a></li></ul></li><li><a href=#curlhttpwwwruanyifengcomblog201909curl-referencehtml aria-label=curl><a href=http://www.ruanyifeng.com/blog/2019/09/curl-reference.html>curl</a></a><ul><li><a href=#%e7%ae%80%e4%bb%8b-1 aria-label=简介>简介</a></li><li><a href=#%e4%b8%bb%e8%a6%81%e5%91%bd%e4%bb%a4%e8%a1%8c%e5%8f%82%e6%95%b0 aria-label=主要命令行参数>主要命令行参数</a></li><li><a href=#httpiehttpsgithubcomhttpiehttpie aria-label=HTTPie><a href=https://github.com/httpie/httpie>HTTPie</a></a></li><li><a href=#axelhttpsgithubcomaxel-download-acceleratoraxel aria-label=axel><a href=https://github.com/axel-download-accelerator/axel>axel</a></a></li></ul></li><li><a href=#usenethttpswwwruanyifengcomblogusenet aria-label=USENET><a href=https://www.ruanyifeng.com/blog/usenet/>USENET</a></a><ul><li><a href=#%e8%b5%b7%e6%ba%90 aria-label=起源>起源</a></li><li><a href=#%e8%bf%90%e8%a1%8c%e6%9c%ba%e5%88%b6 aria-label=运行机制>运行机制</a></li><li><a href=#%e5%86%85%e5%ae%b9%e7%bb%93%e6%9e%84 aria-label=内容结构>内容结构</a></li><li><a href=#%e4%ba%8c%e8%bf%9b%e5%88%b6%e5%86%85%e5%ae%b9 aria-label=二进制内容>二进制内容</a></li><li><a href=#%e6%94%b6%e8%b4%b9%e6%9c%8d%e5%8a%a1 aria-label=收费服务>收费服务</a></li><li><a href=#google-groups aria-label="Google Groups">Google Groups</a></li></ul></li><li><a href=#%e7%99%be%e5%ba%a6%e7%bd%91%e7%9b%98httpspanbaiducomdownloadlinux aria-label=百度网盘><a href=https://pan.baidu.com/download#linux>百度网盘</a></a><ul><li><a href=#%e9%98%bf%e9%87%8c%e4%ba%91%e7%9b%98%e5%b0%8f%e7%99%bd%e7%be%8a%e7%89%88httpsgithubcomliupan1890aliyunpan aria-label=阿里云盘小白羊版><a href=https://github.com/liupan1890/aliyunpan>阿里云盘小白羊版</a></a></li><li><a href=#baidupcs-gohttpsgithubcomqjfoidnhbaidupcs-go aria-label=BaiduPCS-Go><a href=https://github.com/qjfoidnh/BaiduPCS-Go>BaiduPCS-Go</a></a></li></ul></li><li><a href=#%e5%9d%9a%e6%9e%9c%e4%ba%91 aria-label=坚果云>坚果云</a></li><li><a href=#xdmhttpsgithubcomsubhra74xdm aria-label=xdm><a href=https://github.com/subhra74/xdm>xdm</a></a></li><li><a href=#motrixhttpsgithubcomagalwoodmotrix aria-label=Motrix><a href=https://github.com/agalwood/Motrix>Motrix</a></a></li><li><a href=#thunderhttpsflathuborgappsdetailscomxunleithunder aria-label=Thunder><a href=https://flathub.org/apps/details/com.xunlei.Thunder>Thunder</a></a></li></ul></li><li><a href=#editor aria-label=Editor>Editor</a><ul><li><a href=#%e4%bf%ae%e6%94%b9%e9%a0%90%e8%a8%ad-editorhttpssamwhelpgithubionote-about-ubuntureadadjustmentenveditorhtml aria-label="修改預設 editor"><a href=https://samwhelp.github.io/note-about-ubuntu/read/adjustment/env/editor.html>修改預設 editor</a></a></li><li><a href=#vscodehttpscodevisualstudiocomdocssetuplinux aria-label=VSCode><a href=https://code.visualstudio.com/docs/setup/linux>VSCode</a></a><ul><li><a href=#%e9%85%8d%e7%bd%ae-1 aria-label=配置>配置</a></li><li><a href=#%e5%bf%ab%e6%8d%b7%e9%94%aehttpszhuanlanzhihucomp113222681 aria-label=快捷键><a href=https://zhuanlan.zhihu.com/p/113222681>快捷键</a></a></li><li><a href=#%e6%8f%92%e4%bb%b6 aria-label=插件>插件</a></li><li><a href=#truste-foldershttpsstackoverflowcoma67914669 aria-label="Truste folders"><a href=https://stackoverflow.com/a/67914669>Truste folders</a></a></li></ul></li><li><a href=#google-keep aria-label="Google Keep">Google Keep</a></li><li><a href=#joplinhttpscomputetechnologydailycom20210212cf916cdb6cfb498aac38d4fa50d785a2 aria-label=Joplin><a href=https://computetechnologydaily.com/2021/02/12/cf916cdb6cfb498aac38d4fa50d785a2/>Joplin</a></a><ul><li><a href=#%e4%b8%ba%e7%9f%a5%e7%ac%94%e8%ae%b0 aria-label=为知笔记>为知笔记</a></li><li><a href=#notion aria-label=notion>notion</a></li><li><a href=#%e6%80%9d%e6%ba%90%e7%ac%94%e8%ae%b0httpsgithubcomsiyuan-notesiyuanblobmasterreadme_zh_cnmd aria-label=思源笔记><a href=https://github.com/siyuan-note/siyuan/blob/master/README_zh_CN.md>思源笔记</a></a></li><li><a href=#%e5%a4%87%e4%bb%bd%e7%9b%98--%e5%90%8c%e6%ad%a5%e7%9b%98-httpswwwzhihucomquestion388093965answer1335747294 aria-label="备份盘 &amp;amp; 同步盘 "><a href=https://www.zhihu.com/question/388093965/answer/1335747294>备份盘 & 同步盘</a></a></li></ul></li><li><a href=#obsidianhttpsobsidianmd aria-label=Obsidian><a href=https://obsidian.md/>Obsidian</a></a><ul><li><a href=#%e6%9c%80%e9%80%82%e5%90%88%e7%a8%8b%e5%ba%8f%e5%91%98%e7%9a%84%e7%ac%94%e8%ae%b0%e8%bd%af%e4%bb%b6httpswwwruanyifengcomblog202108best-note-taking-software-for-programmershtml aria-label=最适合程序员的笔记软件><a href=https://www.ruanyifeng.com/blog/2021/08/best-note-taking-software-for-programmers.html>最适合程序员的笔记软件</a></a></li><li><a href=#%e5%ae%89%e8%a3%85 aria-label=安装>安装</a></li><li><a href=#%e5%85%a8%e5%b9%b3%e5%8f%b0%e5%90%8c%e6%ad%a5 aria-label=全平台同步>全平台同步</a></li></ul></li><li><a href=#typorahttpssupporttyporaioquick-start aria-label=Typora><a href=https://support.typora.io/Quick-Start/>Typora</a></a><ul><li><a href=#marktexthttpsgithubcommarktextmarktext aria-label=MarkText><a href=https://github.com/marktext/marktext>MarkText</a></a></li></ul></li><li><a href=#foxit-pdf-readerhttpswwwfoxitcompdf-reader aria-label="Foxit PDF Reader"><a href=https://www.foxit.com/pdf-reader/>Foxit PDF Reader</a></a><ul><li><a href=#portable-pdf-unlockerhttpssourceforgenetprojectsportablepdfunlockerfileslatestdownloadpdfcrackhttppdfcracksourceforgenet aria-label="Portable PDF Unlocker/PDFCrack"><a href=https://sourceforge.net/projects/portablepdfunlocker/files/latest/download>Portable PDF Unlocker</a>/<a href=http://pdfcrack.sourceforge.net/>PDFCrack</a></a></li><li><a href=#pdftkhttpsaskubuntucomquestions828720how-to-remove-the-password-from-a-pdf aria-label=pdftk><a href=https://askubuntu.com/questions/828720/how-to-remove-the-password-from-a-pdf>pdftk</a></a></li></ul></li><li><a href=#tesseracthttpsgithubcomtesseract-ocrtesseract aria-label=Tesseract><a href=https://github.com/tesseract-ocr/tesseract>Tesseract</a></a><ul><li><a href=#ocrmypdfhttpsgithubcomocrmypdfocrmypdf aria-label=OCRmyPDF><a href=https://github.com/ocrmypdf/OCRmyPDF>OCRmyPDF</a></a></li><li><a href=#pandaocrhttpsgithubcommiaomiaosoftpandaocr aria-label=PandaOCR><a href=https://github.com/miaomiaosoft/PandaOCR>PandaOCR</a></a></li><li><a href=#gimagereaderhttpsgithubcommanisandrogimagereader aria-label=gImageReader><a href=https://github.com/manisandro/gImageReader>gImageReader</a></a></li><li><a href=#ocrfeederhttpswikignomeorgactionshowappsocrfeederactionshowredirectocrfeeder aria-label=OCRfeeder><a href="https://wiki.gnome.org/action/show/Apps/OCRFeeder?action=show&amp;redirect=OCRFeeder">OCRfeeder</a></a></li><li><a href=#tianruoocrhttpsgithubcomanylistentianruoocr aria-label=tianruoocr><a href=https://github.com/AnyListen/tianruoocr>tianruoocr</a></a></li><li><a href=#marguerite-%e7%ad%94-orchttpsforumsuseorgcntocr-opensuse23799uhsiung aria-label="marguerite 答 ORC"><a href="https://forum.suse.org.cn/t/ocr-opensuse/2379/9?u=hsiung">marguerite 答 ORC</a></a></li></ul></li><li><a href=#wpshttpswwwwpscomdownload aria-label=WPS><a href=https://www.wps.com/download/>WPS</a></a><ul><li><a href=#wps-fonts aria-label="WPS Fonts">WPS Fonts</a></li></ul></li><li><a href=#sublime-texthttpwwwsublimetextcom aria-label="Sublime Text"><a href=http://www.sublimetext.com/>Sublime Text</a></a></li><li><a href=#atomhttpsatomio aria-label=Atom><a href=https://atom.io/>Atom</a></a></li><li><a href=#vim aria-label=Vim>Vim</a><ul><li><a href=#vimtutor aria-label=vimtutor>vimtutor</a></li><li><a href=#vivimtiny aria-label=vi&amp;amp;vim.tiny>vi&amp;vim.tiny</a></li><li><a href=#clear-highlightinghttpsstackoverflowcomquestions657447vim-clear-last-search-highlighting aria-label="clear highlighting"><a href=https://stackoverflow.com/questions/657447/vim-clear-last-search-highlighting>clear highlighting</a></a></li><li><a href=#vimbasicvimtiny aria-label=vim.basic&amp;amp;vim.tiny>vim.basic&amp;vim.tiny</a></li></ul></li><li><a href=#vimrchttpsgithubcomamixvimrc aria-label=VIMRC><a href=https://github.com/amix/vimrc>VIMRC</a></a><ul><li><a href=#copilotvimhttpsgithubcomgithubcopilotvim aria-label=copilot.vim><a href=https://github.com/github/copilot.vim>copilot.vim</a></a></li><li><a href=#neovimhttpsneovimio aria-label=Neovim><a href=https://neovim.io/>Neovim</a></a></li><li><a href=#vimplushttpsgithubcomchxuanvimplus aria-label=vimplus><a href=https://github.com/chxuan/vimplus>vimplus</a></a></li><li><a href=#rangerhttpsgithubcomrangerranger aria-label=ranger><a href=https://github.com/ranger/ranger>ranger</a></a></li><li><a href=#color-scheme aria-label="Color Scheme">Color Scheme</a></li><li><a href=#fonthttpsvimfandomcomwikichange_font aria-label=Font><a href=https://vim.fandom.com/wiki/Change_font>Font</a></a></li></ul></li><li><a href=#qa aria-label=QA>QA</a></li></ul></li><li><a href=#shell aria-label=Shell>Shell</a><ul><li><a href=#tmuxhttpswwwruanyifengcomblog201910tmuxhtml aria-label=Tmux><a href=https://www.ruanyifeng.com/blog/2019/10/tmux.html>Tmux</a></a><ul><li><a href=#%e7%ae%80%e4%bb%8b-2 aria-label=简介>简介</a></li><li><a href=#%e5%9f%ba%e6%9c%ac%e7%94%a8%e6%b3%95 aria-label=基本用法>基本用法</a></li><li><a href=#%e4%bc%9a%e8%af%9d%e7%ae%a1%e7%90%86 aria-label=会话管理>会话管理</a></li><li><a href=#%e6%9c%80%e7%ae%80%e6%93%8d%e4%bd%9c%e6%b5%81%e7%a8%8b aria-label=最简操作流程>最简操作流程</a></li><li><a href=#%e7%aa%97%e6%a0%bc%e6%93%8d%e4%bd%9c aria-label=窗格操作>窗格操作</a></li><li><a href=#%e7%aa%97%e5%8f%a3%e7%ae%a1%e7%90%86 aria-label=窗口管理>窗口管理</a></li><li><a href=#%e5%85%b6%e4%bb%96%e5%91%bd%e4%bb%a4 aria-label=其他命令>其他命令</a></li></ul></li><li><a href=#fishhttpswwwruanyifengcomblog201705fish_shellhtml aria-label=Fish><a href=https://www.ruanyifeng.com/blog/2017/05/fish_shell.html>Fish</a></a><ul><li><a href=#%e7%ae%80%e4%bb%8b-3 aria-label=简介>简介</a></li><li><a href=#%e5%ae%89%e8%a3%85-1 aria-label=安装>安装</a></li><li><a href=#%e5%90%af%e5%8a%a8%e4%b8%8e%e5%b8%ae%e5%8a%a9 aria-label=启动与帮助>启动与帮助</a></li><li><a href=#%e5%bd%a9%e8%89%b2%e6%98%be%e7%a4%ba aria-label=彩色显示>彩色显示</a></li><li><a href=#%e8%87%aa%e5%8a%a8%e5%bb%ba%e8%ae%ae aria-label=自动建议>自动建议</a></li><li><a href=#%e8%87%aa%e5%8a%a8%e8%a1%a5%e5%85%a8 aria-label=自动补全>自动补全</a></li><li><a href=#%e6%98%93%e6%87%82%e7%9a%84%e8%af%ad%e6%b3%95 aria-label=易懂的语法>易懂的语法</a></li><li><a href=#%e5%87%bd%e6%95%b0 aria-label=函数>函数</a></li><li><a href=#%e6%8f%90%e7%a4%ba%e7%ac%a6 aria-label=提示符>提示符</a></li><li><a href=#%e9%85%8d%e7%bd%ae-2 aria-label=配置>配置</a></li></ul></li><li><a href=#zsh aria-label=Zsh>Zsh</a></li><li><a href=#bash aria-label=Bash>Bash</a><ul><li><a href=#tips-1 aria-label=Tips>Tips</a></li></ul></li><li><a href=#goghhttpsgithubcomgogh-cogogh aria-label=Gogh><a href=https://github.com/Gogh-Co/Gogh>Gogh</a></a></li></ul></li><li><a href=#proxy aria-label=Proxy>Proxy</a><ul><li><a href=#v2rayhttpsarchlinuxstudiogithubioarchlinuxtutorialrookiefxckgfw aria-label=v2ray><a href=https://archlinuxstudio.github.io/ArchLinuxTutorial/#/rookie/fxckGFW>v2ray</a></a><ul><li><a href=#%e8%8a%82%e7%82%b9%e5%87%86%e5%a4%87 aria-label=节点准备>节点准备</a></li><li><a href=#%e5%ae%89%e8%a3%85-2 aria-label=安装>安装</a></li><li><a href=#%e4%bb%a3%e7%90%86%e9%85%8d%e7%bd%ae aria-label=代理配置>代理配置</a></li><li><a href=#%e9%80%8f%e6%98%8e%e4%bb%a3%e7%90%86httpsarchicekylinonlinerookietransparenthtml aria-label=透明代理><a href=https://arch.icekylin.online/rookie/transparent.html>透明代理</a></a></li></ul></li><li><a href=#clashhttpsgithubcomdreamacroclash aria-label=Clash><a href=https://github.com/Dreamacro/clash>Clash</a></a><ul><li><a href=#clashservicehttpsgithubcomdreamacroclashwikiclash-as-a-daemon aria-label=clash.service><a href=https://github.com/Dreamacro/clash/wiki/clash-as-a-daemon>clash.service</a></a></li><li><a href=#providershttpsbloghifoolcnpostsf42b65b0 aria-label=Providers><a href=https://blog.hifool.cn/posts/f42b65b0/>Providers</a></a></li><li><a href=#clash-dashboardhttpsgithubcomdreamacroclash-dashboard aria-label="Clash Dashboard"><a href=https://github.com/Dreamacro/clash-dashboard>Clash Dashboard</a></a></li><li><a href=#%e9%85%8d%e7%bd%ae%e6%96%87%e4%bb%b6httpswwwcfmemcom202108clashhtml aria-label=配置文件><a href=https://www.cfmem.com/2021/08/clash.html>配置文件</a></a><ul><li><a href=#proxies aria-label=proxies>proxies</a></li><li><a href=#proxy-groups aria-label=proxy-groups>proxy-groups</a></li><li><a href=#rules aria-label=rules>rules</a></li></ul></li><li><a href=#dns%e6%b1%a1%e6%9f%93httpsblogrssinsnetarchives1379 aria-label=DNS污染><a href=https://blog.rssins.net/archives/1379>DNS污染</a></a><ul><li><a href=#%e5%af%b9%e6%8a%97dns%e5%8a%ab%e6%8c%81 aria-label=对抗DNS劫持>对抗DNS劫持</a></li><li><a href=#%e4%bd%95%e6%97%b6%e4%bd%bf%e7%94%a8 aria-label=何时使用>何时使用</a></li><li><a href=#dns%e9%85%8d%e7%bd%aehttpswwwxkww3ncyou20220208use-clash-dns-anti-dns-hijacking aria-label=DNS配置><a href=https://www.xkww3n.cyou/2022/02/08/use-clash-dns-anti-dns-hijacking/>DNS配置</a></a></li></ul></li><li><a href=#%e4%bb%a3%e7%90%86%e7%8e%af%e5%a2%83%e4%b8%ad%e7%9a%84-dns-%e8%a7%a3%e6%9e%90%e8%a1%8c%e4%b8%bahttpsblogskkmoepostwhat-happend-to-dns-in-proxy aria-label="代理环境中的 DNS 解析行为"><a href=https://blog.skk.moe/post/what-happend-to-dns-in-proxy>代理环境中的 DNS 解析行为</a></a><ul><li><a href=#%e4%b8%8d%e4%bd%bf%e7%94%a8%e4%bb%a3%e7%90%86 aria-label=不使用代理>不使用代理</a></li><li><a href=#%e8%ae%be%e7%bd%ae%e4%bb%a3%e7%90%86%e5%b9%b6%e4%bd%bf%e7%94%a8%e7%9b%b4%e8%bf%9e aria-label=设置代理并使用直连>设置代理并使用直连</a></li><li><a href=#%e8%ae%be%e7%bd%ae%e4%bb%a3%e7%90%86%e5%b9%b6%e5%b0%86%e6%b5%81%e9%87%8f%e8%bd%ac%e5%8f%91%e5%88%b0%e8%bf%9c%e7%ab%af%e6%9c%8d%e5%8a%a1%e5%99%a8 aria-label=设置代理并将流量转发到远端服务器>设置代理并将流量转发到远端服务器</a></li><li><a href=#%e8%ae%be%e7%bd%ae%e4%bb%a3%e7%90%86%e5%b9%b6%e4%bd%bf%e7%94%a8-ip-%e8%a7%84%e5%88%99%e5%92%8c%e5%9f%9f%e5%90%8d%e8%a7%84%e5%88%99%e8%bf%9b%e8%a1%8c%e5%88%86%e6%b5%81 aria-label="设置代理并使用 IP 规则和域名规则进行分流">设置代理并使用 IP 规则和域名规则进行分流</a></li><li><a href=#%e4%bd%bf%e7%94%a8-redir--tun2socks-%e5%ae%9e%e7%8e%b0%e5%85%a8%e5%b1%80%e6%b5%81%e9%87%8f%e7%bb%8f%e8%bf%87%e4%bb%a3%e7%90%86 aria-label="使用 redir / tun2socks 实现全局流量经过代理">使用 redir / tun2socks 实现全局流量经过代理</a></li><li><a href=#%e5%9c%a8-redir--tun2socks-%e4%b8%ad%e4%bd%bf%e7%94%a8-fake-ip aria-label="在 redir / tun2socks 中使用 Fake IP">在 redir / tun2socks 中使用 Fake IP</a></li><li><a href=#fancyss-%e5%92%8c-surge--clash-%e7%9a%84%e5%8c%ba%e5%88%ab aria-label="FancySS 和 Surge / Clash 的区别">FancySS 和 Surge / Clash 的区别</a></li><li><a href=#%e5%a6%82%e6%9e%9c%e6%93%8d%e4%bd%9c%e7%b3%bb%e7%bb%9f%e6%88%96%e8%80%85%e6%b5%8f%e8%a7%88%e5%99%a8%e7%bc%93%e5%ad%98%e4%ba%86-dns-%e8%a7%a3%e6%9e%90%e7%bb%93%e6%9e%9c aria-label="如果操作系统或者浏览器缓存了 DNS 解析结果">如果操作系统或者浏览器缓存了 DNS 解析结果</a></li><li><a href=#%e5%8f%82%e8%80%83%e8%b5%84%e6%96%99 aria-label=参考资料>参考资料</a></li></ul></li><li><a href=#cfw-tun-%e6%a8%a1%e5%bc%8fhttpsdocscfwlbyczfcomcontentstunhtmllinux aria-label="CFW TUN 模式"><a href=https://docs.cfw.lbyczf.com/contents/tun.html#linux>CFW TUN 模式</a></a></li></ul></li><li><a href=#tproxyhttpsblogindigocodes20211120iptables-tproxy-and-home aria-label=TProxy><a href=https://blog.indigo.codes/2021/11/20/iptables-tproxy-and-home/>TProxy</a></a><ul><li><a href=#summaryhttpsguidev2flyorgapptproxyhtmle9858de7bdaee9808fe6988ee4bba3e79086e8a784e58899 aria-label=Summary><a href=https://guide.v2fly.org/app/tproxy.html#%E9%85%8D%E7%BD%AE%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86%E8%A7%84%E5%88%99>Summary</a></a></li><li><a href=#outputprerouting aria-label=OUTPUT&amp;amp;PREROUTING>OUTPUT&amp;PREROUTING</a></li><li><a href=#%e4%bd%bf%e7%94%a8-chain aria-label="使用 Chain">使用 Chain</a></li><li><a href=#%e5%ba%94%e7%94%a8-tproxy aria-label="应用 tproxy">应用 tproxy</a></li><li><a href=#%e8%a7%a3%e5%86%b3%e5%9b%9e%e7%8e%af%e9%97%ae%e9%a2%98 aria-label=解决回环问题>解决回环问题</a></li><li><a href=#%e5%8a%ab%e6%8c%81-dns aria-label="劫持 DNS">劫持 DNS</a></li></ul></li><li><a href=#wireguardhttpsfuckcloudnativeiopostswireguard-docs-practice aria-label=WireGuard><a href=https://fuckcloudnative.io/posts/wireguard-docs-practice/>WireGuard</a></a><ul><li><a href=#%e6%9c%af%e8%af%ad aria-label=术语>术语</a></li><li><a href=#%e5%b7%a5%e4%bd%9c%e5%8e%9f%e7%90%86 aria-label=工作原理>工作原理</a></li><li><a href=#%e6%90%ad%e5%bb%ba%e4%bd%bf%e7%94%a8%e4%b8%8e%e9%85%8d%e7%bd%ae%e8%af%a6%e8%a7%a3 aria-label=搭建使用与配置详解>搭建使用与配置详解</a><ul><li><a href=#%e5%bf%ab%e9%80%9f%e5%bc%80%e5%a7%8b aria-label=快速开始>快速开始</a></li><li><a href=#%e9%85%8d%e7%bd%ae%e8%af%a6%e8%a7%a3 aria-label=配置详解>配置详解</a></li></ul></li></ul></li></ul></li><li><a href=#gnome aria-label=Gnome>Gnome</a><ul><li><a href=#dconf aria-label=Dconf>Dconf</a></li><li><a href=#%e6%b5%8f%e8%a7%88 aria-label=浏览>浏览</a></li><li><a href=#gedit aria-label=Gedit>Gedit</a></li><li><a href=#nautilushttpswwwcnblogscomkeatonlaop12717071htmltop aria-label=Nautilus><a href=https://www.cnblogs.com/keatonlao/p/12717071.html#top>Nautilus</a></a><ul><li><a href=#%e5%bf%ab%e6%8d%b7%e9%94%ae aria-label=快捷键>快捷键</a></li><li><a href=#%e4%bb%8e%e5%8f%b3%e9%94%ae%e8%8f%9c%e5%8d%95%e5%88%9b%e5%bb%ba%e6%96%b0%e6%96%87%e6%a1%a3 aria-label=从右键菜单创建新文档>从右键菜单创建新文档</a></li><li><a href=#%e7%9b%b4%e6%8e%a5%e6%90%9c%e7%b4%a2%e5%8c%b9%e9%85%8d aria-label=直接搜索匹配>直接搜索匹配</a></li></ul></li><li><a href=#gnome-tweaks aria-label="Gnome Tweaks">Gnome Tweaks</a><ul><li><a href=#ubuntu-dockhttpsblogcsdnneta6864657articledetails103606669 aria-label="Ubuntu Dock"><a href=https://blog.csdn.net/a6864657/article/details/103606669/>Ubuntu Dock</a></a></li><li><a href=#gsconnecthttpsgithubcomgsconnectgnome-shell-extension-gsconnectwikiinstallation aria-label=GSConnect><a href=https://github.com/GSConnect/gnome-shell-extension-gsconnect/wiki/Installation>GSConnect</a></a></li><li><a href=#desktop-icons-ng-dinghttpsextensionsgnomeorgextension2087desktop-icons-ng-ding aria-label="Desktop Icons NG (DING)"><a href=https://extensions.gnome.org/extension/2087/desktop-icons-ng-ding/>Desktop Icons NG (DING)</a></a></li><li><a href=#lunar-calendar-%e5%86%9c%e5%8e%86httpsextensionsgnomeorgextension675lunar-calendar aria-label="Lunar Calendar 农历"><a href=https://extensions.gnome.org/extension/675/lunar-calendar/>Lunar Calendar 农历</a></a></li><li><a href=#paperwmhttpsgithubcompaperwmpaperwm aria-label=PaperWM><a href=https://github.com/paperwm/PaperWM>PaperWM</a></a></li><li><a href=#%e5%85%b6%e4%bb%96%e6%89%a9%e5%b1%95%e6%8e%a8%e8%8d%90 aria-label=其他扩展推荐>其他扩展推荐</a></li></ul></li><li><a href=#%e9%81%97%e7%95%99%e5%90%8d%e7%a7%b0 aria-label=遗留名称>遗留名称</a></li><li><a href=#%e9%bb%98%e8%ae%a4%e5%ba%94%e7%94%a8%e7%a8%8b%e5%ba%8f aria-label=默认应用程序>默认应用程序</a></li><li><a href=#%e6%a1%8c%e9%9d%a2%e5%8d%a1%e6%ad%bbhttpsblogcsdnnetsonggu1996articledetails87712546 aria-label=桌面卡死><a href=https://blog.csdn.net/SongGu1996/article/details/87712546>桌面卡死</a></a></li><li><a href=#nvidia aria-label=NVIDIA>NVIDIA</a><ul><li><a href=#nvidia-drivers-on-ubuntuhttpslinuxconfigorghow-to-install-the-nvidia-drivers-on-ubuntu-20-04-focal-fossa-linux aria-label="NVIDIA drivers on Ubuntu"><a href=https://linuxconfig.org/how-to-install-the-nvidia-drivers-on-ubuntu-20-04-focal-fossa-linux>NVIDIA drivers on Ubuntu</a></a></li><li><a href=#nvidia-optimushttpswikiarchlinuxorgtitlenvidia_optimus_e7ae80e4bd93e4b8ade69687 aria-label="NVIDIA Optimus"><a href=https://wiki.archlinux.org/title/NVIDIA_Optimus_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)>NVIDIA Optimus</a></a></li><li><a href=#prime-synchronizationhttpswikidebianorgnvidia20optimusprime_synchronization aria-label="PRIME Synchronization"><a href=https://wiki.debian.org/NVIDIA%20Optimus#PRIME_synchronization>PRIME Synchronization</a></a></li><li><a href=#nvidia-powermizerhttpsrastatinggithubiohow-to-permanently-set-nvidia-powermizer-settings-in-ubuntu aria-label="NVIDIA PowerMizer"><a href=https://rastating.github.io/how-to-permanently-set-nvidia-powermizer-settings-in-ubuntu/>NVIDIA PowerMizer</a></a></li></ul></li><li><a href=#%e5%af%86%e9%92%a5%e7%8e%afhttpslinuxcnarticle-12093-1html aria-label=密钥环><a href=https://linux.cn/article-12093-1.html>密钥环</a></a><ul><li><a href=#%e5%af%86%e9%92%a5%e7%8e%af%e6%98%af%e4%bb%80%e4%b9%88%e4%b8%ba%e4%bb%80%e4%b9%88%e9%9c%80%e8%a6%81%e5%ae%83 aria-label=密钥环是什么，为什么需要它？>密钥环是什么，为什么需要它？</a></li><li><a href=#%e4%bf%ae%e6%94%b9%e5%af%86%e9%92%a5%e7%8e%af%e5%af%86%e7%a0%81 aria-label=修改密钥环密码>修改密钥环密码</a></li><li><a href=#%e7%a6%81%e7%94%a8%e5%af%86%e9%92%a5%e7%8e%af%e5%af%86%e7%a0%81 aria-label=禁用密钥环密码>禁用密钥环密码</a></li></ul></li><li><a href=#gnome-apps aria-label="Gnome Apps">Gnome Apps</a><ul><li><a href=#bookshttpswikignomeorgappsbooks aria-label=Books><a href=https://wiki.gnome.org/Apps/Books>Books</a></a></li><li><a href=#calendarhttpswikignomeorgappscalendar aria-label=Calendar><a href=https://wiki.gnome.org/Apps/Calendar>Calendar</a></a></li></ul></li></ul></li></ul></div></details></div><div class=post-content><p><code>友邦拓</code> <code>乌班图</code></p><blockquote><p>During the first ten years of this HOWTO&rsquo;s life, I reported that from a new user&rsquo;s point of view, all Linux distributions are almost equivalent. But in 2006-2007, an actual best choice emerged: <a href=http://www.ubuntu.com/>Ubuntu</a>. While other distros have their own areas of strength, Ubuntu is far and away the most accessible to Linux newbies. Beware, though, of the hideous and nigh-unusable &ldquo;Unity&rdquo; desktop interface that Ubuntu introduced as a default a few years later; the Xubuntu or Kubuntu variants are better.</p><p>Eric Steven Raymond - How To Become A Hacker</p></blockquote><h2 id=学习-linux-几点忠告httpswikiubuntuorgcne5ada6e4b9a0_linux_e587a0e782b9e5bfa0e5918a><a href=https://wiki.ubuntu.org.cn/%E5%AD%A6%E4%B9%A0_Linux_%E5%87%A0%E7%82%B9%E5%BF%A0%E5%91%8A>学习 Linux 几点忠告</a><a hidden class=anchor aria-hidden=true href=#学习-linux-几点忠告httpswikiubuntuorgcne5ada6e4b9a0_linux_e587a0e782b9e5bfa0e5918a>#</a></h2><p><strong>不要當“傳教士”</strong></p><p><em>(這點有一個重大弊端：開放軟體沒有商業軟件那樣的宣傳，如果使用者都如此低調，用戶群不會大幅擴展。)</em></p><p>很多人在討論區不斷的引起的Linux對比Windows之類的討論，甚至爭的面紅耳赤，這是沒有必要的</p><p>這種爭論是浪費時間而沒有任何用處的。對，你花了一下午，用許多事實“捍衛”了Linux比Windows好這個說法。但是Windows的支持者並不會喜歡上Linux的，他們只是稍微退縮一下，然後找一些新的證據來跟你辯論。</p><p>世界上的人們都在利用Linux的研究最前沿的科學，我們還在這裡討論“要不要用Linux的這種無聊的問題，什麼時候才能趕上時代前進的步伐？</p><p>什麼叫做Window支持者，什麼叫做Linux的支持者？我們為什麼要支持某一個而反對另外一個？你不需要為 Linux的護法，不需要成為 Linux的支持者“或者”GNU的傳教士“ GNU / Linux的已經用事實向世界證明了它們的威力，已經被大多數人接受。你只需要安安靜靜享受的GNU / Linux的給你的樂趣和自由。</p><p>你需要關心的不是你的工具是什麼，而是你用它做了什麼。精通的Linux並不說明任何問題，因為它只是一個工具而已。如果你用的Windows能很好的完成你的任務，那你就沒有必要費時間去熟悉Linux操作系統。直到有一天你發現一項任務只有Linux操作系統才能完成的時候再換也不遲，因為你身邊的的Linux的愛好者一定會很樂意的幫助你。</p><p>如果你在使用Linux操作系統的過程中對它產生了感情，那麼你應該明白那些習慣於使用Windows的人也會對Windows產生依賴。類似的爭論還有很多：微軟 Office Word和TeX，Emacs和Vim，Wolfram Mathematica和Maple，侏儒，fvwm的和KDE的時候，狗派&mldr; &mldr;和冷靜地對自己說：“我不站在它們任何一邊。”儘管這有些不容易辦到。</p><p>各人的需要不同，生活的環境不同。對你來說好的東西，對別人來說不一定好，我們需要尊重別人的選擇。如果你當面說別人正在用的程序不好，沒有必要。</p><p><strong>不要強迫自己</strong></p><p>喜歡電腦的人總是有某些心理強迫傾向。有的人說：“鍵盤比滑鼠快。我不要用滑鼠。這樣才有高效率。”所以他在編輯器裡無論什麼時候總是用20W的，大於 10J這樣的命令到達目的點。他甚至覺得圖形界面是多餘的，乾脆都不裝 Xwindow。</p><p>全部用鍵盤看起來的確比讓手離開鍵盤去拿鼠標，再回來“快”多了，但是快的擊鍵頻率不等於工作的高效率，對你的健康更沒有什麼好處。這只能把你變成打鍵盤的機器。</p><p>當你正在檢查你的文章或者程序，思維正在隨著字符的含義流動，突然為 20W，大於 10J這樣的東西出現在你的腦子裡，是不是會打斷思路？不？那說明你當時思考的問題比較簡單，這些干擾還不會起到副作用。</p><p>其實很多人用電腦的時候，思想都受到某種教學的束縛，上面這個只是教多數種類中的一種。某些人創造了很多這種數學，用他的工作方式來要求別人，嘲笑方式跟他不一樣的人。比如有的人嘲笑其它人寫程序不按ç 8字符縮進，嘲笑別人在六裡用方向鍵，嘲笑別人不知道是什麼增值稅，嘲笑其它人用在Java，C＃這種由地方選區回收內存語言 &mldr; &mldr;</p><p>你不用管各種各樣的教學，電腦只是你的工具，你想怎麼用就怎麼用。沒有人能夠約束你，沒有人可以嘲笑你的工作方式。電腦明天就不再是這個樣子，所以今天你不用完全了解它。你沒有必要知道別人創造的一切，因為你需要留點時間自己創造些東西。只要有樂趣！</p><p>當你下次修改文章的時候，不妨試試悠閒的用滑鼠在你眼睛看到的地方輕輕點一下。</p><blockquote><p>如果你發現自己有類似的強迫症，建議去諮詢一下心理醫生。</p></blockquote><p><strong>不要“玩”Linux</strong></p><p>Linux的很多人用的時候會感覺很迷茫，該用哪個發行版本呢？是不是我少裝了什麼？怎麼升級這麼快啊！怎麼這麼不穩定！每當遇到新的軟件他就想試用，每當新的版本出現，他就更新，然後用鼠標在新的菜單裡選擇從來沒見過的程序來用用。</p><p>其實你是為了玩Linux而使用Linux操作系統的，而沒有找到正確的理由來利用Linux操作系統。你首先要明確用電腦的目的，你用它是為了解決你的實際問題，而不是為了學習安裝操作系統，不是為了測試哪個版本好用，不是為了“趕上潮流，更不是因為你硬盤太大了，你想多佔點空間。</p><p>如果你啟動了電腦之後不知道應該幹什麼，那麼最好先不要用電腦，因為你可能有更重要的事情需要做。這沒什麼說的。</p><p><strong>不用挑剔發行版本</strong></p><p>很多人剛開始用linux的時候，總是在懷疑別的發行版本是否比自己正在用的這個好，總是懷疑自己以後什麼時候會失去支持，不得不換用別的發行。所以很多人今天是紅帽，明天又換成了Debian的，一會兒又是巴布亞&mldr; &mldr;甚至有的人在一台機器上裝了兩個版本的Linux操作系統，然後比較哪一個好。</p><p>其實你完全沒有必要這樣做，任何發行，只要你熟悉了，你在上面的工作方式幾乎不會受到任何影響。我以前一直用的紅帽，當我有一天在我的一台新機器上安裝Debian時，我發現使用紅帽的經驗完全沒有浪費。我用了一個下午就配置好了Debian，使它服服貼貼的聽我的話，就跟沒有換發行版本一樣。</p><p>Debian，拓林思，SuSE，紅帽，Gentoo&mldr; &mldr;任何一個版本都是不錯的。很多人認為自己攢一個 LFS的是高水平黑客的象徵，但是不是每個人都有精力去了解所有細節。</p><p><strong>不要盲目升級</strong></p><p>不知道這是心理作用還是什麼，有的人看到比較大的版本號，就會很想換成那個。很多人的Redhat的本來配置的很舒服了，可是一旦Redhat的發行新的版本，他們就會盡快下載過來，然後選擇升級安裝。結果很多時候把自己原來修改得很好的配置文件給沖掉了。新的軟件又帶來了新的問題，比如有一次我的rxvt的就升級到2.7.8跟miniChinput衝突了，升級到Redhat的8.0，xmms的發現居然缺省不能放了MP3播放，XFree86的是i810的模塊在啟動上有新的漏洞，Mozilla中，會導致突然退出。</p><p>如果你已經配置好了一切，千萬別再整體升級了，這會浪費你很多很多時間的，不值得。有句話說得好：“如果沒有打破，不解決它。”如果你的程序能夠完成你需要做的事情，你何必升級呢？？？？</p><blockquote><p>是的，不論是從論壇還是其他的地方反映出來的大部分都是這個問題，要么比较SUSE和Ubuntu的好，要么比Ubuntu或者Mandriva的好等等的言論。很多人還是把Linux操作系統看成了一個表面的東西。並沒有塌下心來學習 Linux系統。</p></blockquote><p><strong>不要配置你不需要的東西</strong></p><p>如果你只想做一個像我這樣的普通用戶，主要目的是用的Linux來完成自己的科研任務和日常工作，那就可以不用系統管理員或者網絡管理員的標準來要求自己，因為當一個系統和網絡管理員確實很辛苦。普通用戶學習那些不經常用到的複雜的維護系統的工具，其實是浪費時間，學了不用是會很快忘記的！</p><p>我不是一個合格的網絡管理員，我的服務器都只設置了我自己需要的功能，設置好ssh連接的ftp已經足夠了，那樣可以省去我很多麻煩。我從來不過度考慮“安全，因為 Linux操作系統缺省已經很安全了。我沒有磁帶機，就不用管tar的那些稀奇古怪的參數了，czf，xzf，ztf已經可以滿足我所有的需要。桑達，awk的，&mldr;我也只會幾種常用的命令行。</p><p><strong>不要習慣的使用根帳號。在需要的時候才用！</strong></p><p>這是很多剛接觸的UNIX類操作系統的人常見的現象，他們不喜歡在管理系統的時候才用，而是一直用根帳號幹所有事情，配置系統，安裝程序，瀏覽網頁，玩遊戲，編程 &mldr; &mldr;</p><p>結果有一天，他不小心在某個系統目錄使用了del * &mldr;後果不堪設想 &mldr; &mldr;</p><p><strong>不要用商業的眼光來看待Linux</strong></p><p>Linux不是商業軟件，所以不要用要求Solaris操作系統，視窗那樣的眼光來看 Linux操作系統。自由軟件的作者們從來不拉攏用戶，他們對用戶不負有任何責任。實際上在自由軟件的世界裡，開發者“和”用戶“並沒有明確的界限，大家是朋友。</p><p>自由軟件很可能只是滿足作者和他的朋友的需要，甚至是為了好玩而創造的。自由軟件不是完美的，自由軟件承認自己有缺點，它不會自吹自擂，蒙蔽“用戶”的耳目。這種對作者責任的解脫激發了作者的創造力，他們不用過分考慮“向上兼容，他們往往比背上重重包袱的商業軟件結構更合理，技術更先進。</p><p>所以當你用某個自由軟件遇到困難的時候，不應該埋怨軟件的作者，因為他們對你並沒有義務。你不應該把自己當成一個挑剔的顧客，而要把自己作為這個軟件的顧問和一個和藹的建議者，這樣你才能理解作者寫這個程序時的快樂，在遇到問題時向作者反映，幫助他完善這個軟件，成為一個快樂的參與者。就像你的哥哥送你一個他用舊了的自行車，你應該珍惜這份友情，而不要在車壞了，或者騎車摔了一跤的時候大罵你的哥哥。如果你真的不能使用這種合作的心態，那麼最好不要使用這個軟件。</p><p>這是一種先進的文化，它包含了互相合作，科學創新的精神。理解這一點不是很容易，很多人往往是因為不能理解這種文化而離開自由軟件。這對於作者來說並沒有什麼損失。</p><p><strong>幹你的正事去</strong></p><p>很多人跟我說，你的網頁浪費我好多時間來配置這配置那，一會兒是fvwm的，一會兒是Mutt中&mldr; &mldr;</p><p>嗯&mldr; &mldr;那些東西都是我有空的時候一點一點積累的，如果你想一次性搞定所有那些東西，恐怕得花你幾個星期甚至幾個月的時間！並不是一定要搞定所有這些東西你才能正常工作的。除非你真的非得利用某個程序，或者你閒著沒事，否則你可以不管這些東西。</p><p><strong>上面幾條僅供參考</strong></p><p>以上只是個人意見，不一定適合所有人。取捨由你了！</p><h2 id=settings>Settings<a hidden class=anchor aria-hidden=true href=#settings>#</a></h2><p><code>gnome-control-center</code></p><h3 id=dnshttpsguoyunheme20220529linux-gfw-dns><a href=https://guoyunhe.me/2022/05/29/linux-gfw-dns/>DNS</a><a hidden class=anchor aria-hidden=true href=#dnshttpsguoyunheme20220529linux-gfw-dns>#</a></h3><p>最近经常出现 Firefox 可以打开 GitHub 网站，但是命令行 Git 无法拉取/推送代码的情况。甚至开了 VPN 也不行。运行 ping 命令发现 github.com 被解析到了 127.0.0.1，这是 DNS 被劫持了。是谁搞的鬼，相信你一定懂得。</p><h4 id=为啥-firefox-可以打开-github>为啥 Firefox 可以打开 GitHub<a hidden class=anchor aria-hidden=true href=#为啥-firefox-可以打开-github>#</a></h4><p>最新的 Firefox 桌面版默认启用了 DoH（DNS over HTTPS），通过向特定的服务器发送 HTTPS 请求获取域名的 IP 地址。这就绕过了电信/联通/移动等提供的有毒 DNS 服务器。因为 DoH 采用 HTTPS 协议，不容易被劫持。另外国内用 Firefox 的很少，这个技术并不普及，所以暂时没有被老大哥盯上。</p><p>但是很可惜，DoH 目前无法在 Linux 系统层面支持，运行命令行仍然是使用 ISP 提供的 DNS 服务器。电信/联通/移动经常抽风，甚至某些路由器都会给你下毒，让你打不开网页或者直接跳到某网址导航。</p><h4 id=为啥开了-vpn-也不行>为啥开了 VPN 也不行<a hidden class=anchor aria-hidden=true href=#为啥开了-vpn-也不行>#</a></h4><p>因为通常是先连接本地网络，这时候已经从 ISP 获取了一个 DNS 服务器。再连接 VPN，（以 OpenVPN 为例）仍然是用的这个 DNS 服务器。</p><p>某些商业 VPN 客户端是会在连接上 VPN 之后自动更换 DNS 服务器的。但是 Linux 自带的网络管理是没这个能力的。</p><p>因此，如果你只用 Linux 自带的网络管理，最好的解决方法依然是手动设置一个可靠的 DNS 服务器。</p><h4 id=dns-服务器哪家强>DNS 服务器哪家强<a hidden class=anchor aria-hidden=true href=#dns-服务器哪家强>#</a></h4><p>如果你去网上搜，很多老的文章会推荐这两个：</p><ol><li>Google 的 8.8.8.8</li><li>Cloudflare 的 1.1.1.1</li></ol><p>这两个 DNS 还是能用的，但是在有些地方不太稳定，甚至直接连不上。</p><p>目前还是推荐国内正规企业提供的 DNS 服务器：</p><ol><li><a href=https://dns.pub/>DNSPod/腾讯云</a> 119.29.29.29</li><li><a href=https://alidns.com/>阿里云</a> 223.5.5.5</li></ol><p>并不能保证腾讯和阿里的 DNS 百分之百可靠，但是比电信/联通/移动好太多。起码 GitHub 是可以正常解析的。</p><h4 id=如何设置-dns>如何设置 DNS<a hidden class=anchor aria-hidden=true href=#如何设置-dns>#</a></h4><p>这里就只介绍普通桌面用户用 NetworkManager 和 KDE 的用法。GNOME 基本类似。用 Wicked 的都是技术大佬，相信也不用看下面这些了。</p><ol><li>从系统托盘网络图标右击，打开“网络设置”。</li><li>选择你的有线或者 WiFi 链接，进行编辑。</li><li>切换到 IPv4 标签页。</li><li>将“方法”从“自动”改成“自动（仅网络地址）”。</li><li>将“DNS服务器”改成“119.29.29.29”。</li><li>点“应用”并关闭“网络设置”窗口。</li><li>点击系统托盘的网络图标，打开网络列表，断开并重新链接。</li></ol><p>注意，如果需要频繁更换不同的 WiFi 链接，则需要对不同的 WiFi 配置添加自己的 DNS 服务器。</p><p>如果是自己家的网络，可以在路由器上配置，方法和上面类似，都是配置 IPv4 方法和 DNS 服务器。（注意，路由器的 WAN 互联网和 LAN 局域网设置都要配一下）这样家里的设备就不用单独配置了。</p><p><strong><a href=https://www.cnblogs.com/baihuitestsoftware/articles/9519724.html>CLI</a></strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 显示当前网络连接</span>
</span></span><span style=display:flex><span>$ nmcli connection show
</span></span><span style=display:flex><span><span style=color:#75715e># 修改当前网络连接对应的DNS服务器，这里的网络连接可以用名称或者UUID来标识</span>
</span></span><span style=display:flex><span>$ nmcli con mod ens160 ipv4.dns <span style=color:#e6db74>&#34;8.8.4.4 8.8.8.8&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 配置生效</span>
</span></span><span style=display:flex><span>$ nmcli con up ens160
</span></span></code></pre></div><p><a href=https://phoenixnap.com/kb/ubuntu-dns-nameservers>或者</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Config File</span>
</span></span><span style=display:flex><span>$ vi /etc/netplan/01-network-manager-all.yaml
</span></span><span style=display:flex><span>network:
</span></span><span style=display:flex><span>  version: <span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  renderer: NetworkManager
</span></span><span style=display:flex><span>  ethernets:
</span></span><span style=display:flex><span>    ens3:
</span></span><span style=display:flex><span>      dhcp4: no
</span></span><span style=display:flex><span>      addresses:
</span></span><span style=display:flex><span>        - 192.168.100.199/24
</span></span><span style=display:flex><span>      gateway4: 192.168.100.1
</span></span><span style=display:flex><span>      nameservers:
</span></span><span style=display:flex><span>        address: <span style=color:#f92672>[</span>8.8.4.4, 8.8.8.8<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  wifis:
</span></span><span style=display:flex><span>    ...
</span></span><span style=display:flex><span><span style=color:#75715e># Apply the changes you made in the config file</span>
</span></span><span style=display:flex><span>$ sudo netplan apply
</span></span><span style=display:flex><span><span style=color:#75715e># To check if the system successfully applied the changes</span>
</span></span><span style=display:flex><span>$ systemd-resolve --status | grep <span style=color:#e6db74>&#39;DNS Servers&#39;</span> -A2
</span></span><span style=display:flex><span>         DNS Servers: 8.8.4.4
</span></span><span style=display:flex><span>                      8.8.8.8        
</span></span></code></pre></div><p>注意：您系统上的文件可能缺少整个以太网或 wifi 部分。 在这种情况下，添加缺少的行，确保遵守示例中提供的缩进。</p><p><strong><a href=https://www.fosslinux.com/45397/opendns-vs-google-dns.htm>Testing the Domain Name Resolution Speed</a></strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ time dig @8.8.4.4
</span></span></code></pre></div><h4 id=清空-dns-缓存>清空 DNS 缓存<a hidden class=anchor aria-hidden=true href=#清空-dns-缓存>#</a></h4><p>因为 DNS 记录是有本地缓存的，即使你更换了 DNS 服务器，依然会优先从缓存里取 IP 地址。所以更换 DNS 之后，需要清空 DNS 缓存。</p><p>这是一个比较头疼的问题，因为各家 Linux 发行版用来管理 DNS 的方式不一样，清空 DNS 缓存的方法也不一样。最通用的方法：重启系统。</p><p>如果不想重启系统，那么可以参考这篇<a href=https://www.techrepublic.com/article/how-to-flush-the-dns-cache-on-linux/>How to flush the DNS cache on Linux</a> 。我大概总结一下，就是逐个试下面的命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo systemd-resolve --flush-caches
</span></span><span style=display:flex><span>$ sudo systemctl restart nscd
</span></span><span style=display:flex><span>$ sudo systemctl restart named
</span></span></code></pre></div><p>如果没有用的话，还是重启系统吧。</p><h4 id=测试-dns-解析>测试 DNS 解析<a hidden class=anchor aria-hidden=true href=#测试-dns-解析>#</a></h4><p>首先用 nslookup 测试一下 DNS 服务器是否能解析，如果解析出来的 Server 是你之前配的地址，Address 不是 127.0.0.1 或者 0.0.0.0 这种，应该就是好的。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ nslookup github.com
</span></span><span style=display:flex><span>Server:         119.29.29.29
</span></span><span style=display:flex><span>Address:        119.29.29.29##53
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Non-authoritative answer:
</span></span><span style=display:flex><span>Name:   github.com
</span></span><span style=display:flex><span>Address: 20.205.243.166
</span></span></code></pre></div><p>但是 nslookup 能解析，并不意味着就能连上。实际连接还要看 ping 命令。注意 github.com 并不回应 ping 请求，也就是数据包都会 lost，这是正常的。只要 ping 能解析到 IP 地址就行了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ping github.com
</span></span><span style=display:flex><span>PING github.com <span style=color:#f92672>(</span>20.205.243.166<span style=color:#f92672>)</span> 56<span style=color:#f92672>(</span>84<span style=color:#f92672>)</span> 字节的数据。
</span></span><span style=display:flex><span>^C
</span></span><span style=display:flex><span>--- github.com ping 统计 ---
</span></span><span style=display:flex><span>已发送 <span style=color:#ae81ff>3</span> 个包， 已接收 <span style=color:#ae81ff>0</span> 个包, 100% packet loss, time 2049ms
</span></span></code></pre></div><p>如果 ping 没问题，最后再试一下 git pull 命令。如果不能访问，则需要试试 VPN 了。</p><h3 id=others>Others<a hidden class=anchor aria-hidden=true href=#others>#</a></h3><ul><li>Bluetooth: OFF</li><li>Formats: United States</li><li>Night Light: ON</li><li>Blank screen: 10</li><li>Touchpad: OFF</li><li><a href=https://linuxhint.com/enable-fractional-scaling-on-ubuntu/>Fractional Scaling</a></li></ul><h2 id=softwareupdates>SoftWare&amp;Updates<a hidden class=anchor aria-hidden=true href=#softwareupdates>#</a></h2><p><code>software-properties-gtk</code> or <code>software-properties-kde</code> (Kubuntu) and <code>update-manager</code> (Software Updator)</p><ul><li><p>Ubuntu Software 栏 Download from 选择 <a href=https://mirrors.ustc.edu.cn/>USTC MIRRORS</a>。也可以在 <a href=https://launchpad.net/ubuntu/+archivemirrors>Official Archive Mirrors for Ubuntu</a> 中选择。</p></li><li><p>Other Software 栏下开启 Canonical Partner Repositories (The partner repositories offer access to proprietary and closed-source software)。</p></li><li><p>Ubuntu 自动下载并安装对你的系统至关重要的安全更新。而这个自动更新经常导致你<a href=https://itsfoss.com/could-not-get-lock-error/>“无法锁定管理目录”</a>错误。在 Updates 栏下选择</p><ul><li>For other packages, subscribe to: All updates</li><li>Automatically check for updates: Every two weeks</li><li>When there are security updates: Download and Install automatically</li><li>When there are other updates: Display immediately</li><li>Notify me of a new Ubuntu version: For long-term support versions</li></ul></li><li><p>更新系统:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt update
</span></span><span style=display:flex><span>$ sudo apt upgrade
</span></span><span style=display:flex><span>$ sudo apt autoremove
</span></span></code></pre></div></li><li><p><a href=https://ubuntu.com/livepatch>Livepatch</a>: 更新内核不需要 Reboot required 了</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo ua attach &lt;subscription&gt;
</span></span></code></pre></div></li></ul><p><strong>Ubuntu Software & Update 卡在 cache refresh</strong></p><p>通过 <code>apt update</code> 可以看见是 Connecting to security.ubuntu.com Failed，解决办法是更改 /etc/hosts 文件添加其 IP，可通过 <a href=https://www.easycounter.com/>EASYCOUNTER</a> 查找：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>## security.ubuntu.com</span>
</span></span><span style=display:flex><span>91.189.88.142 security.ubuntu.com
</span></span><span style=display:flex><span>91.189.88.152 security.ubuntu.com
</span></span><span style=display:flex><span>91.189.91.38 security.ubuntu.com
</span></span><span style=display:flex><span>91.189.91.39 security.ubuntu.com
</span></span><span style=display:flex><span><span style=color:#75715e>## archive.canonical.com</span>
</span></span><span style=display:flex><span>91.189.92.150 archive.canonical.com
</span></span><span style=display:flex><span>91.189.92.191 archive.canonical.com
</span></span><span style=display:flex><span>91.189.91.15 archive.canonical.com
</span></span><span style=display:flex><span><span style=color:#75715e>## downloads.sourceforge.net</span>
</span></span><span style=display:flex><span>216.105.38.13 downloads.sourceforge.net
</span></span></code></pre></div><p><strong>ubuntu下如何获取源码包和源码</strong></p><ul><li><p>在 Software & Updates 中选中 Source code，不要 Reload，因为很慢，在命令行中 update。或者在软件源配置文件 /etc/apt/sources.list 中添加 deb-src 项。</p></li><li><p>获取 xxx 源码包的详细信息</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt-cache showsrc xxx
</span></span></code></pre></div></li><li><p>获取源码包，并将源码包解压到同名目录</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt-get source  xxx 
</span></span></code></pre></div></li></ul><p><strong><a href=https://vitux.com/how-to-upgrade-ubuntu-20-04-to-21-04/>Upgrade Ubuntu version</a></strong></p><ul><li>打开 Software Updater 更新软件</li><li>打开 Software & Updates 选择 Updates 栏，在 Notify me of a new Ubuntu Version 中选择 For any new version 。</li><li>打开 Software Updater 更新到新 Ubuntu 版本。</li><li>使用 <code>lsb_release -a</code> 确认 Ubuntu 版本。</li></ul><h2 id=input-method-editor>Input Method Editor<a hidden class=anchor aria-hidden=true href=#input-method-editor>#</a></h2><p>首先在 Language Support (<code>gnome-language-selector</code>，注意不要在终端中运行这个命令，因为环境不一样) 中下载语言包。</p><p>里面的选择输入法实质是 <code>im-config</code> 这个包。</p><h3 id=ibushttpswikiarchlinuxorgtitleibus><a href=https://wiki.archlinux.org/title/IBus>IBus</a><a hidden class=anchor aria-hidden=true href=#ibushttpswikiarchlinuxorgtitleibus>#</a></h3><p>ubuntu libpinyin 输入法支持云拼音，只需要开启就可以了。</p><p><strong>Emoji input</strong></p><p>IBus supports the input of emoji icons. Type <code>Ctrl+.</code> or <code>Ctrl+;</code> and you will see the input prompt change to an underlined <strong>e</strong> character. You can then type the symbol or name of the emoji you want (e.g. <strong>:)</strong> or <strong>face</strong>) and press <code>Space</code> to render it. If you are satisfied with the result press <code>Enter</code> to submit it and exit emoji input mode, or press <code>Space</code> for a second time to open a dialog where you can further customize your desired emoji.</p><p>See <a href=https://man.archlinux.org/man/ibus-emoji.7>ibus-emoji(7)</a> for more information.</p><p><strong>Unicode input</strong></p><p>IBus supports the input of complex Unicode characters. Type <code>Ctrl+Shift+u</code> and you will see the input prompt change to an underlined <strong>u</strong> character. You can then type the code of the Unicode character you want and press <code>Space</code> or <code>Enter</code> to render and submit it.</p><ul><li>間隔號「·」<code>U+00B7</code></li></ul><p><a href="https://forum.ubuntu.com.cn/viewtopic.php?t=252407"><strong>搜狗细胞词库</strong></a></p><p>到<a href=https://code.google.com/archive/p/hslinuxextra/downloads>hslinuxextra</a>下载<a href=https://storage.googleapis.com/google-code-archive-downloads/v2/code.google.com/hslinuxextra/sougou-phrases-full.7z>sougou-phrases-full.7z</a>。</p><p>经过与ibus开发者协商，ibus-pinyin的词库查找规则做了一些更改，只要在词库目录（就是有一个.db文件的那个目录，一般是<code>/usr/share/ibus-libpinyin/db/</code>目录）把新词库复制过来并改名为local.db就可以使用了，如果感觉词库不好，直接删除掉local.db，就可以让ibus使用原来的词库。</p><p>覆盖以后，你把ibus重启一下<code>ibus-daemon -d -x -r</code>，如果你能打出下面的这个词组，说明生效了：</p><pre tabindex=0><code class=language-把 data-lang=把>弗雷德霍姆行列式
</code></pre><p>这个词库，基于ibus原有的android词库文件，另外增加了搜狗的细胞词库。</p><h3 id=fcitx-4>Fcitx 4<a hidden class=anchor aria-hidden=true href=#fcitx-4>#</a></h3><p><a href=https://www.sinocalife.com/ubuntu-20-04-chinese-ime-selection>在Ubuntu Wayland 桌面中使用fictx管理中文输入法</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install fcitx -y
</span></span></code></pre></div><p>设置 fcitx：</p><ul><li><p>在 Language Support 中选择 fcitx，全局应用，并恢复 ibus 自定义切换语言快捷键设置。</p></li><li><p>(可选）<strong>wayland</strong>桌面默认不读取/etc/profile中的环境变量，而是从/etc/environment文件中读取，这是导致fcitx不能正常工作的原因。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo vim /etc/environment
</span></span><span style=display:flex><span>INPUT_METHOD<span style=color:#f92672>=</span>fcitx
</span></span><span style=display:flex><span>GTK_IM_MODULE<span style=color:#f92672>=</span>fcitx
</span></span><span style=display:flex><span>QT_IM_MODULE<span style=color:#f92672>=</span>fcitx
</span></span><span style=display:flex><span>XMODIFIERS<span style=color:#f92672>=</span>@im<span style=color:#f92672>=</span>fcitx
</span></span></code></pre></div></li></ul><p>输入法框架：</p><ul><li><a href="https://pinyin.sogou.com/linux/?r=pinyin">搜狗输入法 for Linux</a></li><li><a href=https://srf.baidu.com/site/guanwang_linux/index.html>百度输入法Linux版</a></li><li><a href=https://www.ubuntuupdates.org/package/core/focal/universe/base/fcitx-googlepinyin>Google拼音</a></li></ul><p>其他：</p><ul><li>百度输入法不能安装用于更换皮肤的 fcitx-ui-qimpanel，否则乱码。需要手动安装 fcitx-libs，否则开机不自动启动。</li><li>在 fcitx 与 sogoupinyin 安装完之后，需要重启才能使用。</li></ul><p>皮肤：</p><ul><li><a href="https://forum.ubuntu.com.cn/viewtopic.php?t=391755">fcitx 皮肤</a>：/usr/share/fcitx/skin</li><li><a href=https://www.cnblogs.com/chilono/p/9203041.html>sogoupinyin 皮肤</a>：/usr/share/sogou-qimpanel/skin。<ul><li><a href=https://pinyin.sogou.com/skins/skin_use.php>旧</a>：可以改名为 zip 解压</li><li><a href=https://linux.zone/5616>新</a>：受版权保护</li></ul></li></ul><h3 id=fcitx-5httpsfcitx-imorgwikifcitx_5><a href=https://fcitx-im.org/wiki/Fcitx_5>Fcitx 5</a><a hidden class=anchor aria-hidden=true href=#fcitx-5httpsfcitx-imorgwikifcitx_5>#</a></h3><h4 id=安装httpsplumzmearchives11740><a href=https://plumz.me/archives/11740/>安装</a><a hidden class=anchor aria-hidden=true href=#安装httpsplumzmearchives11740>#</a></h4><p>配置工具 KDE 下使用 <code>kde-config-fcitx5</code>， Gnome 下使用 <code>fcitx5-config-qt</code>。</p><p>20.04 (20220122) 官方仓库里没有 Gnome 的配置工具 kcm-fcitx5（内含 fcitx5-config-qt），因此通过 <strong><a href=https://launchpad.net/~zhsj/+archive/ubuntu/fcitx5>ppa:zhsj/fcitx5</a></strong> 来安装</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo add-apt-repository ppa:zhsj/fcitx5
</span></span><span style=display:flex><span>$ sudo apt-get update
</span></span><span style=display:flex><span>$ sudo apt install fcitx5 fcitx5-chinese-addons
</span></span></code></pre></div><p>或者也可以通过**<a href=https://plumz.me/archives/12285/>通过 flatpak 安装</a>**。</p><p><strong>安装后在 Ubuntu 在 Language Support 里修改输入法系统为 fcitx5，记得点击 Apply System-Wide。</strong></p><p>安装报如下错</p><pre tabindex=0><code>E: Failed to fetch http://103.95.217.6/ppa.launchpad.net/zhsj/fcitx5/ubuntu/pool/main/f/fcitx5-chinese-addons/fcitx5-module-cloudpinyin_5.0.4-1~ubuntu20.04.1~ppa1_amd64.deb  503  Service Unavailable [IP: 103.95.217.6 80]
E: Aborting install.
</code></pre><p>可以在浏览器中打开链接直接下载。</p><h4 id=肥猫百万大词库httpsgithubcomfelixonmarsfcitx5-pinyin-zhwiki><a href=https://github.com/felixonmars/fcitx5-pinyin-zhwiki>肥猫百万大词库</a><a hidden class=anchor aria-hidden=true href=#肥猫百万大词库httpsgithubcomfelixonmarsfcitx5-pinyin-zhwiki>#</a></h4><p>Download latest version of &ldquo;<strong>zhwiki.dict</strong>&rdquo; from <a href=https://github.com/felixonmars/fcitx5-pinyin-zhwiki/releases>https://github.com/felixonmars/fcitx5-pinyin-zhwiki/releases</a></p><p>Copy into <code>~/.local/share/fcitx5/pinyin/dictionaries/</code> (create the folder if it does not exist)</p><p>可以在设置中看到是否启用，或者输入 “jinjinjin” 会出现 “鑫”。</p><h4 id=fcitx5-皮肤绘制简易教程httpsforumsuseorgcnttopic14474><a href=https://forum.suse.org.cn/t/topic/14474>fcitx5 皮肤绘制简易教程</a><a hidden class=anchor aria-hidden=true href=#fcitx5-皮肤绘制简易教程httpsforumsuseorgcnttopic14474>#</a></h4><h4 id=tips>Tips<a hidden class=anchor aria-hidden=true href=#tips>#</a></h4><p><a href=https://wiki.archlinux.org/title/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E9%80%9A%E8%BF%87_Fcitx5_%E8%BE%93%E5%85%A5%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6><strong>通过 Fcitx5 输入特殊字符</strong></a></p><p>将光标定位到任意一个输入框内，然后按下 <code>Ctrl + Alt + Shift + U</code>，然后输入 <code>circle one</code>，您将会看到多种形式的 <code>①</code>。alpha, beta, sigma 等同理。</p><p><a href=https://github.com/levinit/fcitx-emoji><strong>emoji表情</strong></a></p><p>fcitx输入法自带的表情名都是英文的，而且以两个<code>:</code>包含住的，例如🌹（玫瑰rose），按下<code>;</code>后，输入<code>🌹</code>即可打出玫瑰的图标（更多内置图标名字见 Fcitx Configuration => Addons => Quick Phrase => Editor => emoji-eac)。</p><h3 id=rimehttpswwwcnblogscomkeatonlaop12983158html><a href=https://www.cnblogs.com/keatonlao/p/12983158.html>RIME</a><a hidden class=anchor aria-hidden=true href=#rimehttpswwwcnblogscomkeatonlaop12983158html>#</a></h3><p>RIME/中州韵输入法引擎（Rime Input Method Engine），是一个跨平台的可高度定制的输入法算法框架。基于这个算法框架，Rime 開發者與其他開源社區的參與者在 Windows、macOS、Linux、Android 等平臺上創造了不同的輸入法前端實現。每个平台都有各自的名称：</p><ul><li>【中州韵】 ibus_rime → Linux</li><li>【小狼毫】 Weasel → Windows</li><li>【鼠须管】 Squirrel → Mac OS X</li></ul><p>在 Linux 下有两大主要的输入法支持框架：fcitx 和 IBus。</p><ul><li>fcitx 是 Free Chinese Input Toy for X 的简称。</li><li>IBus 是 Intelligent Input Bus 的简称。</li></ul><p>Rime 二者都支持，有 <a href=https://github.com/rime/home/wiki/RimeWithIBus>ibus rime</a> 和 fcitx-rime 两个版本。值得注意的是，基于 Fcitx 输入法框架的 fcitx-rime 是第三方软件，由 Fcitx 团队开发和维护。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># ibus</span>
</span></span><span style=display:flex><span>$ sudo apt install ibus-rime
</span></span><span style=display:flex><span><span style=color:#75715e># fcitx4</span>
</span></span><span style=display:flex><span>$ sudo apt install fcitx-rime
</span></span><span style=display:flex><span><span style=color:#75715e># fcitx5〔方案選單〕 </span>
</span></span><span style=display:flex><span>$ sudo apt install fcitx5-rime
</span></span></code></pre></div><p>按组合键 <strong>Ctrl+`</strong> 或 <code>F4</code> 键唤出输入方案选单，由此调整 Rime 输入〔方案選單〕 法最常用的选项。您可通过方案选单切换已经安装的输入方案。</p><p>更多中州韵输入法配置，请阅读晦涩的官方文档：</p><ul><li><a href=https://github.com/rime/home/wiki/UserGuide>用户指南 · rime/home Wiki</a></li><li><a href=https://github.com/rime/home/wiki/CustomizationGuide>配置指南 · rime/home Wiki</a></li><li><a href=https://github.com/rime/home/wiki/RimeWithSchemata>方案設計書 · rime/home Wiki</a></li></ul><h4 id=必知必会>必知必会<a hidden class=anchor aria-hidden=true href=#必知必会>#</a></h4><ul><li>输入法代号：<code>ibus_rime</code></li><li>ibus 用户资料夹： <code>~/.config/ibus/rime/</code></li><li>fcitx 用户资料夹：<code>~/.config/fcitx/rime</code></li><li>fcitx5 用户资料夹：<code>~/.local/share/fcitx5/rime</code></li><li>共享资料夹： <code>/usr/share/rime-data/</code></li></ul><p>共享资料夹包含预设输入方案的源文件。 这些文件属于 Rime 所发行软件的一部份，在访问权限控制较严格的系统上对用户是只读的，因此谢绝软件版本更新以外的任何修改—— 一旦用户修改这里的文件，很可能影响后续的软件升级或在升级时丢失数据。</p><p>在「部署 Rime」操作时，将用到这里的输入方案源文件、并结合用户定制的内容来编译预设输入方案。</p><p><strong>「用户资料夹」数据说明</strong></p><p>用户资料夹则包含为用户准备的内容，如</p><ul><li>〔全局設定〕 <code>default.yaml</code></li><li>〔發行版設定〕 <code>ibus_rime.yaml</code>：定制外观一般情况下会在 <code>&lt;发行版>.custom.yaml</code> 文件中进行配置，Linux 下就是 <code>ibus_rime.custom.yaml</code>，macOS 下是 <code>squirrel.custom.yaml</code>，windows 下就是 <code>weasel.custom.yaml</code></li><li>〔預設輸入方案副本〕 <code>&lt;方案标识>.schema.yaml</code> <code>ibus_rime.schema.yaml</code></li><li>※〔安裝信息〕 <code>installation.yaml</code></li><li>※〔用戶狀態信息〕 <code>user.yaml</code></li></ul><p>编译输入方案所产出的二进制文件：</p><ul><li>〔Rime 棱鏡〕 <code>&lt;方案标识>.prism.bin</code></li><li>〔Rime 固態詞典〕 <code>&lt;词典名>.table.bin</code>：由系统文本词库（一般以xxx.dict.yaml结尾）通过「重新部署/deploy」生成的固态词典（一般以xxx.table.bin结尾），这部份词库因为在输入过程是固定不変的，所以存在用大量的词彚，也不允许用戸来直接删除。</li><li>〔Rime 反查詞典〕 <code>&lt;词典名>.reverse.bin</code></li></ul><p>记录用户写作习惯的文件：</p><ul><li>※〔用戶詞典〕 <code>&lt;词典名>.userdb.kct</code>：记录我们用戸输入习惯的用戸词典（一般以xxx.userdb.kct）结尾。这部份词库的词彚，正常情况下是由用戸输入的时候随时生成的；其词彚可以动态调整，数量理论上来说不会特别多，也允许用戸自行删除（shift+delete）。</li><li>※〔用戶詞典快照〕 <code>&lt;词典名>.userdb.txt</code>、<code>&lt;词典名>.userdb.kct.snapshot</code> 見於同步文件夾</li></ul><p>以及用户自己设定的：</p><ul><li>※〔用戶對全局設定的定製信息〕 <code>default.custom.yaml</code></li><li>※〔用戶對預設輸入方案的定製信息〕 <code>&lt;方案标识>.custom.yaml</code></li><li>※〔用戶自製輸入方案〕及配套的詞典源文件</li></ul><p>注：以上标有 ※ 号的文件，包含用户资料，您在清理文件时要注意备份！</p><p><a href=https://github.com/rime/weasel/issues/6><strong>关于配置的位置问题</strong></a></p><p>要更改輸入方案裏面的選項，給輸入方案打補靪；</p><p>要更改全局選項，給 default.yaml 打補靪；</p><p>要更改「小狼毫」專屬的選項，如界面樣式，給 weasel.yaml 打補靪。</p><p>總地來說規則是：要修改的配置項在 x(.schema).yaml 裏，就編輯 x.custom.yaml 打補靪。</p><h4 id=定制>定制<a hidden class=anchor aria-hidden=true href=#定制>#</a></h4><h5 id=定制指南>定制指南<a hidden class=anchor aria-hidden=true href=#定制指南>#</a></h5><p>当用户需要对 Rime 中的各种设定做小幅的调节，最直接、但不完全正确的做法是：编辑「共享资料夹」中那些 <code>.yaml</code> 文档（<code>/usr/share/rime-data/</code> ）。</p><p>这种方法有很大缺陷：</p><ul><li>当 Rime 软件升级时，也会升级各种设定档、预设输入方案。用户编辑过的文档会被覆盖为更高版本，所做调整也便丢失了。</li><li>软件升级后，你不能将备份文件直接覆盖升级后的文件。这将失去本次升级所新增和修复的功能。唯一的方法是，重新编辑升级后的文件。</li></ul><p>因此，对于随 Rime 发行的设定档及预设输入方案，推荐的定制方法是：</p><p>在「用户资料夹」下创建 <code>.yaml</code> 定制文档；比如</p><ul><li><code>default.yaml</code> 的定制文件名为 <code>default.custom.yaml</code></li><li><code>luna_pinyin</code> 的定制文件名为 <code>luna_pinyin.custom.yaml</code></li><li><code>luna_pinyin_simp</code> 的定制文件名为 <code>luna_pinyin_simp.custom.yaml</code></li><li><code>symbols.yaml</code> 的定制文件名为 <code>symbols.custom.yaml</code></li></ul><p>规范为在文件名主体（ID）和 <code>.yaml</code> 之间增加次级扩展名 <code>.custom</code>。定制文档的书写格式为：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-lua data-lang=lua><span style=display:flex><span>patch:
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;一级设定项/二级设定项/三级设定项&#34;</span>: <span style=color:#960050;background-color:#1e0010>新的设定值</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;另一个设定项&#34;</span>: <span style=color:#960050;background-color:#1e0010>新的设定值</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;再一个设定项&#34;</span>: <span style=color:#960050;background-color:#1e0010>新的设定值</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;含列表的设定项/@n&#34;</span>: <span style=color:#960050;background-color:#1e0010>列表第</span>n<span style=color:#960050;background-color:#1e0010>个元素新的设定值，从</span><span style=color:#ae81ff>0</span><span style=color:#960050;background-color:#1e0010>开始计数</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;含列表的设定项/@last&#34;</span>: <span style=color:#960050;background-color:#1e0010>列表最后一个元素新的设定值</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;含列表的设定项/@before 0&#34;</span>: <span style=color:#960050;background-color:#1e0010>在列表第一个元素之前插入新的设定值（不建议在补丁中使用）</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;含列表的设定项/@after last&#34;</span>: <span style=color:#960050;background-color:#1e0010>在列表</span>  <span style=color:#e6db74>&#34;一级设定项/二级设定项/三级设定项&#34;</span>: <span style=color:#960050;background-color:#1e0010>新的设定值最后一个元素之后插入新的设定值（不建议在补丁中使用）</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;含列表的设定项/@next&#34;</span>: <span style=color:#960050;background-color:#1e0010>在列表最后一个元素之后插入新的设定值（不建议在补丁中使用）</span>
</span></span></code></pre></div><p>就是这样：<code>patch</code> 定义了一组「补丁」，以源文件中的设定为基础，写入新的设定项、或以新的设定值取代现有设定项的值。</p><p>每次修改配置文件，你需要重新部署来生效。</p><p><strong>重新部署的操作方法</strong></p><ul><li><p>点击输入法的程序指示器，选择「部署」</p></li><li><p>点击输入法状态栏上的 ⟲ (Deploy) 按钮。如果找不到状态栏，在终端输入以下命令，可触发自动部署：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># ibus</span>
</span></span><span style=display:flex><span>$ rm ~/.config/ibus/rime/default.yaml; ibus-daemon -drx
</span></span></code></pre></div></li></ul><h5 id=定制每页候选数>定制每页候选数<a hidden class=anchor aria-hidden=true href=#定制每页候选数>#</a></h5><p>Rime 中，默认每页至多显示 5 个候选项，而允许的范围是 1〜9（个别 Rime 发行版可支持 10 个候选）。</p><p>设定每页候选个数的默认值为 9，在用户目录建立定制文档 ：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi ~/.config/ibus/rime/default.custom.yaml
</span></span><span style=display:flex><span>patch:
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;menu/page_size&#34;</span>: <span style=color:#ae81ff>9</span>
</span></span></code></pre></div><p>重新部署即可生效。</p><p><strong>注意！</strong> 如果 default.custom.yaml 里面已经有其他设定内容，只要以相同的缩进方式添加 <code>patch:</code> 以下的部分，不可重复 <code>patch:</code> 这一行。</p><h5 id=定制方案选单>定制方案选单<a hidden class=anchor aria-hidden=true href=#定制方案选单>#</a></h5><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi ~/.config/ibus/rime/default.custom.yaml
</span></span><span style=display:flex><span>patch:
</span></span><span style=display:flex><span><span style=color:#75715e># 對於列表類型，現在無有辦法指定如何添加、消除或單一修改某項，於是要在定製檔中將整個列表替換！</span>
</span></span><span style=display:flex><span>  schema_list:  
</span></span><span style=display:flex><span>    - schema: luna_pinyin
</span></span><span style=display:flex><span>    - schema: cangjie5
</span></span><span style=display:flex><span>    - schema: luna_pinyin_fluency
</span></span><span style=display:flex><span>    - schema: luna_pinyin_simp
</span></span><span style=display:flex><span>    <span style=color:#75715e># 這樣就啓用了未曾有過的高級輸入方案！其實這麼好的方案應該排在最前面哈。</span>
</span></span><span style=display:flex><span>    - schema: my_coolest_ever_schema  
</span></span></code></pre></div><p>调整方案候选顺序，增加输入法方案，或者通过 <code>#</code> 注释内容将不用的方案移除候选菜单。</p><p>重新部署生效。</p><h5 id=定制字体字号>定制字体字号<a hidden class=anchor aria-hidden=true href=#定制字体字号>#</a></h5><p>GNOME 桌面可以使用扩展 <strong><a href=https://extensions.gnome.org/extension/2820/ibus-tweaker/>IBus Tweaker</a></strong>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi ~/.config/fcitx/rime/default.custom.yaml
</span></span><span style=display:flex><span>patch:
</span></span><span style=display:flex><span>  <span style=color:#75715e># 字體名稱，從記事本等處的系統字體對話框裏能看到</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;style/font_face&#34;</span>: <span style=color:#e6db74>&#34;明兰&#34;</span>  
</span></span><span style=display:flex><span>  <span style=color:#75715e># 字號，只認數字的，不認「五號」、「小五」這樣的</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;style/font_point&#34;</span>: <span style=color:#ae81ff>16</span>     
</span></span></code></pre></div><h5 id=横排与竖排候选码httpsgithubcomrimehomewikicustomizationguidee5b08fe78bbce6afabe5a496e8a780e8a8ade5ae9a><a href=https://github.com/rime/home/wiki/CustomizationGuide#%E5%B0%8F%E7%8B%BC%E6%AF%AB%E5%A4%96%E8%A7%80%E8%A8%AD%E5%AE%9A>横排与竖排候选码</a><a hidden class=anchor aria-hidden=true href=#横排与竖排候选码httpsgithubcomrimehomewikicustomizationguidee5b08fe78bbce6afabe5a496e8a780e8a8ade5ae9a>#</a></h5><p>在<code>ibus_rime.custom.yaml</code>添加如下内容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>patch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>style/horizontal</span>: <span style=color:#66d9ef>true</span>
</span></span></code></pre></div><h5 id=定制皮肤httpsjdhaogithubio20190218rime_configuration_intro><a href=https://jdhao.github.io/2019/02/18/rime_configuration_intro/>定制皮肤</a><a hidden class=anchor aria-hidden=true href=#定制皮肤httpsjdhaogithubio20190218rime_configuration_intro>#</a></h5><p><a href=https://github.com/rime/home/wiki/CustomizationGuide#%E9%BC%A0%E9%AC%9A%E7%AE%A1%E5%A4%96%E8%A7%80%E8%88%87%E9%8D%B5%E7%9B%A4%E8%A8%AD%E5%AE%9A>注</a>：ibus用户 <code>ibus_rime.custom.yaml</code> 不包含控制配色、字體字號等外觀樣式的設定項。</p><p><img loading=lazy src=/Distributions/EG9rFyi.jpg alt></p><p>Rime 中，输入法的显示效果称为「颜色主题」(color scheme)。在网上看到一个有趣的主题，如何添加到 Rime 中使用呢？假如我们要加入<a href=https://zhuanlan.zhihu.com/p/28516904>这里</a>提供的「丹青」主题，在系统 custom 设置文件中加入以下配置即可：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># 在配色方案列表裏加入標識爲 tantsing 的新方案</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;preset_color_schemes/tantsing&#34;: </span> 
</span></span><span style=display:flex><span>    <span style=color:#f92672>author</span>: <span style=color:#ae81ff>Mijiag</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>back_color</span>: <span style=color:#ae81ff>0xE3E3E3</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>border_color</span>: <span style=color:#ae81ff>0x000000</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>candidate_text_color</span>: <span style=color:#ae81ff>0x000000</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>comment_text_color</span>: <span style=color:#ae81ff>0x474747</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>hilited_back_color</span>: <span style=color:#ae81ff>0x1A0791</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>hilited_candidate_back_color</span>: <span style=color:#ae81ff>0x6F0B73</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>hilited_candidate_text_color</span>: <span style=color:#ae81ff>0xE3E3E3</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>hilited_text_color</span>: <span style=color:#ae81ff>0xE3E3E3</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>name</span>: <span style=color:#e6db74>&#34;丹青/Tantsing&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>text_color</span>: <span style=color:#ae81ff>0x000000</span>
</span></span></code></pre></div><p>引用该主题的时候，使用名字 <code>tantsing</code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># squirrel.custom.yaml</span>
</span></span><span style=display:flex><span><span style=color:#f92672>patch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>style</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>color_scheme</span>: <span style=color:#ae81ff>tantsing</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>horizontal</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>inline_preedit</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>font_point</span>: <span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>corner_radius</span>: <span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>candidate_format</span>: <span style=color:#e6db74>&#34;%c\u2005%@ \u2005&#34;</span>
</span></span></code></pre></div><p>如果要自己制作 Rime 主题，<a href=https://gjrobert.github.io/Rime-See-Me-squirrel/>「Rime 西米」</a>是一款网页端工具，可以辅助制作，实时渲染颜色，便于查看最终显示效果。<a href=https://github.com/rime-aca/color_schemes>这里</a>有一些预定义的主题可供使用。</p><h5 id=输入符号>输入符号<a hidden class=anchor aria-hidden=true href=#输入符号>#</a></h5><p>符号文件 <code>/usr/share/rime-data/symbols.yaml</code> 开头已经说明了使用方法：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># Usage: patch your Rime schema to enable /X symbols:</span>
</span></span><span style=display:flex><span><span style=color:#75715e># patch:</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   punctuator/import_preset: symbols</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   recognizer/patterns/punct: &#39;^/([0-9]0?|[A-Za-z]+)$&#39;</span>
</span></span></code></pre></div><p>想在朙月拼音·简化字 <code>luna_pinyin_simp</code> 方案下输入符号，就新建 <code>luna_pinyin_simp.custom.yaml</code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>patch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>punctuator/import_preset</span>: <span style=color:#ae81ff>symbols</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>recognizer/patterns/punct</span>: <span style=color:#e6db74>&#39;^/([0-9]0?|[A-Za-z]+)$&#39;</span>
</span></span></code></pre></div><p>重新部署生效。</p><p>输入符号请键入识别码：</p><ul><li>星号 <code>/xh</code></li><li>箭头 <code>/jt</code></li><li>數字 <code>/1</code></li><li>更多符号参阅文件 <code>symbols.yaml</code>。</li></ul><p>其他方案下输入符号，照葫芦画瓢。</p><h5 id=符号自定义>符号自定义<a hidden class=anchor aria-hidden=true href=#符号自定义>#</a></h5><p>拷贝 <code>/usr/share/rime-data/symbols.yaml</code> 为 <code>~/.config/ibus/rime/symbols.custom.yaml</code>。在末尾添加自定义符号：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-perl data-lang=perl><span style=display:flex><span><span style=color:#75715e># 个人常用信息</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;/yx&#39;</span>: [ xiaoming@gmail<span style=color:#f92672>.</span>com, xiaoming@163<span style=color:#f92672>.</span>com, <span style=color:#ae81ff>1234567910</span> ] 
</span></span><span style=display:flex><span><span style=color:#75715e># 快速输入勾和叉 </span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;/gc&#39;</span>: [ <span style=color:#960050;background-color:#1e0010>✓</span>, <span style=color:#960050;background-color:#1e0010>☑</span>, <span style=color:#960050;background-color:#1e0010>✗</span>, <span style=color:#960050;background-color:#1e0010>☒</span> ]
</span></span></code></pre></div><p>想在朙月拼音·简化字 <code>luna_pinyin_simp</code> 方案下输入符号，就修改 <code>luna_pinyin_simp.custom.yaml</code> 文件内容为：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>patch:
</span></span><span style=display:flex><span>  punctuator/import_preset: symbols.custom
</span></span><span style=display:flex><span>  recognizer/patterns/punct: <span style=color:#e6db74>&#39;^/([0-9]0?|[A-Za-z]+)$&#39;</span>
</span></span></code></pre></div><p>重新部署生效。</p><p>然后在中文模式下，输入 <code>/gc</code>，就会显示出自定义的符号，输入对应的数字，符号就会上屏。</p><h5 id=输入直角引号>输入直角引号<a hidden class=anchor aria-hidden=true href=#输入直角引号>#</a></h5><p>有的人喜欢在写作的时候使用直角引号：<code>「」</code>和<code>『』</code>，Rime 在 <code>symbols.yaml</code> 里面，已经提供了这个功能，不过是在 <code>[</code> 和 <code>]</code> 按键上提供的，中文输入法状态下，按下<code>[</code> (<code>]</code>)，返回的结果中包含 <code>「</code> (<code>」</code>)，如果按住 Shift 键，按下 <code>[</code> (<code>]</code>)，返回的结果中包含 <code>『</code> (<code>』</code>)。</p><p>但是因为这毕竟是引号，最好是按下引号的时候，能够输出直角引号，在<code>symbols.custom.yaml</code> 中，找到 <code>punctuator</code> 部分下的 <code>hafl_shape</code> (半角的意思)下面，把下面的映射</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;&#39;</span> : <span style=color:#f92672>{</span> pair: <span style=color:#f92672>[</span> <span style=color:#e6db74>&#39;‘&#39;</span>, <span style=color:#e6db74>&#39;’&#39;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#34;&#39;</span> : <span style=color:#f92672>{</span> pair: <span style=color:#f92672>[</span> <span style=color:#e6db74>&#39;“&#39;</span>, <span style=color:#e6db74>&#39;”&#39;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>}</span>
</span></span></code></pre></div><p>改成</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#e6db74>&#39;&#39;&#39;&#39;</span> : <span style=color:#f92672>{</span> pair: <span style=color:#f92672>[</span> <span style=color:#e6db74>&#39;『&#39;</span>, <span style=color:#e6db74>&#39;』&#39;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#39;&#34;&#39;</span> : <span style=color:#f92672>{</span> pair: <span style=color:#f92672>[</span> <span style=color:#e6db74>&#39;「&#39;</span>, <span style=color:#e6db74>&#39;」&#39;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>}</span>
</span></span></code></pre></div><p>这样就可以直接输入直角引号了，另外一种方式就是在词典中添加直角引号映射，在<code>jdhao.dict.yaml</code> 中加入下面的映射即可：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>「」	syh	<span style=color:#ae81ff>1000</span>
</span></span><span style=display:flex><span>『』	dyh	<span style=color:#ae81ff>1000</span>
</span></span></code></pre></div><h5 id=扩展词库httpswikiarchlinuxorgtitlefcitx5_e7ae80e4bd93e4b8ade69687e5afbce585a5e8af8de5ba93><a href=https://wiki.archlinux.org/title/Fcitx5_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)#%E5%AF%BC%E5%85%A5%E8%AF%8D%E5%BA%93>扩展词库</a><a hidden class=anchor aria-hidden=true href=#扩展词库httpswikiarchlinuxorgtitlefcitx5_e7ae80e4bd93e4b8ade69687e5afbce585a5e8af8de5ba93>#</a></h5><p><a href=https://github.com/rime-aca/dictionaries>下载Rime 擴充詞庫</a>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>luna_pinyin<span style=color:#f92672>.</span>hanyu<span style=color:#f92672>.</span>dict<span style=color:#f92672>.</span>yaml
</span></span><span style=display:flex><span>luna_pinyin<span style=color:#f92672>.</span>cn_en<span style=color:#f92672>.</span>dict<span style=color:#f92672>.</span>yaml
</span></span><span style=display:flex><span>luna_pinyin<span style=color:#f92672>.</span>extended<span style=color:#f92672>.</span>dict<span style=color:#f92672>.</span>yaml
</span></span><span style=display:flex><span>luna_pinyin<span style=color:#f92672>.</span>poetry<span style=color:#f92672>.</span>dict<span style=color:#f92672>.</span>yaml
</span></span></code></pre></div><p>接着将四个文件移动到用户资料夹 <code>~/.config/ibus/rime</code> 下。</p><p>新增一個自訂的 <code>luna_pinyin_simp.extended.dict.yaml</code> 檔案：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># 以下禁用了默认词库同时不启用默认的“八股文”词库及词频系统,如果您不希望候选词中的出现繁体字、方框字的话</span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>luna_pinyin_simp.extended</span>
</span></span><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#34;2022.08.21&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>sort</span>: <span style=color:#ae81ff>by_weight</span>
</span></span><span style=display:flex><span><span style=color:#f92672>use_preset_vocabulary</span>: <span style=color:#66d9ef>false</span> <span style=color:#75715e>#是否启用默认的“八股文”词库及词频系统,如需启用请设为 true </span>
</span></span><span style=display:flex><span><span style=color:#f92672>import_tables</span>: <span style=color:#75715e>#在此导入词库</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#- luna_pinyin</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>luna_pinyin.hanyu</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>lluna_pinyin.cn_en</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>luna_pinyin.extended</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>luna_pinyin.poetry</span>
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>接着再於 <code>luna_pinyin_simp.custom.yaml</code> 中將 <code>translator/dictionary</code> 設置成此字典檔即可</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>patch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>translator/dictionary</span>: <span style=color:#ae81ff>luna_pinyin_simp.extended</span> <span style=color:#75715e># 词典名字可自定义，保持一致即可</span>
</span></span></code></pre></div><p>重新部署生效。</p><p>其他扩展词库：</p><ul><li><p><a href=https://github.com/ssnhd/rime>ssnhd/rime</a> 1.5k（🗸）</p><p><img loading=lazy src=/Distributions3B0Aucj.png alt></p></li><li><p><a href=https://github.com/wongdean/rime-settings>wongdean/rime-settings</a> 1.3k</p></li><li><p><a href=fkxxyz/rime-cloverpinyin>fkxxyz/rime-cloverpinyin</a> 1.1k（用过）</p></li><li><p><a href=thunlp/THUOCL>thunlp/THUOCL</a> 610</p></li><li><p><a href=ayaka14732/awesome-rime>ayaka14732/awesome-rime</a> 383</p></li><li><p><a href=https://github.com/LoganJC/rime-dict>LoganJC/rime-dict</a> 289</p></li><li><p><a href=https://github.com/xiaoTaoist/rime-dict>xiaoTaoist/rime-dict</a> 226（用过）</p></li><li><p><a href=https://github.com/yangshann/rime-dict>yangshann/rime-dict</a> 48（用过）</p></li></ul><h5 id=增加自己的词库>增加自己的词库<a hidden class=anchor aria-hidden=true href=#增加自己的词库>#</a></h5><p>我们可以仿照上一步的词典文件建立自己额外的词典，增加自己的词汇。例如，建立名为 <code>my.dict.yaml</code> 的文件，然后参照 <code>luna_pinyin_simp.cn_en.dict.yaml</code> 添加几个自己常用的词汇，文件内容如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e># my.dict.yaml 文件内容</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Rime dictionary</span>
</span></span><span style=display:flex><span><span style=color:#75715e># encoding: utf-8</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>---
</span></span><span style=display:flex><span><span style=color:#f92672>name</span>: <span style=color:#ae81ff>my</span>
</span></span><span style=display:flex><span><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#34;2020.05.28&#34;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>sort</span>: <span style=color:#ae81ff>by_weight</span>
</span></span><span style=display:flex><span><span style=color:#f92672>use_preset_vocabulary</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>GitHub	github	100</span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>Stack Overflow	so	1000</span>
</span></span></code></pre></div><p>词典的格式为: <code>词汇&lt;Tab>编码&lt;Tab>词频</code>，各个项目之间<strong>必须用 Tab（也就是制表符 ）分割</strong>。一个最保险的方法就是，复制粘贴。词频部分可以不要。</p><p>然后在 <code>luna_pinyin_simp.extended.dict.yaml</code> 的 <code>import_tables</code> 中加上自己建立的词汇。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>import_tables</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>my</span>
</span></span></code></pre></div><p>一切添加妥当之后，重新部署生效。</p><h5 id=默认英文>默认英文<a hidden class=anchor aria-hidden=true href=#默认英文>#</a></h5><p>如果经常和英语打交道，偶尔输入汉字，可以把朙月拼音初始状态设为英语，需要时再切回中文。参考 <a href=https://github.com/rime/home/wiki/CustomizationGuide#%E4%B8%80%E4%BE%8B%E9%BB%98%E8%AA%8D%E8%8B%B1%E6%96%87%E8%BC%B8%E5%87%BA>这里</a> 给出的说明，在 <code>luna_pinyin_simp.custom.yaml</code> 文件中加入下面的设置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-YAML data-lang=YAML><span style=display:flex><span><span style=color:#f92672>patch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>&#34;switches/@0/reset&#34;: </span><span style=color:#ae81ff>1</span>  <span style=color:#75715e># 初始的 ascii mode 设置为「西文」</span>
</span></span></code></pre></div><p>意思就是將 switcher 列表中的第一個元素（即 ascii_mode 開關）的初始值重設爲狀態1（即「英文」）。</p><h5 id=模糊拼音>模糊拼音<a hidden class=anchor aria-hidden=true href=#模糊拼音>#</a></h5><p>这里是官方给的一个<a href=https://gist.github.com/lotem/2320943>模板</a> （朙月拼音）。将模板剪贴进 <code>~/.config/ibus/rime/luna_pinyin_simp.custom.yaml</code> 文件中，然后需要哪组就去掉那一行前面的 <code>#</code> 即可。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-powershell data-lang=powershell><span style=display:flex><span><span style=color:#75715e># luna_pinyin.custom.yaml</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 【朙月拼音】模糊音定製模板</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#   佛振配製 :-)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 位置：</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ~/.config/ibus/rime  (Linux)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ~/Library/Rime  (Mac OS)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># %APPDATA%\Rime  (Windows)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 於重新部署後生效</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>patch<span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#39;speller/algebra&#39;</span><span style=color:#960050;background-color:#1e0010>:</span>
</span></span><span style=display:flex><span>    - erase/^xx$/                      <span style=color:#75715e># 第一行保留</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 模糊音定義</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 需要哪組就刪去行首的 # 號，單雙向任選</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^([zcs])h/$1/             # zh, ch, sh =&gt; z, c, s</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^([zcs])([^h])/$1h$2/     # z, c, s =&gt; zh, ch, sh</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^n/l/                     # n =&gt; l</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^l/n/                     # l =&gt; n</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 這兩組一般是單向的</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^r/l/                     # r =&gt; l</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^ren/yin/                 # ren =&gt; yin, reng =&gt; ying</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^r/y/                     # r =&gt; y</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 下面 hu &lt;=&gt; f 這組寫法複雜一些，分情況討論</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^hu$/fu/                  # hu =&gt; fu</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^hong$/feng/              # hong =&gt; feng</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^hu([in])$/fe$1/          # hui =&gt; fei, hun =&gt; fen</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^hu([ao])/f$1/            # hua =&gt; fa, ...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^fu$/hu/                  # fu =&gt; hu</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^feng$/hong/              # feng =&gt; hong</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^fe([in])$/hu$1/          # fei =&gt; hui, fen =&gt; hun</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^f([ao])/hu$1/            # fa =&gt; hua, ...</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 韻母部份</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^([bpmf])eng$/$1ong/      # meng = mong, ...</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/([ei])n$/$1ng/            # en =&gt; eng, in =&gt; ing</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/([ei])ng$/$1n/            # eng =&gt; en, ing =&gt; in</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 樣例足夠了，其他請自己總結……</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 反模糊音？</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 誰說方言沒有普通話精確、有模糊音，就能有反模糊音。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 示例爲分尖團的中原官話：</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^ji$/zii/   # 在設計者安排下鳩佔鵲巢，尖音i只好雙寫了</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^qi$/cii/</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^xi$/sii/</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^ji/zi/</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^qi/ci/</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^xi/si/</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^ju/zv/</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^qu/cv/</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^xu/sv/</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 韻母部份，只能從大面上覆蓋</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^([bpm])o$/$1eh/          # bo =&gt; beh, ...</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/(^|[dtnlgkhzcs]h?)e$/$1eh/  # ge =&gt; geh, se =&gt; sheh, ...</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^([gkh])uo$/$1ue/         # guo =&gt; gue, ...</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^([gkh])e$/$1uo/          # he =&gt; huo, ...</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/([uv])e$/$1o/             # jue =&gt; juo, lve =&gt; lvo, ...</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^fei$/fi/                 # fei =&gt; fi</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^wei$/vi/                 # wei =&gt; vi</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^([nl])ei$/$1ui/          # nei =&gt; nui, lei =&gt; lui</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^([nlzcs])un$/$1vn/       # lun =&gt; lvn, zun =&gt; zvn, ... </span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>#- derive/^([nlzcs])ong$/$1iong/    # long =&gt; liong, song =&gt; siong, ...</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 這個辦法雖從拼寫上做出了區分，然而受詞典制約，候選字仍是混的。</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 只有真正的方音輸入方案纔能做到！但「反模糊音」這個玩法快速而有效！</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 模糊音定義先於簡拼定義，方可令簡拼支持以上模糊音</span>
</span></span><span style=display:flex><span>    - abbrev/^([a-z]).+$/$1/           <span style=color:#75715e># 簡拼（首字母）</span>
</span></span><span style=display:flex><span>    - abbrev/^([<span style=color:#66d9ef>zcs</span>]h).+$/$1/          <span style=color:#75715e># 簡拼（zh, ch, sh）</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 以下是一組容錯拼寫，《漢語拼音》方案以前者爲正</span>
</span></span><span style=display:flex><span>    - derive/^([<span style=color:#66d9ef>nl</span>])ve$/$1ue/          <span style=color:#75715e># nve = nue, lve = lue</span>
</span></span><span style=display:flex><span>    - derive/^([<span style=color:#66d9ef>jqxy</span>])u/$1v/           <span style=color:#75715e># ju = jv,</span>
</span></span><span style=display:flex><span>    - derive/un$/uen/                  <span style=color:#75715e># gun = guen,</span>
</span></span><span style=display:flex><span>    - derive/ui$/uei/                  <span style=color:#75715e># gui = guei,</span>
</span></span><span style=display:flex><span>    - derive/iu$/iou/                  <span style=color:#75715e># jiu = jiou,</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#75715e># 自動糾正一些常見的按鍵錯誤</span>
</span></span><span style=display:flex><span>    - derive/([<span style=color:#66d9ef>aeiou</span>])ng$/$1gn/        <span style=color:#75715e># dagn =&gt; dang </span>
</span></span><span style=display:flex><span>    - derive/([<span style=color:#66d9ef>dtngkhrzcs</span>])o(u|ng)$/$1o/  <span style=color:#75715e># zho =&gt; zhong|zhou</span>
</span></span><span style=display:flex><span>    - derive/ong$/on/                  <span style=color:#75715e># zhonguo =&gt; zhong guo</span>
</span></span><span style=display:flex><span>    - derive/ao$/oa/                   <span style=color:#75715e># hoa =&gt; hao</span>
</span></span><span style=display:flex><span>    - derive/([<span style=color:#66d9ef>iu</span>])a(o|ng?)$/a$1$2/    <span style=color:#75715e># tain =&gt; tian</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># 分尖團後 v =&gt; ü 的改寫條件也要相應地擴充：</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#&#39;translator/preedit_format&#39;:</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>#  - &#34;xform/([nljqxyzcs])v/$1ü/&#34;</span>
</span></span></code></pre></div><h5 id=同步用户资料>同步用户资料<a hidden class=anchor aria-hidden=true href=#同步用户资料>#</a></h5><p>默认地，词典快照备份到 <code>~/.config/ibus/rime/sync/UUID</code> 这个地方。我们可以设定同步的目标文件夹，直接编辑 <code>~/.config/ibus/rime/installation.yaml</code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-vbnet data-lang=vbnet><span style=display:flex><span>sync_dir: <span style=color:#75715e>&#39;/DATA/Backup/RimeSync&#39;
</span></span></span></code></pre></div><p>然后，点击输入法程序指示器选择「同步」。你的 <strong>用户配置</strong>、<strong>用户词库</strong> 等都会被放在目标文件夹。</p><blockquote><p><strong>注意</strong>！可能有些你自己添加的文件不会被备份，注意下就行。</p></blockquote><p>我们可以借助移动存储设备，或在线存储服务如百度网盘、坚果云等，在多台电脑及不同系统之间同步用户词典和用户设定。在新电脑上配置一下 <code>installation.yaml</code> 文件，执行 <strong>部署</strong> -> <strong>同步</strong> -> <strong>部署</strong> ，你的 <strong>用户配置</strong>、<strong>用户词库</strong> 都回来了。</p><h5 id=新世纪五笔>新世纪五笔<a hidden class=anchor aria-hidden=true href=#新世纪五笔>#</a></h5><p>参阅 <a href=https://github.com/GuoBinyong/wubixinshiji>https://github.com/GuoBinyong/wubixinshiji</a>。<a href=https://blog.csdn.net/fonaix/article/details/102405204>Rime输入法之五笔自动上屏</a>。</p><p>后续配置来自视频 <a href="https://www.bilibili.com/video/BV1jE411u7FE?from=search&amp;seid=12079970368693355374">rime 中的小狼毫输入法的安装和基础自定义</a> 所分享的文件： <a href=https://www.lanzous.com/ia2g86h>https://www.lanzous.com/ia2g86h</a>。</p><h5 id=easy-english>Easy english<a hidden class=anchor aria-hidden=true href=#easy-english>#</a></h5><p>用于输入英文。拷贝下面两个文件到「用户资料夹」：</p><ul><li>easy_en.schema.yaml</li><li>easy_en.dict.yaml</li></ul><p><code>vim default.custom.yaml</code> 添加输入方案：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  <span style=color:#f92672>schema_list</span>:
</span></span><span style=display:flex><span>    - <span style=color:#f92672>schema</span>: <span style=color:#ae81ff>wubixinshiji   </span> <span style=color:#75715e># 新世纪五笔</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>schema</span>: <span style=color:#ae81ff>wubixinshiji_pinyin   </span> <span style=color:#75715e># 新世纪五笔·拼音</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>schema</span>: <span style=color:#ae81ff>luna_pinyin_simp   </span> <span style=color:#75715e># 朙月拼音·简化字</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>schema</span>: <span style=color:#ae81ff>easy_en</span>
</span></span><span style=display:flex><span>    - <span style=color:#f92672>schema</span>: <span style=color:#ae81ff>pinyin_simp   </span> <span style=color:#75715e># 袖珍简化字拼音</span>
</span></span></code></pre></div><h5 id=输入日期>输入日期<a hidden class=anchor aria-hidden=true href=#输入日期>#</a></h5><p>将文件 <code>rime.lua</code> 拷贝到 <code>~/.config/ibus/rime/</code> 下，在方案配置文件比如 <code>wubi86.schema.yaml</code> 的 <code>engine\translators:</code> 下面添加滤镜引用：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>  translators<span style=color:#f92672>:</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span> lua_translator<span style=color:#a6e22e>@date_translator</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>-</span> lua_translator<span style=color:#a6e22e>@week_translator</span>
</span></span></code></pre></div><h5 id=rime-emojihttpsgithubcomrimerime-emoji><a href=https://github.com/rime/rime-emoji>rime-emoji</a><a hidden class=anchor aria-hidden=true href=#rime-emojihttpsgithubcomrimerime-emoji>#</a></h5><ol><li>下載<code>opencc</code>檔案夾內容，將完整檔案夾放入Rime用戶檔案夾內</li><li>將<code>emoji_suggestion.yaml</code>內的內容加入至想添加Emoji的方案custom檔中</li></ol><p>我安装后，没有显示emoji，所以还是用 <code>gnome-characters</code> 好了。</p><h5 id=切换中英文httpszhuanlanzhihucomp91129641><a href=https://zhuanlan.zhihu.com/p/91129641>切换中英文</a><a hidden class=anchor aria-hidden=true href=#切换中英文httpszhuanlanzhihucomp91129641>#</a></h5><p>切换中英文，rime在默认情况下，输入中文时按shift键会切换为英文，但字符还在，需要按回车输出字符，有的用户可能不习惯shift这个键位，或者不习惯按shift不直接上屏，还要按一下回车，对此，我们可以做出修改 <code>default.custom.yaml</code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>patch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ascii_composer/good_old_caps_lock</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ascii_composer/switch_key</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>Caps_Lock</span>: <span style=color:#ae81ff>clear</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>Shift_L</span>: <span style=color:#ae81ff>commit_code</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>Shift_R</span>: <span style=color:#ae81ff>inline_ascii</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>Control_L</span>: <span style=color:#ae81ff>noop</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>Control_R</span>: <span style=color:#ae81ff>noop</span>
</span></span></code></pre></div><p><strong>注意换行前空格以及冒号后的空格，还有字母大小写</strong>，前两行代码先不看，下面五行分别代表：</p><ul><li>caps_lock即为大写键，shift_L即为左shift，R是右，control_L即为左ctrl键，R为右</li><li>冒号后的字符即为这个键位的操作<ul><li>clear表示按下此键后已输入的字符清除，同时rime输入状态切换为英文，大写键一定不能改为noop，否则大写英文将会无法输出，很多教程里都改为了noop，这点值得注意</li><li>commit_code即为提交代码，就是将已输入的字符上屏，同时输入法切换为英文</li><li>inline_ascii即为插入字符，就是已输入的字符为上屏前，按此键后输入法转为英文，可以接着输入，回车键再上屏</li><li>noop就是这个键在输入法里不会有任何操作</li></ul></li></ul><p>各个键位和代码的意思已经介绍完了，可以按自己的喜好，自行修改。</p><p>不过仍有部分用户从win7开始是用的ctrl键+空格键切换中英文，且习惯输入法为默认英文。RIME的快捷键是在“default.yaml”文档中定义的，我们可以将“default.yaml”文档中相关代码直接复制过来，接上面代码：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>key_binder</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>bindings</span>:
</span></span><span style=display:flex><span>    - {<span style=color:#f92672>accept</span>: <span style=color:#e6db74>&#34;Control+Shift+2&#34;</span><span style=color:#f92672>, toggle: ascii_mode, when</span>: <span style=color:#ae81ff>always}</span>
</span></span></code></pre></div><p>注意到<code>ascii_mode了</code>吗，“字符模式”即为我们需要的中英文切换快捷键，默认快捷键为<code>ctrl+shift+2</code>，我们可以将其代码修改为<code>Control+space</code>即为<code>ctrl+空格</code>，注意大小写，这样我们就能让输入法默认英文同时用回习惯的操作</p><p>至此，关于<code>default.custom.yaml</code>的设置基本完成，样例如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>patch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>ascii_composer/good_old_caps_lock</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>ascii_composer/switch_key</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>Caps_Lock</span>: <span style=color:#ae81ff>clear</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>Shift_L</span>: <span style=color:#ae81ff>noop</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>Shift_R</span>: <span style=color:#ae81ff>noop</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>Control_L</span>: <span style=color:#ae81ff>noop</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>Control_R</span>: <span style=color:#ae81ff>noop</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>key_binder/bindings</span>:
</span></span><span style=display:flex><span>    - { <span style=color:#f92672>when: always, accept: Control+space, toggle</span>: <span style=color:#ae81ff>ascii_mode }</span>
</span></span><span style=display:flex><span>    - { <span style=color:#f92672>when: has_menu, accept: minus, send</span>: <span style=color:#ae81ff>Page_Up }</span>
</span></span><span style=display:flex><span>    - { <span style=color:#f92672>when: has_menu, accept: equal, send</span>: <span style=color:#ae81ff>Page_Down }</span>
</span></span></code></pre></div><p>注意：如果没有Page_Up，Page_Down两行，就没办法用 + 与 - 进行翻页了。</p><h5 id=清空候选词>清空候选词<a hidden class=anchor aria-hidden=true href=#清空候选词>#</a></h5><p>我使用ibus-rime，有一个很大的缺点是如果输入没有完成的情况下，移动鼠标，其他的输入法未完成的内容都会被清空，而只有rime不会，而且会重复输出未完成的内容，这点很烦人，也不知道哪里能够设置。</p><p><img loading=lazy src=/Distributions/rime-empty.gif alt></p><ol><li><p>定制快捷键</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>patch</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>key_binder/bindings</span>:
</span></span><span style=display:flex><span>    - { <span style=color:#f92672>when: composing, accept: Control+g, send</span>: <span style=color:#ae81ff>Escape }</span>
</span></span></code></pre></div></li><li><p>使用 Sitch input sources individually for each window</p></li></ol><h2 id=wallpapers>Wallpapers<a hidden class=anchor aria-hidden=true href=#wallpapers>#</a></h2><h3 id=gnome-backgroundhttpssamwhelpgithubionote-about-ubuntureadsubjectwallpaperhtml><a href=https://samwhelp.github.io/note-about-ubuntu/read/subject/wallpaper.html>Gnome Background</a><a hidden class=anchor aria-hidden=true href=#gnome-backgroundhttpssamwhelpgithubionote-about-ubuntureadsubjectwallpaperhtml>#</a></h3><p><strong>圖形使用者介面程式</strong></p><p>可以透過「圖形使用者介面程式」，來更改「桌面圖片」。在桌面，按下「滑鼠右鍵」，就會出現一個選單，選擇「Change Background…」。就會出現設定更改「桌面圖片」的操作介面。</p><p>也就是「Settings / Background」。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gnome-control-center background
</span></span></code></pre></div><p><strong>指令操作</strong></p><p>也可以透過「<a href=https://manpages.ubuntu.com/manpages/jammy/en/man1/gsettings.1.html>gsettings</a>」這個指令，來更改「桌面圖片」。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gsettings set org.gnome.desktop.background picture-uri <span style=color:#e6db74>&#39;file:///usr/share/backgrounds/Blue_flower_by_Elena_Stravoravdi.jpg&#39;</span>
</span></span></code></pre></div><p>在測試的過程中發現，若使用「暗色系」的「佈景主題」，則要執行下面指令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gsettings set org.gnome.desktop.background picture-uri-dark <span style=color:#e6db74>&#39;file:///usr/share/backgrounds/Blue_flower_by_Elena_Stravoravdi.jpg&#39;</span>
</span></span></code></pre></div><p><strong>小技巧</strong></p><p>切換顯示桌面的按鍵組合是「<code>Win + d</code>」。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gsettings get org.gnome.desktop.wm.keybindings show-desktop
</span></span><span style=display:flex><span><span style=color:#f92672>[</span><span style=color:#e6db74>&#39;&lt;Primary&gt;&lt;Super&gt;d&#39;</span>, <span style=color:#e6db74>&#39;&lt;Primary&gt;&lt;Alt&gt;d&#39;</span>, <span style=color:#e6db74>&#39;&lt;Super&gt;d&#39;</span><span style=color:#f92672>]</span>
</span></span></code></pre></div><h3 id=apps>Apps<a hidden class=anchor aria-hidden=true href=#apps>#</a></h3><ul><li>Shotwell：在侧边栏 Photos 中 Ctrl + A，在菜单栏 File 中选择 Set as Desktop SlideShow&mldr;；这会把图片复制到 <code>.local/share/shotwell/wallpaper</code>，并在该目录生成 wallpaper.xml，wallpaper.xml 定义自动切换壁纸动画。</li><li>替代软件：BingWall 等。</li><li>脚本分享：<a href=https://github.com/thevinter/styli.sh>styli.sh</a>、<a href=https://github.com/LittleSimpleWallpaperChanger/lswc>lswc</a>、<a href=https://github.com/fosskers/rs-setwall>setwall</a></li><li>动态壁纸：<a href=https://github.com/cheesecakeufo/komorebi>komorebi</a>、<a href=https://launchpad.net/livewallpaper>LiveWallpaper</a>、<a href=https://github.com/WuSiYu/PlasmaVideoWallpaper>PlasmaVideoWallpaper</a>&<a href=https://github.com/halverneus/org.kde.video>org.kde.video</a>、<a href=https://github.com/adi1090x/dynamic-wallpaper>dynamic-wallpaper</a>&<a href=https://github.com/dylanaraps/pywal>pywal</a>、<a href=https://github.com/zzag/plasma5-wallpapers-dynamic>plasma5-wallpapers-dynamic</a>(Solar Dynamic Wallpaper)</li></ul><h3 id=varietyhttpsgithubcomvarietywallsvariety><a href=https://github.com/varietywalls/variety>Variety</a><a hidden class=anchor aria-hidden=true href=#varietyhttpsgithubcomvarietywallsvariety>#</a></h3><p>默认仓库版本可能较低，导致一些 Bug，因此最好用 PPA</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo add-apt-repository ppa:variety/stable
</span></span><span style=display:flex><span>$ sudo apt update
</span></span><span style=display:flex><span>$ sudo apt install variety -y
</span></span></code></pre></div><p>支持 wallhaven，添加 keywords 就可以使用了，配置文件在 <code>~/.config/variety/variety.conf</code> ：</p><ul><li>Touhou</li><li>Azur Lane</li><li>Genshin Impact</li><li>anime girls</li><li>cosplay</li><li>GUWEIZ</li><li>WLOP</li></ul><h3 id=unsplashshhttpsyounessnetlinuxset-random-wallpapers-unsplash-com-ubuntuv2><a href=https://youness.net/linux/set-random-wallpapers-unsplash-com-ubuntu#v2>unsplash.sh</a><a hidden class=anchor aria-hidden=true href=#unsplashshhttpsyounessnetlinuxset-random-wallpapers-unsplash-com-ubuntuv2>#</a></h3><p>添加脚本</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi $HOME/Pictures/unsplash.sh
</span></span><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/bash</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>UNSPLASH_DIR<span style=color:#f92672>=</span>$HOME/Pictures/Unsplash
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> ! -d <span style=color:#e6db74>${</span>UNSPLASH_DIR<span style=color:#e6db74>}</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    mkdir -p <span style=color:#e6db74>${</span>UNSPLASH_DIR<span style=color:#e6db74>}</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>URL_LOCATION<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>curl -I https://source.unsplash.com/daily | grep Location | cut -d<span style=color:#e6db74>&#39; &#39;</span> -f 2<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>WALLPAPER_NAME<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo $URL_LOCATION | egrep -o <span style=color:#e6db74>&#39;photo[a-z0-9-]+&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>WALLPAPER_FORMAT<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo $URL_LOCATION | egrep -o <span style=color:#e6db74>&#39;fm=[a-z]+&#39;</span> | cut -d<span style=color:#e6db74>&#39;=&#39;</span> -f 2<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>wget --no-proxy -O <span style=color:#e6db74>${</span>UNSPLASH_DIR<span style=color:#e6db74>}</span>/<span style=color:#e6db74>${</span>WALLPAPER_NAME<span style=color:#e6db74>}</span>.<span style=color:#e6db74>${</span>WALLPAPER_FORMAT<span style=color:#e6db74>}</span> <span style=color:#e6db74>${</span>URL_LOCATION<span style=color:#e6db74>}</span>
</span></span></code></pre></div><ul><li>在 <a href=https://source.unsplash.com/>Unsplash Source</a> 查看更多 API。</li><li><a href=https://stackoverflow.com/questions/6881034/curl-to-grab-remote-filename-after-following-location>Curl to grab remote filename after following location</a></li><li>关于 cut 获取子字符串：<a href=https://stackoverflow.com/a/428118>Extract substring in Bash</a></li></ul><p>可以使用 Crontab 定时切换壁纸：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ crontab -e
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span> <span style=color:#ae81ff>12</span> * * * /home/vane/Pictures/unsplash.sh
</span></span></code></pre></div><p>除了使用 crontab 外，还可以使用 Startup Applications Preferences 添加一个启动项。</p><h3 id=wallhavensh>wallhaven.sh<a hidden class=anchor aria-hidden=true href=#wallhavensh>#</a></h3><p>wallhaven图片右键下载的是原图，不是缩略图。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi $HOME/.wallhaven/wallhaven.sh
</span></span><span style=display:flex><span><span style=color:#75715e>#!/bin/bash</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>WORK_DIR<span style=color:#f92672>=</span>$HOME/.wallhaven
</span></span><span style=display:flex><span>SAVE_DIR<span style=color:#f92672>=</span>$HOME/Pictures/wallhaven
</span></span><span style=display:flex><span>IMG_URL<span style=color:#f92672>=</span>https://w.wallhaven.cc/full
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> GetListing<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#39;get listing&#39;</span>
</span></span><span style=display:flex><span>  listing<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>curl https://wallhaven.cc/api/v1/search?apikey<span style=color:#f92672>=</span>&lt;API KEY&gt;&amp;categories<span style=color:#f92672>=</span>010&amp;purity<span style=color:#f92672>=</span>111&amp;atleast<span style=color:#f92672>=</span>1920x1080&amp;ratios<span style=color:#f92672>=</span>16x9&amp;sorting<span style=color:#f92672>=</span>random&amp;order<span style=color:#f92672>=</span>desc&amp;page<span style=color:#f92672>=</span>1<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#39;save listing&#39;</span>
</span></span><span style=display:flex><span>  echo $listing | jq -r <span style=color:#e6db74>&#39;.data[].path&#39;</span> | awk -F <span style=color:#e6db74>&#39;/&#39;</span> <span style=color:#e6db74>&#39;{print $NF}&#39;</span> &gt; $WORK_DIR/listing
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#39;save res&#39;</span>
</span></span><span style=display:flex><span>  cat $WORK_DIR/listing | wc -l &gt; $WORK_DIR/res
</span></span><span style=display:flex><span>  SetWallpaper
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> SetWallpaper<span style=color:#f92672>()</span>
</span></span><span style=display:flex><span><span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -a $WORK_DIR/res <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#39;read res&#39;</span>
</span></span><span style=display:flex><span>    read res  &lt; $WORK_DIR/res
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $res -ne <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span> 
</span></span><span style=display:flex><span>      echo <span style=color:#e6db74>&#39;get img&#39;</span>
</span></span><span style=display:flex><span>      img<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>cat $WORK_DIR/listing | tail -<span style=color:#e6db74>${</span>res<span style=color:#e6db74>}</span> | head -1<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>      echo <span style=color:#e6db74>&#34;down </span>$img<span style=color:#e6db74> from </span>$IMG_URL<span style=color:#e6db74>/</span><span style=color:#e6db74>${</span>img:10:2<span style=color:#e6db74>}</span><span style=color:#e6db74>/</span>$img<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>      curl -o $SAVE_DIR/$img $IMG_URL/<span style=color:#e6db74>${</span>img:10:2<span style=color:#e6db74>}</span>/$img
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> $? -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#39;set wallpaper&#39;</span>
</span></span><span style=display:flex><span>        cp $SAVE_DIR/$img $HOME/Wallpaper
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#39;res-1&#39;</span>
</span></span><span style=display:flex><span>        echo <span style=color:#66d9ef>$((</span>$res <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#66d9ef>))</span> &gt; $WORK_DIR/res
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#39;exit&#39;</span>
</span></span><span style=display:flex><span>        exit <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>        echo <span style=color:#e6db74>&#39;download error&#39;</span>
</span></span><span style=display:flex><span>        SetWallpaper
</span></span><span style=display:flex><span>      <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>      echo <span style=color:#e6db74>&#39;res=0&#39;</span>
</span></span><span style=display:flex><span>      GetListing
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#39;no res&#39;</span>
</span></span><span style=display:flex><span>    GetListing
</span></span><span style=display:flex><span>  <span style=color:#66d9ef>fi</span>
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>SetWallpaper
</span></span></code></pre></div><p><a href=https://www.tomczhen.com/2017/10/15/parsing-json-with-shell-script/>使用 Shell 脚本来处理 JSON</a>，<a href=https://stedolan.github.io/jq/manual/>jq Manual</a>，<a href=https://wallhaven.cc/help/api>wallhaven API v1 Documentation</a></p><p>一般文件内容开头都会有一个<a href=https://www.zhihu.com/question/28161418>文件类型的标记</a>，根据文件名后缀只是一个快捷的方法，不用读取文件内容就判断文件类型，但不是唯一的方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ crontab -e
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span> <span style=color:#ae81ff>12</span> * * * /home/vane/.wallhaven/wallhaven.sh
</span></span></code></pre></div><p><a href=https://stackoverflow.com/questions/10374520/gsettings-with-cron>Gsettings 无法在 Cron 中使用</a>：出现此问题是因为 cron 仅使用一组非常有限的环境变量。 唯一一个负责在将其设置为 cron 作业时以正确方式运行问题脚本的环境变量是 DBUS_SESSION_BUS_ADDRESS。</p><h3 id=astronomyshhttpsapinasagov><a href=https://api.nasa.gov/>astronomy.sh</a><a hidden class=anchor aria-hidden=true href=#astronomyshhttpsapinasagov>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>API_KEY<span style=color:#f92672>=</span>zTL5rJmctXwHcsjfCSalfDRNFTeaVYa9FxgINVVU
</span></span><span style=display:flex><span>HTTP_REQUEST<span style=color:#f92672>=</span>https://api.nasa.gov/planetary/apod?api_key<span style=color:#f92672>=</span>$API_KEY
</span></span><span style=display:flex><span>HTTP_RESPONSE<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>curl $HTTP_REQUEST<span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>IMG_HDURL<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo $HTTP_RESPONSE | jq -r <span style=color:#e6db74>&#39;.hdurl&#39;</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>IMG_FILENAME<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>echo <span style=color:#e6db74>${</span>IMG_HDURL##*/<span style=color:#e6db74>}</span><span style=color:#66d9ef>)</span>
</span></span><span style=display:flex><span>curl -o $HOME/DataOne/Images/Astronomy/$IMG_FILENAME $IMG_HDURL
</span></span><span style=display:flex><span>cp -av $HOME/DataOne/Images/Astronomy/$IMG_FILENAME $HOME/Wallpaper
</span></span></code></pre></div><h3 id=wallpaper-slideshowshttpslinuxcnarticle-9571-1html><a href=https://linux.cn/article-9571-1.html>Wallpaper Slideshows</a><a hidden class=anchor aria-hidden=true href=#wallpaper-slideshowshttpslinuxcnarticle-9571-1html>#</a></h3><p>2018-04-23 18:53</p><blockquote><p>使用一个简单的 XML，你就可以设置 GNOME 能够在桌面上显示一个幻灯片。</p></blockquote><p>在 GNOME 中，一个非常酷、但却鲜为人知的特性是它能够将幻灯片显示为墙纸。你可以从 <a href=http://manpages.ubuntu.com/manpages/xenial/man1/gnome-control-center.1.html>GNOME 控制中心</a>的 “背景设置” 面板中选择墙纸幻灯片。在预览的右下角显示一个小时钟标志，可以将幻灯片的墙纸与静态墙纸区别开来。</p><p>一些发行版带有预装的幻灯片壁纸。 例如，Ubuntu 包含了库存的 GNOME 定时壁纸幻灯片，以及 Ubuntu 壁纸大赛胜出的墙纸。</p><p>如果你想创建自己的自定义幻灯片用作壁纸怎么办？虽然 GNOME 没有为此提供一个用户界面，但是在你的主目录中使用一些简单的 XML 文件来创建一个是非常容易的。 幸运的是，GNOME 控制中心的背景选择支持一些常见的目录路径，这样就可以轻松创建幻灯片，而不必编辑你的发行版所提供的任何内容。</p><h4 id=开始>开始<a hidden class=anchor aria-hidden=true href=#开始>#</a></h4><p>使用你最喜欢的文本编辑器在 <code>$HOME/.local/share/gnome-background-properties/</code> 创建一个 XML 文件。 虽然文件名不重要，但目录名称很重要（你可能需要创建该目录）。 举个例子，我创建了带有以下内容的 <code>/home/ken/.local/share/gnome-background-properties/osdc-wallpapers.xml</code>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE wallpapers SYSTEM &#34;gnome-wp-list.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;wallpapers&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;wallpaper</span> <span style=color:#a6e22e>deleted=</span><span style=color:#e6db74>&#34;false&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;name&gt;</span>Opensource.com Wallpapers<span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;filename&gt;</span>/home/ken/Pictures/Wallpapers/osdc/osdc.xml<span style=color:#f92672>&lt;/filename&gt;</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>&lt;options&gt;</span>zoom<span style=color:#f92672>&lt;/options&gt;</span>
</span></span><span style=display:flex><span> <span style=color:#f92672>&lt;/wallpaper&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/wallpapers&gt;</span>
</span></span></code></pre></div><p>每一个你需要包含在 GNOME 控制中心的 “背景面板”中的每个幻灯片或静态壁纸，你都要在上面的 XML 文件需要为其增加一个 <code>&lt;wallpaper></code> 节点。</p><p>在这个例子中，我的 <code>osdc.xml</code> 文件看起来是这样的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; ?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;background&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!-- Duration in seconds to display the background --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>30.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/ken/Pictures/Wallpapers/osdc/osdc_2.png<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!-- Duration of the transition in seconds, default is 2 seconds --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>0.5<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/ken/Pictures/Wallpapers/osdc/osdc_2.png<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/ken/Pictures/Wallpapers/osdc/osdc_1.png<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>30.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/ken/Pictures/Wallpapers/osdc/osdc_1.png<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>0.5<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/ken/Pictures/Wallpapers/osdc/osdc_1.png<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/ken/Pictures/Wallpapers/osdc/osdc_2.png<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/background&gt;</span>
</span></span></code></pre></div><p>上面的 XML 中有几个重要的部分。 XML 中的 <code>&lt;background></code> 节点是你的外部节点。 每个背景都支持多个 <code>&lt;static></code> 和 <code>&lt;transition></code> 节点。</p><ul><li><code>&lt;static></code> 节点定义用 <code>&lt;file></code> 节点要显示的图像以及用 <code>&lt;duration></code> 显示它的持续时间。</li><li><code>&lt;transition></code> 节点定义 <code>&lt;duration></code>（变换时长），<code>&lt;from></code> 和 <code>&lt;to></code> 定义了起止的图像。</li></ul><h4 id=全天更换壁纸>全天更换壁纸<a hidden class=anchor aria-hidden=true href=#全天更换壁纸>#</a></h4><p>另一个很酷的 GNOME 功能是基于时间的幻灯片。 你可以定义幻灯片的开始时间，GNOME 将根据它计算时间。 这对于根据一天中的时间设置不同的壁纸很有用。 例如，你可以将开始时间设置为 06:00，并在 12:00 之前显示一张墙纸，然后在下午和 18:00 再次更改。</p><p>这是通过在 XML 中定义 <code>&lt;starttime></code> 来完成的，如下所示：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;starttime&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#75715e>&lt;!-- A start time in the past is fine --&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;year&gt;</span>2017<span style=color:#f92672>&lt;/year&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;month&gt;</span>11<span style=color:#f92672>&lt;/month&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;day&gt;</span>21<span style=color:#f92672>&lt;/day&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;hour&gt;</span>6<span style=color:#f92672>&lt;/hour&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;minute&gt;</span>00<span style=color:#f92672>&lt;/minute&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;second&gt;</span>00<span style=color:#f92672>&lt;/second&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/starttime&gt;</span>
</span></span></code></pre></div><p>上述 XML 文件定义于 2017 年 11 月 21 日 06:00 开始动画，时长为 21,600.00，相当于六个小时。 这段时间将显示你的早晨壁纸直到 12:00，12:00 时它会更改为你的下一张壁纸。 你可以继续以这种方式每隔一段时间更换一次壁纸，但确保所有持续时间的总计为 86,400 秒（等于 24 小时）。</p><p>GNOME 将计算开始时间和当前时间之间的增量，并显示当前时间的正确墙纸。 例如，如果你在 16:00 选择新壁纸，则GNOME 将在 06:00 开始时间之后显示 36,000 秒的适当壁纸。</p><h4 id=实用程序>实用程序<a hidden class=anchor aria-hidden=true href=#实用程序>#</a></h4><ul><li><a href=https://github.com/almet/gnome-background-generator>gnome-backearth-generator</a></li><li><a href=https://github.com/maoschanz/dynamic-wallpaper-editor>Dynamic Wallpaper Editor</a></li></ul><h4 id=macos-dynamic-wallpaper-实例httpswwwomgubuntucouk201806macos-mojave-dynamic-background-linux><a href=https://www.omgubuntu.co.uk/2018/06/macos-mojave-dynamic-background-linux>macOS Dynamic Wallpaper 实例</a><a hidden class=anchor aria-hidden=true href=#macos-dynamic-wallpaper-实例httpswwwomgubuntucouk201806macos-mojave-dynamic-background-linux>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;!-- Instructions:
</span></span></span><span style=display:flex><span><span style=color:#75715e>- Download and unzip Mojave dynamic background here: https://files.rb.gd/mojave_dynamic.zip 
</span></span></span><span style=display:flex><span><span style=color:#75715e>- Rename the extracted folder as &#34;mojave-background&#34; (Excuse the trouble but I renamed it on my machine and already use that path in the XML file)
</span></span></span><span style=display:flex><span><span style=color:#75715e>- Save this xml file next to the Mojave background files
</span></span></span><span style=display:flex><span><span style=color:#75715e>- Fix the path to the background images below (better using absolute path)
</span></span></span><span style=display:flex><span><span style=color:#75715e>- Lastly, either: 
</span></span></span><span style=display:flex><span><span style=color:#75715e>  + GNOME: Use gnome-tweaks tool to select this XML as wallpaper (as default wallpaper settings won&#39;t let you choose wallpaper from custom path)
</span></span></span><span style=display:flex><span><span style=color:#75715e>  + MATE: Go to background setting (in Appearance) &gt; Choose +Add... &gt; make sure **All files** filter is selected at the bottom right &gt; Then choose mojave.xml
</span></span></span><span style=display:flex><span><span style=color:#75715e>--&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;background&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;starttime&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;year&gt;</span>2014<span style=color:#f92672>&lt;/year&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;month&gt;</span>01<span style=color:#f92672>&lt;/month&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;day&gt;</span>11<span style=color:#f92672>&lt;/day&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;hour&gt;</span>0<span style=color:#f92672>&lt;/hour&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;minute&gt;</span>00<span style=color:#f92672>&lt;/minute&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;second&gt;</span>00<span style=color:#f92672>&lt;/second&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/starttime&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 00:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>10795.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_15.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_15.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_16.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 03:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>10795.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_16.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_16.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_1.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 05:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_1.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_1.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_2.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 06:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_2.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_2.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_3.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 07:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_3.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_3.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_4.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 08:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_4.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_4.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_5.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 09:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_5.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_5.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_6.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 10:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_6.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_6.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_7.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 11:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>7195.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_7.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_7.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_8.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 13:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_8.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_8.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_9.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 14:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_9.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_9.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_10.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 15:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_10.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_10.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_11.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 16:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_11.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_11.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_12.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 17:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3595.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_12.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_12.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_13.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 18:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>7195.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_13.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_13.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_14.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e>&lt;!-- 20:00 --&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;static&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>10795.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;file&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_14.jpeg<span style=color:#f92672>&lt;/file&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/static&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>5.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_14.jpeg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/home/thanh/Pictures/wallpapers/mojave-background/mojave_dynamic_15.jpeg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/background&gt;</span>
</span></span></code></pre></div><ul><li>最好先根据图片数量，将时间段划分出来，之后再编写代码。时间段划分可以参考<a href=https://richuriluo.xuenb.com/>日出日落时间表</a>。</li><li>~~更进一步，用 ffmpeg 创建足够多的帧，Dynamic Wallpaper 或许可以变成 Video Wallpaper 了，~~经过测试，时间精度也限定为 0.1s，所以并不适合做为 Video Wallpaper。</li><li>overlay 和 5.0 的使得过渡非常自然。</li></ul><h3 id=light-and-dark-wallpaperhttpslinuxcnarticle-14471-1html><a href=https://linux.cn/article-14471-1.html>Light and Dark Wallpaper</a><a hidden class=anchor aria-hidden=true href=#light-and-dark-wallpaperhttpslinuxcnarticle-14471-1html>#</a></h3><p>2022-04-13 23:38</p><blockquote><p>一份简单的指南：如何针对 GNOME 桌面环境来创建你的自定义的深色和浅色壁纸。</p></blockquote><p><a href=https://www.debugpoint.com/2022/03/gnome-42-release/>GNOME 42</a> 将备受期待的深浅主题带到 GNOME 桌面环境。它也带来壁纸的深色和浅色版本，当你切换深色或浅色主题时，它会自动地转换。</p><p>因此，默认情况下，GNOME 给予你一套预配置的深色和浅色壁纸。但是如果你想要在主题更改时自动地转换成另一种不同的壁纸要怎么做呢？</p><p>下面是如何在 GNOME 中配置和创建你自己的深浅壁纸的方法。</p><h4 id=自定义的深浅壁纸>自定义的深浅壁纸<a hidden class=anchor aria-hidden=true href=#自定义的深浅壁纸>#</a></h4><ol><li><p>确保你手边有两个版本的壁纸。一般来说，它们应该是标准的 PNG 或 JPG 图像文件。</p></li><li><p>我们需要为我们自己创建一个模式文件。壁纸的自动更换是由 XML 文件处理的，它定义了特定的深色和浅色的背景标记。因此，我们将为壁纸创建我们自己的 XML 文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>&lt;!DOCTYPE wallpapers SYSTEM &#34;gnome-wp-list.dtd&#34;&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;wallpapers&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;wallpaper</span> <span style=color:#a6e22e>deleted=</span><span style=color:#e6db74>&#34;false&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;name&gt;</span>Default Background<span style=color:#f92672>&lt;/name&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;filename&gt;</span>@BACKGROUNDDIR@/adwaita-l.webp<span style=color:#f92672>&lt;/filename&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;filename-dark&gt;</span>@BACKGROUNDDIR@/adwaita-d.webp<span style=color:#f92672>&lt;/filename-dark&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;options&gt;</span>zoom<span style=color:#f92672>&lt;/options&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;shade_type&gt;</span>solid<span style=color:#f92672>&lt;/shade_type&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;pcolor&gt;</span>#3071AE<span style=color:#f92672>&lt;/pcolor&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;scolor&gt;</span>#000000<span style=color:#f92672>&lt;/scolor&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/wallpaper&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/wallpapers&gt;</span>
</span></span></code></pre></div><p>你能够会在这个文件中看到两个标记 – <code>filename</code> 和 <code>filename-dark</code>。这两个 XML 标记包含这两个壁纸的完整的限定的路径（绝对路径）。现在，在这两个标记下添加你的图像文件的路径。</p></li><li><p>把这个文件保存到 <code>/home/&lt;your_name>/.local/share/gnome-background-properties</code>，文件名任意。</p></li></ol><p>这样，你就准备好了所有的东西。最后，打开 “设置Settings” 并转到 “外观” 标签页，你应该会看到一个新的壁纸选项。</p><p>选择你自己的自定义的深浅壁纸，尽情享受。</p><h4 id=获取动态壁纸>获取动态壁纸<a hidden class=anchor aria-hidden=true href=#获取动态壁纸>#</a></h4><p>当然，你必然会想，谁有时间去查找和创建壁纸的日夜版本？这里有一些网站来向你提供预制好的动态壁纸，你可以轻松地下载和安装。</p><p><a href=https://9to5mac.com/2022/03/30/how-to-use-find-make-dynamic-mac-wallpapers/>How to find and make dynamic Mac wallpapers</a>:</p><ul><li><a href=https://dynamicwallpaper.club/gallery>Dynamic Wallpaper Club</a></li><li><a href=https://www.jetsoncreative.com/mojave>24 Hour Wallpaper</a></li><li><a href=http://dynwalls.com/>Dynwalls</a></li></ul><p>此外，如果你打算从上述网站下载，请记住该网站的图像文件是 <a href=https://en.wikipedia.org/wiki/High_Efficiency_Image_File_Format>heic</a> 格式的，因为这个网站是针对 macOS 的。高效视频编码High-Efficiency Video Coding（HEIC）是苹果的专有的 HEIF（高效图像文件High-Efficiency Image File）专有版本。</p><p>那么，如何在 Linux 系统中转换它们? 好吧，在 Ubuntu 中，你需要一个驱动程序来查看和转换动态的 heic 图像文件。打开一个终端，运行下面的命令开安装驱动程序。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install heif-gdk-pixbuf
</span></span></code></pre></div><p>针对使用 KDE Plasma 的用户（没有这个插件的帮助，Plasma 应用程序就不能打开 heic 格式的图像文件）：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install qt-heif-image-pluginsudo dnf install qt-heif-image-plugin
</span></span></code></pre></div><h4 id=convert-heic>Convert HEIC<a hidden class=anchor aria-hidden=true href=#convert-heic>#</a></h4><ul><li><p><a href="https://ubuntuhandbook.org/index.php/2021/06/open-heic-convert-jpg-png-ubuntu-20-04/#:~:text=Convert%20HEIF%2FHEIC%20to%20JPEG,select%20Export%20to%20JPG%20%2F%20PNG.">using heif-convert</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install libheif-examples
</span></span><span style=display:flex><span>$ heif-convert input.HEIC output.JPG
</span></span></code></pre></div><p>后面发现解压文件的序号与图片的播放顺序不一致，因此需要预览图来对照调整顺序——图片少也不难，图片多的话，也不是全部都打乱了，只是一两张顺序而已。</p></li><li><p><a href=https://github.com/ImageMagick/ImageMagick/issues/1391>using ImageMagick</a>：</p><p>22.04.1 仓库 ImageMagick 6.9.11 版本低了，只能转换成一张 png，因此使用<a href=https://imagemagick.org/script/download.php#linux>官网 portable 版本</a>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ./magick convert burst.heic output.jpg
</span></span><span style=display:flex><span>convert: no decode delegate <span style=color:#66d9ef>for</span> this image format <span style=color:#e6db74>`</span>HEIC<span style=color:#e6db74>&#39; @ error/constitute.c/ReadImage/741.
</span></span></span><span style=display:flex><span><span style=color:#e6db74>convert: no images defined `output.jpg&#39;</span> @ error/convert.c/ConvertImageCommand/3342.
</span></span></code></pre></div><p>需要<a href=https://medium.com/praaveen/compiling-imagemagick-with-heic-support-17d39119e80>手动编译以支持HEIC</a></p></li></ul><h4 id=heif-metadata>HEIF metadata<a hidden class=anchor aria-hidden=true href=#heif-metadata>#</a></h4><ul><li><p>使用 <a href=https://github.com/strukturag/libheif>libheif</a>(depend by <em>heif-gdk-pixbuf</em> package) 提供的 <code>heif-info</code> 工具，<code>heif-info file.heif</code> 可以列出每个图片简略信息（没啥用），<code>heif-info -d file.heif</code> 可以列出 low-level 信息：</p><ul><li>每个 <code>item_type: grid</code> 就是照片起始位置，会发现其 <code>item_ID</code> 与 <code>heif-info file.heif</code> 输出一致。</li></ul></li><li><p>参考 <a href=https://github.com/xyproto/wallutils>wallutils</a> 的 issue：<a href=https://github.com/xyproto/wallutils/issues/23>Support macOS dynamic wallpapers</a></p><p>You can inspect this metadata with the following steps:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install libimage-exiftool-perl
</span></span><span style=display:flex><span>$ exiftool wallpaper.heic
</span></span></code></pre></div><p>Under the key &ldquo;Solar&rdquo; there&rsquo;s a base64 encoded plist file. You can decode this with:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install libplist-utils
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;[Base64 string]&#34;</span> | base64 -d - | plistutil
</span></span></code></pre></div><p>所谓 Solar，参考制作 MacOS Dynamic Wallpaper 的开源项目 <a href=https://github.com/mczachurski/wallpapper>wallpapper</a> 的博客文章 <a href=https://itnext.io/macos-mojave-dynamic-wallpapers-ii-f8b1e55c82f>macOS Mojave dynamic wallpapers (II)</a>：Thanks to <a href=https://en.wikipedia.org/wiki/Horizontal_coordinate_system>altitude and azimuth</a> w exactly know where the Sun was when image was taken. This idea is brilliant, because thanks to this information macOS can change images differently during Summer and during Winter. System knows where the Sun is and it will choose image which was taken in similar conditions. <strong>Brilliant</strong>.（即，计算机以拍照者的视角展示照片）</p><p>最终 wallutils 是部分完成了这个功能了，使用了 <a href=https://github.com/xyproto>xyproto</a>/<a href=https://github.com/xyproto/heic>heic</a> 这个库，实现在<a href=https://github.com/xyproto/heic/blob/45e6b3945dc3292d6ac8f6b149f78830335e1e4b/metadata.go#L154>这里</a>，可以解析 H24 时间格式，但是不能解析 Solar 格式的。其实就是乘个 24 就得出时钟了。我的方法是 24 乘以最小的数值，得出初始时间放入 <code>&lt;starttime></code>，以该时间对应的照片开头（合理即可），按照照片数量等分 24 小时放入 <code>&lt;duration></code>。</p><p>Solar 话我这里我简单地计算（复杂的不会啊！😂）：观察 azimuth，找到第一个 0°～180°的数值（天体上升，180°～360° 天体下降），将其乘以 24 / 360，得出其初始时间，放入 <code>&lt;starttime></code>，然后以该时间对应的照片开头（合理即可），按照照片数量等分 24 小时放入 <code>&lt;duration></code>。</p></li></ul><p><a href=https://github.com/xyproto/wallutils/blob/main/pkg/simpletimed/stw-1.0.0.md><strong>Real world examples</strong></a></p><p>mojave-timed.xml：还可以这样写，全部都是 transition，没有 static 部分</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#f92672>&lt;background&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;starttime&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;year&gt;</span>2000<span style=color:#f92672>&lt;/year&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;month&gt;</span>01<span style=color:#f92672>&lt;/month&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;day&gt;</span>01<span style=color:#f92672>&lt;/day&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;hour&gt;</span>01<span style=color:#f92672>&lt;/hour&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;minute&gt;</span>00<span style=color:#f92672>&lt;/minute&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;second&gt;</span>00<span style=color:#f92672>&lt;/second&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/starttime&gt;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>14400.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0100.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0500.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3600.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0500.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0600.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3600.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0600.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0700.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3600.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0700.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0800.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3600.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0800.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0900.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3600.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0900.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1000.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3600.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1000.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1100.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3600.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1100.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1200.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>4800.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1200.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1320.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>4800.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1320.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1440.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>4800.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1440.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1600.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>4800.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1600.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1720.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>4800.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1720.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1840.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>4800.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-1840.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-2000.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>3600.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-2000.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-2100.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;transition</span> <span style=color:#a6e22e>type=</span><span style=color:#e6db74>&#34;overlay&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;duration&gt;</span>14400.0<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;from&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-2100.jpg<span style=color:#f92672>&lt;/from&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>&lt;to&gt;</span>/usr/share/backgrounds/gnome/mojave/mojave_dynamic-0100.jpg<span style=color:#f92672>&lt;/to&gt;</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>&lt;/transition&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/background&gt;</span>
</span></span></code></pre></div><h3 id=視頻動壁紙httpsblogmegumifoxcompublic20220201i3wm-e4b88be4bdbfe794a8e8a696e9a0bbe58b95e5a381e7b499e5b8b6e7a1ace4bbb6e58aa0e9809f><a href=https://blog.megumifox.com/public/2022/02/01/i3wm-%E4%B8%8B%E4%BD%BF%E7%94%A8%E8%A6%96%E9%A0%BB%E5%8B%95%E5%A3%81%E7%B4%99%E5%B8%B6%E7%A1%AC%E4%BB%B6%E5%8A%A0%E9%80%9F/>視頻動壁紙</a><a hidden class=anchor aria-hidden=true href=#視頻動壁紙httpsblogmegumifoxcompublic20220201i3wm-e4b88be4bdbfe794a8e8a696e9a0bbe58b95e5a381e7b499e5b8b6e7a1ace4bbb6e58aa0e9809f>#</a></h3><p>1 Feb, 2022</p><p>日常使用的話，我是不會去碰動態壁紙之類的東西，因爲這些東西很影響我的注意力，而且這也沒多大的必要。但你十分喜歡這種十分炫酷的視頻動態壁紙的話，希望這篇東西可能可以幫到你吧。</p><p>舉個例子：我的屏幕大小是 3440 x 1440 ，使用 <a href="https://www.youtube.com/watch?v=n9w_hZkbfoo">這個視頻</a> 作爲動態壁紙</p><p>命令如下:（參數就看你需求改就是了這裏只是演示一下）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ xwinwrap -g 3440x1440 -ni -s -nf -b -un -ov -fdt -argb -- mpv -wid WID --ao<span style=color:#f92672>=</span>null --loop<span style=color:#f92672>=</span>inf --stop-screensaver<span style=color:#f92672>=</span>no --script-opts<span style=color:#f92672>=</span>ytdl_hook-ytdl_path<span style=color:#f92672>=</span>yt-dlp <span style=color:#e6db74>&#34;https://www.youtube.com/watch?v=n9w_hZkbfoo&#34;</span>
</span></span></code></pre></div><p>注：因爲 youtube-dl 下載太慢這裏使用 youtube-dl 的一個 fork <code>yt-dlp</code></p><p>如果你是要播放本地視頻，那麼改爲：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ xwinwrap -g 3440x1440 -ni -s -nf -b -un -ov -fdt -argb -- mpv -wid WID --ao<span style=color:#f92672>=</span>null --loop<span style=color:#f92672>=</span>inf --stop-screensaver<span style=color:#f92672>=</span>no $VIDEO_PATH
</span></span></code></pre></div><h2 id=social>Social<a hidden class=anchor aria-hidden=true href=#social>#</a></h2><h3 id=telegramhttpswwwnotionsotelegram-95a6c23f0bb1466892b55f9ec8c755fd><a href=https://www.notion.so/Telegram-95a6c23f0bb1466892b55f9ec8c755fd>Telegram</a><a hidden class=anchor aria-hidden=true href=#telegramhttpswwwnotionsotelegram-95a6c23f0bb1466892b55f9ec8c755fd>#</a></h3><p>先通过手机登录，再在电脑端登录。电脑先登录，手机老是收不到验证码。</p><h4 id=简介>简介<a hidden class=anchor aria-hidden=true href=#简介>#</a></h4><ul><li><p>Telegram —— 中文名又称"电报"，或简称"TG"。</p></li><li><p>Telegram 是跨平台的即时通信软件，其客户端是自由及开放源代码软件，但服务器是专有软件。</p></li><li><p>Telegram 在中国大陆境内无法直接连接，注册和使用都需要科学上网，请自备节点和工具。</p></li><li><p>下载：Telegram 有官方版和第三方版本，但出于安全和隐私的考虑，推荐大家使用 Telegram 官方版客户端</p></li></ul><h4 id=推荐设置>推荐设置<a hidden class=anchor aria-hidden=true href=#推荐设置>#</a></h4><ul><li>Privacy and Security<ul><li>Phone Number<ul><li>谁能看见我的手机号码：Nobody</li><li>谁能通过手机号码找到我：My Contacts</li></ul></li><li>Forwarded Messages：Nobody</li><li>Calls：Nobody</li><li>Groups：My Contacts</li></ul></li><li>Local Passcode：本地密码只是本设备打开 Telegram 的应用密码</li><li>Two-Step Verification：为了账号安全，强烈推荐您设置两步验证密码。</li><li>Delete my account：推荐您设置为一年</li></ul><h4 id=隐私保护注意事项>隐私保护注意事项<a hidden class=anchor aria-hidden=true href=#隐私保护注意事项>#</a></h4><ul><li>资料设置<ul><li>昵称及用户名：避免使用与其他社交平台相同或相似的昵称及用户名</li><li>手机号码：在"设置——隐私——电话号码"中设置"不允许任何人查看我的手机号码"和"仅允许联系人通过手机号码找到我"。</li></ul></li><li>群组聊天：Telegram 的群聊是"不安全"的。 公开群组的所有聊天内容都可被其他人查看，即使他人并未注册 Telegram； 对于群组内的机器人，它们可以收集群组内的绝大部分消息。</li><li>媒体文件：在分享照片时，请注意使用专业修图软件打码处理关键信息，并清除照片包含的地理位置信息</li><li>分享链接：从其他平台分享内容至 Telegram 时，请注意清除分享链接中的用户 UserID 识别信息，他人完全有可能从您的分享链接中获取您的用户信息。</li><li>第三方客户端：如无特殊需要，请使用官方 Telegram 客户端。第三方客户端有能力获取和控制您的账户，读取您全部的聊天记录，收集您设备的可识别信息，包括但不限于：手机号、设备型号、IMEI码、MAC码等。</li></ul><h4 id=常见问题及解答>常见问题及解答<a hidden class=anchor aria-hidden=true href=#常见问题及解答>#</a></h4><ul><li>无法给他人发送私聊：“Sorry, you can only send messages to mutual contacts at the momet.”<ul><li>@SpamBot</li><li>But I can&rsquo;t message non-contacts！</li><li>No，I&rsquo;ll never do any of this</li></ul></li><li>群组和频道有什么类型？有什么特点？<ul><li>群组(Group)或者频道(Channel)有两种类型。<ul><li>一种是公开群组(Public Group/Channel)</li><li>一种是私有群组(Private Group/Channel)</li></ul></li><li>公开群组(Public Group/Channel) 有自定义设置的ID，所有人可以通过搜索功能，输入id查询到相应的群组。公开群组的历史消息对所有人可见，即使没加入公开群组，也可以查看群组历史消息。</li><li>私有群组(Private Group/Channel) 没有自定义的ID，要加入只能通过点击邀请链接或者被邀请入群，
在私有群组，群主可以设定历史消息的可见性。而对于没有加入群组的人，则不可以查看群组的消息。</li></ul></li><li>Telegram 用户名是什么？<ul><li>其他用户可以通过用户名找到您，您将出现在“全局结果”下的联系人搜索中。这样人们就可以在不知道您的电话号码的情况下通过 Telegram 与您联系。</li><li>由于用户名的唯一性，可以防止他人盗用你的头像和昵称冒充你。</li></ul></li><li>如何添加联系人？：添加和删除联系人都是单向操作，对方设备并不会同步。</li><li>添加非手机号码联系人后，对方能知道自己的手机号码吗？：如果想取消分享你的手机号，请到隐私设置(Privacy and Security)中找到手机号码(Phone Number)的设置，在里面移除对方即可。</li><li>不登陆 Telegram 如何查看频道消息？：Telegram 公开频道可以直接通过浏览器输入 <code>https://t.me/s/频道id</code> 访问，不需要拥有TG账号。</li></ul><h4 id=进阶知识>进阶知识<a hidden class=anchor aria-hidden=true href=#进阶知识>#</a></h4><p>什么是 MTProxy 代理？</p><ul><li><a href=https://github.com/TelegramMessenger/MTProxy>MTProxy</a> 是 Telegram 的官方项目，仅能用于代理 Telegram 软件</li><li>MTP 代理是在 Telegram 中内置的代理程序，可以直接在软件内配置，而不需要下载任何其他 App 来配置代理</li></ul><h4 id=主题与美化>主题与美化<a hidden class=anchor aria-hidden=true href=#主题与美化>#</a></h4><p>美化主题频道</p><ul><li>官方 Desktop 桌面版主题频道 @themes</li><li>官方 Android 安卓主题频道 @Androidthemes</li></ul><h4 id=sticker-packhttpsblogphoenixlzxcom20150606make-telegram-sticker-the-lazy-way><a href=https://blog.phoenixlzx.com/2015/06/06/make-telegram-sticker-the-lazy-way/>Sticker Pack</a><a hidden class=anchor aria-hidden=true href=#sticker-packhttpsblogphoenixlzxcom20150606make-telegram-sticker-the-lazy-way>#</a></h4><p>用现成的图片集来制作 stickers pack。Linux 可以方便地使用 ImageMagick 来操作。</p><p>Telegram 要求 Sticker 图片为 PNG 格式，并且要有透明层，至少一边为 512 像素，另一边则不超过 512 像素。最大文件大小为 350KB。透明层就算了，我不会玩 PS。那么直接偷懒(死)来批量把当前目录下 JPG 和 PNG 混杂的图片们统一转换为 PNG 好了。</p><p>几条命令发给 <a href=https://telegram.me/stickers>stickers bot</a>：</p><ol><li><code>/newstickerpack</code></li><li>发送表情包的名字…</li><li>在内置的 emoji 中发送一个最符合你要发送图片的表情…</li><li>然后把对应的图片<strong>作为文件</strong>发送</li><li>如果还有其他图片的话重复 3-4</li><li>全部表情图片设置完毕，发送 <code>/publish</code> 命令</li><li>为你的 stickers pack 取一个短名字 (用于 URL)</li></ol><h4 id=使用efb推送qq与微信消息httpswwwshawnleettttxyzpostsf1bc687a><a href=https://www.shawnleetttt.xyz/posts/f1bc687a/>使用EFB推送QQ与微信消息</a><a hidden class=anchor aria-hidden=true href=#使用efb推送qq与微信消息httpswwwshawnleettttxyzpostsf1bc687a>#</a></h4><h4 id=导出-telegram-贴图>导出 Telegram 贴图<a hidden class=anchor aria-hidden=true href=#导出-telegram-贴图>#</a></h4><ul><li><p><a href=https://nyaatech.com/how-to-save-telegram-sticker-html/>Easy Way to Save Telegram Stickers</a>：<a href=https://t.me/Stickerdownloadbot>@Stickerdownloadbot</a> 适合导出 Normal Stickers，高质量的 Animated Stickers 需要付费，只需发送 Stickers 链接即可。</p></li><li><p><a href=https://blog.feizhuqwq.com/18>Telegram的表情包和贴纸么导出</a>：<a href=https://t.me/tgstogifbot>@tgstogifbot</a> 是<a href=https://github.com/ed-asriyan/tgs-to-gif>开源的</a>，只能导出部分 Animated Stickers，只需要发送一张 Sticker，会将整套 Animated Stickers 给予下载。</p></li></ul><h4 id=默认-desktop>默认 Desktop<a hidden class=anchor aria-hidden=true href=#默认-desktop>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>Desktop Entry<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Version<span style=color:#f92672>=</span>1.5
</span></span><span style=display:flex><span>Name<span style=color:#f92672>=</span>Telegram Desktop
</span></span><span style=display:flex><span>Comment<span style=color:#f92672>=</span>Official desktop version of Telegram messaging app
</span></span><span style=display:flex><span>TryExec<span style=color:#f92672>=</span>/home/kurome/.telegram/Telegram
</span></span><span style=display:flex><span>Exec<span style=color:#f92672>=</span>/home/kurome/.telegram/Telegram -workdir /home/kurome/.local/share/TelegramDesktop/ -- %u
</span></span><span style=display:flex><span>Icon<span style=color:#f92672>=</span>telegram
</span></span><span style=display:flex><span>Terminal<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>StartupWMClass<span style=color:#f92672>=</span>TelegramDesktop
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>Application
</span></span><span style=display:flex><span>Categories<span style=color:#f92672>=</span>Chat;Network;InstantMessaging;Qt;
</span></span><span style=display:flex><span>MimeType<span style=color:#f92672>=</span>x-scheme-handler/tg;
</span></span><span style=display:flex><span>Keywords<span style=color:#f92672>=</span>tg;chat;im;messaging;messenger;sms;tdesktop;
</span></span><span style=display:flex><span>Actions<span style=color:#f92672>=</span>Quit;
</span></span><span style=display:flex><span>SingleMainWindow<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>X-GNOME-UsesNotifications<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>X-GNOME-SingleWindow<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Desktop Action Quit<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Exec<span style=color:#f92672>=</span>/home/kurome/.telegram/Telegram -workdir /home/kurome/.local/share/TelegramDesktop/ -quit
</span></span><span style=display:flex><span>Name<span style=color:#f92672>=</span>Quit Telegram
</span></span><span style=display:flex><span>Icon<span style=color:#f92672>=</span>application-exit
</span></span></code></pre></div><h4 id=xdg-openhttpsmanpagesubuntucommanpagesfocalenman1xdg-open1html><a href=https://manpages.ubuntu.com/manpages/focal/en/man1/xdg-open.1.html>xdg-open</a><a hidden class=anchor aria-hidden=true href=#xdg-openhttpsmanpagesubuntucommanpagesfocalenman1xdg-open1html>#</a></h4><pre tabindex=0><code>xdg-open opens a file or URL in the user&#39;s preferred application. If a URL is provided the URL will be opened in the user&#39;s preferred web browser. If a file is provided the file will be opened in the preferred application for files of that type. xdg-open supports file, ftp, http and https URLs.
</code></pre><p>在设置了默认 desktop 文件后，在浏览器中点击 JOIN GROUP 依旧打不开 Telegram，有如下报错：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ xdg-open tg://join?invite<span style=color:#f92672>=</span>xxxx
</span></span><span style=display:flex><span>gio: tg://join?invite<span style=color:#f92672>=</span>xxxx: The specified location is not supported
</span></span></code></pre></div><p>参考<a href=https://www.linuxquestions.org/questions/linux-desktop-74/xdg-open-doesn%27t-recognize-custom-protocol-4175433062/><strong>xdg-open doesn&rsquo;t recognize custom protocol</strong></a>解决：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ xdg-mime default telegram.desktop x-scheme-handler/tg
</span></span></code></pre></div><h4 id=telegram-充當雲端筆記httpswwwplaypcesorcom201602telegramhtml><a href=https://www.playpcesor.com/2016/02/telegram.html>Telegram 充當雲端筆記</a><a hidden class=anchor aria-hidden=true href=#telegram-充當雲端筆記httpswwwplaypcesorcom201602telegramhtml>#</a></h4><p>Telegram本身有非常多的新闻、咨询以及网友们非常有深度的讨论，因此可以通过Saved Message或者建立群组频道来转存感兴趣的信息。<a href=http://farseerfc.me/>farseerfc 的小窝</a> 就有一个。</p><h4 id=中文搜索httpscongcong0806githubio20191104telegramsearch><a href=https://congcong0806.github.io/2019/11/04/TelegramSearch/>中文搜索</a><a hidden class=anchor aria-hidden=true href=#中文搜索httpscongcong0806githubio20191104telegramsearch>#</a></h4><h5 id=问题在哪>问题在哪<a hidden class=anchor aria-hidden=true href=#问题在哪>#</a></h5><p>Telegram 群组和频道越来越多，消息也越来越多，但是搜索中文的消息却是一个很大的问题。</p><p><strong>主要原因</strong></p><p>Telegram 的搜索是以”词”为基础单位的，是以<code>英文标点符号</code>或<code>空格</code>作为”词”的间隔。</p><p>这是以英文为基础的搜索方式，这样的方式对于英文的搜索就很方便，比如”hello”，用”he”就搜索不到，必须用”hello”，这就符合英文的语境，当我想要找”he”消息时并不想看到有”hello”的消息。</p><p>但是这种方式对于中文等语言来说就很不方便，中文是以字为单位的，按照上面的方式，比如消息内容”动态贴纸不能用这个bot导出”用”贴纸”或”导出”就不能搜索到此消息。</p><h5 id=如何解决>如何解决<a hidden class=anchor aria-hidden=true href=#如何解决>#</a></h5><p>知道问题出在哪儿？那又如何解决呢？ 解决方案：</p><ul><li>发消息时以<code>英文标点符号</code>或<code>空格</code>作为间隔，比如消息”动态贴纸不能用这个bot导出”，可以用”动态 贴纸 不能 用这个 bot 导出”方法发出，这样就可以用”动态”“贴纸”“不能”“导出”关键词搜索到此消息。</li><li>发消息时可以加’tag’，比如想发送消息”ABCDEFG”，可以发送”#tag ABCDEFG”，下次可以用”#tag”关键词搜索找到都有这个标签的消息。</li><li>已发的消息，以<code>标点符号</code>或<code>空格</code>作为间隔单位搜索，比如”好像国区是没有，点链接提示转到国区，关掉就好了，账号可以在不同地区购买”，可以用”好像国区是没有”“点链接提示转到国区”“关掉就好了”“账号可以在不同地区购买”关键词搜索到此消息。</li></ul><h4 id=冻屏>冻屏<a hidden class=anchor aria-hidden=true href=#冻屏>#</a></h4><p>Alex Fish, [17/08/2022 3:55 PM]
就点击不了，就拖动啊，super+鼠标拉，虽然快捷键也能操作就是了</p><p>Alex Fish, [17/08/2022 3:58 PM]
虽然快捷键也能操作就是了</p><p>Big V, [17/08/2022 3:58 PM]
Advanced => Use system window frame
Qt窗口绘制的锅</p><h4 id=profile-videoshttpstelegramorgblogprofile-videos-people-nearby-and-moreprofile-videos><a href=https://telegram.org/blog/profile-videos-people-nearby-and-more#profile-videos>Profile Videos</a><a hidden class=anchor aria-hidden=true href=#profile-videoshttpstelegramorgblogprofile-videos-people-nearby-and-moreprofile-videos>#</a></h4><p>20220820 暂时只有手机支持。</p><h3 id=mutthttpssegmentfaultcoma1190000018131615><a href=https://segmentfault.com/a/1190000018131615>Mutt</a><a hidden class=anchor aria-hidden=true href=#mutthttpssegmentfaultcoma1190000018131615>#</a></h3><p><a href=https://wiki.archlinux.org/title/Mutt>Mutt</a> 是一个基于文本的邮件客户端，因其强大的功能而闻名。 Mutt虽然已诞生二十多年了，但仍然是大量用户的首选邮件客户端。</p><p>Mutt主要侧重于作为邮件用户代理（MUA），最初是为了查看邮件而编写的。 与其他邮件应用程序相比，稍后实现的功能（检索，发送和过滤邮件）比较简单，因此用户可能希望使用外部应用程序来扩展Mutt的功能。</p><h4 id=模块搭配方案>模块搭配方案<a hidden class=anchor aria-hidden=true href=#模块搭配方案>#</a></h4><p>就像穿衣搭配一样，收件发件过滤邮件转发邮件各种功能都有很多种程序可以用，mutt怎么搭配呢？</p><p>常用选项有这些(User/Transport/Delivery)：</p><ul><li>MUA 收件：<code>fetchmail</code>或<code>getmail</code>或<code>OfflineIMAP</code></li><li>MTA 发件：<code>sendmail</code>或<code>msmtp</code>或<code>postfix</code>。其中<code>msmtp</code>兼容强，<code>postfix</code>对国内不友好</li><li>MDA 分类: <code>procmail</code>或<code>maildrop</code></li><li>邮件编辑：VIM。</li></ul><p>一般搭配是：</p><ul><li>老式搭配：mutt + getmail + sendmail + procmail</li><li>新式搭配：mutt + fetchmail + msmtp + maildrop</li></ul><p>这里我们用：<code>mutt + fetchmail + msmtp + procmail</code></p><p>安装：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install mutt fetchmail msmtp procmail -y
</span></span></code></pre></div><p>Mutt或各个写协作程序在配置前都是不能使用的，学习曲线还是比较陡峭的，所以要做好准备去花好一段去了解和学习各个部件。</p><p>大概的配置流程是：</p><ul><li>配置收件：<code>~/.fetchmailrc</code></li><li>配置过滤：<code>~/.procmailrc</code></li><li>配置发件：<code>~/.msmtprc</code></li><li>配置mutt框架本身：<code>~/.muttrc</code></li></ul><p>注意：初学过程中，不要一上来就配置mutt。最好是先从各个部件开始：<code>收件->过滤邮件->阅读邮件->发件->mutt界面</code>，按照这种顺序。</p><h4 id=收件配置fetchmailhttpswwwlinodecomdocsguidesusing-fetchmail-to-retrieve-email><a href=https://www.linode.com/docs/guides/using-fetchmail-to-retrieve-email/>收件：配置Fetchmail</a><a hidden class=anchor aria-hidden=true href=#收件配置fetchmailhttpswwwlinodecomdocsguidesusing-fetchmail-to-retrieve-email>#</a></h4><blockquote><p>Fetchmail是由著名的《大教堂与集市》作者 Eric Steven Raymond 编写的。</p></blockquote><p>Fetchmail是一个非常简单的收件程序，而且是<code>前台运行</code>、<code>一次性运行</code>的，意思是：你每次手动执行<code>fetchmail</code>命令，都是在前台一次收取完，程序就自动退出了，不是像一般邮件客户端一直在后台运行。</p><p>注意：fetchmail只负责收件，而不负责存储！所以它是要调用另一个程序如<code>procmail</code>来进行存储的。</p><p>fetchmail的配置文件为<code>~/.fetchmailrc</code>。然后文件权限最少要设置<code>chmod 600 ~/.fetchmailrc</code></p><p>比如我们要设置多个邮箱账户同时收取，那么配置如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>poll pop.AAA.com protocol POP3 user <span style=color:#e6db74>&#34;me@AAA.com&#34;</span> password <span style=color:#e6db74>&#34;123&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>poll pop.BBB.com protocol POP3 user <span style=color:#e6db74>&#34;me&#34;</span> there with password <span style=color:#e6db74>&#34;123&#34;</span> is falko here fetchall
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>poll pop.CCC.com protocol POP3 user <span style=color:#e6db74>&#34;me&#34;</span> there with password <span style=color:#e6db74>&#34;123&#34;</span> is till here keep
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>poll pop.DDD.com
</span></span><span style=display:flex><span>  protocol POP3
</span></span><span style=display:flex><span>  user <span style=color:#e6db74>&#34;me&#34;</span>
</span></span><span style=display:flex><span>  password <span style=color:#e6db74>&#34;123&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## QQ 邮箱</span>
</span></span><span style=display:flex><span>poll pop.qq.com
</span></span><span style=display:flex><span>  port <span style=color:#ae81ff>995</span> 
</span></span><span style=display:flex><span>  protocol POP3
</span></span><span style=display:flex><span>  user <span style=color:#e6db74>&#34;1664548605@qq.com&#34;</span>
</span></span><span style=display:flex><span>  password <span style=color:#f92672>[</span>授权码<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  ssl
</span></span><span style=display:flex><span>  keep
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 全局选项</span>
</span></span><span style=display:flex><span>mimedecode
</span></span><span style=display:flex><span><span style=color:#75715e># 不加 -d %T 就会报 ~/Mail/inbox is not a mailbox. 错误</span>
</span></span><span style=display:flex><span>mda <span style=color:#e6db74>&#34;/usr/bin/procmail -d %T&#34;</span>
</span></span></code></pre></div><p>其中：</p><ul><li>各种参数可以不按顺序，也可以不在一行。 <code>空格</code>隔开每个参数，<code>poll</code>隔开每个账户。</li><li><code>here</code>, <code>there</code>, <code>with</code>, <code>is</code>等等，都不是关键词，随便写不影响参数。</li><li>以下是必填<ul><li><code>poll</code>后面是邮件服务器的地址，一般是<code>pop.xxx.com</code></li><li><code>protocol</code>后面是收件协议，一般是<code>pop</code>或<code>pop3</code></li><li><code>user</code>后面是用户名，可以是username，也可以是邮箱地址</li><li><code>password</code>后面是密码</li></ul></li><li><a href=https://zhuanlan.zhihu.com/p/376290375><code>sslproto</code></a>：可能会报错 <code>fetchmail: pop.qq.com: upgrade to TLS failed.</code>，故可以禁掉SSL，同 man 手册查到<ul><li>加上option <code>--nosslcertck</code>，虽然有报错，但至少可以收邮件了。</li><li>加<code>--sslprotocl ''</code>, 注意要用空字符串</li></ul></li><li>四选一：<ul><li><code>nofetchall</code> ：仅检索新消息（默认）。</li><li><code>fetchall</code> ：获取所有消息，无论是否看到。</li><li><code>keep</code> ：不要从服务器上删除看到的消息。</li><li><code>nokeep</code> ：从服务器中删除看到的消息。</li></ul></li><li><code>mimedecode</code>用来自动解码MIME</li><li><code>mda</code>后面指定本机安装的邮件过滤分类程序。如果不填，则收取的邮件在本地不会保存。注意用<code>which procmail</code>查一下路径。</li><li><a href="https://support.microsoft.com/en-us/office/pop-imap-and-smtp-settings-for-outlook-com-d088b986-291d-42b8-9564-9c414e2aa040?ui=en-us&amp;rs=en-us&amp;ad=us#:~:text=If%20you%20want%20to%20add%20your%20Outlook.com%20account%2c587%209%20SMTP%20encryption%20method%20STARTTLS%20See%20More">Outlook 邮件客户端设置</a></li><li><a href="https://support.google.com/mail/answer/7126229?hl=en#zippy=">Gmail 邮件客户端设置</a></li><li><a href="https://service.mail.qq.com/cgi-bin/help?subtype=1&&amp;id=28&&amp;no=167">QQ 邮件客户端设置</a></li><li><a href="http://help.163.com/09/1223/14/5R7P3QI100753VB8.html?servCode=6010377">163 邮件客户端设置</a></li></ul><p>配置完成后，可以运行<code>fetcmail -v</code>来看看是否有错误信息，如果能够正常显示很多行的收取信息，那么就能正确登录邮箱收取了。</p><p>一般收取的命令如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 只收取未读邮件</span>
</span></span><span style=display:flex><span>$ fetchmai
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 收取所有邮件</span>
</span></span><span style=display:flex><span>$ fetchmail -a
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># （重要）收取新邮件，但不在服务器端删除已经收取的邮件</span>
</span></span><span style=display:flex><span>$ fetchmail -k
</span></span></code></pre></div><p>但是fetchmail只负责收取，不负责“下载”部分，你找不到邮件存在哪了。
所以还需要配置MDA分类器，如<code>procmail</code>，才能看到下载后的邮件。</p><p>注意：Fetch其实不是在Mutt“里”使用的，而是脱离mutt之外的！也就是说，Mutt只负责读取本地存储邮件的文件夹更新，而不会自动帮你去执行<code>fetchmail</code>命令。</p><p>你必须自己手动执行，或者用Crontab定期收取，或者设为Daemon守护进程，还可以在Mutt中设置快捷键执行Shell命令：</p><ul><li><p><a href=https://www.howtoing.com/debian_etch_fetchmail/>要使fetchmail作为守护进程运行</a>，我们必须编辑<code>/etc/default/fetchmail</code>并将START_DAEMON设置为yes</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi /etc/default/fetchmail
</span></span><span style=display:flex><span>START_DAEMON<span style=color:#f92672>=</span>yes
</span></span></code></pre></div><p>xxxxxxxxxx yum -y install tigervnc-servershell</p></li><li><p>设置Mutt快捷键收取邮件的方法是在<code>~/.muttrc</code>中加入macro：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-crystal data-lang=crystal><span style=display:flex><span><span style=color:#66d9ef>macro</span> <span style=color:#a6e22e>index</span>,pager I <span style=color:#960050;background-color:#1e0010>&#39;</span><span style=color:#f92672>&lt;</span>shell<span style=color:#f92672>-</span>escape<span style=color:#f92672>&gt;</span> fetchmail <span style=color:#f92672>-</span>vk<span style=color:#f92672>&lt;</span>enter<span style=color:#f92672>&gt;</span><span style=color:#960050;background-color:#1e0010>&#39;</span>
</span></span></code></pre></div><p>这样的话，你就可以在index邮件列表中按<code>I</code>执行外部shell命令收取邮件了。</p></li></ul><h4 id=邮件过滤配置procmailhttpslifegoopluskidorgwikiprocmailhtml><a href=https://lifegoo.pluskid.org/wiki/Procmail.html>邮件过滤：配置Procmail</a><a hidden class=anchor aria-hidden=true href=#邮件过滤配置procmailhttpslifegoopluskidorgwikiprocmailhtml>#</a></h4><p>Procmail是单纯负责邮件的存储、过滤和分类的，一般配合<code>fetchmail</code>收件使用。</p><p>在Pipline中，fetchmail把收到的邮件全部传送到Procmail进行过滤筛选处理，然后Procmail就会把邮件存到本地形成文件，然后给邮件分类为工作、生活、重要、垃圾等。</p><p>当然，分类规则是自己可以指定的。可以根据发信人、主题、长度以及关键字 等对邮件进行排序、分类、整理。</p><p>Procmail 的配置文件是 <code>~/.procmailrc</code> ，记得改权限：<code>chmod 600 ~/.procmailrc</code>。</p><p>内容也非常简单，前面是邮件位置、日志等默认选项，后面则是一块一块的过滤规则。</p><p>基本配置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 邮件存储地址</span>
</span></span><span style=display:flex><span>MAILDIR<span style=color:#f92672>=</span>$HOME/Mail   
</span></span><span style=display:flex><span><span style=color:#75715e># 默认：收件箱</span>
</span></span><span style=display:flex><span>DEFAULT<span style=color:#f92672>=</span>$MAILDIR/inbox   
</span></span><span style=display:flex><span>VERBOSE<span style=color:#f92672>=</span>off
</span></span><span style=display:flex><span>LOGFILE<span style=color:#f92672>=</span>/tmp/procmaillog
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 某个垃圾邮件规则</span>
</span></span><span style=display:flex><span>:0
</span></span><span style=display:flex><span>* ^From: webmaster@st<span style=color:#ae81ff>\.</span>zju<span style=color:#ae81ff>\.</span>edu<span style=color:#ae81ff>\.</span>cn
</span></span><span style=display:flex><span><span style=color:#75715e># 垃圾文件的存储位置</span>
</span></span><span style=display:flex><span>/dev/null    
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 其它所有都存到收件箱中</span>
</span></span><span style=display:flex><span>:0:
</span></span><span style=display:flex><span>inbox/
</span></span></code></pre></div><p>其中，<code>$HOME/Mail</code>是设定的邮件存储位置。</p><p>我们需要手动创建<code>mkdir ~/Mail</code>，否则程序会报错。</p><p>配置好后，我们再测试一下就会看到：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ fetchmail -a
</span></span><span style=display:flex><span><span style=color:#ae81ff>78</span> messages <span style=color:#66d9ef>for</span> 1664548605@qq.com at pop.qq.com <span style=color:#f92672>(</span><span style=color:#ae81ff>2843793</span> octets<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>reading message 1664548605@qq.com@pop.qq.com:1 of <span style=color:#ae81ff>78</span> <span style=color:#f92672>(</span><span style=color:#ae81ff>36692</span> octets<span style=color:#f92672>)</span> not flushed
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ tree ~/Mail
</span></span><span style=display:flex><span>/home/vane/Mail
</span></span><span style=display:flex><span>└── inbox
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ae81ff>0</span> directories, <span style=color:#ae81ff>1</span> file
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ du -h Mail/inbox 
</span></span><span style=display:flex><span>2.1M    Mail/inbox
</span></span></code></pre></div><p>可以看到，所有邮件都保存在了inbox这个单一文件中。这个文件可以打开看到MIME格式(协议)的邮件源码。就像HTML一样，展示给我们的和背后的源码不一样。</p><p>那么怎么把这个类似HTML的MIME格式邮件解析为我们人能读懂的内容呢？——这个我们就要靠<code>mutt</code>自己了，mutt自身具备基本的MIME邮件解析功能（不包括HTML格式邮件读取）。</p><h4 id=发件配置msmtp>发件：配置msmtp<a hidden class=anchor aria-hidden=true href=#发件配置msmtp>#</a></h4><p><code>msmtp</code>是作为<code>sendmail</code>发邮件程序更好的替代品。</p><p>msmtp的配置文件为<code>~/.msmtprc</code>，记得改权限：<code>chmod 600 ~/.msmtprc</code></p><p>配置内容比收件还简单，因为发件永远比收件简单。</p><p>基本配置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>account default
</span></span><span style=display:flex><span>  auth login
</span></span><span style=display:flex><span>  host smtp.XXX.com
</span></span><span style=display:flex><span>  port <span style=color:#ae81ff>587</span>
</span></span><span style=display:flex><span>  from ME@XXX.com
</span></span><span style=display:flex><span>  user ME
</span></span><span style=display:flex><span>  password passwd
</span></span><span style=display:flex><span>  <span style=color:#75715e># 关于tls，如果是阿里云则不用写，如果是Outlook的话，必须写</span>
</span></span><span style=display:flex><span>  tls on
</span></span><span style=display:flex><span>  tls_starttls off
</span></span><span style=display:flex><span>  tls_certcheck off
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># QQ 邮箱例子</span>
</span></span><span style=display:flex><span>account default
</span></span><span style=display:flex><span>  <span style=color:#75715e># QQ邮箱这里必须是 on，否则会 535 Login Fail</span>
</span></span><span style=display:flex><span>  auth on
</span></span><span style=display:flex><span>  host smtp.qq.com
</span></span><span style=display:flex><span>  port <span style=color:#ae81ff>587</span>
</span></span><span style=display:flex><span>  from 1664548605@qq.com
</span></span><span style=display:flex><span>  <span style=color:#75715e># user 必须是 @ 之前的部分，不能自定义，否则会 535 Login Fail</span>
</span></span><span style=display:flex><span>  user <span style=color:#ae81ff>1664548605</span>
</span></span><span style=display:flex><span>  password <span style=color:#f92672>[</span>授权码<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>  tls on
</span></span><span style=display:flex><span>  tls_starttls off
</span></span><span style=display:flex><span>  tls_certcheck off
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>logfile /tmp/msmtp.log
</span></span></code></pre></div><p>QQ 邮箱例子：<a href=https://www.cnblogs.com/IvanChen/p/5987928.html>使用mutt+msmtp在Linux命令行界面下发邮件</a>。</p><p>总之，哪怕QQ 邮箱设置对了，也要多试几次才能发送成功。</p><h4 id=主界面配置mutt>主界面：配置Mutt<a hidden class=anchor aria-hidden=true href=#主界面配置mutt>#</a></h4><p>Mutt的配置文件为<code>~/.muttrc</code>，记得改权限：<code>chmod 600 ~/.muttrc</code></p><p>另外：mutt的配置文件还可以放在<code>~/.mutt/muttrc</code>。这种方法有一个好处，即<code>~/.mutt/</code>目录下可以放很多主题、插件等文件。</p><p>基本配置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 通用设定</span>
</span></span><span style=display:flex><span>set use_from<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>set envelope_from<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span><span style=color:#75715e>#移动已读邮件</span>
</span></span><span style=display:flex><span>set move<span style=color:#f92672>=</span>yes    
</span></span><span style=display:flex><span><span style=color:#75715e>#回复的时候调用原文</span>
</span></span><span style=display:flex><span>set include 
</span></span><span style=display:flex><span>set charset<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;utf-8&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#自动显示HTML</span>
</span></span><span style=display:flex><span>auto_view text/html   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 发送者账号</span>
</span></span><span style=display:flex><span>set realname<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Vane Hsiung&#34;</span>
</span></span><span style=display:flex><span>set from<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;1664548605@qq.com&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 分类邮箱</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#Mail box type</span>
</span></span><span style=display:flex><span>set mbox_type <span style=color:#f92672>=</span> Maildir 
</span></span><span style=display:flex><span>set folder <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/Mail&#34;</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#INBOX</span>
</span></span><span style=display:flex><span>set spoolfile <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/Mail/inbox&#34;</span> 
</span></span><span style=display:flex><span><span style=color:#75715e>#Seen box</span>
</span></span><span style=display:flex><span>set mbox<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/Mail/seen&#34;</span> 
</span></span><span style=display:flex><span><span style=color:#75715e>#Sent box</span>
</span></span><span style=display:flex><span>set record<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/Mail/sent&#34;</span>  
</span></span><span style=display:flex><span><span style=color:#75715e>#Draft box</span>
</span></span><span style=display:flex><span>set postponed<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/Mail/draft&#34;</span>  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 关联程序（需要自己用which命令确定一下）</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 默认使用 nano</span>
</span></span><span style=display:flex><span>set editor<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;vim&#34;</span>
</span></span><span style=display:flex><span>set sendmail<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/usr/bin/msmtp&#34;</span>
</span></span></code></pre></div><p>以上如果有什么问题，可参考<a href=https://gist.github.com/iharsuvorau/45a078ecb597eb916fdf>etchmail + proc + msmtp + mutt configuration samples</a>。</p><h4 id=确认邮箱服务器>确认邮箱服务器<a hidden class=anchor aria-hidden=true href=#确认邮箱服务器>#</a></h4><p>即使上面配置一切OK，也不一定能正常收发邮件。因为你用的Gmail、QQ、网易、阿里云等等，后台都有一系列的第三方收取设置。这是各不相同的。</p><p>除了第三方客户端的允许，我们还要设置POP。最好放开全部邮件或者最近30天，然后禁止客户端删信。这是什么意思呢？POP默认客户端在收件后，服务器上的邮件就自动删除了！这个不太合适，所以必须要禁止。</p><h4 id=基本操作httpslifehackercomhow-to-use-the-fast-and-powerful-mutt-email-client-with-5574557><a href=https://lifehacker.com/how-to-use-the-fast-and-powerful-mutt-email-client-with-5574557>基本操作</a><a hidden class=anchor aria-hidden=true href=#基本操作httpslifehackercomhow-to-use-the-fast-and-powerful-mutt-email-client-with-5574557>#</a></h4><p>邮件列表操作：</p><ul><li>基本：<code>q</code>:Quit, <code>d</code>:删除当前邮件, <code>s</code>:将邮件移动至指定文件夹, <code>m</code>:创建新邮件, <code>r</code>:回复当前邮件, <code>?</code>:帮助</li><li>移动：<code>j/k</code> 上下移动邮件, <code>z/Z</code>上下翻页, <code>&lt;Number></code> 跳至序号处（不进入邮件）</li><li><code>&lt;Enter></code> 打开选中的邮件</li><li><code>/</code>在当前文件夹搜索</li><li><code>d</code> 将选中邮件标记为删除, <code>N</code> 将选中邮件标记为未读, <code>$</code> 让标记的东西生效，如删除、未读等。</li><li><code>f</code> 转发选中邮件, <code>e</code> 编辑选中邮件</li><li><code>c</code>切换文件夹(inbox/seen/draft等), 需要输入文件夹名称，或按<code>?</code>在列表里选择，<code>j/k</code>上下移动。</li></ul><p>在邮件中的操作：</p><ul><li><code>j/k</code> 上一封／下一封邮件, <code>&lt;Space></code>: 向下翻页, <code>&lt;Enter></code>: 向下滚动</li><li><code>e</code> 编辑当前邮件, <code>t</code>编辑TO，<code>c</code>编辑CC，<code>b</code>编辑BCC，<code>y</code>发送邮件，<code>a</code>添加附件，<code>Return</code>查看附件，<code>E</code>编辑附件，<code>D</code>删除附件</li></ul><p><a href=https://gitlab.com/muttmua/mutt/-/wikis/MuttFaq/Action>使用命令操作</a>：</p><p>Mutt如同Vim一样，不光可以把命令绑定为快捷键，还能直接输入<code>:</code>直接输入命令。
但是稍有不同的是，Mutt称之为<code>Action</code>，而且需要用<code>:exec &lt;命令></code>这样格式执行。</p><p>比如sidebar侧边栏的移动，命令是：<code>sidebar-next</code>, <code>sidebar-prev</code>。
那么我们可以直接输入<code>:exec sidebar-next</code>，按下回车执行。</p><h3 id=irchttpswwwcnblogscomsztomp11173404html><a href=https://www.cnblogs.com/sztom/p/11173404.html>IRC</a><a hidden class=anchor aria-hidden=true href=#irchttpswwwcnblogscomsztomp11173404html>#</a></h3><h4 id=简介httpsenwikipediaorgwikiinternet_relay_chat><a href=https://en.wikipedia.org/wiki/Internet_Relay_Chat>简介</a><a hidden class=anchor aria-hidden=true href=#简介httpsenwikipediaorgwikiinternet_relay_chat>#</a></h4><p>芬兰人雅尔可·欧伊卡利宁（Jarkko Oikarinen）于1988年8月创造了IRC来取代一个叫做MUT的程序。</p><ul><li>IRC（Internet Relay Chat的缩写，“因特网中继聊天”）是一个位于应用层的协议。</li><li>其主要用于群体聊天，但同样也可以用于个人对个人的聊天。</li><li>一个IRC服务器可以连接其他的IRC服务器以扩展为一个IRC网络。</li><li>IRC 不强制注册；但如果你注册了，就可以强制把占用自己唯一 ID 的人踢下线。</li><li>IRC 协议简单，开源实现多，其第三方机器人程序非常众多，几乎每种语言都有一个实现。</li><li>IRC 是开源社区会议标准；因此，许多开源世界的技术大牛混在那里。</li></ul><p><a href=https://www.irchelp.org/>irchelp</a>：一个致力于帮助用户了解IRC的网站。</p><p><a href=http://tldp.org/HOWTO/IRC/index.html>IRC</a>：Linux文档项目的IRC HOWTO</p><h4 id=服务器>服务器<a hidden class=anchor aria-hidden=true href=#服务器>#</a></h4><p>首先要区分一些概念：</p><ul><li>Networks：是指的互相隔离的网络，如Libera.Chat和DALnet这些是世界知名的网络，但互相隔离，频道不共享。</li><li>Servers：Network网络中的某一台电脑服务器，你加入世界上任何一个server都能加入这个Network。IRC是一个分布式的客户端/服务器结构。通过连接到一个IRC服务器，我们可以访问这个服务器以及它所连接的其他服务器上的频道（即这个 Network 中所有频道）。</li></ul><p>频道存在于一个IRC服务器上。一个频道类似于一个聊天室，频道名称必须以<code>#</code>符号开始，例如<code>#irchelp</code>。</p><p>要使用IRC，必须先登录到一个IRC服务器上，Libera.Chat为免费和开源软件社区，非营利组织和相关社区提供讨论设施。（<a href=https://zh.wikipedia.org/zh-cn/Libera_Chat>在Freenode被安德鲁·李接管后</a>，Freenode的前成员创办了Freenode的替代服务Libera Chat。）</p><p>IRC使用的服务器端口有:</p><ul><li>6667（明文传输）</li><li>6697（SSL加密传输，如ircs://irc.libera.chat:6697）。</li></ul><p><a href=https://en.wikipedia.org/wiki/IRCd>IRCD</a>: 简称互联网中继聊天守护，是服务器软件实现了IRC 协议，使人们通过上网彼此交谈（交换文本即时消息）。</p><h4 id=客户端>客户端<a hidden class=anchor aria-hidden=true href=#客户端>#</a></h4><p>IRC用户透过客户端软件和服务器相连。</p><ul><li><a href=https://en.wikipedia.org/wiki/Comparison_of_Internet_Relay_Chat_clients>Internet Relay Chat客户端的比较</a></li><li><a href=https://ircv3.net/software/clients>IRCv3 Client Support</a></li></ul><p>常用客户端：</p><table><thead><tr><th>Client</th><th>Homepage</th><th>描述</th></tr></thead><tbody><tr><td>HexChat</td><td><a href=https://hexchat.github.io/>https://hexchat.github.io/</a></td><td>基于XChat的图形化IRC客户端。</td></tr><tr><td>Irssi</td><td><a href=https://irssi.org/>https://irssi.org/</a></td><td>支持IPv6的模块化文本UI IRC客户端。</td></tr><tr><td>Pidgin</td><td><a href=https://pidgin.im/>https://pidgin.im/</a></td><td>具有GTK +界面的流行即时消息客户端。</td></tr><tr><td>WeeChat</td><td><a href=https://weechat.org/>https://weechat.org/</a></td><td>便携式和多接口（文本，Web和GUI）IRC客户端。</td></tr><tr><td>Konversation</td><td><a href=https://konversation.kde.org/>https://konversation.kde.org/</a></td><td>基于KDE框架的用户友好型IRC客户端。</td></tr><tr><td>Polari</td><td><a href=https://wiki.gnome.org/Apps/Polari>https://wiki.gnome.org/Apps/Polari</a></td><td>GNOME的IRC客户端</td></tr><tr><td>ircii</td><td><a href=http://eterna.com.au/ircii/>http://eterna.com.au/ircii/</a></td><td>在大多数UNIX平台下运行的IRC和ICB客户端。</td></tr><tr><td>kvirc</td><td><a href=http://www.kvirc.net/>http://www.kvirc.net/</a></td><td>使用Qt GUI工具包的便携式IRC客户端。</td></tr><tr><td>Quassel</td><td><a href=https://quassel-irc.org/>https://quassel-irc.org/</a></td><td>Qt5 IRC客户端支持远程守护进程以实现全天候连接</td></tr></tbody></table><h4 id=irssihttpssegmentfaultcoma1190000018120591><a href=https://segmentfault.com/a/1190000018120591>Irssi</a><a hidden class=anchor aria-hidden=true href=#irssihttpssegmentfaultcoma1190000018120591>#</a></h4><p><strong>安装</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ apt install irssi
</span></span></code></pre></div><p>命令行输入<code>irssi</code>即进入了聊天室。</p><p>和一般Linux程序的一般命令、格式都不同，IRC客户端一般有自己的命令。窗口右下方<code>[(status)]</code>是输入命令的地方。</p><p>一般命令(不区分大小写)：</p><ul><li><code>/quit</code>，退出程序。一般的ctrl-c, ctrl-d, esc, q之类的都不管用</li><li><code>/help</code>，帮助</li><li><code>/network list</code> 查看已保存的服务器列表</li><li><code>/connect xxx.xxx.xxx</code> 连接某服务器。</li><li><code>/join xxx</code> 加入某channel</li><li><code>/leave</code>或<code>/part</code> 离开当前channel</li><li><code>/normal</code>或<code>/n</code> 查看当前channel的人数</li><li><code>/list -YES</code> 查看当前服务器的所有chennels (慎用)</li><li><code>/nick NewNickName</code> 更改当前昵称</li><li><code>/msg NickName Content</code> 给某人发送消息，一般都是给<code>/msg nickserv</code>管理人NPC发送消息</li></ul><p>常用快捷键：</p><ul><li><code>Alt + 1/2/3/4...</code>，切换window窗口，一般一个channel一个窗口</li><li><code>Alt + n/p</code>，上下滚动屏幕</li></ul><p><a href=http://www.ircbeginner.com/ircinfo/abbreviations.html>IRC 常用缩写词</a></p><p><strong>配置</strong></p><p>如果想长期保存、备份一个固定的程序配置，那么就需要修改配置文件。</p><p><code>irssi</code>默认的配置文件为<code>~/.irssi/config</code>。</p><p>配置中，会在第一次运行时就自动设置了一些，包括根据当前电脑账户的用户名设置<code>nickname</code>等。整个配置，是一直“类似”JSON的格式。</p><p><code>settings</code> ：记录自己的名字：nick, real_name, user_name</p><p><code>servers</code> ：这是指的Network而不是具体某台server，如Freenode、Dal、ESPer、EFnet等大型网络。服务器配置案例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>servers <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span> address <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;irc.dal.net&#34;</span>; chatnet <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;DALnet&#34;</span>; port <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;6667&#34;</span>; <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>      address <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;路径&#34;</span>;
</span></span><span style=display:flex><span>      chatnet <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;下面chatnet对应的名称&#34;</span>;
</span></span><span style=display:flex><span>      port <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;端口&#34;</span>;
</span></span><span style=display:flex><span>      autoconnect <span style=color:#f92672>=</span> true;
</span></span><span style=display:flex><span>      use_ssl <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;yes&#34;</span>;
</span></span><span style=display:flex><span>      password <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;用户名:密码&#34;</span>;
</span></span><span style=display:flex><span>  <span style=color:#f92672>}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>;
</span></span></code></pre></div><p><code>chatnets</code>：记录各个网络的登录信息，也可以作为“别名”，这样每次<code>/connect</code>不用输入全路径了。配置完每个服务器后，还要配置相应的<code>chatnets</code>，每一条的名称都要与<code>servers</code>中的对应。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>chatnets <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>    DALnet <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;IRC&#34;</span>;
</span></span><span style=display:flex><span>        max_kicks <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;4&#34;</span>; max_msgs <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;20&#34;</span>;max_whois <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;30&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>;
</span></span><span style=display:flex><span>    Freenode <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>        type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;IRC&#34;</span>;
</span></span><span style=display:flex><span>        max_kicks <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;4&#34;</span>; max_msgs <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;20&#34;</span>;max_whois <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;30&#34;</span>;
</span></span><span style=display:flex><span>        autosendcmd <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;/msg nickserv identify MyName MyPassword&#34;</span>;
</span></span><span style=display:flex><span>    <span style=color:#f92672>}</span>;
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>;
</span></span></code></pre></div><p><code>channels</code> ：记录自己收藏的频道名。RC的频道不是用URL之类很复杂的东西，全都是用<code>#tag</code>这种简单一个标签来区分的，非常好记。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>channels <span style=color:#f92672>=</span> <span style=color:#f92672>(</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span> name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#lobby&#34;</span>; chatnet <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;EsperNet&#34;</span>; autojoin <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;No&#34;</span>; <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span>  <span style=color:#f92672>{</span> name <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#freenode&#34;</span>; chatnet <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;Freenode&#34;</span>; autojoin <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;No&#34;</span>; <span style=color:#f92672>}</span>,
</span></span><span style=display:flex><span><span style=color:#f92672>)</span>;
</span></span></code></pre></div><p><code>statusbar</code>：界面美化的设置。目前IRSSI的世界里，唯一知名的主题只有<a href=https://github.com/ronilaukkarinen/weed>weed</a>。</p><h2 id=multimedia>Multimedia<a hidden class=anchor aria-hidden=true href=#multimedia>#</a></h2><h3 id=gstreamer>GStreamer<a hidden class=anchor aria-hidden=true href=#gstreamer>#</a></h3><h4 id=gstreamer-入门概念httpsthebigdocreadthedocsioenlatestgstreamergst-concepthtml><a href=https://thebigdoc.readthedocs.io/en/latest/gstreamer/gst-concept.html>GStreamer 入门概念</a><a hidden class=anchor aria-hidden=true href=#gstreamer-入门概念httpsthebigdocreadthedocsioenlatestgstreamergst-concepthtml>#</a></h4><h5 id=overview>Overview<a hidden class=anchor aria-hidden=true href=#overview>#</a></h5><p>GStreamer是一个多媒体框架，它可以允许你轻易地创建、编辑与播放多媒体文件，这是 通过创建带有很多特殊的多媒体元素的管道来完成的。</p><h5 id=管道-pipeline>管道-pipeline<a hidden class=anchor aria-hidden=true href=#管道-pipeline>#</a></h5><p>GStreamer的工作方式非常简单，你只需创建一个包含很多元素的管道，这与Linux命令行 的管道非常类似，例如，一般命令行的管道是这样的:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ps ax | grep <span style=color:#e6db74>&#34;apache&#34;</span> | wc -l
</span></span></code></pre></div><p>这个命令首先捕获一个进程列表然后返回名字包含 “apache” 的进程并传递给 wc 命令并 统计出行数。我们可以看出每一个使用 <code>|</code> 连接，并且 <code>|</code> 左边的命令的输出传递 给其右边的命令作为输入。</p><p>GStreamer的工作方式与此类似，GStreamer中你将很多元素串联起来，每一个元素都完成 某些特定的事。我们来演示一下:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>gst-launch-1.0 filesrc location<span style=color:#f92672>=</span>越单纯越幸福.mp3 ! decodebin ! audioconvert ! alsasink
</span></span></code></pre></div><p>运行这条命令你就可以听到动听的音乐了，当然前提是你的当前目录有这个音乐文件。</p><p><code>gst-launch-1.0</code> 可以用来运行 GStreamer 管道，你只需要将需要使用的元素一个一个 传递给它就可以了，每一个命令使用 <code>!</code> 来连接。此处你可以把 <code>!</code> 当作命令行里 的 <code>|</code> 。上面那条命令包含了几个元素，我们简单解释一下：</p><ol><li>filesrc：这个元素从本地磁盘加载了一个文件，使用该元素时你设置了 <em>location</em> 属性指向了音乐文件，关于属性我们后边聊。</li><li>decodebin：我们需要从 <em>filesrc</em> 解码，因此我们使用了这个元素。这个元素是一个 聪明的小家伙，它会自动检测文件的类型并在后台构造一些GStreamer元素来解码。因此， 此处对于 mp3 你可以使用 mad 代替之试一下。</li><li>audioconvert：一个声音文件中有各种各样的信息，每种信息传递到喇叭都是不同的， 因此要使用此元素来做一下转换。</li><li>alsasink：这个元素做的事很简单，就是把你的音频使用ALSA传递给你的声卡。</li></ol><p>文章写到这里，我们就可以使用管道来做各种试验了，但首先我们要知道有那些元素可以 使用啊:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gst-inspect-1.0
</span></span></code></pre></div><p>这个命令列出了可用的元素，你也可以使用该命令查看某一元素的详细信息，例如 filesrc 元素:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gst-inspect-1.0 filesrc
</span></span></code></pre></div><p>下面介绍一些GStreamer的相关术语，一些人可能很快就会对 <em>pad</em>, <em>cap</em> 这些术语搞晕， 就不要说 <em>bin</em> 和 <em>ghost pad</em> 了。其实这些术语都相当的简单。。。</p><h5 id=元素element>元素element<a hidden class=anchor aria-hidden=true href=#元素element>#</a></h5><p>其实我们已经讨论了管道，而元素就在管道上。每一个元素都有很多属性用来设置该元素。 例如， <em>volume</em> 元素（设置管道的音量）有一个熟悉 <strong>volume</strong> 可以设置音量或者静音。 当你创建自己的管道时就要给很多的元素设置属性。</p><h5 id=pad>pad<a hidden class=anchor aria-hidden=true href=#pad>#</a></h5><p>每一个元素都有虚拟的插头供数据流入和流出，即pad。如果你把元素看作一个对输入的 数据做一些处理的黑盒。在盒子的左右两边就是插孔了，你可以插入电缆向盒子传入信息， 这就是pad要做的事。绝大多数元素有一个输入pad（叫做sink）和一个输出pad(叫做src)。 因此，我们上面的管道看起来是这样的:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>src<span style=color:#f92672>]</span> ! <span style=color:#f92672>[</span>sink src<span style=color:#f92672>]</span> ! <span style=color:#f92672>[</span>sink src<span style=color:#f92672>]</span> ! <span style=color:#f92672>[</span>sink<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>最左边的元素只有一个src pad用来提供信息（如filesrc）。接下来的几个元素接收信息并 做一些处理，因此他们有sink和src pad（例如decodebin和audiocovert），最后一个元素 只接收信息（例如alsasink）。当你使用 <code>gst-inspect-1.0</code> 命令查看一个元素的详细 信息时，就会列出该元素的pad信息。</p><p>注意可能与平时大家认为的概念有些不同的是，src pad是用来发送数据的端点，即数据的 输出端；而sink pad是用来接收数据的端点，即数据的输入端。</p><p>而且，一般来说，src pad只能连接到sink pad。当然，没有例外的规则是不存在的， ghost pad两端就要连接相同类型的pad，具体请参考后面的例子吧。</p><h5 id=cap>cap<a hidden class=anchor aria-hidden=true href=#cap>#</a></h5><p>我们已经了解了pad和从管道第一个元素到最后一个元素的数据流是怎么回事了，那么我们 来讨论下 <em>cap</em> 。每一个元素都有特定的cap，cap是指该元素可以接收什么样的信息（ 例如是接收音频还是视频）。你可以把cap看成是电源插座上其可以接受什么范围电压的规则。</p><h5 id=bin>bin<a hidden class=anchor aria-hidden=true href=#bin>#</a></h5><p>很多人不理解bin，其实它很简单。bin就是一种便捷的方式，可以把很多个元素放进一个 容器中。例如你有很多个元素用来解码视频并对其使用一些效果。要使事情变得简单一些， 你可以把这些元素放进一个bin（就像一个容器）中，以后你就可以使用bin来引用这些元素了。 这样其实bin变成了一个元素，例如你的管道是 <code>a ! b ! c ! d</code> ，你可以把他们放进 mybin，这样当你使用mybin时其实是引用了 <code>a ! b ! c ! d</code> 。</p><h5 id=ghost-pad>ghost pad<a hidden class=anchor aria-hidden=true href=#ghost-pad>#</a></h5><p>当你创建了一个bin并在里面放置了很多元素时，该bin变成了你自定义的元素，该元素按 顺序调用里面的元素。要做到这样，你的bin很自然地需要它自己的pad，它自己的pad会挂接 到bin里面元素的pad上，这就是 <em>ghost pad</em> 了。当你创建一个bin时，你创建了ghost pad 并告诉他们要去挂接里面哪一个元素。</p><h4 id=gstreamer-系列httpswwwcnblogscomxlengtaggstreamer><a href=https://www.cnblogs.com/xleng/tag/gstreamer/>GStreamer 系列</a><a hidden class=anchor aria-hidden=true href=#gstreamer-系列httpswwwcnblogscomxlengtaggstreamer>#</a></h4><h3 id=ffmpeghttpswwwruanyifengcomblog202001ffmpeghtml><a href=https://www.ruanyifeng.com/blog/2020/01/ffmpeg.html>FFmpeg</a><a hidden class=anchor aria-hidden=true href=#ffmpeghttpswwwruanyifengcomblog202001ffmpeghtml>#</a></h3><ul><li>powershell 执行与在 cmd 执行不一样，poweshell 某些 <code>-c:v</code> 会报错</li><li>ffmpeg 输出参数含义<ul><li>frame: 编码的帧数量</li><li>fps：每秒编码的帧数</li><li>q：质量因子</li><li>size/ Lsize：视频和音频编码后的大小，即基本等于视频和音频 之和</li><li>time：输出帧的显示时间</li><li>bitrate：输出视频的比特率</li><li>dup：输入帧重复（duplicate）的数量</li><li>drop：输入帧丢弃（drop）的个数</li><li>speed：编码速度</li></ul></li></ul><p>视频文件本身其实是一个容器（container），里面包括了视频和音频，也可能有字幕等其他内容。</p><p>视频和音频都需要经过编码，才能保存成文件。不同的编码格式（CODEC），有不同的压缩率，会导致文件大小和清晰度的差异。</p><p>编码器（encoders）是实现某种编码格式的库文件。只有安装了某种格式的编码器，才能实现该格式视频/音频的编码和解码。</p><p>FFmpeg 的命令行参数非常多，可以分成五个部分：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg <span style=color:#f92672>[</span>全局参数<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>输入文件参数<span style=color:#f92672>]</span> -i 输入文件 <span style=color:#f92672>[</span>输出文件参数<span style=color:#f92672>]</span> <span style=color:#f92672>[</span>输出文件<span style=color:#f92672>]</span>
</span></span></code></pre></div><h4 id=常用参数>常用参数<a hidden class=anchor aria-hidden=true href=#常用参数>#</a></h4><ul><li><code>-c</code>：指定编码器</li><li><code>-c copy</code>：直接复制，不经过重新编码（这样比较快）</li><li><code>-c:v</code>：指定视频编码器</li><li><code>-c:a</code>：指定音频编码器</li><li><code>-i</code>：指定输入文件</li><li><code>-an</code>：去除音频流</li><li><code>-vn</code>： 去除视频流</li><li><code>-preset</code>：指定输出的视频质量，会影响文件的生成速度，有以下几个可用的值 ultrafast, superfast, veryfast, faster, fast, medium, slow, slower, veryslow。</li><li><code>-y</code>：不经过确认，输出时直接覆盖同名文件。</li></ul><h4 id=查看视频文件的元信息>查看视频文件的元信息<a hidden class=anchor aria-hidden=true href=#查看视频文件的元信息>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i input.mp4 -hide_banner
</span></span></code></pre></div><h4 id=转换编码格式>转换编码格式<a hidden class=anchor aria-hidden=true href=#转换编码格式>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i <span style=color:#f92672>[</span>input.file<span style=color:#f92672>]</span> -c:v libx264 output.mp4
</span></span></code></pre></div><p>转成 H.264 编码，一般使用编码器 libx264</p><h4 id=转换容器格式>转换容器格式<a hidden class=anchor aria-hidden=true href=#转换容器格式>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i input.mp4 -c copy output.mkv
</span></span></code></pre></div><h4 id=改变分辨率>改变分辨率<a hidden class=anchor aria-hidden=true href=#改变分辨率>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i input.mp4 -vf scale<span style=color:#f92672>=</span>720:-1 output.mp4
</span></span></code></pre></div><h4 id=提取视频>提取视频<a hidden class=anchor aria-hidden=true href=#提取视频>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i input.mp4 -an -c:v copy ouput.mp4
</span></span></code></pre></div><p><code>-vcodec codec</code> 强制使用codec编解码方式。如果用copy表示原始编解码数据必须被拷贝。</p><h4 id=提取音频>提取音频<a hidden class=anchor aria-hidden=true href=#提取音频>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i input.mp4 -vn -c:a copy output.aac
</span></span></code></pre></div><p><code>-c:a copy</code>表示不改变音频编码，直接拷贝。</p><h4 id=添加音轨>添加音轨<a hidden class=anchor aria-hidden=true href=#添加音轨>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i input.aac -i input.mp4 output.mp4
</span></span></code></pre></div><h4 id=音视频合成>音视频合成<a hidden class=anchor aria-hidden=true href=#音视频合成>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i video.mp4 -i audio.aac -c:v copy -c:a copy output.mp4
</span></span></code></pre></div><h4 id=截图>截图<a hidden class=anchor aria-hidden=true href=#截图>#</a></h4><p>从指定时间开始，连续对1秒钟的视频进行截图</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -y -i input.mp4 -ss 00:01:24 -t 00:00:01 output_%3d.jpg
</span></span></code></pre></div><p>指定只截取一帧</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -ss 01:23:45 -i input.mp4 -vframes <span style=color:#ae81ff>1</span> -q:v <span style=color:#ae81ff>2</span> output.jpg
</span></span></code></pre></div><p><code>-vframes 1</code>指定只截取一帧，<code>-q:v 2</code>表示输出的图片质量，一般是1到5之间（1 为质量最高）。</p><h4 id=裁剪>裁剪<a hidden class=anchor aria-hidden=true href=#裁剪>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -ss <span style=color:#f92672>[</span>start<span style=color:#f92672>]</span> -i <span style=color:#f92672>[</span>input<span style=color:#f92672>]</span> -t <span style=color:#f92672>[</span>duration<span style=color:#f92672>]</span> -c copy <span style=color:#f92672>[</span>output<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>$ ffmpeg -ss <span style=color:#f92672>[</span>start<span style=color:#f92672>]</span> -i <span style=color:#f92672>[</span>input<span style=color:#f92672>]</span> -to <span style=color:#f92672>[</span>end<span style=color:#f92672>]</span> -c copy <span style=color:#f92672>[</span>output<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>裁剪（cutting）指的是，截取原始视频里面的一个片段，输出为一个新视频。可以指定开始时间（start）和持续时间（duration），也可以指定结束时间（end）。</p><h4 id=添加字幕httpswwwjianshucompf33910818a1c><a href=https://www.jianshu.com/p/f33910818a1c>添加字幕</a><a hidden class=anchor aria-hidden=true href=#添加字幕httpswwwjianshucompf33910818a1c>#</a></h4><ul><li>外挂字幕：一个单独的外部字幕文件，格式类型一般有srt、vtt、ass等等。播放视频时，需要把外挂字幕和视频放在同一目录下，并在播放器中选择字幕文件才可以在视频中看到字幕。</li><li>软字幕：也叫内挂字幕、封装字幕、内封字幕，字幕流等，就是把前面的外挂字幕的字幕文件嵌入到视频中作为流的一部分，如果一个视频有多个字幕流那么播放视频是还得选择对应的字幕流</li><li>硬字幕：是嵌入到视频帧里面的字幕，它就像视频水印一样作为视频帧的一分部分了，不管再任何平台字幕看起来都是一样的，而且也不再要求播放器单独对字母进行渲染</li></ul><p>常见的字幕格式有：</p><ul><li>SRT（标准外挂字幕格式）：只包含文字和时间码，没有样式，显示效果由播放器决定，不同的播放器显示出的效果可能差别很大。</li><li>ASS（高级外挂字幕格式）：支持样式、字体、字幕定位、淡入淡出、简单的特效。如果不缺字体，不同的播放器显示效果基本一致。</li></ul><p>ffmpeg字幕处理流程(容器是否支持字幕流指的是输出容器)</p><p><img loading=lazy src=/Distributions/ffmpeg.webp alt></p><p>添加软字幕：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i video.mp4 -i subtitle.srt -c copy output.mkv
</span></span></code></pre></div><p>软字幕只有部分容器格式比如(mkv)才支持，MP4/MOV等不支持，而且也只有部分播放器支持软字幕或者外挂字幕(如VLC播放器)。</p><p>添加多个字幕：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>ffmpeg -i input.mp4 -i zh_CN.srt -i en_US.srt -map 0:v -map 0:a -map <span style=color:#ae81ff>1</span> -map <span style=color:#ae81ff>2</span>  -c:v copy -c:a copy -metadata:s:s:0 language<span style=color:#f92672>=</span>chn -metadata:s:s:1 language<span style=color:#f92672>=</span>eng <span style=color:#e6db74>&#34;output.mp4&#34;</span>
</span></span></code></pre></div><ul><li><code>-map</code> 是轨道参数，如果只有一个字幕，就不需要这个参数。<code>-map 0:v</code> 表示第一个文件输入视频轨道，<code>-map 0:a</code> 表示第二个轨道是第一个文件输入的音频轨道，<code>-map 1</code> 建立第三个轨道，<code>-map 2</code> 建立第四个轨道。如果没添加 map 参数，默认就只有一个字幕轨道，第二个英文字幕会覆盖第一个中文字幕轨道。</li><li><code>-metadata:s:s:0 language=chn</code> 第一条字幕的语言设置为中文，<code>-metadata:s:s:1 language=eng</code> 第二条字幕的语言设置为英文。 <code>language</code> 不能自定义，只能设置成固定的缩写。</li></ul><p>添加硬字幕：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i video.mkv -vf subtitles<span style=color:#f92672>=</span>subtitle.srt out.mp4
</span></span></code></pre></div><h4 id=下载-m3u8httpswww51ctocomarticle558658html><a href=https://www.51cto.com/article/558658.html>下载 m3u8</a><a hidden class=anchor aria-hidden=true href=#下载-m3u8httpswww51ctocomarticle558658html>#</a></h4><p>现在比较常见的视频流媒体，大部分都是 m3u8 格式的，而对于 m3u8 格式的视频而言，如果你下载过，你会发现它就是一个文本文件，大概也就只有几十 kb，从磁盘大小来看，应该也知道它并不是一个直接的视频文件。</p><p><strong>什么是 m3u8</strong></p><p>说到 m3u8 就要先说说 HLS（HTTP Live Streaming）。HLS 是 Apple 公司针对 iPhone、iPod、iTouch 等移动设备，而研发的基于 HTTP 协议的流媒体解决方案。在 HLS 技术中，Web 服务器可以向客户端提供接近实时的音视频流，但是它又是使用的标准的 HTTP 协议。所以基本上，比较大型的点播直播类服务，都是基于 HLS 的。</p><p>而该技术的原理，就是将视频文件或者视频流，进行切片（ts文件），并建立索引文件（m3u8），它支持的视频流编码为 H.264，音频流编码为 AAC。</p><p>简单来说，基于 HLS 的视频流，会将完整的视频，切割成一个个比较小的视频片段（ts 文件），然后根据协议组合成一个 m3u8 文件。这些比较小的 ts 文件，是可以单独播放的。而视频播放器，拿到 m3u8 文件之后，根据对其内 ts 片段的索引，连续播放不同的视频片段，来达到流畅的播放效果。</p><p><strong>下载的 m3u8 文件</strong></p><p>说这些概念都没用，我们来看两个真实的被下载的 m3u8 文件。</p><p><img loading=lazy src=/Distributions/4dda38f226d35487c838575d86125b9b.jpg alt=img></p><p>这种 m3u8 文件就还是比较清晰的，能看到它一个个的片段。但是需要注意的是，这里的片段，全部是基于域名的相对地址，也就是说，这样一个 m3u8 文件，你丢到播放器里，是无法播放的，但是如果你记录了原始下载这个 m3u8 的链接，它在播放器里是可以正常播放的。</p><p>当然，如果你修改这个 m3u8 文件，将它相对路径拼接上域名地址，也是可以达到播放的效果的。</p><p>再来看看另外一种 m3u8 文件，它其内的 ts 片段，都是完整地址。</p><p><img loading=lazy src=/Distributions/231561a1c6ac4f063f05c72257701e35.jpg alt=img></p><p>像这种具有完整地址的 ts 片段，哪怕你将它保存成一个本地的文件，播放器依然是可以直接播放的，不过这里本质上依然是在在线播放。</p><p>这两中 m3u8 文件，虽然有细微的差别，但是它们都是基于标准的协议。</p><p>简单总结一下：</p><ol><li>m3u8 不是视频内容的文件，它占用的磁盘空间非常的小。</li><li>m3u8 文件，如果其内的 ts 片段，是完整地址，则可以保存后播放，否者只能在线播放。</li><li>播放器播放 m3u8 文件的时候，实际上，还是在线从线上获取的视频流进行播放，所以是存在失效的情况的。</li></ol><p>暂时知道这三点就可以了，接下来我们再看如何将一个 m3u8 文件，下载成一个 mp4 视频文件。</p><p><strong>使用 fmpeg 下载 m3u8</strong></p><p>ffmpeg 是一套可以用来记录、转换音视频，并将其转化为流的开源程序，采用 LGPL 或 GPL 协议许可证书，很多大型的音视频软件，内部都是基于 ffmpeg 的。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i <span style=color:#e6db74>&#34;m3u8_file_uri&#34;</span> <span style=color:#e6db74>&#34;save_video.mp4&#34;</span> 
</span></span></code></pre></div><p>到此，如果 m3u8 的链接正确可播放，就会开始下载，等待下载完成就可以了，最终会在指定目录下，保存 save_video.mp4 文件，它就是最终我们下载的离线视频文件。</p><p><a href=https://www.zhihu.com/question/354737430/answer/2168822179><strong>blob url</strong></a></p><p>想下载淘宝上一个视频，打开控制台审查元素定位到video标签发现视频地址是blob:https开头，不能直接下载，可能是网站为了防止下载使用这种方式做了保护，用这种的大部分原始视频都是m3u8格式。</p><p>获取blob真实地址：控制台单击network filter里输入.m3u8 刷新浏览器重新拉取资源，出现的就是m3u8地址，把他复制下来用 ffmpeg 下载就可以了</p><h4 id=webm-to-gifhttpsaskubuntucomquestions506670how-to-do-i-convert-an-webm-video-to-a-animated-gif-on-the-command-line><a href=https://askubuntu.com/questions/506670/how-to-do-i-convert-an-webm-video-to-a-animated-gif-on-the-command-line>webm to gif</a><a hidden class=anchor aria-hidden=true href=#webm-to-gifhttpsaskubuntucomquestions506670how-to-do-i-convert-an-webm-video-to-a-animated-gif-on-the-command-line>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ffmpeg -i input.webm -pix_fmt rgb8 output.gif
</span></span></code></pre></div><h3 id=mkvtoolnixhttpsmkvtoolnixdownloaddownloadshtml><a href=https://mkvtoolnix.download/downloads.html>MKVToolNix</a><a hidden class=anchor aria-hidden=true href=#mkvtoolnixhttpsmkvtoolnixdownloaddownloadshtml>#</a></h3><p><em>MKVToolNix</em> is a set of tools to create, alter and inspect <a href=http://www.matroska.org/>Matroska</a>(mkv) files under Linux, other Unices and Windows.</p><p>轨道提取模式：</p><pre tabindex=0><code>mkvextract 输入文件名 tracks [选项] TID1:目标文件名1 [TID2:目标文件名2 ...]
</code></pre><p>TID:输出文件名 如果输入文件中存在 ID 为 TID 的轨道，则将其提取为文件 输出文件名。轨道 ID 与 <code>mkvmerge --identify 文件</code> 选项所输出的相同。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mkvextract <span style=color:#e6db74>&#34;Another Movie.mkv&#34;</span> tracks 0:video.h265 <span style=color:#e6db74>&#34;1:main audio.aac&#34;</span>
</span></span></code></pre></div><h3 id=rhythmboxhttpszhtweyewatedcomrhythmboxe79a84e5ae8ce695b4e68c87e58d97><a href=https://zhtw.eyewated.com/rhythmbox%E7%9A%84%E5%AE%8C%E6%95%B4%E6%8C%87%E5%8D%97/>Rhythmbox</a><a hidden class=anchor aria-hidden=true href=#rhythmboxhttpszhtweyewatedcomrhythmboxe79a84e5ae8ce695b4e68c87e58d97>#</a></h3><h4 id=music>Music<a hidden class=anchor aria-hidden=true href=#music>#</a></h4><p>搜 &ldquo;无损音乐&rdquo; &ldquo;车载音乐&rdquo; 打包下载。</p><p><strong>將音樂從計算機上的文件夾導入</strong></p><p>為了使用Rhythmbox，您需要創建一個音樂庫。要做到這一點，請點擊“導入”按鈕。點擊“選擇位置”下拉菜單，然後在計算機上選擇一個包含音樂的文件夾。</p><h4 id=prodcast播客>Prodcast/播客<a hidden class=anchor aria-hidden=true href=#prodcast播客>#</a></h4><p>通过 feed 链接订阅，查看<a href=https://getpodcast.xyz/#%E6%92%AD%E5%AE%A2>播客 Feed 订阅</a>：</p><ul><li><a href=https://www.lizhi.fm/user/55587>哈喽怪谈</a>：http://rss.lizhi.fm/rss/21628.xml</li><li><a href=https://www.ximalaya.com/album/3558668>黑水公园</a>：https://www.ximalaya.com/album/3558668.xml</li></ul><p>喜马拉雅的播客feed是 <code>https://www.ximalaya.com/album/[ID].xml</code>，即在播客url后添加<code>.xml</code>就行，但是只限于免费的。</p><h4 id=radio电台>Radio/电台<a hidden class=anchor aria-hidden=true href=#radio电台>#</a></h4><p><strong>互聯網廣播</strong></p><p>廣播電台列表將出現在Ambient到Underground的各種類別中。 選擇您想收聽的電台並點擊播放圖標。</p><p>如果您希望收聽的廣播電台沒有出現，請點擊“添加”並輸入廣播電台供稿的URL。</p><p><strong>其他收听方式</strong></p><p>一种方式是通过传统的无线电收音机收听，一般手机上带有 Radio 软件，需插上有线耳机才能收听。</p><p>另一种方式是通过各种平台收听，例如喜马拉雅、蜻蜓FM、央广的<a href=https://www.radio.cn/><strong>云听</strong></a>等，这种收听方式可以在浏览器 DevTool 中得 Network 栏中获取播放链接。</p><p><strong>电台推荐</strong></p><ul><li><a href=https://www.zhihu.com/question/340528796>有哪些地方广播电台值得推荐？</a>：央广中国之声、国广环球资讯、国广Hit FM、央广音乐之声、北京Metro Radio、上海KFM、国广EZFM</li><li><a href=https://www.zhihu.com/question/25332694>中国有哪些值得推荐的音乐电台？</a>：上海动感101、国广HitFM、央广音乐之声、广东怀集音乐之声、北京Metro Radio、北京动听调频、河北音乐广播、浙江音乐调频、厦门音乐广播</li></ul><p><a href=https://medium.com/@k21_79139/%E4%B8%AD%E5%9C%8B%E9%9B%BB%E5%8F%B0%E7%9B%B4%E6%92%AD%E6%BA%90%E5%88%97%E8%A1%A8-61733d389509><strong>中國電台直播源列表</strong></a></p><p>中國國際廣播電台（CRI）</p><ul><li>中文環球：http://sk.cri.cn/hyhq.m3u8</li><li>世界華聲：http://sk.cri.cn/hxfh.m3u8</li><li>南海之聲：http://sk.cri.cn/nhzs.m3u8</li><li>英语资讯广播：http://sk.cri.cn/am846.m3u8</li><li>環球資訊：http://sk.cri.cn/905.m3u8</li><li>輕鬆調頻：http://sk.cri.cn/915.m3u8</li><li>劲曲调频：http://sk.cri.cn/887.m3u8</li></ul><p>中國中央人民廣播電台（CNR）</p><ul><li>中國之聲：http://ngcdn001.cnr.cn/live/zgzs/index.m3u8</li><li>經濟之聲：http://ngcdn002.cnr.cn/live/jjzs/index.m3u8</li><li>音樂之聲 ：http://ngcdn003.cnr.cn/live/yyzs/index.m3u8</li><li>經典音樂廣播：http://ngcdn004.cnr.cn/live/dszs/index.m3u8</li><li>中華之聲：http://ngcdn005.cnr.cn/live/zhzs/index.m3u8</li><li>神州之聲：http://ngcdn006.cnr.cn/live/szzs/index.m3u8</li><li>大湾区之声：http://ngcdn007.cnr.cn/live/hxzs/index.m3u8</li><li>香港之聲：http://ngcdn008.cnr.cn/live/xgzs/index.m3u8</li><li>民族之聲：http://ngcdn009.cnr.cn/live/mzzs/index.m3u8</li><li>文藝之聲：http://ngcdn010.cnr.cn/live/wyzs/index.m3u8</li><li>老年之聲：http://ngcdn011.cnr.cn/live/lnzs/index.m3u8</li><li>藏語廣播：http://ngcdn012.cnr.cn/live/zygb/index.m3u8</li><li>維吾爾語廣播：http://ngcdn013.cnr.cn/live/wygb/index.m3u8</li><li>阅读之声：http://ngcdn014.cnr.cn/live/ylgb/index.m3u8</li><li>中國交通廣播：http://ngcdn016.cnr.cn/live/gsgljtgb/index.m3u8</li><li>中國鄉村之聲：http://ngcdn017.cnr.cn/live/xczs/index.m3u8</li><li>中國民樂：http://ngcdn021.cnr.cn/live/zgmy/index.m3u8</li><li>古典音樂：http://ngcdn022.cnr.cn/live/gdyy/index.m3u8</li><li>相聲小品：http://ngcdn023.cnr.cn/live/xsxp/index.m3u8</li><li>長篇聯播：http://ngcdn024.cnr.cn/live/cplb/index.m3u8</li><li>哈薩克語廣播：http://ngcdn025.cnr.cn/live/hygb/index.m3u8</li></ul><p>香港电台（RTHK）</p><ul><li>RTHK1 第一台：https://rthkaudio1-lh.akamaihd.net/i/radio1_1@355864/master.m3u8</li><li>RTHK2 第二台：https://rthkaudio2-lh.akamaihd.net/i/radio2_1@355865/master.m3u8</li><li>RTHK3 第三台：https://rthkaudio3-lh.akamaihd.net/i/radio3_1@355866/master.m3u8</li><li>RTHK4 第四台：https://rthkaudio4-lh.akamaihd.net/i/radio4_1@355867/master.m3u8，古典音乐台</li><li>RTHK5 第五台：https://rthkaudio5-lh.akamaihd.net/i/radio5_1@355868/master.m3u8</li><li>RTHK6 第六台：https://rthkaudio6cnr-lh.akamaihd.net/i/radio6cnr_1@575604/master.m3u8 ，转播 CNR-香港之声</li><li>RTHK 普通话台：https://rthkaudio6-lh.akamaihd.net/i/radiopth_1@355869/master.m3u8</li></ul><p><strong>其他直播源</strong></p><ul><li><a href=https://www.ximalaya.com/radio/1769>AsiaFM亚洲热歌台</a>：https://live.ximalaya.com/radio-first-page-app/live/1908/64.m3u8</li><li><a href=https://www.qingting.fm/radios/5022023>上海KFM</a>：https://lhttp.qtfm.cn/live/5022023/64k.mp3</li><li><a href=https://tingfm.com/radio/223>上海动感101</a>：https://lhttp.qingting.fm/live/274/64k.mp3</li><li><a href=https://tingfm.com/radio/153>怀集音乐之声</a>：https://lhttp.qingting.fm/live/4804/64k.mp3</li><li><a href=https://tingfm.com/radio/947>北京动听调频Metro Radio</a>：https://lhttp.qingting.fm/live/5022463/64k.mp3</li><li><a href=https://tingfm.com/radio/243>河北音乐广播</a>：https://lhttp.qingting.fm/live/1649/64k.mp3</li><li><a href=https://tingfm.com/radio/446>动听968·浙江音乐调频</a>：https://lhttp.qingting.fm/live/4866/64k.mp3</li><li><a href=https://tingfm.com/radio/103>厦门音乐广播</a>：https://lhttp.qingting.fm/live/1739/64k.mp3</li><li>亚洲电台：https://stream.rcs.revma.com/xpgtqc74hv8uv</li><li>亚太电台：https://stream.rcs.revma.com/kydend74hv8uv</li><li>飞扬调频：https://stream.rcs.revma.com/e0tdah74hv8uv</li></ul><p><strong>International</strong></p><ul><li>Al Jazeera English: <a href=https://live-hls-audio-web-aje.getaj.net/VOICE-AJE/01.m3u8>https://live-hls-audio-web-aje.getaj.net/VOICE-AJE/01.m3u8</a></li><li>BBC World Service: <a href=http://vprbbc.streamguys.net/vprbbc24-nopreroll>http://vprbbc.streamguys.net/vprbbc24-nopreroll</a></li><li>Learning English: <a href=https://voa-ingest.akamaized.net/hls/live/2035234/160_342L/playlist.m3u8>https://voa-ingest.akamaized.net/hls/live/2035234/160_342L/playlist.m3u8</a></li></ul><p><strong>相关资源</strong></p><ul><li><a href=https://zh.m.wikipedia.org/zh-hans/%E4%B8%AD%E5%8D%8E%E4%BA%BA%E6%B0%91%E5%85%B1%E5%92%8C%E5%9B%BD%E5%B9%BF%E6%92%AD%E7%94%B5%E5%8F%B0%E5%88%97%E8%A1%A8>中华人民共和国广播电台列表</a>(收听波段)</li></ul><p><strong>2009年旧方法</strong></p><p>很多电台是基于Microsoft Media Server (MMS) streaming protocol的，如果rhythmbox无法播放mms协议的电台，则需要安装支持mms协议的gstreamer插件——因为rhymbox使用gstreamer做后台解码。支持mms协议的插件为gstreamer-bad插件，所以执行命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt-get install gstreamer0.10-plugins-bad
</span></span></code></pre></div><p>同样的，如果需要播放mp3文件则安装ugly插件，需要播放wma文件则安装ffmpeg插件。</p><ul><li><a href="https://forum.ubuntu.org.cn/viewtopic.php?t=219155">电视台和电台MMS地址</a></li><li><a href="https://forum.ubuntu.org.cn/viewtopic.php?t=183787">分享Rhythmbox电台列表</a></li></ul><h4 id=播客和电台httpswwwzhihucomquestion402348857answer1293689640><a href=https://www.zhihu.com/question/402348857/answer/1293689640>播客和电台</a><a hidden class=anchor aria-hidden=true href=#播客和电台httpswwwzhihucomquestion402348857answer1293689640>#</a></h4><ul><li>播客和电台的区别是什么？</li></ul><p>播客和电台的区别比较明显，一句话概括：播客是通过互联网承载的声音内容；电台则通过传统的广告媒介运营，现在也在互联网上分发拷贝。</p><p>播客，中文圈对“Podcast”的翻译，而Podcast是苹果公司的产品，是由“iPod”和“broadcast”（广播）的混成词，将数码产品和内容产品合二为一。Podcast和itunes一样都对声音内容的生产和商业化产生了深远影响。</p><p>电台，准确来讲是指电台广播（Radio broadcasting），和苹果公司的定义相比，那就是不需要通过他家“iPod”就可以听的广播咯。</p><ul><li>为什么现在的平台上（例如喜马拉雅、网易云音乐）都把播客划分为电台？</li></ul><p>最核心的原因是，现在国内大的声音内容服务平台，声音内容是极其丰富的，例如直播、录播、有声书……（儿童、历史的分类法是按题材/内容划分）从节目录制和播放形式上来看，电台和播客本来都属广播（broadcasting），自然被放到一起了。</p><p>另外，独立播客的的分发方式是在服务器中把一系列的音频档通过RSS消息来源列出，你可以通过任意一种泛用性podcast工具进行RSS订阅收听。现在也仍然有很多泛用性podcast平台提供类似服务，而国内的声音内容平台例如喜马，荔枝也为播客主提供托管服务，但更多是一种延伸服务，显然不是主打。</p><p>最后，播客之所以往往是在各个频道里跟其他内容混装在一起，是因为播客主按自己节目内容类型进行分类，被归入了各个频道。比如我们做的[2082FM]选择的类型标签是“文化”，其实我挺没文化的。</p><h4 id=missing-plugin>Missing plugin<a hidden class=anchor aria-hidden=true href=#missing-plugin>#</a></h4><pre tabindex=0><code>Rhythmbox-Message: 16:22:38.404: Missing plugin: gstreamer|1.0|rhythmbox|application/x-hls decoder|decoder-application/x-hls
</code></pre><p><a href=https://stackoverflow.com/questions/40106047/gstreamer-installation-is-missing-a-plug-in>解决方法</a>：The element missing is named <code>hlsdemux</code> and lives in <code>gst-plugins-bad</code>.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install gstreamer1.0-plugins-bad
</span></span></code></pre></div><p>所有 <a href="https://gstreamer.freedesktop.org/documentation/plugins_doc.html?gi-language=c">GStreamer Plugins</a></p><h3 id=feeluownhttpsgithubcomfeeluownfeeluown><a href=https://github.com/feeluown/FeelUOwn>FeelUOwn</a><a hidden class=anchor aria-hidden=true href=#feeluownhttpsgithubcomfeeluownfeeluown>#</a></h3><p>FeelUOwn 是一个稳定、用户友好以及高度可定制的音乐播放器。支持全平台。</p><h4 id=clementinehttpsgithubcomclementine-playerclementine><a href=https://github.com/clementine-player/Clementine>Clementine</a><a hidden class=anchor aria-hidden=true href=#clementinehttpsgithubcomclementine-playerclementine>#</a></h4><p>Clementine is a modern music player and library organizer for Windows, Linux and macOS.</p><p><img loading=lazy src=/Distributions/image-20220719203631775.png alt=image-20220719203631775></p><h4 id=cmushttpscmusgithubio><a href=https://cmus.github.io/>cmus</a><a hidden class=anchor aria-hidden=true href=#cmushttpscmusgithubio>#</a></h4><p>Small, fast and powerful console music player for Unix-like operating systems.</p><p><a href=https://forum.suse.org.cn/t/topic/14143>官方教程翻译版</a></p><h4 id=deadbeefhttpsdeadbeefsourceforgeio><a href=https://deadbeef.sourceforge.io/>DeaDBeeF</a><a hidden class=anchor aria-hidden=true href=#deadbeefhttpsdeadbeefsourceforgeio>#</a></h4><p>DeaDBeeF (as in <a href=http://en.wikipedia.org/wiki/Hexspeak>0xDEADBEEF</a>) is a modular cross-platform audio player which runs on GNU/Linux distributions, macOS, Windows, *BSD, OpenSolaris, and other UNIX-like systems.</p><h4 id=jellyfinhttpsgithubcomjellyfinjellyfin><a href=https://github.com/jellyfin/jellyfin>jellyfin</a><a hidden class=anchor aria-hidden=true href=#jellyfinhttpsgithubcomjellyfinjellyfin>#</a></h4><p>The Free Software Media System</p><h4 id=audacioushttpsaudacious-media-playerorg><a href=https://audacious-media-player.org/>Audacious</a><a hidden class=anchor aria-hidden=true href=#audacioushttpsaudacious-media-playerorg>#</a></h4><p>Audacious is an open source audio player.</p><h4 id=kde-elisahttpsgithubcomkdeelisaamarokhttpsgithubcomkdeamarok>KDE <a href=https://github.com/KDE/elisa>elisa</a>/<a href=https://github.com/KDE/amarok>amarok</a><a hidden class=anchor aria-hidden=true href=#kde-elisahttpsgithubcomkdeelisaamarokhttpsgithubcomkdeamarok>#</a></h4><p>elisa: Simple music player aiming to provide a nice experience for its users</p><p>amarok: Powerful music player that lets you rediscover your music</p><p>Elisa 在播放文件不可用的时候会迅速的删光所有歌曲，它的播放列表经常被破坏</p><h4 id=osdlyricshttpsgithubcomosdlyricsosdlyrics><a href=https://github.com/osdlyrics/osdlyrics>osdlyrics</a><a hidden class=anchor aria-hidden=true href=#osdlyricshttpsgithubcomosdlyricsosdlyrics>#</a></h4><p>Standalone lyrics fetcher/displayer (windowed and OSD mode).</p><h4 id=zonylrctoolsxhttpsgithubcomreal-zonyzonylrctoolsx><a href=https://github.com/real-zony/ZonyLrcToolsX>ZonyLrcToolsX</a><a hidden class=anchor aria-hidden=true href=#zonylrctoolsxhttpsgithubcomreal-zonyzonylrctoolsx>#</a></h4><p>ZonyLrcToolsX 是一个能够方便地下载歌词的小软件。（ps：一点也不见得方便）</p><h3 id=neteasemusichttpsmusic163com><a href=https://music.163.com/>NeteaseMusic</a><a hidden class=anchor aria-hidden=true href=#neteasemusichttpsmusic163com>#</a></h3><p>Linux 下官方只发布了 deb 包，flatpak 直接安装</p><h4 id=yesplaymusichttpsgithubcomqier222yesplaymusic><a href=https://github.com/qier222/YesPlayMusic>YesPlayMusic</a><a hidden class=anchor aria-hidden=true href=#yesplaymusichttpsgithubcomqier222yesplaymusic>#</a></h4><p>高颜值的第三方网易云播放器</p><h4 id=netease-musicboxhttpsgithubcomdarknessomimusicbox><a href=https://github.com/darknessomi/musicbox>NetEase-MusicBox</a><a hidden class=anchor aria-hidden=true href=#netease-musicboxhttpsgithubcomdarknessomimusicbox>#</a></h4><p>网易云音乐命令行版</p><h4 id=lx-music-desktophttpsgithubcomlyswhutlx-music-desktop><a href=https://github.com/lyswhut/lx-music-desktop>lx-music-desktop</a><a hidden class=anchor aria-hidden=true href=#lx-music-desktophttpsgithubcomlyswhutlx-music-desktop>#</a></h4><p>一个基于 electron 的音乐软件</p><h4 id=listen1_desktophttpsgithubcomlisten1listen1_desktop><a href=https://github.com/listen1/listen1_desktop>listen1_desktop</a><a hidden class=anchor aria-hidden=true href=#listen1_desktophttpsgithubcomlisten1listen1_desktop>#</a></h4><p>one for all free music in china</p><h3 id=qqmusichttpsyqqcom><a href=https://y.qq.com/>QQMusic</a><a hidden class=anchor aria-hidden=true href=#qqmusichttpsyqqcom>#</a></h3><h3 id=spotify>Spotify<a hidden class=anchor aria-hidden=true href=#spotify>#</a></h3><p>作为世界上最大的音乐流媒体服务商，Spotify 因优秀的设计和精准的音乐推荐算法让不少人为之倾心。</p><p>在正式注册 Spotify 之前，我们先来看一看曲库的问题。由于不同地区的歌曲版权差异，Spotify 在不同地区提供服务时，其相应的曲库也有所不同。例如港区的曲库中，粤语歌就要比美区多，相反美区的英文歌就要比港区多。同理，若你喜欢听其他语种的歌，注册当地的 Spotify 则是最好的选择。</p><p>注册后要是发现当前的地区选择并不是很理想，想要换区也是可行的。首先要挂上自己想要换到地区的代理，然后进入自己的「Profile/资料」界面，点击「Edit Profile/修改资料」，「Country/国家」这个选项就会出现你当前所挂代理地区，保存更改即可换区成功。</p><p>登录的话，需要先在登录界面设置Proxy重启。登录后在设置里改回来，不再需要Proxy了。</p><h4 id=spotifydhttpsgithubcomspotifydspotifyd><a href=https://github.com/Spotifyd/spotifyd>Spotifyd</a><a hidden class=anchor aria-hidden=true href=#spotifydhttpsgithubcomspotifydspotifyd>#</a></h4><p>An open source Spotify client running as a UNIX daemon.</p><h3 id=mpvhttpshooke007githubioindexhtml><a href=https://hooke007.github.io/index.html>MPV</a><a hidden class=anchor aria-hidden=true href=#mpvhttpshooke007githubioindexhtml>#</a></h3><p>MPV 是基于 <a href=http://www.mplayerhq.hu/DOCS/man/zh_CN/mplayer.1.html>MPlayer</a> 和 mplayer2 的开源极简全能播放器。支持各种视频格式、音频解码、支持特效字幕（电影动漫的ass特效字幕都没啥问题），不仅支持本地播放，同样支持网络播放（mpv 集成了 <code>youtube-dl</code>）。重点是 MPV 具有多系统平台支持、命令行、自定义、GPU 解码、脚本支持等特点……</p><p>更多请阅读<a href=https://mpv.io/manual/master/>官方参考手册</a>，及其<a href=https://hooke007.github.io/official_man/mpv.html>中文版</a>。</p><h4 id=快捷键httpswwwiplaysoftcommpvhtml><a href=https://www.iplaysoft.com/mpv.html>快捷键</a><a hidden class=anchor aria-hidden=true href=#快捷键httpswwwiplaysoftcommpvhtml>#</a></h4><p>虽然 MPV 并没有提供官方的 GUI 界面，没有菜单，但它提供 OSC 操作界面和快捷键用于操作，只要关联好文件格式，使用 mpv 打开视频后，使用上其实也非常的简单方便。</p><p><img loading=lazy src=/Distributions/mpv_start-osc.png alt></p><p><strong>鼠标操作</strong></p><table><thead><tr><th>快捷键</th><th>作用说明</th></tr></thead><tbody><tr><td>鼠标左键双击</td><td>进入/退出全屏</td></tr><tr><td>鼠标右键单击</td><td>暂停/继续播放</td></tr><tr><td>鼠标滚轮</td><td>快进/快退</td></tr></tbody></table><p><strong>播放控制</strong></p><table><thead><tr><th>快捷键</th><th></th><th>作用说明</th></tr></thead><tbody><tr><td>p</td><td>Space</td><td>暂停、继续播放</td></tr><tr><td>/</td><td>*</td><td>减少/增加音量</td></tr><tr><td>9</td><td>0</td><td>减少/增加音量（数字键盘区的9、0不可用）</td></tr><tr><td>m</td><td></td><td>静音</td></tr><tr><td>←</td><td>→</td><td>快退/快进5秒</td></tr><tr><td>↑</td><td>↓</td><td>快进/快退1分钟</td></tr><tr><td>&lt;</td><td>></td><td>上一个/下一个（播放列表中）</td></tr><tr><td>Enter</td><td></td><td>下一个（播放列表中）</td></tr><tr><td>F8</td><td></td><td>播放列表</td></tr><tr><td>l</td><td></td><td>设定/清除 A-B循环点</td></tr><tr><td>L</td><td></td><td>循环播放</td></tr><tr><td>s</td><td></td><td>截屏</td></tr><tr><td>q</td><td></td><td>停止播放并退出</td></tr><tr><td>Q</td><td></td><td>保存当前播放进度并退出，播放同样文件从上次保存进度继续播放。</td></tr></tbody></table><p><strong>视频控制</strong></p><table><thead><tr><th>快捷键</th><th>作用说明</th></tr></thead><tbody><tr><td>_(下划线)</td><td>循环切换可用视频轨</td></tr><tr><td>A</td><td>循环切换视频画面比例</td></tr><tr><td>Alt+0</td><td>0.5倍源视频画面大小</td></tr><tr><td>Alt+1</td><td>1倍源视频画面大小</td></tr><tr><td>Alt+2</td><td>2倍源视频画面大小</td></tr><tr><td>Ctrl+h</td><td>在运行时切换硬解码。它在 <code>auto</code> 和 <code>no</code> 之间切换这个选项。</td></tr></tbody></table><p><strong>音频控制</strong></p><table><thead><tr><th>快捷键</th><th></th><th>作用说明</th></tr></thead><tbody><tr><td>#</td><td></td><td>循环切换可用音频轨</td></tr><tr><td>Ctrl +</td><td>Ctrl -</td><td>音轨延迟+/- 0.1秒</td></tr></tbody></table><p><strong>字幕控制</strong></p><table><thead><tr><th>快捷键</th><th></th><th>作用说明</th></tr></thead><tbody><tr><td>V</td><td></td><td>关闭/开启字幕</td></tr><tr><td>j</td><td>J</td><td>循环切换可用字幕轨</td></tr><tr><td>x</td><td>z</td><td>字幕延迟 +/- 0.1秒</td></tr><tr><td>r</td><td>t</td><td>上移/下移字幕位置</td></tr></tbody></table><p><strong>窗口控制</strong></p><table><thead><tr><th>快捷键</th><th>作用说明</th></tr></thead><tbody><tr><td>T</td><td>窗口始终置顶</td></tr><tr><td>f</td><td>进入/退出全屏</td></tr><tr><td>ESC</td><td>退出全屏</td></tr></tbody></table><h4 id=配置>配置<a hidden class=anchor aria-hidden=true href=#配置>#</a></h4><p>因为mpv本身不具有图形化前端，绝大多数的设置选项都是靠在主设置文件 <code>~/.config/mpv/mpv.conf</code> 中输入参数实现的。可以参考 <a href=https://github.com/mpv-player/mpv/blob/master/etc/input.conf>官方的内建方案</a> 跟 <a href=https://github.com/hooke007/MPV_lazy/blob/main/portable_config/input.conf>懒人包版</a>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>## 基本说明：</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 注释内容解释 —— # &lt;可选值&gt; [条件要求] 参数意义说明 （补充）</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 部分选项之间有关联作用，MPV读取参数时由上往下读，所以注意书写通用参数的顺序</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 追加读取额外的设置文件，在默认设置文件之后进行解析。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ~~ 意思是 mpv config dir，例如 ~/.config/mpv/</span>
</span></span><span style=display:flex><span><span style=color:#75715e># include=&#34;~~/profiles.conf&#34;  </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 在将要播放的文件的同一目录下查找针对该文件的设置文件</span>
</span></span><span style=display:flex><span>use-filedir-conf<span style=color:#f92672>=</span>yes 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 打开给定的路径进行写入，并输出日志信息到其中。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># ~~desktop 是桌面</span>
</span></span><span style=display:flex><span><span style=color:#75715e># log-file=&#34;~~desktop/mpv.log&#34; </span>
</span></span><span style=display:flex><span>log-file<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;~~/mpv.log&#34;</span> 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>########</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 基础 #</span>
</span></span><span style=display:flex><span><span style=color:#75715e>########</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定一个要使用的视频输出驱动的优先级列表。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># gpu 通用的可定制的、GPU加速的视频输出驱动。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># gpu-next 基于 libplacebo 的实验性视频渲染器。它几乎支持与 gpu 相同的功能集。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 许多渲染相关的选项也只能在这两项下正常工作。首选gpu。</span>
</span></span><span style=display:flex><span>vo<span style=color:#f92672>=</span>gpu 
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 选择用于FBOs的纹理的内部格式。该格式可以影响视频输出的性能和质量。</span>
</span></span><span style=display:flex><span>fbo-format<span style=color:#f92672>=</span>auto      
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果可能的话，指定应该使用的视频硬件解码API。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 硬解码是否实际完成取决于视频编码。如果硬件解码不可能，mpv将回退到软件解码。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果希望硬件解码在默认情况下被启用，可以使用 auto-safe </span>
</span></span><span style=display:flex><span>hwdec<span style=color:#f92672>=</span>auto-safe
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 只允许对一个给定的编码列表进行硬件解码。特殊值 all 总是允许所有的编码。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 默认情况下，这被设置为 h264,vc1,hevc,vp8,vp9,av1,prores</span>
</span></span><span style=display:flex><span>hwdec-codecs<span style=color:#f92672>=</span>all
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用直接渲染（默认： yes）。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果设置为 yes ，视频将被直接解码到GPU video memory（或暂存缓冲区）。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 这可以加快视频上传速度，对高分辨率或慢速硬件可能有帮助。</span>
</span></span><span style=display:flex><span>vd-lavc-dr<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>########</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 功能 #</span>
</span></span><span style=display:flex><span><span style=color:#75715e>########</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 让mpv在没有文件可以播放时空闲等待而不是退出。</span>
</span></span><span style=display:flex><span>idle<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 以暂停状态启动播放器</span>
</span></span><span style=display:flex><span><span style=color:#75715e># pause=yes     </span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 循环一个文件N次，inf 表示永远，no 表示正常播放。</span>
</span></span><span style=display:flex><span>loop-file<span style=color:#f92672>=</span>no
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 循环一个播放列表N次，inf 表示永远，no 表示正常播放。</span>
</span></span><span style=display:flex><span>loop-playlist<span style=color:#f92672>=</span>no
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 允许视频解码器在跳转过程中丢帧，如果这些帧在跳转的目标之前。</span>
</span></span><span style=display:flex><span>hr-seek-framedrop<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 在退出时总是保存当前的播放位置。</span>
</span></span><span style=display:flex><span>save-position-on-quit<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 窗口相关</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 全屏播放。</span>
</span></span><span style=display:flex><span>fullscreen<span style=color:#f92672>=</span>no  
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 窗口边框和装饰。</span>
</span></span><span style=display:flex><span>border<span style=color:#f92672>=</span>no
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 将初始窗口尺寸设置为由 WxH 指定的最大尺寸，不改变窗口的长宽比。</span>
</span></span><span style=display:flex><span>autofit<span style=color:#f92672>=</span>70%
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 将窗口尺寸锁定为视频长宽。</span>
</span></span><span style=display:flex><span>keepaspect-window<span style=color:#f92672>=</span>yes
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 缓存相关</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 播放网络视频时的向后缓存大小（KiB或MiB）</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 该选项可以用来限制最大的预读数。</span>
</span></span><span style=display:flex><span>demuxer-max-bytes<span style=color:#f92672>=</span>50MiB   
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>########</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 字幕 #</span>
</span></span><span style=display:flex><span><span style=color:#75715e>########</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 加载与视频文件名匹配的额外字幕文件。参数指定了外部字幕文件的匹配模式。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># fuzzy 加载包含媒体文件名的所有字幕</span>
</span></span><span style=display:flex><span>sub-auto<span style=color:#f92672>=</span>fuzzy
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>########</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 截图 #</span>
</span></span><span style=display:flex><span><span style=color:#75715e>########</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置用于保存屏幕截图的图像文件类型。</span>
</span></span><span style=display:flex><span>screenshot-format<span style=color:#f92672>=</span>png
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定用于保存屏幕截图的文件名模板。</span>
</span></span><span style=display:flex><span>screenshot-template<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;%{filename:MPV_Screenshot}_%P&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 存储屏幕截图在此目录中。</span>
</span></span><span style=display:flex><span>screenshot-directory<span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;~/Pictures/&#34;</span>
</span></span></code></pre></div><h4 id=直播httpsgithubcomimdazuitvlist-awesome-m3u-m3u8><a href=https://github.com/imDazui/Tvlist-awesome-m3u-m3u8>直播</a><a hidden class=anchor aria-hidden=true href=#直播httpsgithubcomimdazuitvlist-awesome-m3u-m3u8>#</a></h4><h5 id=直播源>直播源<a hidden class=anchor aria-hidden=true href=#直播源>#</a></h5><p><strong>播放方法</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mpv --playlist-start<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> --playlist<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;https://raw.githubusercontent.com/zbefine/iptv/main/iptv.m3u&#34;</span>
</span></span></code></pre></div><p><strong>稳定地址</strong></p><ul><li><a href=https://raw.githubusercontent.com/imDazui/Tvlist-awesome-m3u-m3u8/master/m3u/%E6%88%91%E7%9A%84%E6%92%AD%E6%94%BE%E6%BA%90.m3u8>我的播放源.m3u8</a></li><li><a href=https://raw.githubusercontent.com/billy21/Tvlist-awesome-m3u-m3u8/master/m3u/%E5%9B%BD%E5%86%85%E5%9C%B0%E6%96%B9%E5%8F%B0202005.m3u>国内电视台直播源.m3u8</a></li><li><a href=https://github.com/zbefine/iptv>iptv</a> 分享的 <a href=https://raw.githubusercontent.com/zbefine/iptv/main/iptv.m3u>IPTV 频道</a></li><li><a href=https://github.com/biancangming/wtv/wiki/TV%E7%9B%B4%E6%92%AD%E7%BD%91%E7%AB%99%E5%90%88%E9%9B%86>直播网站</a><ul><li><a href=http://tv.cctv.com/live/>CCTV直播</a></li><li><a href=http://live.kankanews.com/huikan/>看看新闻高清</a></li><li>可通过 <a href=https://github.com/wbt5/real-url>real-url</a> 获取斗鱼&虎牙&哔哩哔哩&抖音&快手等直播平台的真实流媒体地址</li></ul></li></ul><p><strong>IPTV提供商</strong></p><ul><li><a href=https://iptv.shop/>IPTV Shop</a> - 超过6000个直播电视频道+ 4000个影视节目（VOD）。</li><li><a href=https://bestbuyiptv.com/>BestBuyIPTV</a> 超过38个国家/地区的7300个高清频道和9600 VOD 1080p。</li><li><a href=http://www.lyngsat-stream.com/>LyngSat Stream</a> 公共链接到互联网上传输的3018个线性电视频道和2963个线性无线电频道。</li><li><a href=http://database.freetuxtv.net/site/index>FreetuxTV WebTV Manager</a> - WebTV和Web Radio的免费数据库。</li><li><a href=http://www.cxtvlive.com/>CXTv</a> 来自世界各地的1308个电视频道和287个摄像机。</li><li><a href=https://necroiptv.com/>Necro IPTV</a> 提供所有优质的英国，爱尔兰，德国，土耳其，阿拉伯语，美国和加拿大频道。</li></ul><p><strong>电视频道信息</strong></p><ul><li><a href=https://www.lyngsat.com/>LyngSat</a> 卫星电视频道的数据库，其中包含捕获信号所必需的信息。</li><li><a href=https://www.lyngsat-logo.com/>LyngSat Logo</a> - 电视频道徽标的集合。</li><li><a href=http://www.tv-address.com/>TV Address</a> - 电视频道信息。</li></ul><p><strong>其他工具</strong></p><ul><li><a href=http://www.webgrabplus.com/>WebGrab + Plus</a> 多站点增量XMLTV EPG采集器。</li><li><a href=https://www.npmjs.com/package/iptv-checker>IPTV Checker</a> — Node.js的IPTV播放列表检查器</li><li><a href=https://streamtest.in/>Streamtest</a> 免费且易于使用的基于Web的流测试器实用程序。</li></ul><h5 id=epghttpswwwalltechbuzznetzh-cnepg><a href=https://www.alltechbuzz.net/zh-CN/EPG/>EPG</a><a hidden class=anchor aria-hidden=true href=#epghttpswwwalltechbuzznetzh-cnepg>#</a></h5><p>当我们过去看有线电视时，我们会依靠电视指南来了解接下来要播放什么节目或电影，或者我们在特定时间可以期待什么。 现在我们生活在一个更现代的世界中，具有相同功能的指南也发生了变化。 如今，在观看直播电视时依赖电子节目指南或 EPG。</p><p><strong>什么是IPTV？</strong></p><p>对于不知道或不熟悉的人来说，互联网协议电视或 IPTV 本质上是一种即使没有电缆也可以通过互联网观看直播电视频道的方式。 大多数时候，IPTV 订阅比有线电视便宜得多，这就是为什么许多剪线钳决定选择这种方式的原因，尤其是当他们想削减开支时。 此外，您无需订阅有线电视即可安装和使用 IPTV，因此您可以毫无问题地在任何受支持的设备上下载 IPTV 应用程序。</p><p>有很多可用的 IPTV 服务，其中大多数提供数百或数千个频道可供浏览。 但是，无论您使用哪种 IPTV 服务，它通常都会附带一个 EPG，如果您正在寻找特定节目，您可以查看它。</p><p><strong>EPG怎么样？</strong></p><p>现在，让我们更多地讨论 EPG。 也称为电子服务指南 (ESG) 或交互式节目指南 (IPG)，您可以参考 EPG 以查看电视节目以及完整的详细信息列表。 这些详细信息包括节目网络、类型、放映时间、描述、预览等。</p><p>话虽如此，EPG 的界面并不完全相同。 一些 EPG 只展示已经播放或正在播出的节目，而另一些则展示其他节目即将播出的时间表。</p><p><a href=https://gogosmart.ru/zh/texnologii/iptv/epg.html><strong>如何为IPTV设置EPG？</strong></a></p><p>仅对于使用免费Internet访问中包含的M3U播放列表或自行创建它们的用户，才需要有关设置EPG的知识。对于只想通过网络收看电视频道而又不打算学习此主题的用户，可以按照自定义指南在Android或Windows上安装任何IPTV播放器。没有EPG的M3U文件如下所示：</p><pre tabindex=0><code>＃EXTM3U
#EXTINF：0，Europa Plus电视#EXTGRP：音乐http://23acbfe8.ucomist.net/iptv/5K6RMPTM6L8S2Y/115/index.m3u8
#EXTINF：0，MUZ-TV #EXTGRP：音乐http://23acbfe8.ucomist.net/iptv/5K6RMPTM6L8S2Y/116/index.m3u8
#EXTINF：0，BRIDGE TV俄语热播#EXTGRP：音乐http://23acbfe8.ucomist.net/iptv/5K6RMPTM6L8S2Y/120/index.m3u8
#EXTINF：0，Bridge TV #EXTGRP：音乐http://23acbfe8.ucomist.net/iptv/5K6RMPTM6L8S2Y/122/index.m3u8
</code></pre><p>将标记为<code>＃EXTM3U</code>的第一行更改为：<code>＃EXTM3U url-tvg="http://iptvx.one/epg/epg_lite.xml.gz"</code> 这样的形式。</p><p><strong>EPG 列表</strong></p><ul><li><a href=http://epg.51zmt.top:8000/>提供EPG的频道列表，每日与EPG同步更新</a></li><li><a href=https://epg.112114.xyz/>EPG-电子节目单</a></li><li><a href=https://www.iptv-epg.com/>EPG for IPTV</a> - EPG服务提供商，为全球IPTV提供个性化的电子节目指南。</li><li><a href="https://iptvx.one/viewtopic.php?f=12&amp;t=4&amp;sid=5d7f43099b396af229d5961ec746fc14">IPTVX|one</a> 主要用于CIS频道的节目指南。</li><li><a href=http://i.mjh.nz/>i.mjh.nz</a> 来自澳大利亚，新西兰和南非的频道的节目指南。</li></ul><h3 id=vlchttpswwwvideolanorg><a href=https://www.videolan.org/>VLC</a><a hidden class=anchor aria-hidden=true href=#vlchttpswwwvideolanorg>#</a></h3><p><a href=https://appimage.github.io/VLC/>appimage version</a></p><p>VLC is a free and open source cross-platform multimedia player and framework that plays most multimedia files, and various streaming protocols.</p><p><a href="https://www.videolan.org/vlc/skins.html?sort=date_added"><strong>Skins</strong></a></p><ul><li>Put the downloaded VLT files in the following folder: <code>~/.local/share/vlc/skins2</code></li><li>Then open your VLC settings and change your interface from native to skins ( Tools => Performances => Interface => Use custom skin => Skin resource file => Save ). You can choose your desired skin already there or change it when you are in the skins mode by rightclicking somewhere on the skin and going to <em>Interface>Choose Skin</em>.</li><li>VLC needs to be restarted to change to skins mode.</li></ul><p>有些主题只支持英文。</p><p><strong>管理流媒体</strong></p><p>VLC 的 Android 版本 与 Linux 桌面版本操作是不同的：</p><ul><li><p>在 Android 上，选择 More，点击 New stream 添加添加流媒体，添加的流媒体会在Streams展示，可以将所有添加的流媒体分组到playlist，playlist可以备份成名为 vlc_media.db 的 sqlite db，详情看<a href=https://www.vlchelp.com/android-backup-restore-playlists-vlcmediadb/>How to Backup and Restore Playlists</a></p></li><li><p>在 Linux 桌面端，需在 Media => Open Network Stream&mldr; 打开流媒体进行播放，打开的流媒体会在 Playlist 中展示，但是关闭 VLC 后就会清空 Playlist。要保存 Playlist，需右键 => Save Playlist to File&mldr; 保存为 xspf 文件，之后点击该文件播放 Playist 就行。Playlist 例子如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span><span style=color:#75715e>&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;playlist</span> <span style=color:#a6e22e>xmlns=</span><span style=color:#e6db74>&#34;http://xspf.org/ns/0/&#34;</span> <span style=color:#a6e22e>xmlns:vlc=</span><span style=color:#e6db74>&#34;http://www.videolan.org/vlc/playlist/ns/0/&#34;</span> <span style=color:#a6e22e>version=</span><span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;title&gt;</span>Playlist<span style=color:#f92672>&lt;/title&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;trackList&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;track&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;location&gt;</span>http://sk.cri.cn/915.m3u8<span style=color:#f92672>&lt;/location&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;title&gt;</span>輕鬆調頻<span style=color:#f92672>&lt;/title&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;duration&gt;</span>8950<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;extension</span> <span style=color:#a6e22e>application=</span><span style=color:#e6db74>&#34;http://www.videolan.org/vlc/playlist/0&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>&lt;vlc:id&gt;</span>0<span style=color:#f92672>&lt;/vlc:id&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>&lt;vlc:option&gt;</span>network-caching=1000<span style=color:#f92672>&lt;/vlc:option&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;/extension&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;/track&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;track&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;location&gt;</span>http://sk.cri.cn/887.m3u8<span style=color:#f92672>&lt;/location&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;title&gt;</span>劲曲调频<span style=color:#f92672>&lt;/title&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;duration&gt;</span>8950<span style=color:#f92672>&lt;/duration&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;extension</span> <span style=color:#a6e22e>application=</span><span style=color:#e6db74>&#34;http://www.videolan.org/vlc/playlist/0&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>&lt;vlc:id&gt;</span>1<span style=color:#f92672>&lt;/vlc:id&gt;</span>
</span></span><span style=display:flex><span>				<span style=color:#f92672>&lt;vlc:option&gt;</span>network-caching=1000<span style=color:#f92672>&lt;/vlc:option&gt;</span>
</span></span><span style=display:flex><span>			<span style=color:#f92672>&lt;/extension&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;/track&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;/trackList&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;extension</span> <span style=color:#a6e22e>application=</span><span style=color:#e6db74>&#34;http://www.videolan.org/vlc/playlist/0&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;vlc:item</span> <span style=color:#a6e22e>tid=</span><span style=color:#e6db74>&#34;0&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>		<span style=color:#f92672>&lt;vlc:item</span> <span style=color:#a6e22e>tid=</span><span style=color:#e6db74>&#34;1&#34;</span><span style=color:#f92672>/&gt;</span>
</span></span><span style=display:flex><span>	<span style=color:#f92672>&lt;/extension&gt;</span>
</span></span><span style=display:flex><span><span style=color:#f92672>&lt;/playlist&gt;</span>
</span></span></code></pre></div><p>手动编写的话<code>&lt;duration></code>可能是错的（不影响播放），可以在打开后 xspf 文件后再保存一次来覆盖该文件。</p></li></ul><h4 id=smplayerhttpswwwsmplayerinfo><a href=https://www.smplayer.info/>SMPlayer</a><a hidden class=anchor aria-hidden=true href=#smplayerhttpswwwsmplayerinfo>#</a></h4><p>多媒体播放器</p><h4 id=kodihttpskoditv><a href=https://kodi.tv/>Kodi</a><a hidden class=anchor aria-hidden=true href=#kodihttpskoditv>#</a></h4><p>具有库支持的免费跨平台媒体播放器。</p><h3 id=shotcuthttpswwwshotcutorgdownload><a href=https://www.shotcut.org/download/>Shotcut</a><a hidden class=anchor aria-hidden=true href=#shotcuthttpswwwshotcutorgdownload>#</a></h3><p>Shotcut is a free, open source, cross-platform video editor.</p><h3 id=davinci-resolvehttpwwwblackmagicdesigncomcnproductsdavinciresolve><a href=http://www.blackmagicdesign.com/cn/products/davinciresolve/>DaVinci Resolve</a><a hidden class=anchor aria-hidden=true href=#davinci-resolvehttpwwwblackmagicdesigncomcnproductsdavinciresolve>#</a></h3><p>专业的剪辑、调色、特效和音频后期制作！</p><h2 id=download>Download<a hidden class=anchor aria-hidden=true href=#download>#</a></h2><h3 id=aria2httpsaria2githubio><a href=https://aria2.github.io/>Aria2</a><a hidden class=anchor aria-hidden=true href=#aria2httpsaria2githubio>#</a></h3><p>Aria2是一款开源下载工具，可帮助简化不同设备和服务器之间的下载过程。它支持磁力链接、BT种子、http等类型的文件下载，与迅雷相比，Aria2有着优秀的性能及较低的资源占用，架构本身非常轻巧，通常只需要4兆字节（HTTP下载）到9兆字节（用于BitTorrent交互）之间。最重要的一点是Aria2完全免费！</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt-get install aria2
</span></span></code></pre></div><p>下载安装完成之后，可以通过输入 <code>aria2c -v</code> 来验证是否安装成功。</p><h4 id=usage>Usage<a hidden class=anchor aria-hidden=true href=#usage>#</a></h4><p><strong>命令行使用</strong></p><p>使用Aria2下载文件，只需在命令后附加地址即可：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c URL
</span></span></code></pre></div><p>下载后以其他名称保存文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c -o fileName URL
</span></span></code></pre></div><p>下载多个文件</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c -Z URL URL
</span></span></code></pre></div><p>从列表下载文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c -i URLs.txt
</span></span></code></pre></div><p>限制下载速度：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 单个文件</span>
</span></span><span style=display:flex><span>aria2c –max-download-limit<span style=color:#f92672>=</span>500k URL
</span></span><span style=display:flex><span><span style=color:#75715e># 全局</span>
</span></span><span style=display:flex><span>aria2c –max-overall-download-limit<span style=color:#f92672>=</span>500k URL 
</span></span></code></pre></div><p>断点续传：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c -c URL
</span></span></code></pre></div><p>下载磁力链接文件：要下载磁力链接文件，如果下载没有速度，可以添加<code>--bt-tracker=</code>选项，tracker 中用 <code>,</code> 隔开：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c --bt-tracker<span style=color:#f92672>=</span>tracker,tracker torrent
</span></span></code></pre></div><p>tracker 服务器：</p><ul><li><p><a href=https://github.com/ngosang/trackerslist>trackerslist</a>：trackers_best (20 trackers) => <a href=https://raw.githubusercontent.com/ngosang/trackerslist/master/trackers_best.txt>link</a> / <a href=https://ngosang.github.io/trackerslist/trackers_best.txt>mirror</a> / <a href=https://cdn.jsdelivr.net/gh/ngosang/trackerslist@master/trackers_best.txt>mirror 2</a></p></li><li><p><a href=https://github.com/XIU2/TrackersListCollection>TrackersListCollection</a>：BEST Tracker list (78 trackers)=> <a href=https://trackerslist.com/best.txt>link</a> / <a href=https://cdn.jsdelivr.net/gh/XIU2/TrackersListCollection/best.txt>mirror</a></p></li><li><p><a href=https://gitee.com/harvey520/www.yaozuopan.top/raw/master/blacklist.txt>中国可用的 BT Tracker 服务器列表</a></p></li><li><p>将多行文本转换成一行并用逗号隔开</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat tracker | xargs | tr <span style=color:#e6db74>&#39; &#39;</span> <span style=color:#e6db74>&#39;,&#39;</span>
</span></span></code></pre></div></li></ul><p>分段下载：可以加快文件的下载速度，对于下载大文件时特别有用，<code>-s</code> 后面的参数值介于1~5之间，你可以根据实际情况选择。下面命令将使用2连接来下载该文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c -s <span style=color:#ae81ff>2</span> URL
</span></span></code></pre></div><p>后台下载：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c -D url
</span></span><span style=display:flex><span>$ aria2c –deamon<span style=color:#f92672>=</span>true url
</span></span></code></pre></div><p>验证文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c –checksum<span style=color:#f92672>=</span>md5<span style=color:#f92672>=</span>提供的md5
</span></span></code></pre></div><p>设置dht端口：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c –dht-listen-port<span style=color:#f92672>=</span><span style=color:#ae81ff>1234</span> torrent
</span></span></code></pre></div><p>下载需要引用页的文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c –referer<span style=color:#f92672>=</span>referurl URL
</span></span></code></pre></div><p>下载需要Cookie验证的文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c –essay-header<span style=color:#f92672>=</span>’Cookie:key<span style=color:#f92672>=</span>value’ URL
</span></span><span style=display:flex><span>$ aria2c –load-cookies<span style=color:#f92672>=</span>cookie文件 URL
</span></span></code></pre></div><p>从密码保护的网站下载一个文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c --http-user<span style=color:#f92672>=</span>xxx --http-password<span style=color:#f92672>=</span>xxx URL
</span></span><span style=display:flex><span>$ aria2c --ftp-user<span style=color:#f92672>=</span>xxx --ftp-password<span style=color:#f92672>=</span>xxx URL
</span></span></code></pre></div><p>注意：当源地址存在诸如&,*等shell的特殊字符，请使用单引号或双引号把URI包含起来。</p><p><strong>代理</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/usr/bin/aria2c --conf-path<span style=color:#f92672>=</span>/path/of/aria2.conf --<span style=color:#f92672>{</span>http,https,ftp,all<span style=color:#f92672>}</span>-proxy<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;[http://][USER:PASSWORD@]HOST[:PORT]&#34;</span>
</span></span></code></pre></div><p>例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ /usr/bin/aria2c --conf-path<span style=color:#f92672>=</span>/home/kurome/.opt/aria2/aria2.conf --http-proxy<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;http://127.0.0.1:7890&#34;</span>
</span></span></code></pre></div><p>覆盖先前定义的代理, 使用 <code>""</code>，例如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>/usr/bin/aria2c --conf-path<span style=color:#f92672>=</span>/path/of/aria2.conf --all-proxy<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span></code></pre></div><p><strong>RPC Server 模式</strong></p><p>该模式可以配合 Web UI 进行图形管理。默认启动是 6800 端口，怕别人盗用，可以设置用户名和密码(1.18.4以上版本支持密钥)。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ aria2c --enable-rpc --rpc-listen-all --rpc-allow-origin-all -c  --dir ~/Download
</span></span></code></pre></div><h4 id=configurationhttparia2ccomusagehtml><a href=http://aria2c.com/usage.html>Configuration</a><a hidden class=anchor aria-hidden=true href=#configurationhttparia2ccomusagehtml>#</a></h4><p>默认情况下，aria2 检查旧路径 <code>$HOME/.opt/aria2/aria2.conf</code> 是否存在，否则它会将 <code>$XDG_CONFIG_HOME/aria2/aria2.conf</code> 解析为它的配置文件。 您可以使用 <code>--conf-path</code> 选项指定配置文件的路径。 如果您不想使用配置文件，请使用 <code>--no-conf</code> 选项。</p><p><a href=http://www.senra.me/aria2-conf-file-parameters-translation-and-explanation/>配置详解</a>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Description: Awesome Aria2 configuration file</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Version: 2021.09.15</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## &#39;#&#39;开头为注释内容, 选项都有相应的注释说明, 根据需要修改 ##</span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 被注释的选项填写的是默认值, 如为空则无默认设置，请自行选取需要更改的添加到你的配置文件中 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 文件保存设置 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 下载路径(可使用绝对路径或相对路径), 默认: 当前启动位置</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#dir=</span>
</span></span><span style=display:flex><span>dir<span style=color:#f92672>=</span>/home/kurome/Downloads
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 磁盘缓存</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用磁盘缓存. 如果设置为 0, 将禁用磁盘缓存. 此功能将下载的数据缓存在内存中, 最多占用此选项设置的字节数. 缓存存储由 aria2 实例创建并对所有下载共享. 由于数据以较大的单位写入并按文件的偏移重新排序, 所以磁盘缓存的一个优点是减少磁盘的 I/O. 如果调用哈希检查时并且数据缓存在内存中时, 将不需要从磁盘中读取. 大小可以包含 K 或 M (1K = 1024, 1M = 1024K).</span>
</span></span><span style=display:flex><span>disk-cache<span style=color:#f92672>=</span>64M
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 文件预分配方式, 可选：none, prealloc, trunc, falloc, 默认:prealloc</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 预分配对于机械硬盘可有效降低磁盘碎片、提升磁盘读写性能、延长磁盘寿命。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 机械硬盘使用 ext4（具有扩展支持），btrfs，xfs 或 NTFS（仅 MinGW 编译版本）等文件系统建议设置为 falloc</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 若无法下载，提示 fallocate failed.cause：Operation not supported 则说明不支持，请设置为 none</span>
</span></span><span style=display:flex><span><span style=color:#75715e># prealloc 分配速度慢, trunc 无实际作用，不推荐使用。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 固态硬盘不需要预分配，只建议设置为 none ，否则可能会导致双倍文件大小的数据写入，从而影响寿命。</span>
</span></span><span style=display:flex><span>file-allocation<span style=color:#f92672>=</span>none
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 文件分配限制</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 不对比此参数设置大小小的分配文件. 您可以增加数值的单位 K 或 M (1K = 1024, 1M = 1024K).</span>
</span></span><span style=display:flex><span>no-file-allocation-limit<span style=color:#f92672>=</span>64M
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 断点续传</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 继续下载部分完成的文件. 启用此选项可以继续下载从浏览器或其他程序按顺序下载的文件. 此选项目前只支持 HTTP(S)/FTP 下载的文件.</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>continue</span><span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 始终断点续传</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 始终断点续传. 如果设置为&#34;是&#34;, aria2 始终尝试断点续传, 如果无法恢复, 则中止下载. 如果设置为&#34;否&#34;, 对于不支持断点续传的 URI 或 aria2 遇到 N 个不支持断点续传的 URI (N 为 --max-resume-failure-tries 选项设置的值), aria2 会从头下载文件. 参见 --max-resume-failure-tries 参数.</span>
</span></span><span style=display:flex><span>always-resume<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最大断点续传尝试次数</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 当 --always-resume 选项设置为&#34;否&#34;时, 如果 aria2 检测到有 N 个 URI 不支持断点续传时, 将从头开始下载文件. 如果 N 设置为 0, 当所有 URI 都不支持断点续传时才会从头下载文件. 参见 --always-resume 选项.</span>
</span></span><span style=display:flex><span>max-resume-failure-tries<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 获取服务器文件时间</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从 HTTP/FTP 服务获取远程文件的时间戳, 如果可用将设置到本地文件</span>
</span></span><span style=display:flex><span>remote-time<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 进度保存设置 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从会话文件中读取下载任务</span>
</span></span><span style=display:flex><span>input-file<span style=color:#f92672>=</span>/home/kurome/.opt/aria2/aria2.session
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 会话文件保存路径</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 当退出时保存错误及未完成的任务到指定的文件中. 必须用绝对路径</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 您可以在重启 aria2 时使用 --input-file 选项重新加载. 如果您希望输出的内容使用 GZip 压缩, 您可以在文件名后增加 .gz 扩展名. 请注意, 通过 aria2.addTorrent() 和 aria2.addMetalink() RPC 方法添加的下载, 其元数据没有保存到文件的将不会保存. 通过 aria2.remove() 和 aria2.forceRemove() 删除的下载将不会保存.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#save-session=</span>
</span></span><span style=display:flex><span>save-session<span style=color:#f92672>=</span>/home/kurome/.opt/aria2/aria2.session
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 任务状态改变后保存会话的间隔时间（秒）, 0 为仅在进程正常退出时保存, 默认:0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 为了及时保存任务状态、防止任务丢失，此项值只建议设置为 1</span>
</span></span><span style=display:flex><span>save-session-interval<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 自动保存任务进度到控制文件(*.opt/aria2)的间隔时间（秒），0 为仅在进程正常退出时保存，默认：60</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 不论设置的值为多少, aria2 会在任务结束时保存控制文件. 可以设置的值为 0 到 600.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 此项值也会间接影响从内存中把缓存的数据写入磁盘的频率</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 想降低磁盘 IOPS (每秒读写次数)则提高间隔时间</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 想在意外非正常退出时尽量保存更多的下载进度则降低间隔时间</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 非正常退出：进程崩溃、系统崩溃、SIGKILL 信号、设备断电等</span>
</span></span><span style=display:flex><span>auto-save-interval<span style=color:#f92672>=</span><span style=color:#ae81ff>20</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 强制保存，即使任务已完成也保存信息到会话文件, 默认:false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 即使任务完成或删除时使用 --save-session 选项时也保存该任务. 此选项在这种情况下还会保存控制文件. 此选项可以保存被认为已经完成但正在做种的 BT 任务.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 开启后会在任务完成后保留 .opt/aria2 文件，文件被移除且任务存在的情况下重启后会重新下载。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 关闭后已完成的任务列表会在重启后清空。</span>
</span></span><span style=display:flex><span>force-save<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 下载连接设置 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 文件未找到重试次数</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果 aria2 从远程 HTTP/FTP 服务器收到 &#34;文件未找到&#34; 的状态超过此选项设置的次数后下载将会失败. 设置为 0 将会禁用此选项. 此选项仅影响 HTTP/FTP 服务器. 重试时同时会记录重试次数, 所以也需要设置 --max-tries 这个选项.</span>
</span></span><span style=display:flex><span>max-file-not-found<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最大尝试次数</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置最大尝试次数. 0 表示不限制，默认:5</span>
</span></span><span style=display:flex><span>max-tries<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 重试等待时间, 默认:0 (禁用)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置重试间隔时间(秒). 当此选项的值大于 0 时, aria2 在 HTTP 服务器返回 503 响应时将会重试.</span>
</span></span><span style=display:flex><span>retry-wait<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 连接超时时间</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置建立 HTTP/FTP/代理服务器 连接的超时时间(秒). 当连接建立后, 此选项不再生效, 请使用 --timeout 选项.</span>
</span></span><span style=display:flex><span>connect-timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 超时时间。默认：60</span>
</span></span><span style=display:flex><span>timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最大同时下载任务数, 运行时可修改, 默认:5</span>
</span></span><span style=display:flex><span>max-concurrent-downloads<span style=color:#f92672>=</span><span style=color:#ae81ff>5</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 单服务器最大连接线程数, 任务添加时可指定, 默认:1</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最大值为 16 (增强版无限制), 且受限于单任务最大连接线程数(split)所设定的值。</span>
</span></span><span style=display:flex><span>max-connection-per-server<span style=color:#f92672>=</span><span style=color:#ae81ff>16</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 单任务最大连接线程数, 任务添加时可指定, 默认:5</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 下载时使用 N 个连接. 如果提供超过 N 个 URI 地址, 则使用前 N 个地址, 剩余的地址将作为备用. 如果提供的 URI 地址不足 N 个, 这些地址多次使用以保证同时建立 N 个连接. 同一服务器的连接数会被 --max-connection-per-server 选项限制.</span>
</span></span><span style=display:flex><span>split<span style=color:#f92672>=</span><span style=color:#ae81ff>64</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 文件最小分段大小, 添加时可指定, 默认:20M</span>
</span></span><span style=display:flex><span><span style=color:#75715e># aria2 不会分割小于 2*SIZE 字节的文件. 例如, 文件大小为 20MB, 如果 SIZE 为 10M, aria2 会把文件分成 2 段 [0-10MB) 和 [10MB-20MB), 并且使用 2 个源进行下载 (如果 --split &gt;= 2). 如果 SIZE 为 15M, 由于 2*15M &gt; 20MB, 因此 aria2 不会分割文件并使用 1 个源进行下载. 您可以增加数值的单位 K 或 M (1K = 1024, 1M = 1024K). 可以设置的值为: 1M-1024M.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 理论上值越小使用下载分段就越多，所能获得的实际线程数就越大，下载速度就越快，但受限于所下载文件服务器的策略。</span>
</span></span><span style=display:flex><span>min-split-size<span style=color:#f92672>=</span>4M
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 文件分片大小，最小值为 1M，默认：1M</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置 HTTP/FTP 下载的分配大小. aria2 根据这个边界分割文件. 所有的分割都是这个长度的倍数. 此选项不适用于 BitTorrent 下载. 如果 Metalink 文件中包含分片哈希的结果此选项也不适用.</span>
</span></span><span style=display:flex><span>piece-length<span style=color:#f92672>=</span>1M
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 允许分片大小变化。默认：false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果设置为&#34;否&#34;, 当分片长度与控制文件中的不同时, aria2 将会中止下载. 如果设置为&#34;是&#34;, 您可以继续, 但部分下载进度将会丢失.</span>
</span></span><span style=display:flex><span>allow-piece-length-change<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 分片选择算法</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定 HTTP/FTP 下载使用的分片选择算法. 分片表示的是并行下载时固定长度的分隔段. 如果设置为&#34;默认&#34;, aria2 将会按减少建立连接数选择分片. 由于建立连接操作的成本较高, 因此这是合理的默认行为. 如果设置为&#34;顺序&#34;, aria2 将选择索引最小的分片. 索引为 0 时表示为文件的第一个分片. 这将有助于视频的边下边播. --enable-http-pipelining 选项有助于减少重连接的开销. 请注意, aria2 依赖于 --min-split-size 选项, 所以有必要对 --min-split-size 选项设置一个合理的值. 如果设置为&#34;随机&#34;, aria2 将随机选择一个分片. 就像&#34;顺序&#34;一样, 依赖于 --min-split-size 选项. 如果设置为&#34;几何&#34;, aria2 会先选择索引最小的分片, 然后会为之前选择的分片保留指数增长的空间. 这将减少建立连接的次数, 同时文件开始部分将会先行下载. 这也有助于视频的边下边播.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#stream-piece-selector=default</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最小速度限制</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 当下载速度低于此选项设置的值(B/s) 时将会关闭连接. 0 表示不设置最小速度限制. 您可以增加数值的单位 K 或 M (1K = 1024, 1M = 1024K). 此选项不会影响 BT 下载.</span>
</span></span><span style=display:flex><span>lowest-speed-limit<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 全局最大下载速度</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置全局最大下载速度 (字节/秒). 0 表示不限制. 您可以增加数值的单位 K 或 M (1K = 1024, 1M = 1024K).</span>
</span></span><span style=display:flex><span>max-overall-download-limit<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最大下载速度</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置每个任务的最大下载速度 (字节/秒). 0 表示不限制. 您可以增加数值的单位 K 或 M (1K = 1024, 1M = 1024K).</span>
</span></span><span style=display:flex><span>max-download-limit<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 禁用 IPv6, 默认:false</span>
</span></span><span style=display:flex><span>disable-ipv6<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 支持 GZip</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果远程服务器的响应头中包含 Content-Encoding: gzip 或 Content-Encoding: deflate , 将发送包含 Accept: deflate, gzip 的请求头并解压缩响应.</span>
</span></span><span style=display:flex><span>http-accept-gzip<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># URI 复用</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 当所有给定的 URI 地址都已使用, 继续使用已经使用过的 URI 地址.</span>
</span></span><span style=display:flex><span>reuse-uri<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># URI 选择算法</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定 URI 选择的算法. 可选的值包括 &#34;按顺序&#34;, &#34;反馈&#34; 和 &#34;自适应&#34;. 如果设置为&#34;按顺序&#34;, URI 将按列表中出现的顺序使用. 如果设置为&#34;反馈&#34;, aria2 将根据之前的下载速度选择 URI 列表中下载速度最快的服务器. 同时也将有效跳过无效镜像. 之前统计的下载速度将作为服务器状态文件的一部分, 参见 --server-stat-of 和 --server-stat-if 选项. 如果设置为&#34;自适应&#34;, 将从最好的镜像和保留的连接里选择一项. 补充说明, 其返回的镜像没有被测试过, 同时如果每个镜像都已经被测试过时, 返回的镜像还会被重新测试. 否则, 其将不会选择其他镜像. 例如&#34;反馈&#34;, 其使用服务器状态文件.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#uri-selector=feedback</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 禁用 netrc，默认:false</span>
</span></span><span style=display:flex><span>no-netrc<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># .netrc 文件路径</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#netrc-path=$(HOME)/.netrc</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 允许覆盖</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果相应的控制文件不存在时从头重新下载文件. 参见 --auto-file-renaming 选项.</span>
</span></span><span style=display:flex><span>allow-overwrite<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 文件自动重命名。默认:true</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 重新命名已经存在的文件. 此选项仅对 HTTP(S)/FTP 下载有效. 新的文件名后会在文件名后、扩展名 (如果有) 前追加句点和数字(1..9999).</span>
</span></span><span style=display:flex><span>auto-file-renaming<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 UTF-8 处理 Content-Disposition，默认:false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 处理 &#34;Content-Disposition&#34; 头中的字符串时使用 UTF-8 字符集来代替 ISO-8859-1, 例如, 文件名参数, 但不是扩展版本的文件名.</span>
</span></span><span style=display:flex><span>content-disposition-default-utf8<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最低 TLS 版本，可选：TLSv1.1、TLSv1.2、TLSv1.3 默认:TLSv1.2</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#min-tls-version=TLSv1.2</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## BT/PT 下载设置 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT 监听端口(TCP), 默认:6881-6999</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置 BT 下载的 TCP 端口. 多个端口可以使用逗号 &#34;,&#34; 分隔, 例如: 6881,6885. 您还可以使用短横线 &#34;-&#34; 表示范围: 6881-6999, 或可以一起使用: 6881-6889, 6999.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 直通外网的设备，比如 VPS ，务必配置防火墙和安全组策略允许此端口入站</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 内网环境的设备，比如 NAS ，除了防火墙设置，还需在路由器设置外网端口转发到此端口</span>
</span></span><span style=display:flex><span>listen-port<span style=color:#f92672>=</span><span style=color:#ae81ff>51413</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># DHT 网络与 UDP tracker 监听端口(UDP), 默认:6881-6999</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置 DHT (IPv4, IPv6) 和 UDP 服务器使用的 UCP 端口. 多个端口可以使用逗号 &#34;,&#34; 分隔, 例如: 6881,6885. 您还可以使用短横线 &#34;-&#34; 表示范围: 6881-6999, 或可以一起使用: 6881-6889, 6999.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 因协议不同，可以与 BT 监听端口使用相同的端口，方便配置防火墙和端口转发策略。</span>
</span></span><span style=display:flex><span>dht-listen-port<span style=color:#f92672>=</span><span style=color:#ae81ff>51413</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用 DHT (IPv4), 默认:true</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用 IPv4 DHT 功能. 此选项同时会启用 UDP 服务器支持. PT 下载(私有种子)会自动禁用</span>
</span></span><span style=display:flex><span>enable-dht<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用 DHT (IPv6)，默认:false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用 IPv6 DHT 功能. 如果种子设置为私有, 即使此选项设置为&#34;是&#34;, aria2 也不会启用 DHT. 使用 --dht-listen-port 选项设置监听的端口.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 在没有 IPv6 支持的环境开启可能会导致 DHT 功能异常</span>
</span></span><span style=display:flex><span>enable-dht6<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 外部 IP 地址</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定用在 BitTorrent 下载和 DHT 中的外部 IP 地址. 它可能被发送到 BitTorrent 服务器. 对于 DHT, 此选项将会报告本地节点正在下载特定的种子. 这对于在私有网络中使用 DHT 非常关键. 虽然这个方法叫外部, 但其可以接受各种类型的 IP 地址.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用场景：在家庭宽带没有公网 IP 的情况下可以把 BT 和 DHT 监听端口转发至具有公网 IP 的服务器，在此填写服务器的 IP ，可以提升 BT 下载速率。</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#bt-external-ip=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># DHT (IPv4) 文件，默认：$HOME/.opt/aria2/dht.dat</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 修改 IPv4 DHT 路由表文件路径.</span>
</span></span><span style=display:flex><span>dht-file-path<span style=color:#f92672>=</span>/home/kurome/.opt/aria2/dht.dat
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># DHT (IPv6) 文件，默认：$HOME/.opt/aria2/dht6.dat</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 修改 IPv6 DHT 路由表文件路径.</span>
</span></span><span style=display:flex><span>dht-file-path6<span style=color:#f92672>=</span>/home/kurome/.opt/aria2/dht6.dat
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># IPv4 DHT 网络引导节点</span>
</span></span><span style=display:flex><span>dht-entry-point<span style=color:#f92672>=</span>dht.transmissionbt.com:6881
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># IPv6 DHT 网络引导节点</span>
</span></span><span style=display:flex><span>dht-entry-point6<span style=color:#f92672>=</span>dht.transmissionbt.com:6881
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用本地节点发现(LPD),PT 下载(私有种子)会自动禁用,默认:false</span>
</span></span><span style=display:flex><span>bt-enable-lpd<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定用于本地节点发现的接口，可能的值：接口，IP地址</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果未指定此选项，则选择默认接口。</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#bt-lpd-interface=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用节点交换, 默认:true</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用节点交换扩展. 如果种子设置为私有, 即使此选项设置为&#34;是&#34;, aria2 也不会启用此功能.</span>
</span></span><span style=display:flex><span>enable-peer-exchange<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT 下载最大连接数（单任务），运行时可修改。0 为不限制，默认:55</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 理想情况下连接数越多下载越快，但在实际情况是只有少部分连接到的做种者上传速度快，其余的上传慢或者不上传。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果不限制，当下载非常热门的种子或任务数非常多时可能会因连接数过多导致进程崩溃或网络阻塞。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 进程崩溃：如果设备 CPU 性能一般，连接数过多导致 CPU 占用过高，因资源不足 Aria2 进程会强制被终结。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 网络阻塞：在内网环境下，即使下载没有占满带宽也会导致其它设备无法正常上网。因远古低性能路由器的转发性能瓶颈导致。</span>
</span></span><span style=display:flex><span>bt-max-peers<span style=color:#f92672>=</span><span style=color:#ae81ff>128</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT 下载期望速度值（单任务），运行时可修改。单位 K 或 M 。默认:50K</span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT 下载速度低于此选项值时会临时提高连接数来获得更快的下载速度，不过前提是有更多的做种者可供连接。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 实测临时提高连接数没有上限，但不会像不做限制一样无限增加，会根据算法进行合理的动态调节。</span>
</span></span><span style=display:flex><span>bt-request-peer-speed-limit<span style=color:#f92672>=</span>10M
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 全局最大上传速度, 运行时可修改, 默认:0 (无限制)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置全局最大上传速度 (字节/秒). 0 表示不限制. 您可以增加数值的单位 K 或 M (1K = 1024, 1M = 1024K).</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置过低可能影响 BT 下载速度</span>
</span></span><span style=display:flex><span>max-overall-upload-limit<span style=color:#f92672>=</span>2M
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 单任务上传速度限制, 默认:0 (无限制)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置每个任务的最大上传速度 (字节/秒). 0 表示不限制. 您可以增加数值的单位 K 或 M (1K = 1024, 1M = 1024K).</span>
</span></span><span style=display:flex><span>max-upload-limit<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最小分享率, 0 为一直做种, 默认:1.0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定分享率. 当分享率达到此选项设置的值时会完成做种. 强烈建议您将此选项设置为大于等于 1.0. 如果您想不限制分享比率, 可以设置为 0.0. 如果同时设置了 --seed-time 选项, 当任意一个条件满足时将停止做种.</span>
</span></span><span style=display:flex><span>seed-ratio<span style=color:#f92672>=</span>1.0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 最小做种时间（分钟）</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 此选项设置为 0 时, 将在 BT 任务下载完成后不进行做种.</span>
</span></span><span style=display:flex><span>seed-time<span style=color:#f92672>=</span><span style=color:#ae81ff>30</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 做种前检查文件哈希, 默认:true</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果设置为&#34;是&#34;, 当使用 --check-integrity 选项完成哈希检查及文件完成后才继续做种. 如果您希望仅当文件损坏或未完成时检查文件, 请设置为&#34;否&#34;. 此选项仅对 BT 下载有效</span>
</span></span><span style=display:flex><span>bt-hash-check-seed<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 继续之前的BT任务时, 无需再次校验, 默认:false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 不检查之前下载文件中每个分片的哈希值.</span>
</span></span><span style=display:flex><span>bt-seed-unverified<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT tracker 服务器连接超时时间（秒）。默认：60</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 建立连接后，此选项无效，将使用 bt-tracker-timeout 选项的值</span>
</span></span><span style=display:flex><span>bt-tracker-connect-timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT tracker 服务器超时时间（秒）。默认：60</span>
</span></span><span style=display:flex><span>bt-tracker-timeout<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT 服务器连接间隔时间。默认：0 (自动)</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置请求 BT 服务器的间隔时间 (秒). 此选项将完全覆盖服务器返回的最小间隔时间和间隔时间, aria2 仅使用此选项的值.如果设置为 0, aria2 将根据服务器的响应情况和下载进程决定时间间隔.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#bt-tracker-interval=0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT 下载优先下载文件开头或结尾</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 尝试先下载每个文件开头或结尾的分片. 此选项有助于预览文件. 参数可以包括两个关键词: head 和 tail. 如果包含两个关键词, 需要使用逗号分隔. 每个关键词可以包含一个参数, SIZE. 例如, 如果指定 head=SIZE, 每个文件的最前 SIZE 数据将会获得更高的优先级. tail=SIZE 表示每个文件的最后 SIZE 数据. SIZE 可以包含 K 或 M (1K = 1024, 1M = 1024K).</span>
</span></span><span style=display:flex><span>bt-prioritize-piece<span style=color:#f92672>=</span>head<span style=color:#f92672>=</span>32M,tail<span style=color:#f92672>=</span>32M
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 保存通过 WebUI(RPC) 上传的种子文件(.torrent)，默认:true</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 在 dir 选项设置的目录中保存上传的种子文件或 Metalink 文件. 文件名包括 SHA-1 哈希后的元数据和扩展名两部分. 对于种子文件, 扩展名为 &#39;.torrent&#39;. 对于 Metalink 为 &#39;.meta4&#39;. 如果此选项设置为&#34;否&#34;, 通过 aria2.addTorrent() 或 aria2.addMetalink() 方法添加的下载将无法通过 --save-session 选项保存.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 所有涉及种子文件保存的选项都建议开启，不保存种子文件有任务丢失的风险。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 通过 RPC 自定义临时下载目录可能不会保存种子文件。</span>
</span></span><span style=display:flex><span>rpc-save-upload-metadata<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 下载种子文件(.torrent)自动开始下载, 默认:true，可选：false|mem</span>
</span></span><span style=display:flex><span><span style=color:#75715e># true：保存种子文件</span>
</span></span><span style=display:flex><span><span style=color:#75715e># false：仅下载种子文件</span>
</span></span><span style=display:flex><span><span style=color:#75715e># mem：将种子保存在内存中</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果设置为&#34;是&#34;或&#34;仅内存&#34;, 当后缀为 .torrent 或内容类型为 application/x-bittorrent 的文件下载完成时, aria2 将按种子文件读取并下载该文件中提到的文件. 如果设置为&#34;仅内存&#34;, 该种子文件将不会写入到磁盘中, 而仅会存储在内存中. 如果设置为&#34;否&#34;, 则 .torrent 文件会下载到磁盘中, 但不会按种子文件读取并且其中的文件不会进行下载.</span>
</span></span><span style=display:flex><span>follow-torrent<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 种子文件下载完后暂停任务，默认：false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 在开启 follow-torrent 选项后下载种子文件或磁力会自动开始下载任务进行下载，而同时开启当此选项后会建立相关任务并暂停。</span>
</span></span><span style=display:flex><span>pause-metadata<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 保存磁力链接元数据为种子文件(.torrent), 默认:false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 保存种子文件为 &#34;.torrent&#34; 文件. 此选项仅对磁链生效. 文件名为十六进制编码后的哈希值及 &#34;.torrent&#34;后缀. 保存的目录与下载文件的目录相同. 如果相同的文件已存在, 种子文件将不会保存.</span>
</span></span><span style=display:flex><span>bt-save-metadata<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 加载已保存的元数据文件(.torrent)，默认:false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 当使用磁链下载时, 在从 DHT 获取种子元数据之前, 首先尝试加载使用 --bt-save-metadata 选项保存的文件. 如果文件加载成功, 则不会从 DHT 下载元数据.</span>
</span></span><span style=display:flex><span>bt-load-saved-metadata<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 删除 BT 下载任务中未选择文件，默认:false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 当 BT 任务完成后删除未选择的文件. 要选择需要下载的文件, 请使用 --select-file 选项. 如果没有选择, 则所有文件都默认为需要下载. 此选项会从磁盘上直接删除文件, 请谨慎使用此选项.</span>
</span></span><span style=display:flex><span>bt-remove-unselected-file<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT强制加密, 默认: false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用后将拒绝旧的 BT 握手协议并仅使用混淆握手及加密。可以解决部分运营商对 BT 下载的封锁，且有一定的防版权投诉与迅雷吸血效果。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 此选项相当于后面两个选项(bt-require-crypto=true, bt-min-crypto-level=arc4)的快捷开启方式，但不会修改这两个选项的值。</span>
</span></span><span style=display:flex><span>bt-force-encryption<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT加密需求，默认：false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用后拒绝与旧的 BitTorrent 握手协议(\19BitTorrent protocol)建立连接，始终使用混淆处理握手。</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#bt-require-crypto=true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT最低加密等级，可选：plain（明文），arc4（加密），默认：plain</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置加密方法的最小级别. 如果节点提供多种加密方法, aria2 将选择满足给定级别的最低级别.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#bt-min-crypto-level=arc4</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 分离仅做种任务，默认：false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从正在下载的任务中排除已经下载完成且正在做种的任务，并开始等待列表中的下一个任务。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 统计当前活动下载任务(参见 -j 选项) 时排除仅做种的任务. 这意味着, 如果参数设置为 -j3, 此选项打开并且当前有 3 个正在活动的任务, 并且其中有 1 个进入做种模式, 那么其会从正在下载的数量中排除(即数量会变为 2), 在队列中等待的下一个任务将会开始执行. 但要知道, 在 RPC 方法中, 做种的任务仍然被认为是活动的下载任务.</span>
</span></span><span style=display:flex><span>bt-detach-seed-only<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 客户端伪装 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 自定义 User Agent</span>
</span></span><span style=display:flex><span>user-agent<span style=color:#f92672>=</span>Mozilla/5.0 <span style=color:#f92672>(</span>Windows NT 10.0; Win64; x64<span style=color:#f92672>)</span> AppleWebKit/537.36 <span style=color:#f92672>(</span>KHTML, like Gecko<span style=color:#f92672>)</span> Chrome/93.0.4577.63 Safari/537.36 Edg/93.0.961.47
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT 客户端伪装</span>
</span></span><span style=display:flex><span><span style=color:#75715e># PT 下载需要保持 user-agent 和 peer-agent 两个参数一致</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 部分 PT 站对 Aria2 有特殊封禁机制，客户端伪装不一定有效，且有封禁账号的风险。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 自定义 User Agent，默认：aria2/$VERSION</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#user-agent=Deluge 1.3.15</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Peer Agent</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定 BT 扩展握手期间用于节点客户端版本的字符串.</span>
</span></span><span style=display:flex><span>peer-agent<span style=color:#f92672>=</span>Deluge 1.3.15
</span></span><span style=display:flex><span><span style=color:#75715e># 节点 ID 前缀</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定节点 ID 的前缀. BT 中节点 ID 长度为 20 字节. 如果超过 20 字节, 将仅使用前 20 字节. 如果少于 20 字节, 将在其后不足随机的数据保证为 20 字节.</span>
</span></span><span style=display:flex><span>peer-id-prefix<span style=color:#f92672>=</span>-DE13F0-
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 执行额外命令 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 下载停止后执行的命令</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从 正在下载 到 删除、错误、完成 时触发。暂停被标记为未开始下载，故与此项无关。</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#on-download-stop=/home/kurome/.opt/aria2/delete.sh</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 下载完成后执行的命令</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 此项未定义则执行 下载停止后执行的命令 (on-download-stop)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#on-download-complete=/home/kurome/.opt/aria2/clean.sh</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 下载错误后执行的命令</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 此项未定义则执行 下载停止后执行的命令 (on-download-stop)</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#on-download-error=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 下载暂停后执行的命令</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#on-download-pause=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 下载开始后执行的命令</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#on-download-start=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT 下载完成后执行的命令</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#on-bt-download-complete=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## RPC 设置 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用 JSON-RPC/XML-RPC 服务器, 默认:false</span>
</span></span><span style=display:flex><span>enable-rpc<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 接受所有远程请求, 默认:false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 在 RPC 响应头增加 Access-Control-Allow-Origin 字段, 值为 * .web界面跨域权限需要</span>
</span></span><span style=display:flex><span>rpc-allow-origin-all<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 允许外部访问, 默认:false</span>
</span></span><span style=display:flex><span>rpc-listen-all<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RPC 监听端口, 默认:6800</span>
</span></span><span style=display:flex><span>rpc-listen-port<span style=color:#f92672>=</span><span style=color:#ae81ff>6800</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RPC 密钥, v1.18.4新增功能, 取代 --rpc-user 和 --rpc-passwd 选项</span>
</span></span><span style=display:flex><span>rpc-secret<span style=color:#f92672>=</span>SetForYourself
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RPC 最大请求大小</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置 JSON-RPC/XML-RPC 最大的请求大小. 如果 aria2 检测到请求超过设定的字节数, 会直接取消连接.</span>
</span></span><span style=display:flex><span>rpc-max-request-size<span style=color:#f92672>=</span>10M
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># RPC 服务 SSL/TLS 加密, 默认：false</span>
</span></span><span style=display:flex><span><span style=color:#75715e># RPC 将通过 SSL/TLS 加密传输. RPC 客户端需要使用 https 协议连接服务器. 对于 WebSocket 客户端, 使用 wss 协议. 使用 --rpc-certificate 和 --rpc-private-key 选项设置服务器的证书和私钥.</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 不推荐开启，建议使用 web server 反向代理，比如 Nginx、Caddy ，灵活性更强。</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#rpc-secure=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 在 RPC 服务中启用 SSL/TLS 加密时的证书文件,</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 PEM 格式时，您必须通过 --rpc-private-key 指定私钥</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#rpc-certificate=/path/to/certificate.pem</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 在 RPC 服务中启用 SSL/TLS 加密时的私钥文件</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#rpc-private-key=/path/to/certificate.key</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 事件轮询方式, 可选：epoll, kqueue, port, poll, select, 不同系统默认值不同</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 设置事件轮训的方法. 对于 epoll, kqueue, port 和 poll, 只有系统支持时才可用. 最新的 Linux 支持 epoll. 各种 *BSD 系统包括 Mac OS X 支持 kqueue. Open Solaris 支持 port. 默认值根据您使用的操作系统不同而不同.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#event-poll=select</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 高级选项 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启用异步 DNS 功能。默认：true</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#async-dns=true</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定异步 DNS 服务器列表，未指定则从 /etc/resolv.conf 中读取。</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#async-dns-server=119.29.29.29,223.5.5.5,8.8.8.8,1.1.1.1</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定单个网络接口，可能的值：接口，IP地址，主机名</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果接口具有多个 IP 地址，则建议指定 IP 地址。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 已知指定网络接口会影响依赖本地 RPC 的连接的功能场景，即通过 localhost 和 127.0.0.1 无法与 Aria2 服务端进行讯通。</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#interface=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 指定多个网络接口，多个值之间使用逗号(,)分隔。</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用 interface 选项时会忽略此项。</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#multiple-interface=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## 日志设置 ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 日志文件保存路径，默认：不保存</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 如果设置为 &#34;-&#34;, 日志则写入到 stdout. 如果忽略或设置为空字符串(&#34;&#34;), 日志将不会记录到磁盘上.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#log=</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 日志级别，可选 debug, info, notice, warn, error 。默认：debug</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#log-level=warn</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 控制台日志级别，可选 debug, info, notice, warn, error ，默认：notice</span>
</span></span><span style=display:flex><span>console-log-level<span style=color:#f92672>=</span>notice
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 安静模式，禁止在控制台输出日志，默认：false</span>
</span></span><span style=display:flex><span>quiet<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 下载进度摘要输出间隔时间（秒），0 为禁止输出。默认：60</span>
</span></span><span style=display:flex><span>summary-interval<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>## BitTorrent trackers ##</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># BT 服务器地址 2022/02/26</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 逗号分隔的 BT 服务器地址. 如果服务器地址在 --bt-exclude-tracker 选项中, 其将不会生效.</span>
</span></span><span style=display:flex><span>bt-tracker<span style=color:#f92672>=</span>udp://open.tracker.cl:1337/announce,udp://tracker.opentrackr.org:1337/announce,udp://9.rarbg.com:2810/announce,udp://www.torrent.eu.org:451/announce,udp://tracker2.dler.org:80/announce,udp://tracker.torrent.eu.org:451/announce,udp://tracker.moeking.me:6969/announce,udp://tracker.bitsearch.to:1337/announce,udp://tracker.0x.tf:6969/announce,udp://tracker-udp.gbitt.info:80/announce,udp://tr.cili001.com:8070/announce,udp://retracker.lanta-net.ru:2710/announce,udp://open.stealth.si:80/announce,udp://ipv4.tracker.harry.lu:80/announce,udp://explodie.org:6969/announce,udp://exodus.desync.com:6969/announce,udp://bt2.archive.org:6969/announce,udp://bt1.archive.org:6969/announce,https://tracker.nanoha.org:443/announce,https://tracker.lilithraws.org:443/announce
</span></span></code></pre></div><p>更多：<a href=https://github.com/P3TERX/aria2.conf>Aria2 完美配置</a></p><p><strong>Aria2 Web 控制台</strong></p><p>Aira2 没有软件界面，程序员可以用代码执行任务，但普通用户怎样添加下载任务呢？——打开浏览器，输入网址<code>aria2c.com</code>（<a href=https://github.com/binux/yaaw>YAAW</a> 的中文版）就可以打开 Aria2 Web 控制台。</p><p><code>JSON-RPC Path</code> 默认为: <code>http://localhost:6800/jsonrpc</code>，如果提示 “Aria2 RPC 服务器错误”，按照以下方法修改：</p><ul><li>普通情况设置为: <code>http://host:port/jsonrpc</code><ul><li><code>host</code>: 指运行 Aria2 所在机器的 IP 或者名字</li><li><code>port</code>: 使用 <code>--rpc-listen-port</code> 选项设置的端口, 未设置则是 <code>6800</code>；可通过 <code>lsof -i:6800</code> 查看端口是否被占用</li></ul></li><li>使用 <code>--rpc-secret=xxxxxx</code> 选项设置为: <code>http://token:xxxxxx@host:port/jsonrpc</code></li><li>使用 <code>--rpc-user=user --rpc-passwd=pwd </code>选项设置为: <code>http://user:pwd@host:port/jsonrpc</code></li><li>以上<code>JSON-RPC Path</code> 中的 <code>http</code> 可以用 <code>ws</code> 替代, 代表使用 <code>WebSocket 协议</code>。换用 <code>ws</code> 也可能解决 “Aria2 RPC 服务器错误”。</li><li>当使用 <a href=https://aria2c.com/>https://aria2c.com</a> 访问时, 可能需要使用 <code>https</code> 或 <code>wss</code> 协议。</li></ul><p>在 Web UI 中对 Aria2 的设置会在 Aria2 重启后丢失,，必要的设置请写入配置文件。</p><p>已经下载完成的任务会在 Aria2 重启后消失, 除非启用了 <code>--force-save</code> 选项。</p><h4 id=自启动>自启动<a hidden class=anchor aria-hidden=true href=#自启动>#</a></h4><p>两个方案：</p><ol><li><p>建立 desktop 文件放入 <code>~/.config/autostart</code> 中：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vim ~/.config/autostart/aria2.desktop
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Desktop Entry<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>Application
</span></span><span style=display:flex><span>Exec<span style=color:#f92672>=</span>/usr/bin/aria2c --conf-path<span style=color:#f92672>=</span>/home/kurome/.opt/aria2/aria2.conf -D --all-proxy<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>Hidden<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>NoDisplay<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>X-GNOME-Autostart-enabled<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>Name<span style=color:#f92672>[</span>en_US<span style=color:#f92672>]=</span>Aria2 Daemon
</span></span><span style=display:flex><span>Name<span style=color:#f92672>=</span>Aria2 Daemon
</span></span><span style=display:flex><span>Comment<span style=color:#f92672>[</span>en_US<span style=color:#f92672>]=</span>
</span></span><span style=display:flex><span>Comment<span style=color:#f92672>=</span>
</span></span></code></pre></div><p>但这个就看桌面环境怎么操作了，比如我在 openSUSE KDE上的问题：开机登陆后，aria2 启动，但是 logout 后，aria2 就不启动了。</p></li><li><p>建议换 systemd，手写个 <a href=https://gist.github.com/h0tw1r3/ccf7668552fae5d14148>service</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo vim /usr/lib/systemd/system/aria2.service 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Unit<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Description<span style=color:#f92672>=</span>Aria2c download manager
</span></span><span style=display:flex><span>After<span style=color:#f92672>=</span>network.target
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Service<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>simple
</span></span><span style=display:flex><span>User<span style=color:#f92672>=</span>kurome
</span></span><span style=display:flex><span>ExecStart<span style=color:#f92672>=</span>/usr/bin/aria2c --conf-path<span style=color:#f92672>=</span>/home/kurome/.opt/aria2/aria2.conf --all-proxy<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Install<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>WantedBy<span style=color:#f92672>=</span>multi-user.target
</span></span><span style=display:flex><span>$ sudo systemctl enable --now aria2.service
</span></span></code></pre></div><p><a href=https://superuser.com/questions/1156676/what-causes-systemd-failed-at-step-user-spawning-usr-sbin-opendkim-no-such-p>“systemd: Failed at step USER spawning /usr/sbin/opendkim: No such process”</a>：注意 User 部分，首先必须按照如下写，其次必须是存在的用户</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>User<span style=color:#f92672>=</span>tadeusz
</span></span></code></pre></div></li></ol><h4 id=others-1>Others<a hidden class=anchor aria-hidden=true href=#others-1>#</a></h4><p><strong><a href=https://github.com/mayswind/AriaNg>AriaNg</a></strong></p><p>AriaNg 是一个让 aria2 更容易使用的现代 Web 前端</p><ul><li>使用很简单，将文件下载解压即可，可以本地打开 <code>index.html</code> 文件，也可上传到服务器。</li><li>如果您懒得部署 AriaNg ，可以直接访问现成的 <a href=http://a2.ssss.fun/>http://a2.ssss.fun</a> 。</li><li>打开后需要配置 AriaNg，打开 <code>AriaNg 设置</code> - <code>RPC</code>，修改 <code>Aria2 RPC 地址</code> 和 <code>Aria2 RPC 密钥</code> ，点击 <code>重新加载 AriaNg</code> 即可。</li></ul><p><strong><a href=https://github.com/ziahamza/webui-aria2>WebUI-Aria2</a></strong></p><p>这个项目的目标是创建世界上最好和最热门的界面来与 aria2 交互。</p><p>使用非常简单，只需在任何网络浏览器中下载并打开 index.html。</p><p><a href=http://www.senra.me/awesome-downloader-series-aria2-almost-the-best-all-platform-downloader/><strong>Aria2 for &mldr;.</strong></a></p><p>比如 <a href=https://github.com/acgotaku/YAAW-for-Chrome>YAAW for Chrome</a>、<a href=https://github.com/alexhua/Aria2-for-chrome>Aria2 for Chrome</a> 、Aria2 for Edge 之类的。</p><p>在浏览器中直接内置一个 AriaNg，用于直接管理 Aria2。</p><p><strong><a href=https://wiki.archlinux.org/title/Aria2#Using_Aria2_as_a_Daemon>Using Aria2 as a Daemon</a></strong></p><p>运行 <code>gnome-session-properties</code>打开应用程序首选项管理（即 Ubuntu 中的 Startup Applications），添加：</p><ul><li>Name: Aria2 Daemon</li><li>Command: <code>/usr/bin/aria2c --conf-path=/home/kurome/.opt/aria2/aria2.conf -D</code></li></ul><p>会建立 <code>.config/autostart/aria2c.desktop</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>Desktop Entry<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>Application
</span></span><span style=display:flex><span>Exec<span style=color:#f92672>=</span>/usr/bin/aria2c --conf-path<span style=color:#f92672>=</span>/home/vane/.opt/aria2/aria2.conf -D
</span></span><span style=display:flex><span>Hidden<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>NoDisplay<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>X-GNOME-Autostart-enabled<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>Name<span style=color:#f92672>[</span>en_US<span style=color:#f92672>]=</span>Aria2 Daemon
</span></span><span style=display:flex><span>Name<span style=color:#f92672>=</span>Aria2 Daemon
</span></span><span style=display:flex><span>Comment<span style=color:#f92672>[</span>en_US<span style=color:#f92672>]=</span>
</span></span><span style=display:flex><span>Comment<span style=color:#f92672>=</span>
</span></span></code></pre></div><h5 id=bt-下载预热httpwwwsenramesolutions-to-aria2-bt-metalink-download-slowly><a href=http://www.senra.me/solutions-to-aria2-bt-metalink-download-slowly/>BT 下载预热</a><a hidden class=anchor aria-hidden=true href=#bt-下载预热httpwwwsenramesolutions-to-aria2-bt-metalink-download-slowly>#</a></h5><p>是这样滴，和很多BT客户端一样，Aria2有个dht.dat文件(开启ipv6还有个dht6.dat)，这玩意用于存储一种叫做DHT Routing Table的东西，DHT网络由无数节点组成，你接触到一个后能通过它接触到更多的节点，Aria2我记得是有内置的节点，但是！如果你在Aria2第一次运行的时候直接下载磁力链接或者冷门种子，你很可能遇到连MetaData都无法获取的情况，这就是因为第一次只是初始化dht.dat文件，你本地不存在DHT Routing Table的缓存，所以你无法从DHT网络中获取足够的数据。</p><p>那么怎么办？我的建议是，找个热门种子(千万建议是种子，而不是磁力链接)，然后下一波，挂着做种，过几个小时后退出Aria2，或者等Aria2会话自动保存，你会发现dht.dat从空文件变成有数据了，这时候你下载就会正常很多。</p><h5 id=什么是-pthttpswwwcnblogscomwpjamerp4417174html><a href=https://www.cnblogs.com/wpjamer/p/4417174.html>什么是 PT</a><a hidden class=anchor aria-hidden=true href=#什么是-pthttpswwwcnblogscomwpjamerp4417174html>#</a></h5><p>答：PT（Private Tracker）下载其实也是Bt下载的一种，但有两个明显的改进：一是私密的小范围下载，二是进行流量统计，根据上载量决定你的权限。</p><p>BT下载时，软件会分析.torrent种子文件得到Tracker地址，然后连接Tracker服务器，服务器返回其他下载者的IP，下载者再与这些IP联系进行下载，从而减轻了服务器的负担，BT下载的Tracker是公开的，而Private Tracker 下载(PT下载)的Tracker则是私有的，每个人的Tracker是不同的，即passkey不同，passkey对PT下载者很重要，所以不要轻易泄露出去。</p><p>其实和通常BT相比，PT就是多了一个passkey验证，这样就能保证未注册的用户不能下载。所以passkey很重要，一旦发现有问题，就要到站点上去重置passkey。Tracker Server根据passkey把BT客户端上传量和下载量进行计算，从而算出分享率(上传量/下载量)。如果分享率太小，将会被删除帐号，从而不能下载。</p><p>这样Private Tracker 下载(PT下载)是一种小范围的BT下载，通过禁用DHT有要求地选择并控制用户数量，这样，在有限的范围内，下载的用户基本上都可以达到自己的宽带上限，Private Tracker 下载(PT下载)下载还通过论坛等方式的约束机制将BT下载的理念现实化，真正让用户做到下载的过程中努力上传。因此，Private Tracker 下载(PT下载)的速度很快，能够让用户款待得到最大程度的使用。</p><p>PT通过对做种时间和流量的要求在一定程度上避免了BT中存在的下完不做种的现象，因此在网络上，尤其是需要大文件（如高清）资源交换的时候广受欢迎，在PT站里，“水管”代表上传带宽的大小，大水管可以通过快速的上传获得积分，PT站点也会采取措施（比如做种时间，优惠等）使上传较慢的小水管能够参与贡献和共享资源。</p><h5 id=rpchttpswwwzhihucomquestion25536695><a href=https://www.zhihu.com/question/25536695>RPC</a><a hidden class=anchor aria-hidden=true href=#rpchttpswwwzhihucomquestion25536695>#</a></h5><p>首先了解什么叫RPC，为什么要RPC，RPC是指远程过程调用，也就是说两台服务器A，B，一个应用部署在A服务器上，想要调用B服务器上应用提供的函数/方法，由于不在一个内存空间，不能直接调用，需要通过网络来表达调用的语义和传达调用的数据。</p><p>比如说，一个方法可能是这样定义的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-java data-lang=java><span style=display:flex><span>Employee <span style=color:#a6e22e>getEmployeeByName</span><span style=color:#f92672>(</span>String fullName<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>那么：</p><ul><li>首先，要解决通讯的问题，主要是通过在客户端和服务器之间建立TCP连接，远程过程调用的所有交换的数据都在这个连接里传输。连接可以是按需连接，调用结束后就断掉，也可以是长连接，多个远程过程调用共享同一个连接。</li><li>第二，要解决寻址的问题，也就是说，A服务器上的应用怎么告诉底层的RPC框架，如何连接到B服务器（如主机或IP地址）以及特定的端口，方法的名称名称是什么，这样才能完成调用。比如基于Web服务协议栈的RPC，就要提供一个endpoint URI，或者是从UDDI服务上查找。如果是RMI调用的话，还需要一个RMI Registry来注册服务的地址。</li><li>第三，当A服务器上的应用发起远程过程调用时，方法的参数需要通过底层的网络协议如TCP传递到B服务器，由于网络协议是基于二进制的，内存中的参数的值要序列化成二进制的形式，也就是序列化（Serialize）或编组（marshal），通过寻址和传输将序列化的二进制发送给B服务器。</li><li>第四，B服务器收到请求后，需要对参数进行反序列化（序列化的逆操作），恢复为内存中的表达方式，然后找到对应的方法（寻址的一部分）进行本地调用，然后得到返回值。</li><li>第五，返回值还要发送回服务器A上的应用，也要经过序列化的方式发送，服务器A接到后，再反序列化，恢复为内存中的表达方式，交给A服务器上的应用</li></ul><p><img loading=lazy src=/Distributions/rpc.jpg alt=img></p><p>为什么RPC呢？就是无法在一个进程内，甚至一个计算机内通过本地调用的方式完成的需求，比如比如不同的系统间的通讯，甚至不同的组织间的通讯。由于计算能力需要横向扩展，需要在多台机器组成的集群上部署应用，</p><p>RPC的协议有很多，比如最早的CORBA，Java RMI，Web Service的RPC风格，Hessian，Thrift，甚至Rest API。</p><h5 id=其他-bt-下载工具httpwwwsenrametage4b88be8bdbde5b7a5e585b7><a href=http://www.senra.me/tag/%e4%b8%8b%e8%bd%bd%e5%b7%a5%e5%85%b7/>其他 BT 下载工具</a><a hidden class=anchor aria-hidden=true href=#其他-bt-下载工具httpwwwsenrametage4b88be8bdbde5b7a5e585b7>#</a></h5><ul><li><a href=https://github.com/qbittorrent/qBittorrent>qBittorrent</a></li><li><a href=https://github.com/transmission/transmission>Transmission</a></li><li><a href=https://github.com/rakshasa/rtorrent>rTorrent</a></li><li><a href=https://github.com/deluge-torrent/deluge>Deluge</a></li></ul><h5 id=有支持ed2k的计划吗httpsgithubcomaria2aria2issues986><a href=https://github.com/aria2/aria2/issues/986>有支持ed2k的计划吗？</a><a hidden class=anchor aria-hidden=true href=#有支持ed2k的计划吗httpsgithubcomaria2aria2issues986>#</a></h5><p>真是笑死我了，你们难道真的认为那所谓迅雷等国产BT下载软件会使用真正的<a href=https://zh.wikipedia.org/wiki/EDonkey%E7%BD%91%E7%BB%9C>eDonkey网络</a>？</p><p>非也！它们只不过通过ed2k链接所列出的哈希值 <strong>直接链接到它们服务器自身（如迅雷、百度）所存储的文件</strong> 或链接到BitTorrent协议的种子和磁力链接上。你们用的软件不是P2P（Peer to Peer），而是<a href=https://zh.wikipedia.org/wiki/P2SP>P2SP</a>（Peer to <strong>Server</strong> and to Peer）！</p><p>如果你们用过<strong>真正</strong>的ed2k下载器（如<a href=https://zh.wikipedia.org/wiki/EMule>eMule</a>、<a href=https://zh.wikipedia.org/wiki/AMule>aMule</a>）的话，你们会发现，真正的eDonkey网络早已消亡，截至目前全球用户也就50-60万的样子。</p><p>最后，作为曾经的eMule老用户，我可以说明<strong>真正</strong>的eDonkey网络不仅有繁琐的排队机制，还有文件优先级网络优先级等复杂的设定，远比你们想像中难用的多。</p><hr><p><a href=https://zhuanlan.zhihu.com/p/28405896><strong>warez groups</strong></a></p><ul><li><p>RELOADED</p><p>RELOADED成立于2004年，前身是传奇破解组DEVIANCE，曾经在2次重大的政府扫荡中生存下来，由于竞争对手HOODLUM和VENGEANCE被端掉，RELOADED从此称霸PC游戏破解圈，在新游的首发破解上，RELOADED能占据80%。</p><p>RELOADED也是国内最常见的PC游戏破解组，你在各个资源站看到标题写着某某游戏“R组”破解，就是他们的“杰作”。</p><p>高光时刻：</p><p>1、各大破解组都在追求游戏发售前破解游戏，而RELOADED最著名的应该就是2008年对《刺客信条》的破解了，R组在游戏发售1个月之前就放出破解版。</p><p>2、修复了《彩虹六号：维加斯2》数字版的BUG，育碧当年对《彩虹六号：维加斯2》数字版无法运行的BUG毫无办法，最终只能给玩家发放RELOADED的游戏破解补丁&mldr;这次事件让育碧颜面扫地，却成就了RELOADED。</p><p>3、打破《分裂细胞：混沌理论》424天不被破解的记录。</p></li><li><p>SKIDROW</p><p>SKIDROW 是来自美国的游戏破解组，成立时间大概是上个世纪90年代，主要作品有《猎杀潜艇5》、《刺客信条2》等，之后由于人员解散，直到2007年 SKIDROW 才重新开始活跃。</p><p>SKIDROW 在同行中的口碑一般，被RELOADED等破解组爆出过盗用其他破解组代码的料。</p><p>1、 Skidrow成名于DRM事件，DRM是育碧的反破解系统，Skidrow破解组成功破解了育碧两袋DRM系统，最著名的作品是对《刺客信条2》的破解。</p><p>2、2017年，继CPY之后，成功破解了最新的Denuvo64加密技术。并批评CPY只会用Emulation(仿真器)而不是真正的破解。</p></li><li><p>Razor1911</p><p>Razor1911 是来自挪威的破解组，成立于1985年，最初由3个年轻的计算机爱好者组成，主要是破解Commodore64和amiga机种的游戏软件，名称中的1911是因为1991在16进制里写作777，代表不朽。</p><p>作为老牌破解组之一， Razor1911在2001年和2004年的FBI两次反盗版行动中幸存下来，不知道是不是因为名字带来的好运。在业内，如果说RELOADED是以高产著称，那么Razor1911就是以技术见长。</p><p>Razor1911破解组最著名的作品应该是《星际争霸：母巢之战》的硬盘版，间接导致了星际争霸在全世界的流行。</p><p>1、制作《星际争霸：母巢之战》硬盘版，在这一版的星际争霸中，所有文件的体积加起来只有100m多一点，而最为经典的地方就在于他们把光盘版中两个600m左右的install.exe文件压缩到了只有22m的大小。</p><p>2、破解《GTA4》和该游戏价值20万美元的SecuRom反破解系统。</p><p>3、破解EA origin平台的加密技术。</p><p>4、破解《孤岛危机》和《上古卷轴5：天际》。</p></li><li><p>CPY</p><p>CPY全名 CONSPiR4CY，是来自于意大利的破解组，成立于1999年，相比上面的三大破解组成立较晚。但是最近几年，CPY在破解了Denuvo加密技术（D加密）后名声大噪，俨然已超越了上面三大破解组。</p><p>在国内有CPY掌握核心技术的说法，Steam、EA origin、Denuvo等加密技术先后被CPY破解。</p><p>高光时刻：</p><p>1、2015年，继Steam平台后，EA origin平台加密技术被破解，宣布了这套加密系统彻底完蛋。</p><p>2、破解D加密技术，随后一系列热门游戏遭到破解，包括：《合金装备5 幻痛》《古墓丽影 崛起》《毁灭战士4》《看门狗2》等等。</p></li><li><p><a href="https://zh.moegirl.org.cn/index.php?title=%E7%A0%B4%E8%A7%A3%E7%BB%84">CODEX</a></p><p>会破解D加密，如今几乎已经垄断破解业。并在.nfo文件招聘栏中提到CODEX什么都不要，只要竞争!</p><p>2022年2月，CODEX宣告退休。</p><ul><li>PLAZA</li><li>EMPRESS</li></ul></li><li><p><a href=https://en.wikipedia.org/wiki/List_of_warez_groups>STEAMPUNKS</a></p></li></ul><h3 id=youtube-dlhttpsgithubcomytdl-orgyoutube-dl><a href=https://github.com/ytdl-org/youtube-dl>youtube-dl</a><a hidden class=anchor aria-hidden=true href=#youtube-dlhttpsgithubcomytdl-orgyoutube-dl>#</a></h3><p>youtube-dl 是一个命令行程序，用于从 YouTube.com 和<a href=https://ytdl-org.github.io/youtube-dl/supportedsites.html>更多其他网站</a>下载视频。 基于 Python 实现，不限于特定平台。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 安装</span>
</span></span><span style=display:flex><span>$ pip install -i https://pypi.tuna.tsinghua.edu.cn/simple youtube-dl
</span></span><span style=display:flex><span><span style=color:#75715e># 使用</span>
</span></span><span style=display:flex><span>$ youtube-dl <span style=color:#f92672>[</span>OPTIONS<span style=color:#f92672>]</span> URL <span style=color:#f92672>[</span>URL...<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>当前版本（2021.06.06）<a href=https://stackoverflow.com/questions/60506532/why-can-only-download-the-first-episode-video-on-bilibili-with-youtube-dl>不能下载哔哩哔哩播放列表</a>，可以用类似软件如 <a href=https://github.com/soimort/you-get>you-get</a>， <a href=https://github.com/iawia002/annie>annie</a> 代替。</p><h4 id=usagehttpszhuanlanzhihucomp105141332><a href=https://zhuanlan.zhihu.com/p/105141332>Usage</a><a hidden class=anchor aria-hidden=true href=#usagehttpszhuanlanzhihucomp105141332>#</a></h4><p><strong>下载视频或整个视频播放列表</strong></p><ul><li>要从 Youtube 下载视频或整个视频播放列表，只需直接使用 URL 即可：<code>youtube-dl [url]</code>。程序自动选择一个最清晰的格式下载。</li><li>如果要指定视频下载之后的名称，可以使用如下方式：<code>youtube-dl -o '名称' [url]</code>。</li><li>还可以在下载视频时附加更多详细信息，可用的参数有标题、上传者名称（频道名称）和视频上传日期等：<code>youtube-dl -o '%(title)s by %(uploader)s on %(upload_date)s in %(playlist)s.%(ext)s' [ul]</code>。</li></ul><p><strong>查看视频的所有类型，只看不下载</strong></p><p>命令：<code>youtube-dl -F [url]</code>或者<code>youtube-dl --list-formats [url]</code>。
这是一个列清单参数，执行后并不会下载视频，但能知道这个目标视频都有哪些格式存在，以便有选择的下载。</p><p><strong>下载指定质量的视频和音频并自动合并</strong></p><p>下载最佳/最差质量的音/视频文件：</p><p>默认情况下，youtube-dl将自主选择最佳质量的视频下载。 但是，也可以以特定的质量或格式来下载视频或播放列表</p><p>Youtube-dl 支持以下品质：</p><ul><li><code>best</code>选择最佳质量的音/视频文件</li><li><code>worst</code>选择质量最差的格式（视频和音频）</li><li><code>bestvideo</code>选择最佳质量的仅视频格式（例如DASH视频），可能无法使用。</li><li><code>worstvideo</code>选择质量最差的纯视频格式，可能无法使用。</li><li><code>bestaudio</code>选择最优质的音频格式，可能无法使用。</li><li><code>worstaudio</code>选择质量最差的音频格式，可能无法使用。</li></ul><p>例如，如果要自动选择并下载最佳质量格式（音频和视频），只需使用以下命令：<code>youtube-dl -f best [url]</code>。</p><p>您还可以组合使用以下不同的格式选项：<code>youtube-dl -f bestvideo+bestaudio [ul]</code>。该命令将分别下载最高质量的仅视频和最高质量的纯音频格式，再用ffmpeg或avconv合并成一个最佳质量的mkv文件；如果您不想合并，请将<code>+</code>（加号）替换为<code>,</code>（逗号）即可分别得到最高质量的音频和视频（两个文件）：<code>youtube-dl -f 'bestvideo,bestaudio' [url]</code>。</p><p><strong>下载指定质量的音/视频文件</strong>：</p><p>-F 获取的所有视频格式的清单，最左边一列就是编号对应着不同的格式。由于YouTube的1080p及以上的分辨率都是音视频分离的，所以我们需要分别下载视频和音频，可以使用137+140这样的组合。如果系统中安装了ffmpeg的话，youtube-dl 会自动合并下好的视频和音频，然后自动删除单独的音视频文件：<code>youtube-dl -f [format code] [url]</code>。</p><p>从播放列表下载视频时，某些视频可能没有相同的格式。 在这种情况下，可以按首选顺序指定多个格式代码，例如：命令<code>youtube-dl -f 22/17/18 &lt;playlist_url></code>将以格式 22 下载视频（如果可用）；如果格式 22不可用，则它将下载格式 17（如果可用）；如果格式 22 和 17 都不可用，最后尝试下载格式 18。如果所有格式代码都不匹配，Youtube-dl 会报出提示。还需要注意的是，斜杠是左关联的，即最左侧的格式代码是首选。</p><p><strong>下载字幕</strong></p><ul><li><code>youtube-dl --write-sub [url]</code>这样会下载一个vtt格式的英文字幕和mkv格式的1080p视频下来</li><li><code>youtube-dl --write-sub --skip-download [url]</code>下载单独的vtt字幕文件,而不会下载视频</li><li><code>youtube-dl --write-sub --all-subs [url]</code>下载所有语言的字幕(如果有的话)</li><li><code>youtube-dl --write-auto-sub [url]</code>下载自动生成的字幕(YouTube only)</li></ul><p><strong>下载多个视频</strong></p><ul><li><code>youtube-dl &lt;url1> &lt;url2></code>有时我们需要一次下载多个不同的视频，此时我们只需用空格将多个URL分隔开即可。</li><li><code>youtube-dl -a url.txt</code>也可以将要下载视频的URL全部放在文本文件中，并将其作为参数传递给youtube-dl。此命令将下载url.txt文件中所有URL指向的视频。</li></ul><p><strong>只下载（视频中的）音频</strong></p><ul><li><code>youtube-dl -x [url]</code>仅从视频网站下载其音频。</li><li><code>youtube-dl -x --audio-format mp3 [ul]</code>默认情况下，youtube-dl 将以Ogg （opus）格式保存音频。此命令将从给定的视频/播放列表下载音频，将其转换为 MP3 并将其保存在当前目录中。应注意：您应该安装 ffmpeg 或 avconv 将文件转换为 mp3 格式。</li></ul><p><strong>下载带有描述、元数据、注释、字幕和缩略图的视频</strong></p><p>要下载视频及其他详细信息，如：说明、元数据、注释、字幕和缩略图等，请使用以下命令：
<code>youtube-dl --write-description --write-info-json --write-annotations --write-sub --write-thumbnail [url]</code></p><p><strong>通过文件扩展名下载音/视频</strong></p><ul><li><p>以您的首选格式下载视频，例如 MP4，只需执行：<code>youtube-dl --format mp4 [url]</code>或者<code>youtube-dl -f mp4 [url]</code>。</p></li><li><p>某些视频可能无法以您的首选格式提供。 在这种情况下，youtube-dl 将下载其他最佳可用格式。例如：
<code>youtube-dl -f 'bestvideo[ext=mp4]+bestaudio[ext=m4a]/best[ext=mp4]/best' [ul]</code>
此命令将下载最佳质量的MP4格式文件。如果 MP4 格式不可用，则它将下载其他最佳可用格式。</p><p><strong>限制下载视频的大小</strong></p></li></ul><p>从YouTube播放列表下载多个视频时，您可能只想下载特定大小的视频。例如：</p><ul><li>此命令不会下载任何小于指定大小（例如100MB）的视频：<code>youtube-dl --min-filesize 100M &lt;playlist_url></code>。</li><li>如果您不想下载大于给定大小的视频，可以这样：<code>youtube-dl --max-filesize 100M &lt;playlist_url></code>。</li></ul><p>我们还可以用组合格式，选择运算符来下载特定大小的视频。例如：</p><ul><li>以下命令将下载最佳视频格式但不大于 100MB 的视频：<code>youtube-dl -f 'best[filesize&lt;100M]' [url]</code>。</li></ul><p><strong>按日期下载视频</strong></p><p>Youtube-dl 允许我们按照上传日期来筛选和下载视频或播放列表，例如：</p><ul><li>要下载 2019 年 8 月 1 日上传的视频，可以使用：<code>youtube-dl --date 20190801 [URL]</code>；</li><li>下载在特定日期或之前上传的视频：<code>youtube-dl --datebefore 20190801 [URL]</code>；</li><li>下载在特定日期或之后上传的视频：<code>youtube-dl --dateafter 20190101 [URL]</code>；</li><li>仅下载过去 6 个月内上传的视频：<code>youtube-dl --dateafter now-6months [URL]</code>；</li><li>下载特定时间段内（例如 2018 年 1 月 1 日至 2019 年 1 月 1 日）上传的视频：<code>youtube-dl --dateafter 20180101 --datebefore 20190101 [URL]</code>。</li></ul><p><strong>从播放列表下载特定的视频</strong></p><p>从播放列表下载特定的视频，是youtube-dl 的另一个非常有用的功能。例如：</p><ul><li>要从播放列表下载第 10 个文件，可使用：<code>youtube-dl --playlist-items 10 [playlist_url]</code>；</li><li>要下载多个指定的文件，只需用逗号分隔：<code>youtube-dl --playlist-items 2,3,7,10 [playlist_url]</code>；</li></ul><p>也可以按序号来指定要下载范围，例如：</p><ul><li>从第 10 个开始，直接下载完整个列表：<code>youtube-dl --playlist-start 10 [playlist_url]</code>；</li><li>在播放列表中仅下载从第 2 到第 5 的文件：<code>youtube-dl --playlist-start 2 --playlist-end 5 [playlist_url]</code>。</li></ul><h4 id=configurationhttpswwwjianshucomp5143faa6056d><a href=https://www.jianshu.com/p/5143faa6056d>Configuration</a><a hidden class=anchor aria-hidden=true href=#configurationhttpswwwjianshucomp5143faa6056d>#</a></h4><p>在 Linux 和 macOS 上，系统配置文件位于 /<code>etc/youtube-dl.conf</code>，用户配置文件位于 <code>~/.config/youtube-dl/config</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Continue on download errors, for example to skip unavailable videos in a playlist</span>
</span></span><span style=display:flex><span>--ignore-errors
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Time to wait before giving up, in seconds</span>
</span></span><span style=display:flex><span>--socket-timeout <span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Download only videos not listed in the archive file. Record the IDs of all downloaded videos in it.</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#--download-archive   /path/archive.txt</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Number of retries (default is 10), or &#34;infinite&#34;.</span>
</span></span><span style=display:flex><span>--retries infinite
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Give these arguments to the external downloader</span>
</span></span><span style=display:flex><span>--external-downloader aria2c  --external-downloader-args <span style=color:#e6db74>&#34;--no-conf -c&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Output filename template, see the &#34;OUTPUT TEMPLATE&#34; for all the info</span>
</span></span><span style=display:flex><span>-o <span style=color:#e6db74>&#39;~/Videos/%(id)s.%(ext)s&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Write thumbnail image to disk</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#--write-thumbnail</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># download best 30hz mp4 file , h264+aac ,use http or https protocol,because we can use aria2c downloader to have a faster speed</span>
</span></span><span style=display:flex><span>--format <span style=color:#e6db74>&#39;(bestvideo[ext=mp4][fps&lt;31]+bestaudio[ext=m4a]/best[ext=mp4]/bestvideo+bestaudio/best)[protocol^=http]&#39;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Embed thumbnail in the audio as cover art</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#--embed-thumbnail</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># Write metadata to the video file</span>
</span></span><span style=display:flex><span>--add-metadata
</span></span></code></pre></div><h3 id=curlhttpwwwruanyifengcomblog201909curl-referencehtml><a href=http://www.ruanyifeng.com/blog/2019/09/curl-reference.html>curl</a><a hidden class=anchor aria-hidden=true href=#curlhttpwwwruanyifengcomblog201909curl-referencehtml>#</a></h3><h4 id=简介-1>简介<a hidden class=anchor aria-hidden=true href=#简介-1>#</a></h4><p>curl 是常用的命令行工具，用来请求 Web 服务器。它的名字就是客户端（client）的 URL 工具的意思。</p><p>它的功能非常强大，命令行参数多达几十种。如果熟练的话，完全可以取代 Postman 这一类的图形界面工具。</p><p>本文介绍它的主要命令行参数，作为日常的参考，方便查阅。</p><p>不带有任何参数时，curl 就是发出 GET 请求。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl https://www.example.com
</span></span></code></pre></div><p>上面命令向<code>www.example.com</code>发出 GET 请求，服务器返回的内容会在命令行输出。</p><h4 id=主要命令行参数>主要命令行参数<a hidden class=anchor aria-hidden=true href=#主要命令行参数>#</a></h4><p><strong>-A</strong></p><p><code>-A</code>参数指定客户端的用户代理标头，即<code>User-Agent</code>。curl 的默认用户代理字符串是<code>curl/[version]</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -A <span style=color:#e6db74>&#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&#39;</span> https://google.com
</span></span></code></pre></div><p>上面命令将<code>User-Agent</code>改成 Chrome 浏览器。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -A <span style=color:#e6db74>&#39;&#39;</span> https://google.com
</span></span></code></pre></div><p>上面命令会移除<code>User-Agent</code>标头。</p><p>也可以通过<code>-H</code>参数直接指定标头，更改<code>User-Agent</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -H <span style=color:#e6db74>&#39;User-Agent: php/1.0&#39;</span> https://google.com
</span></span></code></pre></div><p><strong>-b</strong></p><p><code>-b</code>参数用来向服务器发送 Cookie。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -b <span style=color:#e6db74>&#39;foo=bar&#39;</span> https://google.com
</span></span></code></pre></div><p>上面命令会生成一个标头<code>Cookie: foo=bar</code>，向服务器发送一个名为<code>foo</code>、值为<code>bar</code>的 Cookie。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -b <span style=color:#e6db74>&#39;foo1=bar;foo2=bar2&#39;</span> https://google.com
</span></span></code></pre></div><p>上面命令发送两个 Cookie。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -b cookies.txt https://www.google.com
</span></span></code></pre></div><p>上面命令读取本地文件<code>cookies.txt</code>，里面是服务器设置的 Cookie（参见<code>-c</code>参数），将其发送到服务器。</p><p><strong>-c</strong></p><p><code>-c</code>参数将服务器设置的 Cookie 写入一个文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -c cookies.txt https://www.google.com
</span></span></code></pre></div><p>上面命令将服务器的 HTTP 回应所设置 Cookie 写入文本文件<code>cookies.txt</code>。</p><p><strong>-d</strong></p><p><code>-d</code>参数用于发送 POST 请求的数据体。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -d <span style=color:#e6db74>&#39;login=emma＆password=123&#39;</span>-X POST https://google.com/login
</span></span><span style=display:flex><span><span style=color:#75715e># 或者</span>
</span></span><span style=display:flex><span>$ curl -d <span style=color:#e6db74>&#39;login=emma&#39;</span> -d <span style=color:#e6db74>&#39;password=123&#39;</span> -X POST  https://google.com/login
</span></span></code></pre></div><p>使用<code>-d</code>参数以后，HTTP 请求会自动加上标头<code>Content-Type : application/x-www-form-urlencoded</code>。并且会自动将请求转为 POST 方法，因此可以省略<code>-X POST</code>。</p><p><code>-d</code>参数可以读取本地文本文件的数据，向服务器发送。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -d <span style=color:#e6db74>&#39;@data.txt&#39;</span> https://google.com/login
</span></span></code></pre></div><p>上面命令读取<code>data.txt</code>文件的内容，作为数据体向服务器发送。</p><p><strong>&ndash;data-urlencode</strong></p><p><code>--data-urlencode</code>参数等同于<code>-d</code>，发送 POST 请求的数据体，区别在于会自动将发送的数据进行 URL 编码。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl --data-urlencode <span style=color:#e6db74>&#39;comment=hello world&#39;</span> https://google.com/login
</span></span></code></pre></div><p>上面代码中，发送的数据<code>hello world</code>之间有一个空格，需要进行 URL 编码。</p><p><strong>-e</strong></p><p><code>-e</code>参数用来设置 HTTP 的标头<code>Referer</code>，表示请求的来源。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -e <span style=color:#e6db74>&#39;https://google.com?q=example&#39;</span> https://www.example.com
</span></span></code></pre></div><p>上面命令将<code>Referer</code>标头设为<code>https://google.com?q=example</code>。</p><p><code>-H</code>参数可以通过直接添加标头<code>Referer</code>，达到同样效果。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>curl -H <span style=color:#e6db74>&#39;Referer: https://google.com?q=example&#39;</span> https://www.example.com
</span></span></code></pre></div><p><strong>-F</strong></p><p><code>-F</code>参数用来向服务器上传二进制文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -F <span style=color:#e6db74>&#39;file=@photo.png&#39;</span> https://google.com/profile
</span></span></code></pre></div><p>上面命令会给 HTTP 请求加上标头<code>Content-Type: multipart/form-data</code>，然后将文件<code>photo.png</code>作为<code>file</code>字段上传。</p><p><code>-F</code>参数可以指定 MIME 类型。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -F <span style=color:#e6db74>&#39;file=@photo.png;type=image/png&#39;</span> https://google.com/profile
</span></span></code></pre></div><p>上面命令指定 MIME 类型为<code>image/png</code>，否则 curl 会把 MIME 类型设为<code>application/octet-stream</code>。</p><p><code>-F</code>参数也可以指定文件名。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -F <span style=color:#e6db74>&#39;file=@photo.png;filename=me.png&#39;</span> https://google.com/profile
</span></span></code></pre></div><p>上面命令中，原始文件名为<code>photo.png</code>，但是服务器接收到的文件名为<code>me.png</code>。</p><p><strong>-G</strong></p><p><code>-G</code>参数用来构造 URL 的查询字符串。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -G -d <span style=color:#e6db74>&#39;q=kitties&#39;</span> -d <span style=color:#e6db74>&#39;count=20&#39;</span> https://google.com/search
</span></span></code></pre></div><p>上面命令会发出一个 GET 请求，实际请求的 URL 为<code>https://google.com/search?q=kitties&amp;count=20</code>。如果省略<code>--G</code>，会发出一个 POST 请求。</p><p>如果数据需要 URL 编码，可以结合<code>--data--urlencode</code>参数。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -G --data-urlencode <span style=color:#e6db74>&#39;comment=hello world&#39;</span> https://www.example.com
</span></span></code></pre></div><p><strong>-H</strong></p><p><code>-H</code>参数添加 HTTP 请求的标头。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -H <span style=color:#e6db74>&#39;Accept-Language: en-US&#39;</span> https://google.com
</span></span></code></pre></div><p>上面命令添加 HTTP 标头<code>Accept-Language: en-US</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -H <span style=color:#e6db74>&#39;Accept-Language: en-US&#39;</span> -H <span style=color:#e6db74>&#39;Secret-Message: xyzzy&#39;</span> https://google.com
</span></span></code></pre></div><p>上面命令添加两个 HTTP 标头。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -d <span style=color:#e6db74>&#39;{&#34;login&#34;: &#34;emma&#34;, &#34;pass&#34;: &#34;123&#34;}&#39;</span> -H <span style=color:#e6db74>&#39;Content-Type: application/json&#39;</span> https://google.com/login
</span></span></code></pre></div><p>上面命令添加 HTTP 请求的标头是<code>Content-Type: application/json</code>，然后用<code>-d</code>参数发送 JSON 数据。</p><p><strong>-i</strong></p><p><code>-i</code>参数打印出服务器回应的 HTTP 标头。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -i https://www.example.com
</span></span></code></pre></div><p>上面命令收到服务器回应后，先输出服务器回应的标头，然后空一行，再输出网页的源码。</p><p><strong>-I</strong></p><p><code>-I</code>参数向服务器发出 HEAD 请求，然会将服务器返回的 HTTP 标头打印出来。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -I https://www.example.com
</span></span></code></pre></div><p>上面命令输出服务器对 HEAD 请求的回应。</p><p><code>--head</code>参数等同于<code>-I</code>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl --head https://www.example.com
</span></span></code></pre></div><p><strong>-k</strong></p><p><code>-k</code>参数指定跳过 SSL 检测。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -k https://www.example.com
</span></span></code></pre></div><p>上面命令不会检查服务器的 SSL 证书是否正确。</p><p><strong>-L</strong></p><p><code>-L</code>参数会让 HTTP 请求跟随服务器的重定向。curl 默认不跟随重定向。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -L -d <span style=color:#e6db74>&#39;tweet=hi&#39;</span> https://api.twitter.com/tweet
</span></span></code></pre></div><p><strong>&ndash;limit-rate4</strong></p><p><code>--limit-rate</code>用来限制 HTTP 请求和回应的带宽，模拟慢网速的环境。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl --limit-rate 200k https://google.com
</span></span></code></pre></div><p>上面命令将带宽限制在每秒 200K 字节。</p><p><strong>-o</strong></p><p><code>-o</code>参数将服务器的回应保存成文件，等同于<code>wget</code>命令。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -o example.html https://www.example.com
</span></span></code></pre></div><p>上面命令将<code>www.example.com</code>保存成<code>example.html</code>。</p><p><strong>-O</strong></p><p><code>-O</code>参数将服务器回应保存成文件，并将 URL 的最后部分当作文件名。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -O https://www.example.com/foo/bar.html
</span></span></code></pre></div><p>上面命令将服务器回应保存成文件，文件名为<code>bar.html</code>。</p><p><strong>-s</strong></p><p><code>-s</code>参数将不输出错误和进度信息。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s https://www.example.com
</span></span></code></pre></div><p>上面命令一旦发生错误，不会显示错误信息。不发生错误的话，会正常显示运行结果。</p><p>如果想让 curl 不产生任何输出，可以使用下面的命令。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s -o /dev/null https://google.com
</span></span></code></pre></div><p><strong>-S</strong></p><p><code>-S</code>参数指定只输出错误信息，通常与<code>-s</code>一起使用。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -s -o /dev/null https://google.com
</span></span></code></pre></div><p>上面命令没有任何输出，除非发生错误。</p><p><strong>-u</strong></p><p><code>-u</code>参数用来设置服务器认证的用户名和密码。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -u <span style=color:#e6db74>&#39;bob:12345&#39;</span> https://google.com/login
</span></span></code></pre></div><p>上面命令设置用户名为<code>bob</code>，密码为<code>12345</code>，然后将其转为 HTTP 标头<code>Authorization: Basic Ym9iOjEyMzQ1</code>。</p><p>curl 能够识别 URL 里面的用户名和密码。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl https://bob:12345@google.com/login
</span></span></code></pre></div><p>上面命令能够识别 URL 里面的用户名和密码，将其转为上个例子里面的 HTTP 标头。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -u <span style=color:#e6db74>&#39;bob&#39;</span> https://google.com/login
</span></span></code></pre></div><p>上面命令只设置了用户名，执行后，curl 会提示用户输入密码。</p><p><strong>-v</strong></p><p><code>-v</code>参数输出通信的整个过程，用于调试。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -v https://www.example.com
</span></span></code></pre></div><p><code>--trace</code>参数也可以用于调试，还会输出原始的二进制数据。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl --trace - https://www.example.com
</span></span></code></pre></div><p><strong>-x</strong></p><p><code>-x</code>参数指定 HTTP 请求的代理。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -x socks5://james:cats@myproxy.com:8080 https://www.example.com
</span></span></code></pre></div><p>上面命令指定 HTTP 请求通过<code>myproxy.com:8080</code>的 socks5 代理发出。</p><p>如果没有指定代理协议，默认为 HTTP。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -x james:cats@myproxy.com:8080 https://www.example.com
</span></span></code></pre></div><p>上面命令中，请求的代理使用 HTTP 协议。</p><p><strong>-X</strong></p><p><code>-X</code>参数指定 HTTP 请求的方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl -X POST https://www.example.com
</span></span></code></pre></div><p>上面命令对<code>https://www.example.com</code>发出 POST 请求。</p><h4 id=httpiehttpsgithubcomhttpiehttpie><a href=https://github.com/httpie/httpie>HTTPie</a><a hidden class=anchor aria-hidden=true href=#httpiehttpsgithubcomhttpiehttpie>#</a></h4><p>HTTPie（<code>http</code>）以一种更人性化的方式做同样的工作。你会看到彩色的、格式化的输出，这使得它更容易理解和调试。</p><h4 id=axelhttpsgithubcomaxel-download-acceleratoraxel><a href=https://github.com/axel-download-accelerator/axel>axel</a><a hidden class=anchor aria-hidden=true href=#axelhttpsgithubcomaxel-download-acceleratoraxel>#</a></h4><p>Lightweight CLI download accelerator</p><h3 id=usenethttpswwwruanyifengcomblogusenet><a href=https://www.ruanyifeng.com/blog/usenet/>USENET</a><a hidden class=anchor aria-hidden=true href=#usenethttpswwwruanyifengcomblogusenet>#</a></h3><h4 id=起源>起源<a hidden class=anchor aria-hidden=true href=#起源>#</a></h4><p>简单地说，USENET是一个巨大无比的网上讨论组，一般也称为"新闻组"（newsgroups）。你可以将它想象成一个包罗万象、无所不有的网上论坛，但是它又不同于我们通常看到的普通论坛。这要从它的起源说起。</p><p>上个世纪70年代末，当时还没有互联网和浏览器，它们都要在十多年后才会出现。那时所谓"上网"，就是用modem（调制解调器），拨一个电话号码，将自己的电脑连到另一台电脑（也称"主机"），收收邮件，看看上面系统管理员发的通告。如果想换一台主机看看，那就必须先挂断，再拨另外一个电话号码。</p><p>这样的上网方式，很不利于开展多人的讨论。由于是拨号上网，只有地理位置相近的用户，才会登录同一台主机。很难想象，同一台机器的登录用户，既有东岸的纽约人，也有西岸的洛杉矶人。即使长途电话费不是问题，当时的主机也没有能力同时负担太多的远程终端。因此，迫切需要一种大规模的、分布式的、多中心的远程信息交换手段。</p><p>1979年，Duke大学的两个研究生Tom Truscott和Jim Ellis，提出一种分布式的网上讨论组的构想。这种讨论组创建之初，主要是供UNIX爱好者协会（USENIX）的成员使用，因此就被定名为USENET。当然，后来全世界的用户都在使用它。</p><h4 id=运行机制>运行机制<a hidden class=anchor aria-hidden=true href=#运行机制>#</a></h4><p>USENET的运行机制其实非常简单。对于用户来说，只有三步。</p><p>1）网络服务提供商（ISP）在一个网络中，设定一台服务器作为USENET专用服务器，再将它的网址告诉用户。</p><p>2）用户想要发言的时候，就向这个网址发送帖子（post），这与发送Email很相似，但是两者格式不一样，在USENET上发言必须使用专用的客户端。不过，现在大多数的Email客户端都带有新闻组功能，最常见的Outlook Express的设置可以参考网上的说明。</p><p>3）查看其他人的发言时，就必须从服务器上下载其他人的帖子。下载完成后，如果想回复某人的帖子，就再重复第二步。</p><p>可以看到，这个过程同邮件列表的运行几乎一模一样，不同之处在于，USENET服务器每天会同其他USENET服务器交换帖子。这就是说，全世界所有的USENET服务器最终都可以互相交换帖子，保持内容的同步。所以理论上，不管你的帖子是发到哪一台服务器上，最终全世界的人们都会看到，并且会从世界各地给你回复。</p><p>因此，USENET就有一个其他交流机制所没有的优点，即这是一个真正的全世界参与的讨论组。</p><h4 id=内容结构>内容结构<a hidden class=anchor aria-hidden=true href=#内容结构>#</a></h4><p>由于USENET中的讨论内容无所不包，所以必须根据主题分类。每一个主题就是一个"频道"，对这个主题感兴趣的用户就订阅这个频道。</p><p>USENET中的主题分类采用等级制（hierarchies），在形式上同域名很相似，即"一级主题.二级主题.三级主题&mldr;."，中间以小数点分隔。</p><p>一级主题有9个。</p><blockquote><p>* comp.*: 与计算机相关的讨论。（computer-related discussions，比如comp.software, comp.sys.amiga）</p><p>* misc.*: 各种不属于其他分类的主题。（Miscellaneous topics，比如misc.education, misc.forsale, misc.kids）</p><p>* news.*: 对USENET本身的讨论（比如news.groups, news.admin）</p><p>* rec.*: 休闲和娱乐（Recreation and entertainment，比如rec.music, rec.arts.movies）</p><p>* sci.*: 与科学相关的讨论。（Science related discussions，比如sci.psychology, sci.research）</p><p>* soc.*: 与社会相关的讨论。（Social discussions，比如soc.college.org, soc.culture.african）</p><p>* talk.*: 各种争议性话题的讨论。（Talk about various controversial topics，比如talk.religion, talk.politics, talk.origins）</p><p>* humanities.*: 艺术、文学、哲学方面的讨论。（Fine arts, literature, and philosophy，比如humanities.classics, humanities.design.misc）</p><p>* alt.*: 自由讨论区。（alternative）</p></blockquote><p>这9个一级主题中，除了alt.*以外，都不能自行设立讨论区。只有在alt主题区中，可以自己发起主题"频道"。</p><h4 id=二进制内容>二进制内容<a hidden class=anchor aria-hidden=true href=#二进制内容>#</a></h4><p>USENET最初设计的时候，只打算用来传递文本信息，没有考虑传递二进制数据（也就是"文件"）。但是，随着互联网的发展，不传递二进制数据看上去是不可能的。</p><p>于是，专门的编码方式被设计了出来，使得二进制文件可以转换成文本文件，在USENET上传递，用户下载以后再传换成原来的格式。这时，USENET就不仅是一个讨论组了，而成了传递文件的一种手段，图片、音频和视频都可以通过USENET传播。</p><p>事实上，如今USENET上的流量，99%都已经是二进制文件了。它们大部分都在alt.binaries这个主题中传播。由于不受监管，所以各种各样的文件都有。</p><h4 id=收费服务>收费服务<a hidden class=anchor aria-hidden=true href=#收费服务>#</a></h4><p>根据一项统计，2007年4月USENET上一天的流量为3.12TB，且还在快速增加中。这么大的流量，使得世界上提供USENET的服务商肯定不会很多。大家可以查看这个<a href=http://www.exit109.com/~jeremy/news/providers/providers.html>网页</a>，上面有USENET提供商的不完全列表。</p><p>这些服务商，又分为免费和收费两种。免费的USENET绝大多数都不提供二进制文件下载，查看<a href=https://groups.google.com/group/alt.free.newsservers>alt.free.newsservers</a>主题可以获得最新的免费USENET服务器的信息。</p><p>在收费服务商中，名气比较大的是<a href="https://www.giganews.com/?a=ruanyf">GIGANEWS</a>，它提供多种收费账户供用户选择。其中白金用户每月费用为19.99美元，可以无限量下载，14天内不满意可以退款。如果你是一个狂热的下载爱好者，我强烈推荐去购买一个账户。</p><h4 id=google-groups>Google Groups<a hidden class=anchor aria-hidden=true href=#google-groups>#</a></h4><p><a href=https://groups.google.com/>Google Groups</a>也提供免费USENET服务。（当然，没有二进制文件下载。）我会另写文章专门介绍，这里就省略了。</p><h3 id=百度网盘httpspanbaiducomdownloadlinux><a href=https://pan.baidu.com/download#linux>百度网盘</a><a hidden class=anchor aria-hidden=true href=#百度网盘httpspanbaiducomdownloadlinux>#</a></h3><h4 id=阿里云盘小白羊版httpsgithubcomliupan1890aliyunpan><a href=https://github.com/liupan1890/aliyunpan>阿里云盘小白羊版</a><a hidden class=anchor aria-hidden=true href=#阿里云盘小白羊版httpsgithubcomliupan1890aliyunpan>#</a></h4><h4 id=baidupcs-gohttpsgithubcomqjfoidnhbaidupcs-go><a href=https://github.com/qjfoidnh/BaiduPCS-Go>BaiduPCS-Go</a><a hidden class=anchor aria-hidden=true href=#baidupcs-gohttpsgithubcomqjfoidnhbaidupcs-go>#</a></h4><h3 id=坚果云>坚果云<a hidden class=anchor aria-hidden=true href=#坚果云>#</a></h3><h3 id=xdmhttpsgithubcomsubhra74xdm><a href=https://github.com/subhra74/xdm>xdm</a><a hidden class=anchor aria-hidden=true href=#xdmhttpsgithubcomsubhra74xdm>#</a></h3><p>Powerfull download accelerator and video downloader</p><h3 id=motrixhttpsgithubcomagalwoodmotrix><a href=https://github.com/agalwood/Motrix>Motrix</a><a hidden class=anchor aria-hidden=true href=#motrixhttpsgithubcomagalwoodmotrix>#</a></h3><p>A full-featured download manager.</p><h3 id=thunderhttpsflathuborgappsdetailscomxunleithunder><a href=https://flathub.org/apps/details/com.xunlei.Thunder>Thunder</a><a hidden class=anchor aria-hidden=true href=#thunderhttpsflathuborgappsdetailscomxunleithunder>#</a></h3><p>flatpak 版迅雷下载，用于下载 ed2k 链接。</p><h2 id=editor>Editor<a hidden class=anchor aria-hidden=true href=#editor>#</a></h2><h3 id=修改預設-editorhttpssamwhelpgithubionote-about-ubuntureadadjustmentenveditorhtml><a href=https://samwhelp.github.io/note-about-ubuntu/read/adjustment/env/editor.html>修改預設 editor</a><a hidden class=anchor aria-hidden=true href=#修改預設-editorhttpssamwhelpgithubionote-about-ubuntureadadjustmentenveditorhtml>#</a></h3><p>visudo 等操作会打开默认编辑器，在linux中默认编辑器读取EDITOR环境变量，可通过一下命令设置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ export EDITOR<span style=color:#f92672>=</span>nano
</span></span></code></pre></div><p>可将其加入~/.bashrc文件，使得每次登录都可使用</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ nano ~/.bashrc
</span></span><span style=display:flex><span>export EDITOR<span style=color:#f92672>=</span>nano
</span></span><span style=display:flex><span>$ . ~/.bashrc
</span></span></code></pre></div><p>debian系统提供了一个管理工具来设置默认编辑器。執行下面的指令，就可以設定改用其他慣用的文字編輯器了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo update-alternatives --config editor
</span></span></code></pre></div><p>會出現一個類似如下的列表，選擇你預設要使用的文字編輯器就行了。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>There are <span style=color:#ae81ff>5</span> choices <span style=color:#66d9ef>for</span> the alternative editor <span style=color:#f92672>(</span>providing /usr/bin/editor<span style=color:#f92672>)</span>.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  Selection    Path                Priority   Status
</span></span><span style=display:flex><span>------------------------------------------------------------
</span></span><span style=display:flex><span>* <span style=color:#ae81ff>0</span>            /bin/nano            <span style=color:#ae81ff>40</span>        auto mode
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>1</span>            /bin/ed             -100       manual mode
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>2</span>            /bin/nano            <span style=color:#ae81ff>40</span>        manual mode
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>3</span>            /usr/bin/nvim        <span style=color:#ae81ff>30</span>        manual mode
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>4</span>            /usr/bin/vim.basic   <span style=color:#ae81ff>30</span>        manual mode
</span></span><span style=display:flex><span>  <span style=color:#ae81ff>5</span>            /usr/bin/vim.tiny    <span style=color:#ae81ff>15</span>        manual mode
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>Press &lt;enter&gt; to keep the current choice<span style=color:#f92672>[</span>*<span style=color:#f92672>]</span>, or type selection number:
</span></span></code></pre></div><p>我輸入「3」，按下「Enter」。</p><p>上面的操作完畢後驗證一下,看看是不是你想要預設使用的編輯器。</p><p>執行下面的指令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ editor
</span></span></code></pre></div><p>或是執行下面的指令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sensible-editor
</span></span></code></pre></div><p>另外也可以直接執行下面的指令，更改成你慣用的文字編輯器</p><p>例如：</p><p>慣用 vim.tiny</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo update-alternatives --set editor /usr/bin/vim.tiny
</span></span></code></pre></div><h3 id=vscodehttpscodevisualstudiocomdocssetuplinux><a href=https://code.visualstudio.com/docs/setup/linux>VSCode</a><a hidden class=anchor aria-hidden=true href=#vscodehttpscodevisualstudiocomdocssetuplinux>#</a></h3><p>Alternatively, the repository and key can also be installed manually with the following script:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt-get install wget gpg
</span></span><span style=display:flex><span>$ wget -qO- https://packages.microsoft.com/keys/microsoft.asc | gpg --dearmor &gt; packages.microsoft.gpg
</span></span><span style=display:flex><span>$ sudo install -D -o root -g root -m <span style=color:#ae81ff>644</span> packages.microsoft.gpg /etc/apt/keyrings/packages.microsoft.gpg
</span></span><span style=display:flex><span>$ sudo sh -c <span style=color:#e6db74>&#39;echo &#34;deb [arch=amd64,arm64,armhf signed-by=/etc/apt/keyrings/packages.microsoft.gpg] https://packages.microsoft.com/repos/code stable main&#34; &gt; /etc/apt/sources.list.d/vscode.list&#39;</span>
</span></span><span style=display:flex><span>$ rm -f packages.microsoft.gpg
</span></span></code></pre></div><p>Then update the package cache and install the package using:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install apt-transport-https
</span></span><span style=display:flex><span>$ sudo apt update
</span></span><span style=display:flex><span>$ sudo apt install code <span style=color:#75715e># or code-insiders</span>
</span></span><span style=display:flex><span>$ cat /usr/share/applications/code.desktop 
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Desktop Entry<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Name<span style=color:#f92672>=</span>Visual Studio Code
</span></span><span style=display:flex><span>Comment<span style=color:#f92672>=</span>Code Editing. Redefined.
</span></span><span style=display:flex><span>GenericName<span style=color:#f92672>=</span>Text Editor
</span></span><span style=display:flex><span>Exec<span style=color:#f92672>=</span>/usr/share/code/code --unity-launch %F
</span></span><span style=display:flex><span>Icon<span style=color:#f92672>=</span>com.visualstudio.code
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>Application
</span></span><span style=display:flex><span>StartupNotify<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span>StartupWMClass<span style=color:#f92672>=</span>Code
</span></span><span style=display:flex><span>Categories<span style=color:#f92672>=</span>TextEditor;Development;IDE;
</span></span><span style=display:flex><span>MimeType<span style=color:#f92672>=</span>text/plain;inode/directory;application/x-code-workspace;
</span></span><span style=display:flex><span>Actions<span style=color:#f92672>=</span>new-empty-window;
</span></span><span style=display:flex><span>Keywords<span style=color:#f92672>=</span>vscode;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Desktop Action new-empty-window<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Name<span style=color:#f92672>=</span>New Empty Window
</span></span><span style=display:flex><span>Exec<span style=color:#f92672>=</span>/usr/share/code/code --new-window %F
</span></span><span style=display:flex><span>Icon<span style=color:#f92672>=</span>com.visualstudio.code
</span></span></code></pre></div><p><strong>GitHub VS Code Web</strong></p><p>只要访问下面的网址，你就能在浏览器里面，使用 VS Code 编辑指定仓库。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>https://github.dev/<span style=color:#f92672>[</span>用户名<span style=color:#f92672>]</span>/<span style=color:#f92672>[</span>仓库名<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>它实际上就是 VS Code 编辑器的 Web 版，并且与 Git 高度集成。</p><p><a href="https://cyhour.com/1638/#:~:text=%E4%B8%8D%E8%BF%87%E8%BA%AB%E5%A4%84%E5%B1%80%E5%9F%9F%E7%BD%91%E5%86%85%EF%BC%8C%E4%B8%AD%E5%9B%BD%E5%9B%BD%E5%86%85%E4%B8%8B%E8%BD%BD%20VSCode%20%E9%80%9F%E5%BA%A6%E6%AD%A3%E5%B8%B8%E6%83%85%E5%86%B5%E4%B8%8B%E6%AF%94%E8%BE%83%E6%85%A2%EF%BC%8C%E4%B8%BB%E8%A6%81%E6%9C%89%E4%B8%A4%E4%B8%AA%E8%A7%A3%E5%86%B3%E5%8A%9E%E6%B3%95%EF%BC%9A%E4%B8%80%E6%98%AF%E8%B5%B0%20%E5%A4%96%E8%B4%B8%E5%B7%A5%E4%BD%9C%20%E4%B8%96%E7%95%8C%E4%BA%92%E8%81%94%E7%BD%91%E7%BB%9C%EF%BC%9B%E4%BA%8C%E6%98%AF%E4%BD%BF%E7%94%A8%E4%B8%AD%E5%9B%BD%20cdn%20%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%80%E4%B8%8B%E8%BD%BD%E3%80%82.%20%E6%96%B9%E6%B3%95%E4%BA%8C%E4%BD%BF%E7%94%A8,%E9%95%9C%E5%83%8F%E5%9C%B0%E5%9D%80%E4%B8%8B%E8%BD%BD%E6%AF%94%E8%BE%83%E7%AE%80%E5%8D%95%EF%BC%9A.%20%E6%AF%94%E5%A6%82%EF%BC%8C%E7%82%B9%E5%87%BB%E4%B8%8B%E8%BD%BD%20VSCodeUserSetup-x64-1.52.1.exe%EF%BC%8C%E4%BC%9A%E5%BE%97%E5%88%B0%E8%BF%99%E4%B8%AA%E5%9C%B0%E5%9D%80%EF%BC%9A.%20https%3A%2F%2Faz764295.vo.msecnd.net%2Fstable%2Fea3859d4ba2f3e577a159bc91e3074c5d85c0523%2FVSCodeUserSetup-x64-1.52.1.exe.%20%E6%8A%8A%20stable%20%E5%89%8D%E5%9C%B0%E5%9D%80%E6%9B%BF%E6%8D%A2%E6%88%90%20vscode.cdn.azure.cn%EF%BC%8C%E4%B8%8B%E9%9D%A2%E6%98%AF%E6%9B%BF%E6%8D%A2%E5%90%8E%E5%9C%B0%E5%9D%80%EF%BC%9A."><strong>国内下载速度慢</strong></a></p><p>使用 azure 中国 cdn 镜像地址加速下载 VSCode</p><p>将<a href=https://az764295.vo.msecnd.net/stable/>默认下载地址</a>替换为 <a href=https://vscode.cdn.azure.cn/stable/>vscode.cdn.azure.cn</a></p><p><a href=https://github.com/coder/code-server><strong>code-server</strong></a></p><p>VS Code in the browser</p><p>可以提高兼容性，解决输入法之类的问题。</p><h4 id=配置-1>配置<a hidden class=anchor aria-hidden=true href=#配置-1>#</a></h4><p>Press CTRL+SHIFT+P, then search for</p><p>Open User Settings (JSON)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 每80和120行就显示一条线
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;editor.rulers&#34;</span>: [
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>80</span>,
</span></span><span style=display:flex><span>        <span style=color:#ae81ff>120</span>
</span></span><span style=display:flex><span>    ],
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 失去焦点后自动保存
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;files.autoSave&#34;</span>: <span style=color:#e6db74>&#34;onFocusChange&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 每次保存的时候自动格式化
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;editor.formatOnSave&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 缩进
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;editor.tabSize&#34;</span>: <span style=color:#ae81ff>4</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;editor.insertSpaces&#34;</span>: <span style=color:#66d9ef>true</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;editor.detectIndentation&#34;</span>: <span style=color:#66d9ef>false</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 自动换行
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;editor.wordWrap&#34;</span>: <span style=color:#e6db74>&#34;off&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// 字体
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;editor.fontFamily&#34;</span>: <span style=color:#e6db74>&#34;&#39;Meslo LG S for Powerline&#39;, monospace&#34;</span>,
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;editor.fontSize&#34;</span>: <span style=color:#ae81ff>14</span>,
</span></span><span style=display:flex><span>    <span style=color:#75715e>// Folding Maximum Regions
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>    <span style=color:#f92672>&#34;editor.foldingMaximumRegions&#34;</span>: <span style=color:#ae81ff>50000</span>,
</span></span></code></pre></div><p>Open Keyboard Shortcuts (JSON)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#75715e>// Place your key bindings in this file to override the defaults
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>[
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;key&#34;</span>: <span style=color:#e6db74>&#34;ctrl+shift+u&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;editor.action.transformToUppercase&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;when&#34;</span>: <span style=color:#e6db74>&#34;editorTextFocus&#34;</span>
</span></span><span style=display:flex><span>    },
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;key&#34;</span>: <span style=color:#e6db74>&#34;ctrl+shift+l&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;command&#34;</span>: <span style=color:#e6db74>&#34;editor.action.transformToLowercase&#34;</span>,
</span></span><span style=display:flex><span>        <span style=color:#f92672>&#34;when&#34;</span>: <span style=color:#e6db74>&#34;editorTextFocus&#34;</span>
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>]
</span></span></code></pre></div><p>参考：</p><ul><li><a href=https://stackoverflow.com/questions/29972396/how-can-i-customize-the-tab-to-space-conversion-factor>How can I customize the tab-to-space conversion factor?</a></li><li><a href=https://stackoverflow.com/questions/29968499/vertical-rulers-in-visual-studio-code>Vertical rulers in Visual Studio Code</a></li><li><a href=https://stackoverflow.com/questions/35184509/make-selected-block-of-text-uppercase>Make selected block of text uppercase</a></li><li><a href=https://gist.github.com/thawankeane/478acc9c061210be121c332f9bed064b>vscode.settings.json</a></li><li><a href=https://stackoverflow.com/a/36350929>How to change environment&rsquo;s font size?</a></li></ul><h4 id=快捷键httpszhuanlanzhihucomp113222681><a href=https://zhuanlan.zhihu.com/p/113222681>快捷键</a><a hidden class=anchor aria-hidden=true href=#快捷键httpszhuanlanzhihucomp113222681>#</a></h4><p>对于 行 的操作：</p><ul><li>重开一行：光标在行尾的话，回车即可；不在行尾，<code>ctrl + enter</code> 向下重开一行；<code>ctrl+ shift + enter</code> 则是在上一行重开一行</li><li>删除一行：光标没有选择内容时，<code>ctrl + x</code> 剪切一行；<code>ctrl + shift + k</code> 直接删除一行</li><li>移动一行：<code>alt + ↑</code> 向上移动一行；<code>alt + ↓</code> 向下移动一行</li><li>复制一行：<code>shift + alt + ↓</code> 向下复制一行；<code>shift + alt + ↑</code> 向上复制一行</li><li><code>ctrl + z</code> 回退</li></ul><p>对于 词 的操作：</p><ul><li>选中一个词：<code>ctrl + d</code></li></ul><p>搜索或者替换：</p><ul><li><code>ctrl + f</code> ：搜索</li><li><code>ctrl + alt + f</code>： 替换</li><li><code>ctrl + shift + f</code>：在项目内搜索</li></ul><p>通过 <strong>Ctrl + `</strong> 可以打开或关闭终端</p><p>Ctrl+P 快速打开最近打开的文件</p><p>Ctrl+Shift+N 打开新的编辑器窗口</p><p>Ctrl+Shift+W 关闭编辑器</p><p>Home 光标跳转到行头</p><p>End 光标跳转到行尾</p><p>Ctrl + Home 跳转到页头</p><p>Ctrl + End 跳转到页尾</p><p>Ctrl + Shift + [ 折叠区域代码</p><p>Ctrl + Shift + ] 展开区域代码</p><p>Ctrl + / 添加关闭行注释</p><p>Shift + Alt +A 块区域注释</p><h4 id=插件>插件<a hidden class=anchor aria-hidden=true href=#插件>#</a></h4><ul><li>open in browser：运行html文件</li><li>Auto Rename Tag：自动修改匹配的 HTML 标签。</li><li><a href=https://github.com/microsoft/vscode-hexeditor>VS Code Hex Editor</a></li></ul><h4 id=truste-foldershttpsstackoverflowcoma67914669><a href=https://stackoverflow.com/a/67914669>Truste folders</a><a hidden class=anchor aria-hidden=true href=#truste-foldershttpsstackoverflowcoma67914669>#</a></h4><p><strong>Using a single trusted folder to hold your projects</strong></p><p>If you work with many projects that you trust and don&rsquo;t want to be prompted about trusting each one individually, you can consider trusting their parent folder.</p><ol><li>Using <code>Ctrl + Shift + P</code> run the <code>Workspaces: Manage Workspace Trust</code> command</li><li>Scroll down to the <code>Trusted folders and workspaces</code> section and click <code>Add Folder</code></li><li>Select the parent folder of all your trusted workspaces</li></ol><p>Now any project you open under the parent folder will be trusted automatically.</p><h3 id=google-keep>Google Keep<a hidden class=anchor aria-hidden=true href=#google-keep>#</a></h3><p>web version.</p><p><a href=https://www.makeuseof.com/google-keep-keyboard-shortcuts/><strong>Google Keep键盘快捷键</strong></a></p><table><thead><tr><th style=text-align:left>hortcut</th><th style=text-align:left>Action</th></tr></thead><tbody><tr><td style=text-align:left>J/K</td><td style=text-align:left>Next/previous note</td></tr><tr><td style=text-align:left>Shift + J/K</td><td style=text-align:left>Move note to next/previous position</td></tr><tr><td style=text-align:left>N/P</td><td style=text-align:left>Next/previous list item</td></tr><tr><td style=text-align:left>Shift + N/P</td><td style=text-align:left>Move list item to next/previous position</td></tr><tr><td style=text-align:left>C</td><td style=text-align:left>New note</td></tr><tr><td style=text-align:left>L</td><td style=text-align:left>New list</td></tr><tr><td style=text-align:left>/</td><td style=text-align:left>Search</td></tr><tr><td style=text-align:left>Ctrl + A</td><td style=text-align:left>Select all</td></tr><tr><td style=text-align:left>E</td><td style=text-align:left>Archive</td></tr><tr><td style=text-align:left>#</td><td style=text-align:left>Delete</td></tr><tr><td style=text-align:left>F</td><td style=text-align:left>Pin/unpin</td></tr><tr><td style=text-align:left>X</td><td style=text-align:left>Select</td></tr><tr><td style=text-align:left>Ctrl + G</td><td style=text-align:left>Toggle list and grid view</td></tr><tr><td style=text-align:left>Esc</td><td style=text-align:left>Close editor</td></tr><tr><td style=text-align:left>Ctrl + Shift + 8</td><td style=text-align:left>Toggle checkboxes</td></tr><tr><td style=text-align:left>Ctrl + ] / [</td><td style=text-align:left>Indent/dedent list item</td></tr><tr><td style=text-align:left>?</td><td style=text-align:left>Open shortcut list</td></tr><tr><td style=text-align:left>@</td><td style=text-align:left>Send feedback</td></tr></tbody></table><h3 id=joplinhttpscomputetechnologydailycom20210212cf916cdb6cfb498aac38d4fa50d785a2><a href=https://computetechnologydaily.com/2021/02/12/cf916cdb6cfb498aac38d4fa50d785a2/>Joplin</a><a hidden class=anchor aria-hidden=true href=#joplinhttpscomputetechnologydailycom20210212cf916cdb6cfb498aac38d4fa50d785a2>#</a></h3><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ wget -O - https://raw.githubusercontent.com/laurent22/joplin/dev/Joplin_install_and_update.sh | bash
</span></span></code></pre></div><p>joplin.desktop</p><pre tabindex=0><code>[Desktop Entry]
Encoding=UTF-8
Name=Joplin
Comment=Joplin for Desktop
Exec=${HOME}/.joplin/Joplin.AppImage ${SANDBOXPARAM} %u
Icon=joplin
StartupWMClass=Joplin
Type=Application
Categories=Office;
MimeType=x-scheme-handler/joplin;
X-GNOME-SingleWindow=true // should be removed eventually as it was upstream to be an XDG specification
SingleMainWindow=true
</code></pre><h4 id=为知笔记>为知笔记<a hidden class=anchor aria-hidden=true href=#为知笔记>#</a></h4><h4 id=notion>notion<a hidden class=anchor aria-hidden=true href=#notion>#</a></h4><h4 id=思源笔记httpsgithubcomsiyuan-notesiyuanblobmasterreadme_zh_cnmd><a href=https://github.com/siyuan-note/siyuan/blob/master/README_zh_CN.md>思源笔记</a><a hidden class=anchor aria-hidden=true href=#思源笔记httpsgithubcomsiyuan-notesiyuanblobmasterreadme_zh_cnmd>#</a></h4><h4 id=备份盘--同步盘-httpswwwzhihucomquestion388093965answer1335747294><a href=https://www.zhihu.com/question/388093965/answer/1335747294>备份盘 & 同步盘 </a><a hidden class=anchor aria-hidden=true href=#备份盘--同步盘-httpswwwzhihucomquestion388093965answer1335747294>#</a></h4><p>备份盘：</p><p><img loading=lazy src=/Distributions/v2-f4cf6709c1022af4889fc1046fe575ea_720w.jpg alt></p><p>同步盘：</p><p><img loading=lazy src=/Distributions/v2-3062823464aa9148b95eca6f5107d763_720w.jpg alt></p><h3 id=obsidianhttpsobsidianmd><a href=https://obsidian.md/>Obsidian</a><a hidden class=anchor aria-hidden=true href=#obsidianhttpsobsidianmd>#</a></h3><p>闭源软件，但超好用。</p><h4 id=最适合程序员的笔记软件httpswwwruanyifengcomblog202108best-note-taking-software-for-programmershtml><a href=https://www.ruanyifeng.com/blog/2021/08/best-note-taking-software-for-programmers.html>最适合程序员的笔记软件</a><a hidden class=anchor aria-hidden=true href=#最适合程序员的笔记软件httpswwwruanyifengcomblog202108best-note-taking-software-for-programmershtml>#</a></h4><p>程序员的笔记软件，应该满足下面几个条件。</p><ul><li>跨平台，同时支持桌面电脑（Windows，Mac，Linux）和手机（Android，iOS）。</li><li>随时同步，打开任何一台机器，都能接着上一次的工作继续写。</li><li>实时存储，如果软件突然关闭，也不会丢失内容。</li><li>支持 Markdown 格式，便于后期直接发布。</li><li>支持推送到远程 Git 仓库，产生历史版本，同时作为远程备份。</li></ul><p><a href=https://stackedit.io/>Stackedit.io</a> 和 <a href=https://hackmd.io/>HackMD.io</a>，都不是很理想。</p><p>GitHub 官方推出的 <a href=https://docs.github.com/en/codespaces/developing-in-codespaces/web-based-editor>github.dev</a>。只要访问 <code>https://github.dev/[用户名]/[仓库名]</code>，你就能在浏览器里面，使用 VS Code 编辑指定仓库。它实际上就是 VS Code 编辑器的 Web 版，并且与 Git 高度集成。GitHub 提供了一个快捷入口。 打开 GitHub 仓库主页，按一下小数点（<code>.</code>）这个键， 页面就会自动跳转到 VS Code 编辑环境。</p><p>如果你更希望使用手机原生 App，我推荐 <a href=https://obsidian.md/>Obsidian</a>。它有全平台的客户端，并且可以参考<a href=https://forum.obsidian.md/t/mobile-setting-up-ios-git-based-syncing-with-mobile-app-using-working-copy/16499>这篇文章</a>设置 Git 集成。</p><p>评论里还有很多推荐，选择一个合适的就行。</p><h4 id=安装>安装<a hidden class=anchor aria-hidden=true href=#安装>#</a></h4><p>使用 AppImage 报 <code>dlopen(): error loading libfuse.so.2</code> 错误：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install libfuse2
</span></span></code></pre></div><h4 id=全平台同步>全平台同步<a hidden class=anchor aria-hidden=true href=#全平台同步>#</a></h4><p><a href=https://github.com/remotely-save/remotely-save><strong>remotely-save</strong></a></p><p>remotely-save 用于 Android 端与 PC 端的同步，可使用 dropbox。我希望在每次关闭 Obsidian 窗口（即编辑完毕后）自动备份内容到 Git 仓库。</p><ul><li><p>obsidian.desktop</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>Desktop Entry<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Name<span style=color:#f92672>=</span>Obsidian
</span></span><span style=display:flex><span>GenericName<span style=color:#f92672>=</span>Markdown Editor
</span></span><span style=display:flex><span>Exec<span style=color:#f92672>=</span>/home/kurome/.opt/obsidian/obsidian %U
</span></span><span style=display:flex><span>Icon<span style=color:#f92672>=</span>obsidian
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>Application
</span></span><span style=display:flex><span>StartupNotify<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>Categories<span style=color:#f92672>=</span>Office;WordProcessor;
</span></span><span style=display:flex><span>MimeType<span style=color:#f92672>=</span>x-scheme-handler/obsidian;text/html;text/markdown;text/x-markdown;
</span></span></code></pre></div></li><li><p>obsidian</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/bash
</span></span></span><span style=display:flex><span><span style=color:#75715e></span>TIME<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>date <span style=color:#e6db74>&#39;+%Y%m%d%H%M%S&#39;</span><span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>NOTEON<span style=color:#f92672>=</span>$HOME/Documents/Note_ON
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>function</span> Git_Sync<span style=color:#f92672>()</span> <span style=color:#f92672>{</span>
</span></span><span style=display:flex><span>  cd $NOTEON
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;====== PULL ======&#34;</span>
</span></span><span style=display:flex><span>  git pull
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#39;#Ignore files larger than 100MB&#39;</span>
</span></span><span style=display:flex><span>  cat .gitignore_default &gt; .gitignore
</span></span><span style=display:flex><span>  find . -size +100M | sed <span style=color:#e6db74>&#39;s|^./||g&#39;</span> | cat &gt;&gt; .gitignore
</span></span><span style=display:flex><span>  git add .
</span></span><span style=display:flex><span>  git commit -m <span style=color:#e6db74>&#34;Update-</span><span style=color:#e6db74>${</span>TIME<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;====== PUSH ======&#34;</span>
</span></span><span style=display:flex><span>  git push -v
</span></span><span style=display:flex><span><span style=color:#f92672>}</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>/home/kurome/.opt/obsidian/Obsidian-0.15.6.AppImage
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>trap Git_Sync EXIT
</span></span></code></pre></div></li></ul><p>比较常遇到的问题是有时候分别点击PC端与Android端的同步后，会以PC端为主，将Android端的修改抹除掉。</p><p><a href=https://github.com/denolehov/obsidian-git><strong>obsidian-git</strong></a></p><p>这个方案完全使用 git，在 Android 端也不需要额外的 git 客户端。根据<a href=https://github.com/denolehov/obsidian-git/wiki/Installation#mobile>官方教程</a>进行安装：</p><blockquote><p>Follow these instructions for setting up an Obsidian Vault on a mobile device that is already backed up in a remote git repository.</p><p>The instructions assume you are using GitHub, but can be extrapolated to other providers.</p><ol><li>Make sure any outstanding changes on all devices are pushed and reconciled with the remote repo.</li><li>Install Obsidian for Android or iOS.</li><li>Create a new vault (or point Obsidian to an empty directory). Do NOT select <code>Store in iCloud</code> if you are on iOS.</li><li>If your repo is hosted on GitHub, <a href=https://github.blog/2020-12-15-token-authentication-requirements-for-git-operations/>authentication must be done with a personal access token</a>. Detailed instruction for that process can be found <a href=https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token>here</a>. Minimal permissions required are &ldquo;Read access to metadata&rdquo; and &ldquo;Read and Write access to contents and commit status&rdquo; for the repo you are going to use.</li><li>In Obsidian settings, enable community plugins. Browse plugins to install Obsidian Git.</li><li>Enable Obsidian Git (on the same screen)</li><li>Go to Options for the Obsidian Git plugin (bottom of main settings page, under Community Plugins section)</li><li>Under the &ldquo;Authentication/Commit Author&rdquo; section, fill in the username on your git server and your password/personal access token.</li><li>Leave the relative path setting empty (for advanced users only).</li><li>Exit plugin settings, open command palette, choose &ldquo;Obsidian Git: Clone existing remote repo&rdquo;.</li><li>Fill in repo URL in the text field and press the repo URL button below it. The repo URL is NOT the URL in the browser. You have to append <code>.git</code>.</li><li>Follow instructions to determine the folder to place repo in and whether an <code>.obsidian</code> directory already exits.</li><li>Clone should start. Popup notifications (if not disabled) will display the progress. Do not exit until a popup appears requesting that you &ldquo;Restart Obsidian&rdquo;.</li></ol></blockquote><p>使用的时候只需要下拉打开 command palette，然后输入 <code>commit</code> 或 <code>push</code> 等就行。</p><p>如果产生 Conflict，而手机端没有完全体的 Git，则需要重新 Clone ，这样还没有 remotely-save 好。</p><p><strong>补充文章</strong></p><ul><li><a href=https://obsidian.rocks/how-to-backup-obsidian/>How to Backup Obsidian</a></li><li><a href=https://utgd.net/article/9642>Obsidian 的 PC 端同步方案，无代码搞定 Git 同步</a></li></ul><h3 id=typorahttpssupporttyporaioquick-start><a href=https://support.typora.io/Quick-Start/>Typora</a><a hidden class=anchor aria-hidden=true href=#typorahttpssupporttyporaioquick-start>#</a></h3><p>安装：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># sudo apt-key adv --keyserver keyserver.ubuntu.com --recv-keys BA300B7755AFCFAE</span>
</span></span><span style=display:flex><span>$ wget -qO - https://typora.io/linux/public-key.asc | $ sudo apt-key add -
</span></span><span style=display:flex><span><span style=color:#75715e># add Typora&#39;s repository</span>
</span></span><span style=display:flex><span>$ sudo add-apt-repository <span style=color:#e6db74>&#39;deb https://typora.io/linux ./&#39;</span>
</span></span><span style=display:flex><span>$ sudo apt-get update
</span></span><span style=display:flex><span><span style=color:#75715e># install typora</span>
</span></span><span style=display:flex><span>$ sudo apt-get install typora
</span></span></code></pre></div><p>如果安装的时二进制包，则建立 <code>typora.desktop</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gedit ~/.local/share/applications/typora.desktop
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Desktop Entry<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Name<span style=color:#f92672>=</span>Typora
</span></span><span style=display:flex><span>Comment<span style=color:#f92672>=</span>a minimal Markdown reading &amp; writing app. Change Log: <span style=color:#f92672>(</span>https://typora.io/windows/dev_release.html<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>GenericName<span style=color:#f92672>=</span>Markdown Editor
</span></span><span style=display:flex><span>Exec<span style=color:#f92672>=</span>/home/kurome/.opt/typora/Typora %U
</span></span><span style=display:flex><span>Icon<span style=color:#f92672>=</span>typora
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>Application
</span></span><span style=display:flex><span>StartupNotify<span style=color:#f92672>=</span>true
</span></span><span style=display:flex><span>Categories<span style=color:#f92672>=</span>Office;WordProcessor;
</span></span><span style=display:flex><span>MimeType<span style=color:#f92672>=</span>text/markdown;text/x-markdown;
</span></span></code></pre></div><p>typora 有时会出现丢数据的现象，很困扰；特别是围栏代码块，失去了缩进，成了一行，完全不可阅读了。但是其他的 Markdown Editor 用的不习惯，例如 VSCode、Sublime、ghostwriter、marktext。因此最好通过 ppa 安装，获取 Typora 最新的版本。</p><p>在Joplin下，菜单Tools->Options->General>Text editor command可以设置第三方编辑软件。</p><p>配置 <code>File</code> > <code>Preferences</code>：</p><ul><li><code>General</code> > <code>Auto Save</code>: on</li><li><code>Editor</code> > <code>Spell Check</code>: Disable</li><li><code>Image</code> > <code>Use relative path if possible</code>: on</li><li><code>Markdown</code> > <code>Syntax Support</code> > <code>Inline Math</code>: on</li></ul><p>有时候标点符号没有与文字对齐，比如句号在右中，而不是右下，可以将语言设置为中文（it works for me）。</p><p><a href=https://support.typora.io/purchase/#can-i-use-typora-for-free-><strong>Can I use Typora for free ?</strong></a></p><p>You will have a 15-day free trial before the purchase. If you use the dev version or the Linux version, you will have much longer trial time if you keep Typora updated. However, we may show a “trial button”, disable certain features or shorten trial time in the future, but most functions will be kept.</p><p><a href=https://support.typora.io/purchase/#basic><strong>Typora’s pricing plan</strong></a></p><p>It is one-time payment, not subscription.</p><p>A Typora license is granted to the “user”, which can be activated on up to 3 devices from one person for one license with no expiration time.</p><p>You will have 15 days to evaluate Typora for free before purchasing a license code. If you’re not satisfied with Typora for any reason, you will be able to get a full refund within 30 days from the license purchase.</p><p><strong>Recover Unsaved Drafts</strong></p><p>Preferences => General => Save & Recover => Recover Unsaved Drafts => 选择要恢复的文档，打开后另存为到之前保存的地址覆盖它即可</p><p><a href=https://support.typora.io/Shortcut-Keys/><strong>Ctrl 5 of typora does not work</strong></a></p><p>不知道哪里覆盖了。重新定义一个快捷键。</p><p>Open <code>Menu</code> → <code>Preference</code> in Typora, then click “Open Advanced Settings”.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=display:flex><span><span style=color:#e6db74>&#34;keyBinding&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
</span></span><span style=display:flex><span>    <span style=color:#f92672>&#34;Heading 5&#34;</span>: <span style=color:#e6db74>&#34;Alt+5&#34;</span>,
</span></span><span style=display:flex><span>}<span style=color:#960050;background-color:#1e0010>,</span>
</span></span></code></pre></div><p><strong>主题推荐</strong></p><p>GitHub 主题，很习惯了：</p><ul><li><a href=https://theme.typora.io/theme/D42ker/>D42ker GitHub</a></li><li><a href=https://theme.typora.io/theme/Github/>Github</a></li></ul><h4 id=marktexthttpsgithubcommarktextmarktext><a href=https://github.com/marktext/marktext>MarkText</a><a hidden class=anchor aria-hidden=true href=#marktexthttpsgithubcommarktextmarktext>#</a></h4><h3 id=foxit-pdf-readerhttpswwwfoxitcompdf-reader><a href=https://www.foxit.com/pdf-reader/>Foxit PDF Reader</a><a hidden class=anchor aria-hidden=true href=#foxit-pdf-readerhttpswwwfoxitcompdf-reader>#</a></h3><p>Industry’s most powerful PDF reader.</p><h4 id=portable-pdf-unlockerhttpssourceforgenetprojectsportablepdfunlockerfileslatestdownloadpdfcrackhttppdfcracksourceforgenet><a href=https://sourceforge.net/projects/portablepdfunlocker/files/latest/download>Portable PDF Unlocker</a>/<a href=http://pdfcrack.sourceforge.net/>PDFCrack</a><a hidden class=anchor aria-hidden=true href=#portable-pdf-unlockerhttpssourceforgenetprojectsportablepdfunlockerfileslatestdownloadpdfcrackhttppdfcracksourceforgenet>#</a></h4><p><a href=https://zhuanlan.zhihu.com/p/32261755><strong>Print the Secured PDF in Google Chrome</strong></a></p><p>有的用户虽然记得PDF文档的密码，但由于经常使用这个PDF文档，为了方便使用也想将这个密码去除。而去除的方法也非常简单，用最常见的谷歌浏览器就可以做到。首先运行谷歌浏览器，将需要去除密码的PDF文档拖曳进浏览器窗口。这时会弹出一个对话框，输入相应的密码就可以看到内容。接着在文档内容中点击鼠标右键，选择菜单里面的“打印”命令。</p><p>在弹出的打印窗口点击左侧“目标”中的“更改”按钮，在弹出的对话框中选择“本地目标”中的“另存为PDF”命令。返回到打印窗口后直接点击“保存”按钮，在弹出的对话框里面设置文档的保存位置，再点击“保存”按钮就会将当前的PDF文档另外存储一份，这样也就相当于去除了PDF文档的密码了。</p><p><strong>Online PDF Password Remover</strong></p><ul><li><a href=https://smallpdf.com/unlock-pdf>https://smallpdf.com/unlock-pdf</a></li><li><a href=https://www.ilovepdf.com/unlock_pdf>https://www.ilovepdf.com/unlock_pdf</a></li></ul><p><a href=https://www.freeviewer.org/blog/how-to-unlock-a-pdf-for-editing-without-password/>**How to Unlock A PDF for Editing Without Password? [Five Methods]**</a></p><h4 id=pdftkhttpsaskubuntucomquestions828720how-to-remove-the-password-from-a-pdf><a href=https://askubuntu.com/questions/828720/how-to-remove-the-password-from-a-pdf>pdftk</a><a hidden class=anchor aria-hidden=true href=#pdftkhttpsaskubuntucomquestions828720how-to-remove-the-password-from-a-pdf>#</a></h4><p><a href=https://forum.suse.org.cn/t/topic/14862><strong>给 pdf 电子书加目录</strong></a></p><p>对许多人来说 pdf 格式的电子书最头疼的两件事： → 1) 每页都是没经过 OCR 处理过的图片 2) 没有目录。</p><p>以下这个批量加目录的方法我用好久了，见过我这么操作过的都想学一下，这里详细地记录以下，也方便以后有人再问的时候 <code>:)</code></p><p>用到的软件是 pdftk <a href=https://gitlab.com/pdftk-java/pdftk>pdftk-java</a> 。linux 发行版一般都有这个这个软件可以直接安装。</p><p>pdftk 的用法就是：输出 (dump_data) pdf 的元信息 (data.txt)，编辑以后，重新倒入 (update_info) 到 pdf 文件里面</p><p>主要是这两条命令:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>pdftk <span style=color:#f92672>[</span>my.pdf<span style=color:#f92672>]</span> dump_data &gt; <span style=color:#f92672>[</span>data.txt<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>pdftk <span style=color:#f92672>[</span>my.pdf<span style=color:#f92672>]</span> update_info <span style=color:#f92672>[</span>data.txt<span style=color:#f92672>]</span> output my2.pdf
</span></span></code></pre></div><p>在第一条命令输出的 <code>data.txt</code> 里面加入如下的内容，然后通过第二条命令就可以创建新的目录条目</p><pre tabindex=0><code>BookmarkBegin
BookmarkTitle: name
BookmarkLevel: level
BookmarkPageNumber: page number
</code></pre><p>另外电子书的第一页通常是封面，紧接着的是其它的东西。但是书里面标注的页码的第一页往往后面的某页。</p><p>PDF 支持把页码标注成其它的格式 (page_labels)，第一页标注成 cover，第二到第十页标注成罗马数字，然后从第十一页标注成 1,2,3,4,5,6…</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#75715e># 把第一页标注成名字为 cover 的非数字 (NoNumber)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelBegin</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelNewIndex: 1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelStart: 1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelPrefix: cover</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelNumStyle: NoNumber</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从第二页 (PageLabelNewIndex) 开始标注成小写罗马数字 (LowercaseRomanNumerals)</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelBegin</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelNewIndex: 2</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelStart: 1 # 从数字 1 开始数，如果这里变成 3</span>  <span style=color:#f92672>=</span><span style=color:#e6db74>&gt; 起始的罗马数字会是 iii</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelNumStyle: LowercaseRomanNumerals</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 从 {true start page} 开始用普通的数字标注</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelBegin</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelNewIndex: {true start page}</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelStart: 1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PageLabelNumStyle: DecimalArabicNumerals</span>
</span></span></code></pre></div><p>对于一本书，这种手动添加的方法会很慢，下面是一个小脚本来半自动化。</p><hr><p>由于电子书 100% 可以搜索到目录 <code>编号 标题 页码</code>。如果搜索不到，也可以直接从书里面复制。</p><p>复制粘贴一下，调整成这种格式</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>14
</span></span><span style=display:flex><span>I: Reduction Semantics	1
</span></span><span style=display:flex><span>	1 Semantics via Syntax	5
</span></span><span style=display:flex><span>	2 Analyzing Syntactic Semantics	13
</span></span><span style=display:flex><span>	3 The λ-Calculus	23
</span></span><span style=display:flex><span>	4 ISWIM	45
</span></span><span style=display:flex><span>II: PLT Redex	201
</span></span><span style=display:flex><span>	11 The Basics	205
</span></span><span style=display:flex><span>	12 Variables and Meta-functions	217
</span></span><span style=display:flex><span>	13 Layered Development	227
</span></span><span style=display:flex><span>	14 Testing	237
</span></span><span style=display:flex><span>......
</span></span></code></pre></div><p>第一行是对于人类，而非 pdf 格式来说真正的第一页</p><p>后面根据行首 tab 的数量来决定目录的层级</p><p>每行后面的数字是页码</p><p>然后用这个小脚本 <code>toc-gen.py</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#75715e>#!/usr/bin/env python3</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Usage</span>
</span></span><span style=display:flex><span><span style=color:#75715e># toc-gen.py  &lt; edited-toc.txt</span>
</span></span><span style=display:flex><span><span style=color:#75715e>#</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>make_offset</span>(off: int):
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> off <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;&#34;&#34;PageLabelBegin
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelNewIndex: 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelStart: 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelPrefix: cover
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelNumStyle: NoNumber&#34;&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> off <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>2</span>:
</span></span><span style=display:flex><span>        print(<span style=color:#e6db74>&#34;&#34;&#34;PageLabelBegin
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelNewIndex: 2
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelStart: 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelNumStyle: LowercaseRomanNumerals&#34;&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;&#34;&#34;PageLabelBegin
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelNewIndex: </span><span style=color:#e6db74>{</span>off<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelStart: 1
</span></span></span><span style=display:flex><span><span style=color:#e6db74>PageLabelNumStyle: DecimalArabicNumerals&#34;&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>def</span> <span style=color:#a6e22e>make_bookmark</span>(t: str, l: int, p: int):
</span></span><span style=display:flex><span>    print(<span style=color:#e6db74>f</span><span style=color:#e6db74>&#34;&#34;&#34;BookmarkBegin
</span></span></span><span style=display:flex><span><span style=color:#e6db74>BookmarkTitle: </span><span style=color:#e6db74>{</span>t<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>BookmarkLevel: </span><span style=color:#e6db74>{</span>l<span style=color:#e6db74>}</span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>BookmarkPageNumber: </span><span style=color:#e6db74>{</span>p<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;&#34;&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> __name__ <span style=color:#f92672>==</span> <span style=color:#e6db74>&#39;__main__&#39;</span>:
</span></span><span style=display:flex><span>    offset <span style=color:#f92672>=</span> int(input())
</span></span><span style=display:flex><span>    make_offset(offset)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>while</span> <span style=color:#66d9ef>True</span>:
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>try</span>:
</span></span><span style=display:flex><span>            line <span style=color:#f92672>=</span> input()
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>if</span> <span style=color:#f92672>not</span> line<span style=color:#f92672>.</span>strip():
</span></span><span style=display:flex><span>                <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>except</span> <span style=color:#a6e22e>EOFError</span>:
</span></span><span style=display:flex><span>            <span style=color:#66d9ef>break</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        title <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34; &#34;</span><span style=color:#f92672>.</span>join(line<span style=color:#f92672>.</span>split()[<span style=color:#ae81ff>0</span>:<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>        n_of_tabs <span style=color:#f92672>=</span> len(line) <span style=color:#f92672>-</span> len(line<span style=color:#f92672>.</span>lstrip())
</span></span><span style=display:flex><span>        page <span style=color:#f92672>=</span> int(line<span style=color:#f92672>.</span>split()[<span style=color:#f92672>-</span><span style=color:#ae81ff>1</span>])
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        make_bookmark(t<span style=color:#f92672>=</span>title,
</span></span><span style=display:flex><span>                      l<span style=color:#f92672>=</span>n_of_tabs <span style=color:#f92672>+</span> <span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>                      p<span style=color:#f92672>=</span>page <span style=color:#f92672>+</span> offset)
</span></span></code></pre></div><p>来获取这些内容，把这些内容粘贴到 <code>[data.txt]</code> 后面，然后再用 pdftk 的第二条命令</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>PageLabelBegin
</span></span><span style=display:flex><span>PageLabelNewIndex: 1
</span></span><span style=display:flex><span>PageLabelStart: 1
</span></span><span style=display:flex><span>PageLabelPrefix: cover
</span></span><span style=display:flex><span>PageLabelNumStyle: NoNumber
</span></span><span style=display:flex><span>PageLabelBegin
</span></span><span style=display:flex><span>PageLabelNewIndex: 2
</span></span><span style=display:flex><span>PageLabelStart: 1
</span></span><span style=display:flex><span>PageLabelNumStyle: LowercaseRomanNumerals
</span></span><span style=display:flex><span>PageLabelBegin
</span></span><span style=display:flex><span>PageLabelNewIndex: 14
</span></span><span style=display:flex><span>PageLabelStart: 1
</span></span><span style=display:flex><span>PageLabelNumStyle: DecimalArabicNumerals
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: Reduction Semantics
</span></span><span style=display:flex><span>BookmarkLevel: 1
</span></span><span style=display:flex><span>BookmarkPageNumber: 15
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: Semantics via Syntax
</span></span><span style=display:flex><span>BookmarkLevel: 2
</span></span><span style=display:flex><span>BookmarkPageNumber: 19
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: Analyzing Syntactic Semantics
</span></span><span style=display:flex><span>BookmarkLevel: 2
</span></span><span style=display:flex><span>BookmarkPageNumber: 27
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: The λ-Calculus
</span></span><span style=display:flex><span>BookmarkLevel: 2
</span></span><span style=display:flex><span>BookmarkPageNumber: 37
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: ISWIM
</span></span><span style=display:flex><span>BookmarkLevel: 2
</span></span><span style=display:flex><span>BookmarkPageNumber: 59
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: An Abstract Syntax Machine
</span></span><span style=display:flex><span>BookmarkLevel: 2
</span></span><span style=display:flex><span>BookmarkPageNumber: 79
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: Abstract Register Machines
</span></span><span style=display:flex><span>BookmarkLevel: 2
</span></span><span style=display:flex><span>BookmarkPageNumber: 103
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: Tail Calls and More Space Savings
</span></span><span style=display:flex><span>BookmarkLevel: 2
</span></span><span style=display:flex><span>BookmarkPageNumber: 121
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: Control: Errors, Exceptions, and Continuations
</span></span><span style=display:flex><span>BookmarkLevel: 2
</span></span><span style=display:flex><span>BookmarkPageNumber: 129
</span></span><span style=display:flex><span>BookmarkBegin
</span></span><span style=display:flex><span>BookmarkTitle: State: Imperative Assignment
</span></span><span style=display:flex><span>..............
</span></span></code></pre></div><p><strong>Bingo!</strong> 这下舒服了 <code>:)</code></p><h3 id=tesseracthttpsgithubcomtesseract-ocrtesseract><a href=https://github.com/tesseract-ocr/tesseract>Tesseract</a><a hidden class=anchor aria-hidden=true href=#tesseracthttpsgithubcomtesseract-ocrtesseract>#</a></h3><p>Tesseract Open Source OCR Engine</p><p>更多 OCR 软件请看：<a href=https://en.wikipedia.org/wiki/Comparison_of_optical_character_recognition_software>Comparison of optical character recognition software</a></p><p>Evaluation：An analysis of the accuracy and reliability of the OCR packages Google Docs OCR, Tesseract, ABBYY FineReader, and Transym, employing a dataset including 1227 images from 15 different categories concluded Google Docs OCR and ABBYY to be performing better than others.</p><h4 id=ocrmypdfhttpsgithubcomocrmypdfocrmypdf><a href=https://github.com/ocrmypdf/OCRmyPDF>OCRmyPDF</a><a hidden class=anchor aria-hidden=true href=#ocrmypdfhttpsgithubcomocrmypdfocrmypdf>#</a></h4><p>OCRmyPDF adds an OCR text layer to scanned PDF files, allowing them to be searched</p><h4 id=pandaocrhttpsgithubcommiaomiaosoftpandaocr><a href=https://github.com/miaomiaosoft/PandaOCR>PandaOCR</a><a hidden class=anchor aria-hidden=true href=#pandaocrhttpsgithubcommiaomiaosoftpandaocr>#</a></h4><p>PandaOC/R - 多功能OCR图文识别+翻译+朗读+弹窗+公式+表格+图床+搜图+二维码</p><h4 id=gimagereaderhttpsgithubcommanisandrogimagereader><a href=https://github.com/manisandro/gImageReader>gImageReader</a><a hidden class=anchor aria-hidden=true href=#gimagereaderhttpsgithubcommanisandrogimagereader>#</a></h4><p>A Gtk/Qt front-end to tesseract-ocr.</p><h4 id=ocrfeederhttpswikignomeorgactionshowappsocrfeederactionshowredirectocrfeeder><a href="https://wiki.gnome.org/action/show/Apps/OCRFeeder?action=show&amp;redirect=OCRFeeder">OCRfeeder</a><a hidden class=anchor aria-hidden=true href=#ocrfeederhttpswikignomeorgactionshowappsocrfeederactionshowredirectocrfeeder>#</a></h4><p>支持多个 OCR 后端，例如<a href=http://en.wikipedia.org/wiki/Tesseract_(software)>Tesseract</a>、<a href=http://en.wikipedia.org/wiki/CuneiForm_(software)>CuneiForm</a>、<a href=http://en.wikipedia.org/wiki/GOCR>GOCR</a>、<a href=http://en.wikipedia.org/wiki/Ocrad>Ocrad</a></p><h4 id=tianruoocrhttpsgithubcomanylistentianruoocr><a href=https://github.com/AnyListen/tianruoocr>tianruoocr</a><a hidden class=anchor aria-hidden=true href=#tianruoocrhttpsgithubcomanylistentianruoocr>#</a></h4><p>简介：基于天若幽心开源的代码进行完善制作而成，进行了简单重构，移除了更新的弹窗。</p><p>已停止维护，欢迎使用新版跨平台 OCR 工具（<a href=https://github.com/AnyListen/tools-ocr>树洞 OCR 文字识别</a>），跟之前天若OCR使用习惯出入较大，且不支持翻译。</p><h4 id=marguerite-答-orchttpsforumsuseorgcntocr-opensuse23799uhsiung><a href="https://forum.suse.org.cn/t/ocr-opensuse/2379/9?u=hsiung">marguerite 答 ORC</a><a hidden class=anchor aria-hidden=true href=#marguerite-答-orchttpsforumsuseorgcntocr-opensuse23799uhsiung>#</a></h4><p>我来告诉你什么是 OCR：</p><p>OCR 说白了就是，把一个特定字体的某个字变成计算机可匹配的位置数据，比如在 50x50 像素的格子里，「儿」这个字的撇的黑色像素点落在大概 (30~45, 0~100) 这个范围内，然后把图片进行切割细分，得到许多个 50x50 的格子，在这个格子里 (30~45, 0~100) 它有黑色像素点，那么就非常可能是「儿」字。当然也可能是别的字，究竟是什么字，常用汉字就那么多个，这是概率问题。</p><p>而 OCR 的重点是：</p><ol><li>字体。你针对宋体的 OCR 训练数据拿到黑体上识别率不见得高。</li><li>训练。所谓的训练就是让计算机匹配时所遵守的概率无限趋近于现实。你可能需要拿出比如 3 万个字（一篇文章），先用默认的识别一遍（这涉及到了「如何根据某个特定字体制作出默认的数据」），然后逐字逐句去挑错，再改进默认数据（这涉及到了「你需要会编程，能够写出一个根据 tesseract 库改数据的软件」），最后越改这个数据越接近现实。</li></ol><p>最后才是拿你训练过的数据去进行我上面做过的：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tesseract ./test.png result -l chi_sim
</span></span></code></pre></div><p>参考、归纳、脑补自：http://miphol.com/muse/2013/05/tesseract-ocr.html</p><p>这是 OCR 工作的基本原理和流程，这完全不可能是一个非程序员做的事情，程序员也懒得做这种事情，这是一种苦逼的体力劳动。</p><p>Windows 下的 OCR 软件比如微软 word 自带的那个，ABBYY FineReader（这个最好，而且可以 wine）、以及汉王的软件，都是多少苦逼程序员一起，经历了这种枯燥乏味的流程后的结果。</p><p>Linux 下的 OCR 软件都是开源的「框架」，比如 tesseract 和你之前问过的 ocropus，它们只是为在 Linux 下进行这种苦逼工作提供了一个基础，提供了可能性，并不是像你要求的那样拿来就能用的东西。因为没有训练过的数据，你安装的中文数据包只是可供你拿来训练的数据。</p><p>何况在 Linux 下训练了也没用，OCR 最大的需求是 word 文档转出来的 PDF 和起点网站吧，那些用的字体可不是文泉驿。你现在能够得到的可供训练的数据估计就是 Google 根据 Droid Sans 弄出来的，训练 1 万年也只能识别 Droid Sans，问题是你能把纸面上的字体改了么。想要微软字体的数据？抱歉，微软是商业字体啊。</p><p>所以我觉得现在是你对你需求的描述和理解就不对。钻进死胡同了。</p><h3 id=wpshttpswwwwpscomdownload><a href=https://www.wps.com/download/>WPS</a><a hidden class=anchor aria-hidden=true href=#wpshttpswwwwpscomdownload>#</a></h3><p>WPS Office is a lightweight, feature-rich comprehensive office suite with high compatibility.</p><p><a href=https://github.com/openSUSE-zh/wps-office-appimage><strong>wps-office-appimage</strong></a></p><p>如果进程wpscloudsvr一直运行,占用cpu和内存，可以解包、删除、重打包，或者<a href=https://linuxacme.cn/1008>直接登陆</a>。</p><h4 id=wps-fonts>WPS Fonts<a hidden class=anchor aria-hidden=true href=#wps-fonts>#</a></h4><p><a href=https://linuxhint.com/ttf-mscorefonts-installer/><strong>ttf-mscorefonts-installer</strong></a></p><p>ttf-mscorefonts-installer is a Debian package that includes the following set of fonts, and with the help of this installer, you can easily download and use Microsoft’s True core fonts.</p><ul><li>Andale Mono</li><li>Arial Black</li><li>Arial (Bold, Italic, Bold Italic)</li><li>Comic Sans MS (Bold)</li><li>Courier New (Bold, Italic, Bold Italic)</li><li>Georgia (Bold, Italic, Bold Italic)</li><li>Impact</li><li>Times New Roman (Bold, Italic, Bold Italic)</li><li>Trebuchet (Bold, Italic, Bold Italic)</li><li>Verdana (Bold, Italic, Bold Italic)</li><li>Webdings</li></ul><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo proxychains apt install --reinstall ttf-mscorefonts-installer
</span></span><span style=display:flex><span>$ sudo fc-cache -vr
</span></span></code></pre></div><p><a href=https://github.com/BannedPatriot/ttf-wps-fonts><strong>ttf-wps-fonts</strong></a></p><p>These are the symbol fonts required by wps-office. They are used to display math formulas. We have collected the fonts here to make things easier.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cd /tmp
</span></span><span style=display:flex><span>$ git clone https://github.com/iamdh4/ttf-wps-fonts.git
</span></span><span style=display:flex><span>$ mkdir -p ~/.local/share/fonts/wps-fonts
</span></span><span style=display:flex><span>$ mv ttf-wps-fonts/* ~/.local/share/fonts/wps-fonts
</span></span><span style=display:flex><span>$ chmod <span style=color:#ae81ff>644</span> ~/.local/share/fonts/wps-fonts/*
</span></span><span style=display:flex><span>$ fc-cache -vfs
</span></span><span style=display:flex><span>$ rm -rf ttf-wps-fonts
</span></span></code></pre></div><p><a href=https://hanjingxue-boling.github.io/Whiteboard/essay/main/2022-05-03/#wps><strong>WPS 缺少中文</strong></a></p><p>最近发现了 flatpak 版 wps 没有中文的解决方案：</p><blockquote><p>下载中文版 wps 的包，解压缩后找到里面的 mui 目录，复制到国际版 wps flatpak 的对应目录下，修改一下配置文件，你就得到了中文版 wps</p></blockquote><h3 id=sublime-texthttpwwwsublimetextcom><a href=http://www.sublimetext.com/>Sublime Text</a><a hidden class=anchor aria-hidden=true href=#sublime-texthttpwwwsublimetextcom>#</a></h3><h3 id=atomhttpsatomio><a href=https://atom.io/>Atom</a><a hidden class=anchor aria-hidden=true href=#atomhttpsatomio>#</a></h3><h3 id=vim>Vim<a hidden class=anchor aria-hidden=true href=#vim>#</a></h3><p>安装 vim <a href=https://github.com/ycm-core/YouCompleteMe>ycm</a> 全能补全</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install -y vim-gtk3 vim-addon-manager vim-youcompleteme vim-python-jedi
</span></span><span style=display:flex><span>$ vam install youcompleteme python-jedi
</span></span></code></pre></div><p>然后用 gvim 就有 ycm 智能补全和提示了</p><h4 id=vimtutor>vimtutor<a hidden class=anchor aria-hidden=true href=#vimtutor>#</a></h4><p>Start Vim on a copy of the tutor file.</p><h4 id=vivimtiny>vi&amp;vim.tiny<a hidden class=anchor aria-hidden=true href=#vivimtiny>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ whereis vi
</span></span><span style=display:flex><span>vi: /usr/bin/vi /usr/share/man/man1/vi.1.gz
</span></span><span style=display:flex><span>$ ls -al /usr/bin/vi
</span></span><span style=display:flex><span>lrwxrwxrwx <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>20</span> Oct <span style=color:#ae81ff>26</span> 20:31 /usr/bin/vi -&gt; /etc/alternatives/vi
</span></span><span style=display:flex><span>$ ls -al /etc/alternatives/vi
</span></span><span style=display:flex><span>lrwxrwxrwx <span style=color:#ae81ff>1</span> root root <span style=color:#ae81ff>17</span> Oct <span style=color:#ae81ff>26</span> 20:31 /etc/alternatives/vi -&gt; /usr/bin/vim.tiny
</span></span></code></pre></div><p>可见，在Ubuntu上，vi是vim.tiny的软连接，但是执行命令vi与vim.tiny后是不一样，比如vi是：在编辑模式下使用方向键的时候，并不会使光标移动，而是在命令行中出现[A [B [C [D之类的字母；并且编辑错误的话，退格键(Backspace键)是使用不了的。</p><p><a href=https://unix.stackexchange.com/questions/150217/methods-to-find-out-which-configuration-files-are-read-by-executable-when-star>Methods to find out which (configuration) files are read by executable when started</a>-><a href=https://stackoverflow.com/questions/60404347/strace-vim-nano-ubuntu>&lsquo;strace vim/nano&rsquo; (Ubuntu)</a>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ strace -o $HOME/tracefile vi
</span></span><span style=display:flex><span>$ cat tracefile | grep vimrc
</span></span><span style=display:flex><span>stat<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/usr/share/vim/vimrc.tiny&#34;</span>, <span style=color:#f92672>{</span>st_mode<span style=color:#f92672>=</span>S_IFREG|0644, st_size<span style=color:#f92672>=</span>662, ...<span style=color:#f92672>})</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>openat<span style=color:#f92672>(</span>AT_FDCWD, <span style=color:#e6db74>&#34;/usr/share/vim/vimrc.tiny&#34;</span>, O_RDONLY<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>stat<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/home/vane/.vimrc&#34;</span>, 0x7fff3e755550<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>openat<span style=color:#f92672>(</span>AT_FDCWD, <span style=color:#e6db74>&#34;/home/vane/.vimrc&#34;</span>, O_RDONLY<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>openat<span style=color:#f92672>(</span>AT_FDCWD, <span style=color:#e6db74>&#34;/home/vane/_vimrc&#34;</span>, O_RDONLY<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>stat<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/home/vane/.vim/vimrc&#34;</span>, 0x7fff3e755550<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>openat<span style=color:#f92672>(</span>AT_FDCWD, <span style=color:#e6db74>&#34;/home/vane/.vim/vimrc&#34;</span>, O_RDONLY<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>可以看到 vi，加载的是 <code>/usr/share/vim/vimrc.tiny</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ strace -o $HOME/tracefile vim.tiny
</span></span><span style=display:flex><span>$ cat tracefile | grep vimrc
</span></span><span style=display:flex><span>stat<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/usr/share/vim/vimrc&#34;</span>, <span style=color:#f92672>{</span>st_mode<span style=color:#f92672>=</span>S_IFREG|0644, st_size<span style=color:#f92672>=</span>2266, ...<span style=color:#f92672>})</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span>openat<span style=color:#f92672>(</span>AT_FDCWD, <span style=color:#e6db74>&#34;/usr/share/vim/vimrc&#34;</span>, O_RDONLY<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>3</span>
</span></span><span style=display:flex><span>stat<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/home/vane/.vimrc&#34;</span>, 0x7fff7c99cc30<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>openat<span style=color:#f92672>(</span>AT_FDCWD, <span style=color:#e6db74>&#34;/home/vane/.vimrc&#34;</span>, O_RDONLY<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>openat<span style=color:#f92672>(</span>AT_FDCWD, <span style=color:#e6db74>&#34;/home/vane/_vimrc&#34;</span>, O_RDONLY<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>stat<span style=color:#f92672>(</span><span style=color:#e6db74>&#34;/home/vane/.vim/vimrc&#34;</span>, 0x7fff7c99cc30<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>openat<span style=color:#f92672>(</span>AT_FDCWD, <span style=color:#e6db74>&#34;/home/vane/.vim/vimrc&#34;</span>, O_RDONLY<span style=color:#f92672>)</span> <span style=color:#f92672>=</span> -1 ENOENT <span style=color:#f92672>(</span>No such file or directory<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>可以看到 vim.tiny，加载的是 <code>/usr/share/vim/vimrc</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ diff -u /etc/vim/vimrc /etc/vim/vimrc.tiny
</span></span><span style=display:flex><span>--- /etc/vim/vimrc    2020-01-30 19:11:47.000000000 +0800
</span></span><span style=display:flex><span>+++ /etc/vim/vimrc.tiny    2020-04-15 14:40:31.000000000 +0800
</span></span><span style=display:flex><span>@@ -1,55 +1,13 @@
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>+<span style=color:#e6db74>&#34; Vim configuration file, in effect when invoked as &#34;</span>vi<span style=color:#e6db74>&#34;. The aim of this
</span></span></span><span style=display:flex><span><span style=color:#e6db74>+&#34;</span> configuration file is to provide a Vim environment as compatible with the
</span></span><span style=display:flex><span>+<span style=color:#e6db74>&#34; original vi as possible. Note that ~/.vimrc configuration files as other
</span></span></span><span style=display:flex><span><span style=color:#e6db74>+&#34;</span> configuration files in the runtimepath are still sourced.
</span></span><span style=display:flex><span>+<span style=color:#e6db74>&#34; When Vim is invoked differently (&#34;</span>vim<span style=color:#e6db74>&#34;, &#34;</span>view<span style=color:#e6db74>&#34;, &#34;</span>evim<span style=color:#e6db74>&#34;, ...) this file is
</span></span></span><span style=display:flex><span><span style=color:#e6db74>+&#34;</span> _not_ sourced; /etc/vim/vimrc and/or /etc/vim/gvimrc are.
</span></span><span style=display:flex><span>...
</span></span></code></pre></div><p>上面注释什么都说明白了。</p><p><a href=https://askubuntu.com/questions/104138/what-features-does-vim-tiny-have>link</a>: The missing keybindings etc may be because you are running vim in <a href="http://vimdoc.sourceforge.net/htmldoc/options.html#'compatible'">vi compatible mode</a> - you can turn that off by doing <code>:set nocompatible</code> in vim or adding <code>set nocompatible</code> to you <code>.vimrc</code> file.</p><pre tabindex=0><code>set nocompatible
</code></pre><p>参考 Fedora 默认<code>/etc/virc</code>配置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>set fileencodings<span style=color:#f92672>=</span>ucs-bom,utf-8,latin1
</span></span><span style=display:flex><span>set nocompatible
</span></span><span style=display:flex><span>set bs<span style=color:#f92672>=</span>indent,eol,start
</span></span><span style=display:flex><span>set ruler
</span></span></code></pre></div><h4 id=clear-highlightinghttpsstackoverflowcomquestions657447vim-clear-last-search-highlighting><a href=https://stackoverflow.com/questions/657447/vim-clear-last-search-highlighting>clear highlighting</a><a hidden class=anchor aria-hidden=true href=#clear-highlightinghttpsstackoverflowcomquestions657447vim-clear-last-search-highlighting>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>:noh
</span></span></code></pre></div><h4 id=vimbasicvimtiny>vim.basic&amp;vim.tiny<a hidden class=anchor aria-hidden=true href=#vimbasicvimtiny>#</a></h4><p>它们的<a href=https://askubuntu.com/questions/483308/what-are-the-differences-between-vim-basic-and-vim-tiny>区别</a>：</p><p><strong>vim.basic</strong> is just plain vanilla Vim (as you can check with <code>apt-file vim.basic</code> or <code>dpkg -S /usr/bin/vim.basic</code>).</p><p>While <strong>vim.tiny</strong>, as the name implies, is a <em>trimmed-down</em> version of Vim (<a href=https://askubuntu.com/q/104138/153234>this question</a> explains it further).</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vim.tiny --version
</span></span></code></pre></div><h3 id=vimrchttpsgithubcomamixvimrc><a href=https://github.com/amix/vimrc>VIMRC</a><a hidden class=anchor aria-hidden=true href=#vimrchttpsgithubcomamixvimrc>#</a></h3><p>The ultimate Vim configuration (vimrc)</p><h4 id=copilotvimhttpsgithubcomgithubcopilotvim><a href=https://github.com/github/copilot.vim>copilot.vim</a><a hidden class=anchor aria-hidden=true href=#copilotvimhttpsgithubcomgithubcopilotvim>#</a></h4><p>Neovim plugin for GitHub Copilot</p><h4 id=neovimhttpsneovimio><a href=https://neovim.io/>Neovim</a><a hidden class=anchor aria-hidden=true href=#neovimhttpsneovimio>#</a></h4><p>Neovim 提出了将 Vim 扩展为一个 IDE 的想法。</p><p>它增加了现代终端的功能，如光标样式、焦点事件、括号内粘贴等，并内置了一个终端模拟器。最重要的是，你不需要忘却 Vim 的习惯就可以开始使用 Neovim。</p><p><a href=https://zhuanlan.zhihu.com/p/382092667><strong>现代化Neovim配置</strong></a></p><p><a href=https://github.com/ayamir/nvimdots>git仓库</a>。</p><p>除此之外，目前一个比较好的配置是：https://github.com/LunarVim/LunarVim。</p><h4 id=vimplushttpsgithubcomchxuanvimplus><a href=https://github.com/chxuan/vimplus>vimplus</a><a hidden class=anchor aria-hidden=true href=#vimplushttpsgithubcomchxuanvimplus>#</a></h4><p>现代化的vim插件管理工具，开箱即用</p><h4 id=rangerhttpsgithubcomrangerranger><a href=https://github.com/ranger/ranger>ranger</a><a hidden class=anchor aria-hidden=true href=#rangerhttpsgithubcomrangerranger>#</a></h4><p>A VIM-inspired filemanager for the console</p><h4 id=color-scheme>Color Scheme<a hidden class=anchor aria-hidden=true href=#color-scheme>#</a></h4><p>自带的 color scheme 都在 <code>/usr/share/vim/vim*/colors</code> 目录下。</p><p><code>:colorscheme</code> 可以显示正在使用的 color scheme</p><p><code>:colorscheme</code> + <code>Space</code> + <code>CTRL-d</code> 显示所有 color scheme</p><p>安装 <a href=https://github.com/tomasr/molokai>molokai</a> color scheme</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ mkdir -p ~/.vim/colors
</span></span><span style=display:flex><span>$ wget -O ~/.vim/colors/molokai.vim https://raw.githubusercontent.com/tomasr/molokai/master/colors/molokai.vim
</span></span><span style=display:flex><span>$ echo -e <span style=color:#e6db74>&#34;\&#34; Molokai Color Scheme for Vim\nlet g:molokai_original = 1\nlet g:rehash256 = 1\ncolorscheme molokai\n&#34;</span> &gt;&gt; ~/.vimrc
</span></span></code></pre></div><p>自带主题 slate 也不错。</p><h4 id=fonthttpsvimfandomcomwikichange_font><a href=https://vim.fandom.com/wiki/Change_font>Font</a><a hidden class=anchor aria-hidden=true href=#fonthttpsvimfandomcomwikichange_font>#</a></h4><p>Console Vim uses whatever font the console/terminal is using. Changing the font in your terminal is done differently depending on your system and the terminal in use. Consult the documentation or manpages for your terminal, or do a web search for how to change the font in your chosen terminal. Vim cannot use a different font than the rest of the terminal.</p><h3 id=qa>QA<a hidden class=anchor aria-hidden=true href=#qa>#</a></h3><p><a href=https://vi.stackexchange.com/questions/3340/why-is-the-cursorline-always-showing-after-the-cursor-moves-over-a-line><strong>Why is the cursorline always showing after the cursor moves over a line?</strong></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>set bg<span style=color:#f92672>=</span>dark
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#e6db74>&#34; highlight current line
</span></span></span><span style=display:flex><span><span style=color:#e6db74>set cul                                                                                                                                                     
</span></span></span><span style=display:flex><span><span style=color:#e6db74>&#34;</span> adjust color
</span></span><span style=display:flex><span>highlight CursorLine ctermbg<span style=color:#f92672>=</span>LightBlue cterm<span style=color:#f92672>=</span>None term<span style=color:#f92672>=</span>None
</span></span></code></pre></div><p><a href=https://alvinalexander.com/linux/vi-vim-editor-color-scheme-syntax/>How to control/configure vim colors</a></p><p>其实可以直接换个主题。</p><p><a href="https://www.zhihu.com/question/37308355?utm_id=0"><strong>vim的补全粉色背景色怎么修改呢？</strong></a></p><p>要改变自动补全窗口的配色可以在 vimrc 中加上：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>highlight Pmenu    guibg=darkgrey  guifg=black 
</span></span><span style=display:flex><span>highlight PmenuSel guibg=lightgrey guifg=black
</span></span></code></pre></div><p>Pmenu 是所有项的配色，PmenuSel 是选中项的配色，guibg 和 guifg 分别对应背景色和前景色</p><p><a href=https://www.reddit.com/r/vim/comments/99ylz8/confused_about_the_difference_between_tabstop_and/><strong>Confused about the difference between &rsquo;tabstop&rsquo; and &lsquo;shiftwidth&rsquo;.</strong></a></p><p><code>tabstop</code> doesn&rsquo;t necessarily mean that a tab byte (\x09) will be replaced with a number of space bytes (\x20). It&rsquo;s <code>expandtab</code> that governs whether that happens. <code>tabstop</code> means how long each tabstop will be. <code>set tabstop=8</code> makes it so that a line starting with a tab byte will appear to be indented 8 character blocks from the left edge of the screen.</p><p><code>shiftwidth</code> governs indentation via &#187; and friends (as said in the docs). <code>set shiftwidth=8</code> makes it so that each &#187; you do will indent a line 8 character blocks more to the right. Whether it uses tab bytes or space bytes is actually up to a few settings: if <code>noexpandtab</code> is set, it tries its best to use tab bytes alone. If <code>shiftwidth</code> is not divisible by <code>tabstop</code> (e.g. you have <code>set noexpandtab shiftwidth=6 tabstop=4</code> for some reason), it will use a combination of tabs and spaces to get the proper indent. If <code>expandtab</code> is set, then it will use space bytes alone.</p><p><code>:help shift-left-right</code> is further reading for this: read past the references for the > commands, on to the next few paragraphs where this behavior is explained.</p><p><a href=https://stackoverflow.com/questions/1407922/how-to-tab-back-forward-a-block-of-code-in-vim><strong>How to tab (back, forward) a block of code in Vim?</strong></a></p><ul><li><code>V</code> select lines by <code>↓</code> and then <code>></code></li></ul><p>and for 3 tabs:</p><ul><li><code>V</code>, <code>3</code> and then <code>></code></li></ul><h2 id=shell>Shell<a hidden class=anchor aria-hidden=true href=#shell>#</a></h2><h3 id=tmuxhttpswwwruanyifengcomblog201910tmuxhtml><a href=https://www.ruanyifeng.com/blog/2019/10/tmux.html>Tmux</a><a hidden class=anchor aria-hidden=true href=#tmuxhttpswwwruanyifengcomblog201910tmuxhtml>#</a></h3><p>Tmux 是一个终端复用器（terminal multiplexer），非常有用，属于常用的开发工具。</p><h4 id=简介-2>简介<a hidden class=anchor aria-hidden=true href=#简介-2>#</a></h4><p><strong>会话与进程</strong></p><p>命令行的典型使用方式是，打开一个终端窗口（terminal window，以下简称"窗口"），在里面输入命令。用户与计算机的这种临时的交互，称为一次"会话"（session） 。</p><p>会话的一个重要特点是，窗口与其中启动的进程是连在一起的。打开窗口，会话开始；关闭窗口，会话结束，会话内部的进程也会随之终止，不管有没有运行完。</p><p>一个典型的例子就是，SSH 登录远程计算机，打开一个远程窗口执行命令。这时，网络突然断线，再次登录的时候，是找不回上一次执行的命令的。因为上一次 SSH 会话已经终止了，里面的进程也随之消失了。</p><p>为了解决这个问题，会话与窗口可以"解绑"：窗口关闭时，会话并不终止，而是继续运行，等到以后需要的时候，再让会话"绑定"其他窗口。</p><p><strong>Tmux 的作用</strong></p><p>Tmux 就是会话与窗口的"解绑"工具，将它们彻底分离。</p><ol><li>它允许在单个窗口中，同时访问多个会话。这对于同时运行多个命令行程序很有用。</li><li>它可以让新窗口"接入"已经存在的会话。</li><li>它允许每个会话有多个连接窗口，因此可以多人实时共享会话。</li><li>它还支持窗口任意的垂直和水平拆分。</li></ol><p>类似的终端复用器还有 GNU Screen。Tmux 与它功能相似，但是更易用，也更强大。</p><h4 id=基本用法>基本用法<a hidden class=anchor aria-hidden=true href=#基本用法>#</a></h4><p><strong>安装</strong></p><p>Tmux 一般需要自己安装。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt-get install tmux
</span></span></code></pre></div><p><strong>启动与退出</strong></p><p>安装完成后，键入<code>tmux</code>命令，就进入了 Tmux 窗口。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tmux
</span></span></code></pre></div><p>Tmux 窗口，底部有一个状态栏。状态栏的左侧是窗口信息（编号和名称），右侧是系统信息。</p><p>按下<code>Ctrl+d</code>或者显式输入<code>exit</code>命令，就可以退出 Tmux 窗口。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ exit
</span></span></code></pre></div><p><strong>前缀键</strong></p><p>Tmux 窗口有大量的快捷键。所有快捷键都要通过前缀键唤起。默认的前缀键是<code>Ctrl+b</code>，即先按下<code>Ctrl+b</code>，快捷键才会生效。</p><p>举例来说，帮助命令的快捷键是<code>Ctrl+b ?</code>。它的用法是，在 Tmux 窗口中，先按下<code>Ctrl+b</code>，再按下<code>?</code>，就会显示帮助信息。</p><p>然后，按下 ESC 键或<code>q</code>键，就可以退出帮助。</p><h4 id=会话管理>会话管理<a hidden class=anchor aria-hidden=true href=#会话管理>#</a></h4><p><strong>新建会话</strong></p><p>第一个启动的 Tmux 窗口，编号是<code>0</code>，第二个窗口的编号是<code>1</code>，以此类推。这些窗口对应的会话，就是 0 号会话、1 号会话。</p><p>使用编号区分会话，不太直观，更好的方法是为会话起名。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tmux new -s &lt;session-name&gt;
</span></span></code></pre></div><p>上面命令新建一个指定名称的会话。</p><p><strong>分离会话</strong></p><p>在 Tmux 窗口中，按下<code>Ctrl+b d</code>或者输入<code>tmux detach</code>命令，就会将当前会话与窗口分离。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tmux detach
</span></span></code></pre></div><p>上面命令执行后，就会退出当前 Tmux 窗口，但是会话和里面的进程仍然在后台运行。</p><p><code>tmux ls</code>命令或<code>Ctrl+b s</code>可以查看当前所有的 Tmux 会话。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tmux ls
</span></span><span style=display:flex><span><span style=color:#75715e># or</span>
</span></span><span style=display:flex><span>$ tmux list-session
</span></span></code></pre></div><p><strong>接入会话</strong></p><p><code>tmux attach</code>命令用于重新接入某个已存在的会话。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 使用会话编号</span>
</span></span><span style=display:flex><span>$ tmux attach -t <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用会话名称</span>
</span></span><span style=display:flex><span>$ tmux attach -t &lt;session-name&gt;
</span></span></code></pre></div><p><strong>杀死会话</strong></p><p><code>tmux kill-session</code>命令用于杀死某个会话。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 使用会话编号</span>
</span></span><span style=display:flex><span>$ tmux kill-session -t <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用会话名称</span>
</span></span><span style=display:flex><span>$ tmux kill-session -t &lt;session-name&gt;
</span></span></code></pre></div><p><strong>切换会话</strong></p><p><code>tmux switch</code>命令用于切换会话。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 使用会话编号</span>
</span></span><span style=display:flex><span>$ tmux switch -t <span style=color:#ae81ff>0</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 使用会话名称</span>
</span></span><span style=display:flex><span>$ tmux switch -t &lt;session-name&gt;
</span></span></code></pre></div><p><strong>重命名会话</strong></p><p><code>tmux rename-session</code>命令或<code>Ctrl+b $</code>用于重命名会话。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tmux rename-session -t <span style=color:#ae81ff>0</span> &lt;new-name&gt;
</span></span></code></pre></div><p>上面命令将0号会话重命名。</p><h4 id=最简操作流程>最简操作流程<a hidden class=anchor aria-hidden=true href=#最简操作流程>#</a></h4><p>综上所述，以下是 Tmux 的最简操作流程。</p><ol><li>在服务器端新建会话<code>tmux new -s my_session</code>。</li><li>在 Tmux 窗口运行所需的程序。</li><li>按下快捷键<code>Ctrl+b d</code>将会话分离。</li><li>下次使用时，重新连接到会话<code>tmux attach-session -t my_session</code>。</li></ol><h4 id=窗格操作>窗格操作<a hidden class=anchor aria-hidden=true href=#窗格操作>#</a></h4><p>Tmux 可以将窗口分成多个窗格（pane），每个窗格运行不同的命令。以下命令都是在 Tmux 窗口中执行。</p><p><strong>划分窗格</strong></p><p><code>tmux split-window</code>命令用来划分窗格。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 划分上下两个窗格，或 Ctrl+b &#34;</span>
</span></span><span style=display:flex><span>$ tmux split-window
</span></span><span style=display:flex><span><span style=color:#75715e># 划分左右两个窗格，或 Ctrl+b %</span>
</span></span><span style=display:flex><span>$ tmux split-window -h
</span></span></code></pre></div><p><strong>移动光标</strong></p><p><code>tmux select-pane</code>命令或<code>Ctrl+b &lt;arrow key></code>用来移动光标位置。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 光标切换到上方窗格，或 Ctrl+b ;</span>
</span></span><span style=display:flex><span>$ tmux <span style=color:#66d9ef>select</span>-pane -U
</span></span><span style=display:flex><span><span style=color:#75715e># 光标切换到下方窗格，或 Ctrl+b o</span>
</span></span><span style=display:flex><span>$ tmux <span style=color:#66d9ef>select</span>-pane -D
</span></span><span style=display:flex><span><span style=color:#75715e># 光标切换到左边窗格</span>
</span></span><span style=display:flex><span>$ tmux <span style=color:#66d9ef>select</span>-pane -L
</span></span><span style=display:flex><span><span style=color:#75715e># 光标切换到右边窗格</span>
</span></span><span style=display:flex><span>$ tmux <span style=color:#66d9ef>select</span>-pane -R
</span></span></code></pre></div><ul><li><code>Ctrl+b x</code>：关闭当前窗格。</li><li><code>Ctrl+b !</code>：将当前窗格拆分为一个独立窗口。</li><li><code>Ctrl+b z</code>：当前窗格全屏显示，再使用一次会变回原来大小。</li><li><code>Ctrl+b Ctrl+&lt;arrow key></code>：按箭头方向调整窗格大小。</li><li><code>Ctrl+b q</code>：显示窗格编号。</li></ul><p><strong>交换窗格位置</strong></p><p><code>tmux swap-pane</code>命令用来交换窗格位置。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 当前窗格上移，或 Ctrl+b {</span>
</span></span><span style=display:flex><span>$ tmux swap-pane -U
</span></span><span style=display:flex><span><span style=color:#75715e># 当前窗格下移，或 Ctrl+b }</span>
</span></span><span style=display:flex><span>$ tmux swap-pane -D
</span></span></code></pre></div><ul><li><code>Ctrl+b Ctrl+o</code>：所有窗格向前移动一个位置，第一个窗格变成最后一个窗格。</li><li><code>Ctrl+b Alt+o</code>：所有窗格向后移动一个位置，最后一个窗格变成第一个窗格。</li></ul><h4 id=窗口管理>窗口管理<a hidden class=anchor aria-hidden=true href=#窗口管理>#</a></h4><p>除了将一个窗口划分成多个窗格，Tmux 也允许新建多个窗口。</p><p><strong>新建窗口</strong></p><p><code>tmux new-window</code>命令用来创建新窗口。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tmux new-window
</span></span><span style=display:flex><span><span style=color:#75715e># 新建一个指定名称的窗口</span>
</span></span><span style=display:flex><span>$ tmux new-window -n &lt;window-name&gt;
</span></span></code></pre></div><p><code>Ctrl+b c</code>：创建一个新窗口，状态栏会显示多个窗口的信息。</p><p><strong>切换窗口</strong></p><p><code>tmux select-window</code>命令用来切换窗口。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 切换到指定编号的窗口</span>
</span></span><span style=display:flex><span>$ tmux <span style=color:#66d9ef>select</span>-window -t &lt;window-number&gt;
</span></span><span style=display:flex><span><span style=color:#75715e># 切换到指定名称的窗口</span>
</span></span><span style=display:flex><span>$ tmux <span style=color:#66d9ef>select</span>-window -t &lt;window-name&gt;
</span></span></code></pre></div><ul><li><code>Ctrl+b p</code>：切换到上一个窗口（按照状态栏上的顺序）。</li><li><code>Ctrl+b n</code>：切换到下一个窗口。</li><li><code>Ctrl+b &lt;number></code>：切换到指定编号的窗口，其中的<code>&lt;number></code>是状态栏上的窗口编号。</li><li><code>Ctrl+b w</code>：从列表中选择窗口。</li></ul><p><strong>重命名窗口</strong></p><p><code>tmux rename-window</code>命令或<code>Ctrl+b ,</code>用于为当前窗口起名（或重命名）。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ tmux rename-window &lt;new-name&gt;
</span></span></code></pre></div><h4 id=其他命令>其他命令<a hidden class=anchor aria-hidden=true href=#其他命令>#</a></h4><p>下面是一些其他命令。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 列出所有快捷键，及其对应的 Tmux 命令</span>
</span></span><span style=display:flex><span>$ tmux list-keys
</span></span><span style=display:flex><span><span style=color:#75715e># 列出所有 Tmux 命令及其参数</span>
</span></span><span style=display:flex><span>$ tmux list-commands
</span></span><span style=display:flex><span><span style=color:#75715e># 列出当前所有 Tmux 会话的信息</span>
</span></span><span style=display:flex><span>$ tmux info
</span></span><span style=display:flex><span><span style=color:#75715e># 重新加载当前的 Tmux 配置</span>
</span></span><span style=display:flex><span>$ tmux source-file ~/.tmux.conf
</span></span></code></pre></div><h3 id=fishhttpswwwruanyifengcomblog201705fish_shellhtml><a href=https://www.ruanyifeng.com/blog/2017/05/fish_shell.html>Fish</a><a hidden class=anchor aria-hidden=true href=#fishhttpswwwruanyifengcomblog201705fish_shellhtml>#</a></h3><p><a href=https://zh.wikipedia.org/wiki/%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%95%8C%E9%9D%A2>命令行</a>是程序员的必备技能。图形界面虽然好看，解决问题还是要靠命令行。</p><p>命令行由 Shell 提供。各种命令通过 Shell，传递给操作系统的内核。学习命令行就是在学习 Shell。</p><p>Shell 有好几种，目前最常用是 <a href=https://en.wikipedia.org/wiki/Bash_(Unix_shell)>Bash</a> 和 <a href=https://en.wikipedia.org/wiki/Z_shell>zsh</a>。但是，在我看来，它们都不如 <a href=https://fishshell.com/>Fish Shell</a> 好用。</p><p>五年前，我第一次尝试 Fish，感到很惊艳，一直用到现在。本文介绍 Fish 的主要特点，希望你也来尝试它。</p><h4 id=简介-3>简介<a hidden class=anchor aria-hidden=true href=#简介-3>#</a></h4><p>Fish 是"the <strong>f</strong>riendly <strong>i</strong>nteractive <strong>sh</strong>ell"的简称，最大特点就是方便易用。很多其他 Shell 需要配置才有的功能，Fish 默认提供，不需要任何配置。</p><p>如果你想拥有一个方便好用的 Shell，又不想学习一大堆语法，或者花费很多时间配置，那么你一定要尝试一下 Fish。</p><h4 id=安装-1>安装<a hidden class=anchor aria-hidden=true href=#安装-1>#</a></h4><p>Ubuntu 的安装方法。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install fish
</span></span></code></pre></div><p>其他系统的安装请参考<a href=https://fishshell.com/#platform_tabs>官方网站</a>。</p><h4 id=启动与帮助>启动与帮助<a hidden class=anchor aria-hidden=true href=#启动与帮助>#</a></h4><p>安装完成后，就可以启动 Fish。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ fish
</span></span></code></pre></div><p>由于 Fish 的语法与 Bash 有很大差异，Bash 脚本一般不兼容。因此，我建议不要将 Fish 设为默认 Shell，而是每次手动启动它。</p><p>使用过程中，如果需要帮助，可以输入<code>help</code>命令。浏览器就会自动打开，显示在线文档。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ help
</span></span></code></pre></div><h4 id=彩色显示>彩色显示<a hidden class=anchor aria-hidden=true href=#彩色显示>#</a></h4><p>进入 Fish 以后，你注意到的第一件事，可能就是它默认彩色显示。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 无效命令为红色</span>
</span></span><span style=display:flex><span>$ mkd
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 有效命令为蓝色</span>
</span></span><span style=display:flex><span>$ mkdir
</span></span></code></pre></div><p>有效路径会有下划线。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ cat ~/somefi 
</span></span></code></pre></div><p>上面代码表示，存在以<code>~/somefi</code>开头的路径。如果没有下划线，你就知道这个路径不存在。</p><h4 id=自动建议>自动建议<a hidden class=anchor aria-hidden=true href=#自动建议>#</a></h4><p>Fish 会自动在光标后面给出建议，表示可能的选项，颜色为灰色。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 命令建议</span>
</span></span><span style=display:flex><span>$ /bin/hostname
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 参数建议</span>
</span></span><span style=display:flex><span>$ grep --ignore-case
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 路径建议</span>
</span></span><span style=display:flex><span>$ ls node_modules
</span></span></code></pre></div><p>如果采纳建议，可以按下<code>→</code>或<code>Control + F</code>。如果只采纳一部分，可以按下<code>Alt + →</code>。</p><h4 id=自动补全>自动补全<a hidden class=anchor aria-hidden=true href=#自动补全>#</a></h4><p>输入命令时，Fish 会自动显示匹配的上一条历史记录。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git commit -m <span style=color:#e6db74>&#34;feat: first commit&#34;</span>
</span></span></code></pre></div><p>如果没有匹配的历史记录，Fish 会猜测可能的结果，自动补全各种输入。比如，输入<code>pyt</code>再按下<code>Tab</code>，就会自动补全为<code>python</code>命令。</p><p>如果有多个可能的结果，Fish 会把它们都列出，还带有简要介绍。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vi<span style=color:#f92672>[</span>按下 Tab 键<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>vi <span style=color:#f92672>(</span>Executable link, 2.7MB<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>view <span style=color:#f92672>(</span>Vi IMproved, 一个程序员的文本编辑器<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>viewer.py <span style=color:#f92672>(</span>Executable, 967B<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>viewres  <span style=color:#f92672>(</span>Graphical class browser <span style=color:#66d9ef>for</span> Xt<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>...and <span style=color:#ae81ff>12</span> more rows
</span></span></code></pre></div><p>这时，再按一次<code>tab</code>，就可以在这些命令之中选择。</p><p>除了补全命令，Fish 还可以补全参数。比如，<code>ls</code>命令的<code>-l</code>参数后面按下<code>Tab</code>键，就会显示可以连用的其他参数。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ls -l<span style=color:#f92672>[</span>按下 Tab 键<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>-l1  <span style=color:#f92672>(</span>List one file per line<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>-lA  <span style=color:#f92672>(</span>Show hidden except . and ..<span style=color:#f92672>)</span>  
</span></span><span style=display:flex><span>-la  <span style=color:#f92672>(</span>Show hidden<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>-lB  <span style=color:#f92672>(</span>Ignore files ending with ~<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span>...and <span style=color:#ae81ff>16</span> more rows<span style=color:#e6db74>```</span>
</span></span></code></pre></div><p>Fish 还可以自动补全 Git 分支。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git checkout master
</span></span></code></pre></div><h4 id=易懂的语法>易懂的语法<a hidden class=anchor aria-hidden=true href=#易懂的语法>#</a></h4><p>Fish 的语法非常自然，一眼就能看懂。</p><p><code>if</code>语句：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>if</span> grep fish /etc/shells
</span></span><span style=display:flex><span>    echo Found fish
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> grep bash /etc/shells
</span></span><span style=display:flex><span>    echo Found bash
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>    echo Got nothing
</span></span><span style=display:flex><span>end
</span></span></code></pre></div><p><code>switch</code>语句：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>switch <span style=color:#f92672>(</span>uname<span style=color:#f92672>)</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> Linux
</span></span><span style=display:flex><span>    echo Hi Tux!
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> Darwin
</span></span><span style=display:flex><span>    echo Hi Hexley!
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> FreeBSD NetBSD DragonFly
</span></span><span style=display:flex><span>    echo Hi Beastie!
</span></span><span style=display:flex><span><span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#39;*&#39;</span>
</span></span><span style=display:flex><span>    echo Hi, stranger!
</span></span><span style=display:flex><span>end
</span></span></code></pre></div><p><code>while</code>循环：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>while</span> true
</span></span><span style=display:flex><span>    echo <span style=color:#e6db74>&#34;Loop forever&#34;</span>
</span></span><span style=display:flex><span>end
</span></span></code></pre></div><p><code>for</code>循环：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>for</span> file in *.txt
</span></span><span style=display:flex><span>    cp $file $file.bak
</span></span><span style=display:flex><span>end
</span></span></code></pre></div><h4 id=函数>函数<a hidden class=anchor aria-hidden=true href=#函数>#</a></h4><p>Fish 的函数用来封装命令，或者为现有的命令起别名。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>function</span> ll
</span></span><span style=display:flex><span>    ls -lhG $argv
</span></span><span style=display:flex><span>end
</span></span></code></pre></div><p>上面代码定义了一个<code>ll</code>函数。命令行执行这个函数以后，就可以用<code>ll</code>命令替代<code>ls -lhG</code>。其中，变量<code>$argv</code>表示函数的参数。</p><p>下面是另一个例子。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>function</span> ls
</span></span><span style=display:flex><span>    command ls -hG $argv
</span></span><span style=display:flex><span>end
</span></span></code></pre></div><p>上面的代码重新定义<code>ls</code>命令。注意，函数体内的<code>ls</code>之前，要加上<code>command</code>，否则会因为无限循环而报错。</p><h4 id=提示符>提示符<a hidden class=anchor aria-hidden=true href=#提示符>#</a></h4><p><code>fish_prompt</code>函数用于定义命令行提示符（prompt）。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>function</span> fish_prompt
</span></span><span style=display:flex><span>    set_color purple
</span></span><span style=display:flex><span>    date <span style=color:#e6db74>&#34;+%m/%d/%y&#34;</span>
</span></span><span style=display:flex><span>    set_color FF0
</span></span><span style=display:flex><span>    echo <span style=color:#f92672>(</span>pwd<span style=color:#f92672>)</span> <span style=color:#e6db74>&#39;&gt;&#39;</span>
</span></span><span style=display:flex><span>    set_color normal
</span></span><span style=display:flex><span>end
</span></span></code></pre></div><p>执行上面的函数以后，你的命令行提示符就会变成下面这样。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>02/06/13
</span></span><span style=display:flex><span>/home/tutorial &gt; 
</span></span></code></pre></div><h4 id=配置-2>配置<a hidden class=anchor aria-hidden=true href=#配置-2>#</a></h4><p>Fish 的配置文件是<code>~/.config/fish/config.fish</code>，每次 Fish 启动，就会自动加载这个文件。</p><p>我们可以在这个文件里面写入各种自定义函数，它们会被自动加载。比如，上面的<code>fish_prompt</code>函数就可以写在这个文件里面，这样每次启动 Fish，就会出现自定义的提示符。</p><p>Fish 还提供 Web 界面配置该文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ fish_config
</span></span></code></pre></div><p>输入上面的命令以后，浏览器就会自动打开本机的 8000 端口，用户可以在网页上对 Fish 进行配置，比如选择提示符和配色主题。</p><h3 id=zsh>Zsh<a hidden class=anchor aria-hidden=true href=#zsh>#</a></h3><p><a href=https://github.com/ohmyzsh/ohmyzsh><strong>Oh My Zsh</strong></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sh -c <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>wget https://raw.github.com/ohmyzsh/ohmyzsh/master/tools/install.sh -O -<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p>oh-my-zsh应该对通配符作了限制，需要用跳脱字符</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo apt remove fcitx<span style=color:#ae81ff>\*</span>
</span></span></code></pre></div><p>Zsh theme：<a href=https://www.slant.co/topics/7553/~theme-for-oh-my-zsh>What&rsquo;s the best theme for Oh My Zsh?</a></p><p><a href=https://github.com/romkatv/zsh4humans><strong>zsh4humans</strong></a></p><h3 id=bash>Bash<a hidden class=anchor aria-hidden=true href=#bash>#</a></h3><p><strong>include local bin</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ vim .bashrc
</span></span><span style=display:flex><span>export PATH<span style=color:#f92672>=</span>/home/kurome/.local/bin:$PATH
</span></span></code></pre></div><p><a href=https://github.com/magicmonty/bash-git-prompt><strong>bash-git-prompt</strong></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git clone https://github.com/magicmonty/bash-git-prompt.git ~/.bash-git-prompt --depth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>$ vim ~/.bashrc
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -f <span style=color:#e6db74>&#34;</span>$HOME<span style=color:#e6db74>/.bash-git-prompt/gitprompt.sh&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>    GIT_PROMPT_ONLY_IN_REPO<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>    source $HOME/.bash-git-prompt/gitprompt.sh
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><p><a href=https://github.com/scop/bash-completion><strong>bash-completion</strong></a></p><p>一般已经安装配置好了。</p><p><a href=https://github.com/awesome-lists/awesome-bash><strong>awesome-bash</strong></a></p><p><a href=https://github.com/ohmybash/oh-my-bash><strong>oh-my-bash</strong></a></p><p>不需要 zsh 许多特性，所以可以用这个。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ git clone https://github.com/ohmybash/oh-my-bash.git ~/.oh-my-bash
</span></span><span style=display:flex><span>$ cp ~/.bashrc ~/.bashrc.orig
</span></span><span style=display:flex><span>$ cp ~/.oh-my-bash/templates/bashrc.osh-template ~/.bashrc
</span></span><span style=display:flex><span>$ source ~/.bashrc
</span></span></code></pre></div><p>主题用 <code>powerline</code>，需要下载 <a href=https://github.com/powerline/fonts>Patched fonts for Powerline users</a>，然后在配置中选择 <code>Meslo LG S for Powerline</code> 这一款字体。</p><h4 id=tips-1>Tips<a hidden class=anchor aria-hidden=true href=#tips-1>#</a></h4><p><a href=https://askubuntu.com/questions/746350/request-root-privilege-from-within-a-script><strong>Request root privilege from within a script</strong></a></p><p>This&rsquo;ll work:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>echo <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>whoami<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span> <span style=color:#e6db74>&#34;</span>$UID<span style=color:#e6db74>&#34;</span> -eq <span style=color:#ae81ff>0</span> <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> exec sudo <span style=color:#e6db74>&#34;</span>$0<span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div><p><a href=https://stackoverflow.com/questions/8818119/how-can-i-run-a-function-from-a-script-in-command-line><strong>How can I run a function from a script in command line?</strong></a></p><p>simply place at the end the special parameter <code>"$@"</code></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#66d9ef>if</span> declare -f <span style=color:#e6db74>&#34;</span>$1<span style=color:#e6db74>&#34;</span> &gt; /dev/null
</span></span><span style=display:flex><span><span style=color:#66d9ef>then</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># call arguments verbatim</span>
</span></span><span style=display:flex><span>  <span style=color:#e6db74>&#34;</span>$@<span style=color:#e6db74>&#34;</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>else</span>
</span></span><span style=display:flex><span>  <span style=color:#75715e># Show a helpful error</span>
</span></span><span style=display:flex><span>  echo <span style=color:#e6db74>&#34;&#39;</span>$1<span style=color:#e6db74>&#39; is not a known function name&#34;</span> &gt;&amp;<span style=color:#ae81ff>2</span>
</span></span><span style=display:flex><span>  exit <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>fi</span>
</span></span></code></pre></div><p><a href=https://unix.stackexchange.com/questions/260627/how-do-you-list-all-functions-and-aliases-in-a-specific-script><strong>How do you list all functions and aliases in a specific script?</strong></a></p><pre tabindex=0><code>declare -F | awk &#39;{print $NF}&#39; | sort | egrep -v &#34;^_&#34; 
</code></pre><h3 id=goghhttpsgithubcomgogh-cogogh><a href=https://github.com/Gogh-Co/Gogh>Gogh</a><a hidden class=anchor aria-hidden=true href=#goghhttpsgithubcomgogh-cogogh>#</a></h3><p>Color Scheme for your Terminal</p><pre tabindex=0><code>bash -c &#34;$(wget -qO- https://git.io/vQgMr)&#34;
</code></pre><p>我选择的是 <code>VS Code Dark+</code></p><h2 id=proxy>Proxy<a hidden class=anchor aria-hidden=true href=#proxy>#</a></h2><h3 id=v2rayhttpsarchlinuxstudiogithubioarchlinuxtutorialrookiefxckgfw><a href=https://archlinuxstudio.github.io/ArchLinuxTutorial/#/rookie/fxckGFW>v2ray</a><a hidden class=anchor aria-hidden=true href=#v2rayhttpsarchlinuxstudiogithubioarchlinuxtutorialrookiefxckgfw>#</a></h3><h4 id=节点准备>节点准备<a hidden class=anchor aria-hidden=true href=#节点准备>#</a></h4><p>简单来讲节点是形如如下的神秘链接：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>ss://xxxxxxxxxxxxxxxxxxxxxxxxxxxx
</span></span><span style=display:flex><span>vmess://xxxxxxxxxxxxxxxxxxxxxxxxxxxx
</span></span></code></pre></div><p>如果你没有这些连接：</p><ul><li>自行部署，你则需要自行购买处于自由互联网的服务器并进行节点搭建，这不在本文讨论范围内。如果你需要购买服务器，推荐一个 VPS 提供商：<a href=https://justhost.ru/>justhost.ru</a>。</li><li>购买机场的订阅服务，可以参考它们的订阅流程以获取节点。需要提醒的是，机场服务属于灰色产业，随时有停止服务的可能，购买建议以月付进行购买以避免过大损失。关于机场审计规则，我们的观点是"我可以不看，但是你不可以封禁"。对于机场审计程度，读者可根据自身实际情况自行评估。</li><li>如果你不想花任何费用，可安装<a href=https://psiphon3.com/zh/index.html>赛风</a>这类软件。它是自由软件。如果你使用赛风，可以非常方便的发送空邮件到<a href=mailto:get@psiphon3.com>get@psiphon3.com</a>以获取赛风下载链接。赛风应用目前只支持 Windows\Android\IOS\MacOS 平台。当你在这些平台上能够访问自由互联网时，可以去各个渠道搜索可用的节点和代理资源。注意，使用公共节点需要自行承担可能的风险。</li></ul><h4 id=安装-2>安装<a hidden class=anchor aria-hidden=true href=#安装-2>#</a></h4><p><a href=https://github.com/v2fly/v2ray-core>v2ray</a>/<a href=https://github.com/XTLS/Xray-core> Xray-core</a> 是使用 <a href=https://github.com/Qv2ray/Qv2ray/>Qv2ray</a>（原项目已停止开发） 以及 <a href=https://github.com/v2rayA/v2rayA>V2rayA</a> 的前提，需要先进行安装。</p><p>Qv2ray 和 V2rayA 是两款非常优秀的在 Linux 上可用的科学上网通用客户端：</p><ul><li>Qv2ray：安装后在 Plugins 中，选择 V2ray Core Plugin，并进行 V2ray 的设置。现在你已经可以使用，你需要按照<a href=https://qv2ray.net/>官方文档</a>导入已有的链接或订阅。</li><li>V2rayA：2rayA 是一个浏览器客户端，使用非常方便。更多使用方法请看<a href=https://v2raya.org/>官方文档</a></li></ul><h4 id=代理配置>代理配置<a hidden class=anchor aria-hidden=true href=#代理配置>#</a></h4><p>在经过上述步骤后，你应该已经有了 SOCKS5 代理以及 HTTP 代理的地址和端口。接下来进行设置：</p><ul><li><p>系统代理：在节点链接后，你可在<code>系统设置</code> -> <code>网络设置</code> -> <code>代理</code>中设置代理。注意，<strong><code>系统设置</code>中的代理配置在 KDE 桌面环境中并不是所有应用都会遵守</strong>。没有遵循系统设置代理的应用还需要单独进行代理配置。</p></li><li><p>终端</p><p>可以通过 export 命令设置当前终端的代理方式。比如使用 tldr 或 github raw 等资源需要设置 https 代理。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>export https_proxy<span style=color:#f92672>=</span>http://127.0.0.1:8889
</span></span><span style=display:flex><span>export http_proxy<span style=color:#f92672>=</span>http://127.0.0.1:8889
</span></span><span style=display:flex><span>export all_proxy<span style=color:#f92672>=</span>http://127.0.0.1:8889
</span></span></code></pre></div><p>不同终端命令所识别的环境变量名不同，如 all_proxy 对 curl 生效，而对 wget 则不生效，具体可查看各个命令的 man page。</p></li><li><p><a href=https://github.com/haad/proxychains>proxychains</a>/<a href=https://github.com/rofl0r/proxychains-ng>proxychains-ng</a></p><p>如果对于一个应用，KDE 的系统代理不生效，在终端 export 了 ALL_PROXY 变量再用终端启动此应用代理也不生效，并且这个应用自身也没有配置代理的选项（即应用不支持代理）。此时可以使用 proxychains，它可以为单行命令配置代理，它是一个预加载的 hook，允许通过一个或多个 SOCKS 或 HTTP 代理重定向现有动态链接程序的 TCP 流量（即强制应用走代理）。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install proxychains
</span></span><span style=display:flex><span>$ sudo vim /etc/proxychains.conf
</span></span><span style=display:flex><span>socks5 127.0.0.1 <span style=color:#ae81ff>1089</span>
</span></span></code></pre></div></li></ul><h4 id=透明代理httpsarchicekylinonlinerookietransparenthtml><a href=https://arch.icekylin.online/rookie/transparent.html>透明代理</a><a hidden class=anchor aria-hidden=true href=#透明代理httpsarchicekylinonlinerookietransparenthtml>#</a></h4><p>全局代理，也即透明代理。之所以叫做透明代理，是因为这代理对于操作系统中的各个应用相当于是透明的，应用们感知不到代理的存在。之所以叫做全局代理，很明显意为全局所有流量都走代理。</p><ul><li><p>在 Qv2ray 的“首选项-入站设置”的下方启用任意门设置选项。</p><ul><li>监听 ipv4 地址可填<code>127.0.0.1</code> 或 <code>0.0.0.0</code>，建议前者。若需双栈代理，则在监听 ipv6 地址填上<code>::1</code>（如果监听 ipv4 填了 0.0.0.0 则可不填）。</li><li>嗅探选择 Full，Destination Override 的三项均勾选。</li><li>模式选择“tproxy”。</li></ul></li><li><p>安装<a href=https://github.com/springzfx/cgproxy#introduction>cgproxy</a>软件，编辑<code>/etc/cgproxy/config.json</code>：</p><ul><li>在<code>cgroup_proxy</code>中括号里加上<code>"/"</code>，<code>port</code>改为 Qv2ray 首选项里的透明代理的端口。</li><li>cgproxy默认配置是代理所有 tcp 和 udp，ipv4 和 ipv6 的流量，如果不希望代理其中的某种（些）流量，则将对应的<code>enable_xxx</code>改为 <code>false</code>。注意这里的配置要和 Qv2ray 选项里的配置一致，如 Qv2ray 选项里没有勾选 udp，则这里务必把<code>enable_udp</code>改为 false。</li><li>如果希望当本机作为网关设备时为连接到本机的其他设备（如连接到本机开设的 wifi 热点的设备）也提供透明代理，则把<code>enable_gateway</code>改为 <code>true</code></li></ul></li><li><p>透明代理的基本原理是拦截系统发出的所有流量，并将这些流量转到代理工具里，从而实现让系统所有流量都走代理的目的。此时，为了避免流量出现死循环（即代理工具发出的流量又转回到代理工具里），需要将代理工具排除在透明代理环境外面。有两种方式可以实现这一点：</p><ul><li><p>通过execsnoop监控代理工具的启动，并自动将其移至透明代理环境外面：</p><ul><li>cgproxy软件自带execsnoop支持，以上cgproxy测试过的发行版均可支持。</li><li>编辑<code>/etc/cgproxy/config.json</code>，在<code>program_noproxy</code>中括号里加上<code>"v2ray"</code>、<code>"qv2ray"</code>，以使qv2ray和v2ray发出的流量不经过透明代理。如果你的v2ray或qv2ray不在PATH里，则需要填写它们的绝对路径。</li></ul></li><li><p>在每次连接代理节点时，让qv2ray自己把自己移到透明代理环境外面：</p><p>安装 Qvplugin-Command 插件，在插件设置里的“pre-connection”栏里加上一句</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sh -c <span style=color:#e6db74>&#34;cgnoproxy --pid </span><span style=color:#66d9ef>$(</span>pgrep -x qv2ray<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</span></span></code></pre></div></li></ul></li><li><p>如果启用了 udp 的透明代理（dns 也是 udp），则给 v2ray 二进制文件加上相应的特权：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>sudo setcap <span style=color:#e6db74>&#34;cap_net_admin,cap_net_bind_service=ep&#34;</span> /usr/bin/v2ray
</span></span></code></pre></div><p>否则 udp 的透明代理可能会出问题。如果每次更新了 v2ray 二进制文件，都需要重新执行此命令。</p></li><li><p>启动透明代理服务：<code>systemctl start cgproxy.service</code>或<code>systemctl enable --now cgproxy.service</code>。</p></li></ul><p>以上步骤完成后，透明代理应该能正常使用了。</p><p><strong>dns</strong></p><p>如果勾选了“dns 拦截”，且启用了 dns 和 udp 的透明代理，则 v2ray 会拦截对系统 dns 的请求，并将其转发到 v2ray 的内置 dns 里，即让 v2ray 内置 dns 接管系统 dns。但 v2ray 内置 dns 是会遵循路由规则的。</p><p>如果没勾选“dns 拦截”，则 v2ray 虽然不会让内置 dns 接管系统 dns，但如果启用了 dns 和 udp 的透明代理，则系统 dns 也会走透明代理进 v2ray，并遵循 v2ray 的路由规则。</p><p>因此，在启用了 dns 和 udp 的透明代理时，若系统 dns 或 v2ray 的内置 dns 配置不当，可能导致 dns 请求发不出去，从而影响正常上网。</p><p>由于 qv2ray 常见的路由规则是绕过国内 ip，国外 ip 均走代理。在这个情形中，以下两个配置是典型的有问题的 dns 配置方式：</p><ul><li>配置了国外普通 dns 作为首选，但代理本身不支持 udp（此时 dns 查询的 udp 流量出不去，dns 无法查询）</li><li>配置了使用域名的 doh 作为首选。此时 doh 的域名无法被解析，从而 doh 也无法使用。</li></ul><p>一般而言，如果并不在意将 dns 查询发给谁，那么，在绕过国内 ip 的情况下，只需要配置一个国内普通 dns 作为首选即可保证不会出问题。若代理本身不支持 udp，又希望使用国外 dns，则可以考虑使用使用 ip 的 doh（如<code>https://1.1.1.1/dns-query</code>等）。</p><p>如果需要更复杂的 dns 配置，建议参考<a href=https://www.v2ray.com/chapter_02/04_dns.html>上游文档</a>，并选择合适的不会影响正常上网的 dns 配置。</p><h3 id=clashhttpsgithubcomdreamacroclash><a href=https://github.com/Dreamacro/clash>Clash</a><a hidden class=anchor aria-hidden=true href=#clashhttpsgithubcomdreamacroclash>#</a></h3><p>手动下载配置：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ wget -O config.yaml <span style=color:#f92672>[</span>订阅链接<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>$ curl -L -o config.yaml <span style=color:#f92672>[</span>订阅链接<span style=color:#f92672>]</span>
</span></span></code></pre></div><p>测试 clash：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ chmod u+x clash_premium
</span></span><span style=display:flex><span>$ sudo ./clash_premium -d .
</span></span></code></pre></div><p>设置系统代理：</p><ul><li><p>Using GUI：打开 Gnome 系统设置，点击网络代理右边的 ⚙ 按钮，选择手动</p><ul><li>HTTP 和 HTTPS 代理为 127.0.0.1:7890</li><li>Socks 主机为 127.0.0.1:7891</li></ul></li><li><p><a href=https://www.xmodulo.com/change-system-proxy-settings-command-line-ubuntu-desktop.html>Using CLI</a>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gsettings set org.gnome.system.proxy.http host <span style=color:#e6db74>&#39;127.0.0.1&#39;</span>
</span></span><span style=display:flex><span>$ gsettings set org.gnome.system.proxy.http port <span style=color:#e6db74>&#39;7890&#39;</span>
</span></span><span style=display:flex><span>$ gsettings set org.gnome.system.proxy.https host <span style=color:#e6db74>&#39;127.0.0.1&#39;</span>
</span></span><span style=display:flex><span>$ gsettings set org.gnome.system.proxy.https port <span style=color:#e6db74>&#39;7890&#39;</span>
</span></span><span style=display:flex><span>$ gsettings set org.gnome.system.proxy.socks host <span style=color:#e6db74>&#39;127.0.0.1&#39;</span>
</span></span><span style=display:flex><span>$ gsettings set org.gnome.system.proxy.socks port <span style=color:#e6db74>&#39;7891&#39;</span>
</span></span></code></pre></div><p>The basic usage of <code>gsettings</code> for reading and writing a particular Dconf setting is as follows.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># To modify a DConf setting:</span>
</span></span><span style=display:flex><span>$ gsettings set &lt;schema&gt; &lt;key&gt; &lt;value&gt;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># To read a DConf setting:</span>
</span></span><span style=display:flex><span>$ gsettings get &lt;schema&gt; &lt;key&gt;
</span></span></code></pre></div></li></ul><p>相关软件：<a href=https://github.com/nadoo/glider>glider</a>/<a href=https://github.com/getlantern/lantern>Lantern</a>/<a href=https://www.privoxy.org/>Privoxy</a>/<a href=https://github.com/OpenVPN/openvpn>openvpn</a>/<a href=https://shadowsocks.org/en/index.html>Shadowsocks</a>/<a href=https://www.torproject.org/download/download.html.en>Tor</a>/<a href=https://github.com/trojan-gfw/trojan>trojan</a>：<a href=https://tlanyan.pp.ua/trojan-tutorial/>trojan教程</a></p><h4 id=clashservicehttpsgithubcomdreamacroclashwikiclash-as-a-daemon><a href=https://github.com/Dreamacro/clash/wiki/clash-as-a-daemon>clash.service</a><a hidden class=anchor aria-hidden=true href=#clashservicehttpsgithubcomdreamacroclashwikiclash-as-a-daemon>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo vi clash.service
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Unit<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Description<span style=color:#f92672>=</span>Clash daemon, A rule-based proxy in Go
</span></span><span style=display:flex><span>After<span style=color:#f92672>=</span>network.target
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Service<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>simple
</span></span><span style=display:flex><span>Restart<span style=color:#f92672>=</span>always
</span></span><span style=display:flex><span>RestartSec<span style=color:#f92672>=</span><span style=color:#ae81ff>10</span>
</span></span><span style=display:flex><span>ExecStart<span style=color:#f92672>=</span>/home/kurome/.opt/clash/clash_premium -d /home/kurome/.opt/clash/
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>[</span>Install<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>WantedBy<span style=color:#f92672>=</span>multi-user.target
</span></span></code></pre></div><p>如果不想代理了，可以直接在 clash dashboard 的 Proxy 或者 Settting 里选择 DIRECT，而不是关闭 clash service。</p><h4 id=providershttpsbloghifoolcnpostsf42b65b0><a href=https://blog.hifool.cn/posts/f42b65b0/>Providers</a><a hidden class=anchor aria-hidden=true href=#providershttpsbloghifoolcnpostsf42b65b0>#</a></h4><p>由于机场的订阅规则并不能完全满足自己的要求，因此自己通常会修改配置文件加上自己的规则。然而当使用机场订阅配置时，自动更新之后会覆盖掉自己配置的规则，又需要重新更改，非常麻烦。</p><p>实际上clash在Premium版本中已经提供了proxy-providers的功能，能够完美的解决这个问题。类似的，也有rule-providers的功能，从指定url处获取别人提供的规则，而不用自己来制定。</p><p>Premium 版本与普通版本区别是：Premium core is proprietary.</p><p>proxy-providers原理是提取指定URL或者指定文件中的proxies字段中的所有内容，即指提取订阅节点的信息，到当前文件中供我们使用。详情看该部分的<a href=https://github.com/Dreamacro/clash/wiki/configuration#proxy-providers>官方文档</a>。如果订阅链接或文件没有该部分，则会报错：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>11:56:42 ERR <span style=color:#f92672>[</span>Config<span style=color:#f92672>]</span> configuration file test failed error<span style=color:#f92672>=</span>initial proxy provider tly error: file must have a <span style=color:#e6db74>`</span>proxies<span style=color:#e6db74>`</span> field path<span style=color:#f92672>=</span>/home/kurome/.opt/clash/config.yaml
</span></span></code></pre></div><p>这个时候就要注意看一下自己复制的订阅链接是否是用于 Clash 的，实在没有可以使用<a href=https://sub.xeton.dev/>订阅转换</a>。</p><p>proxy-providers的格式为：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>proxy-providers</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>provider1</span>: <span style=color:#75715e># provider的名称，后期会用到</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>http</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#e6db74>&#34;url&#34;</span> <span style=color:#75715e># 机场给你的订阅链接</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>interval</span>: <span style=color:#ae81ff>3600</span> <span style=color:#75715e># 每3600秒更新一次订阅</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: <span style=color:#ae81ff>./provider1.yaml</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>health-check</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>enable</span>: <span style=color:#66d9ef>true</span> <span style=color:#75715e># 是否自动进行latency-test</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>interval</span>: <span style=color:#ae81ff>600</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>url</span>: <span style=color:#ae81ff>http://www.gstatic.com/generate_204</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>test</span>:
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>file</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>path</span>: <span style=color:#ae81ff>/test.yaml</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>health-check</span>:
</span></span><span style=display:flex><span>      <span style=color:#f92672>enable</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>interval</span>: <span style=color:#ae81ff>36000</span>
</span></span><span style=display:flex><span>      <span style=color:#f92672>url</span>: <span style=color:#ae81ff>http://www.gstatic.com/generate_204</span>
</span></span></code></pre></div><p>相关资源：</p><ul><li><a href=https://github.com/Hackl0us/SS-Rule-Snippet/wiki/clash(X)#linux>SS-Rule-Snippet</a>：提供clash整体配置模版</li><li><a href=https://github.com/Loyalsoldier/clash-rules>clash-rules</a>：主要提供 rule-providers，推荐使用其规则</li></ul><h4 id=clash-dashboardhttpsgithubcomdreamacroclash-dashboard><a href=https://github.com/Dreamacro/clash-dashboard>Clash Dashboard</a><a hidden class=anchor aria-hidden=true href=#clash-dashboardhttpsgithubcomdreamacroclash-dashboard>#</a></h4><p>使用网页版 <a href=http://clash.razord.top>clash dashboard</a> 会遇到<a href=https://developer.mozilla.org/zh-CN/docs/Web/HTTP/CORS>跨源资源共享</a>错误。可以 clone <a href=https://github.com/Dreamacro/clash-dashboard/tree/gh-pages>gh-pages 分支</a>本地使用，直接打开index.html 是依然有错误的，正确的做法是使用 clash 的 <code>external-ui</code>。</p><p><a href=https://www.alvinkwok.cn/2022/01/29/2022/01/Clash%20For%20Linux%20Install%20Guide/>配置控制界面</a>：在 <code>/path/to/clash/config.yaml</code> 中添加控制界面相关配置</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>external-controller</span>: <span style=color:#ae81ff>127.0.0.1</span>:<span style=color:#ae81ff>9090</span>
</span></span><span style=display:flex><span><span style=color:#f92672>external-ui</span>: <span style=color:#ae81ff>./clash-dashboard</span>
</span></span><span style=display:flex><span><span style=color:#f92672>secret</span>: <span style=color:#e6db74>&#34;5L2g5aW9Y2xhc2gK&#34;</span>
</span></span></code></pre></div><h4 id=配置文件httpswwwcfmemcom202108clashhtml><a href=https://www.cfmem.com/2021/08/clash.html>配置文件</a><a hidden class=anchor aria-hidden=true href=#配置文件httpswwwcfmemcom202108clashhtml>#</a></h4><p><strong>Clash</strong> 是基于 Go 语言写的科学上网工具，目前支持 windows, mac, android, openwrt, linux 平台，支持 ss, trojan, vmess, snell 协议，支持分流规则。</p><p>clash 配置文件格式为 yaml 格式，格式如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>port</span>: <span style=color:#ae81ff>7890</span>
</span></span><span style=display:flex><span><span style=color:#f92672>socks-port</span>: <span style=color:#ae81ff>7891</span>
</span></span><span style=display:flex><span><span style=color:#f92672>allow-lan</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span><span style=color:#f92672>mode</span>: <span style=color:#ae81ff>Rule</span>
</span></span><span style=display:flex><span><span style=color:#f92672>log-level</span>: <span style=color:#ae81ff>info</span> <span style=color:#75715e># silent</span>
</span></span><span style=display:flex><span><span style=color:#f92672>external-controller</span>: :<span style=color:#ae81ff>9090</span>
</span></span><span style=display:flex><span><span style=color:#f92672>proxies</span>:
</span></span><span style=display:flex><span>  - {<span style=color:#f92672>name</span>: <span style=color:#ae81ff>cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 20-1}</span>
</span></span><span style=display:flex><span><span style=color:#f92672>proxy-groups</span>:
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>🔰 节点选择</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>select</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxies</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>♻️ 自动选择</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>🎯 全球直连</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 20-1</span>
</span></span><span style=display:flex><span><span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>DOMAIN-SUFFIX,local,🎯 全球直连</span>
</span></span></code></pre></div><p>怎么看呢？当你请求某个网页的时候，就会去匹配 <code>rules</code>，当匹配到某个 rule 后，就看它最后面的 proxy group，proxy group 定义在 <code>proxy-groups</code> 下，其根据不同的类型选择 <code>proxies</code> 中某个 proxy，最后通过该 proxy 打开网页。</p><h5 id=proxies>proxies<a hidden class=anchor aria-hidden=true href=#proxies>#</a></h5><p>proxies 代表节点数据，所有的分流规则都是按照这些节点数据来的，这里可以有很多个节点数据，可以是 trojan, ss, vmess 类型都可以，我们来看个例子：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>{<span style=color:#f92672>name: cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 20-1, server: xxxx, port: 59113, type: vmess, uuid: 1111111, alterId: 0, cipher: auto, tls</span>: <span style=color:#66d9ef>false</span>}
</span></span></code></pre></div><p>clash 用统一的格式来定义不同的节点类型，用 type 来进行区分，特有的属性只需要在这个结构体加上自己属性就可以， clash 客户端会根据 type 不同而来读数据</p><h5 id=proxy-groups>proxy-groups<a hidden class=anchor aria-hidden=true href=#proxy-groups>#</a></h5><p>可以把 <strong>proxy-groups</strong> 理解为一道又道的过滤网，当你发出一个请求时，这个请求将会被在哪一层的过滤网给拦截下来，取决于你的 <strong>rules</strong> 与 请求匹配。我们来解析一下 proxy-groups 里面的参数。</p><p><strong>name</strong></p><p>代表组的名称，组的名称可以随意命名，但建议取有意义的名称，组的名称可以被其它的组引用，也可以放在规则里面</p><p><strong>type</strong></p><p>type 代表这个组的类型，有下面四种情况</p><ul><li><p>select 手动选择，该组在节点列表上，手动选择列表或者 proxy-group</p></li><li><p>url-test 延迟最低节点，测试该组所有节点的延迟</p></li><li><p>fallback 回落，连接该组第一个节点，不可用时切换到下一个节点</p></li><li><p>load-balance 负载均衡，由该组2个以上的节点提供链接</p></li></ul><p><strong>proxies</strong></p><p>这里可以是组名称或者节点名称，依次从上到下进行选择，比如看下面这个</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>🔰 节点选择</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>select</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxies</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>♻️ 自动选择</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>🎯 全球直连</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 20-1</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 26-2</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 28-3</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港-4</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 2-5</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 3-6</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 4-7</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 10-8</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 11-9</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>♻️ 自动选择</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>url-test</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>url</span>: <span style=color:#ae81ff>http://www.gstatic.com/generate_204</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>interval</span>: <span style=color:#ae81ff>300</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxies</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 20-1</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 26-2</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 28-3</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港-4</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 2-5</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 3-6</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 4-7</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 10-8</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 11-9</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 香港 12-10</span>
</span></span><span style=display:flex><span>  - <span style=color:#f92672>name</span>: <span style=color:#ae81ff>🌍 国外媒体</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>type</span>: <span style=color:#ae81ff>select</span>
</span></span><span style=display:flex><span>    <span style=color:#f92672>proxies</span>:
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>🔰 节点选择</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>♻️ 自动选择</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>🎯 全球直连</span>
</span></span><span style=display:flex><span>      - <span style=color:#ae81ff>cfmem.com - 🇭🇰 gq - 香港Amazon数据中心 20-1</span>
</span></span></code></pre></div><p>名称为自动选择的组会每间隔 300 毫秒去 ping 节点数据，测试的地址是：http://www.gstatic.com/generate_204</p><p>而 国外媒体这一项是手动选择默认选择第一个 节点选择，节点选择的第一个是自动选择，所以默认是根据 ping 值来选择节点的</p><h5 id=rules>rules<a hidden class=anchor aria-hidden=true href=#rules>#</a></h5><p>rules 也就是具体的分发规则了，规则一般由 <code>[规则前缀],[域名或地址],[组名]</code> 组成。我们来看下，其中 no-resolve 表示不要解析这条规则，只处理直接 ip 访问请求</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>rules</span>:
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>DOMAIN-SUFFIX,local,🎯 全球直连</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>IP-CIDR,192.168.0.0/16,🎯 全球直连,no-resolve</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>IP-CIDR,10.0.0.0/8,🎯 全球直连,no-resolve</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>IP-CIDR,172.16.0.0/12,🎯 全球直连,no-resolve</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>IP-CIDR,127.0.0.0/8,🎯 全球直连,no-resolve</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>IP-CIDR,100.64.0.0/10,🎯 全球直连,no-resolve</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>IP-CIDR6,::1/128,🎯 全球直连,no-resolve</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>IP-CIDR6,fc00::/7,🎯 全球直连,no-resolve</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>IP-CIDR6,fe80::/10,🎯 全球直连,no-resolve</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>IP-CIDR6,fd00::/8,🎯 全球直连,no-resolve</span>
</span></span><span style=display:flex><span>  - <span style=color:#ae81ff>DOMAIN-KEYWORD,1drv,Ⓜ️ 微软服务</span>
</span></span></code></pre></div><p>规则前缀有这些内容</p><ul><li>DOMAIN-SUFFIX 表示包含什么后缀的域名</li><li>DOMAIN abc.hello.com 表示包含完整的域名</li><li>DOMAIN-KEYWORD,xxx 表示包含 xxx域名关键字的链接</li><li>IP-CIDR IPV4匹配</li><li>SRC-IP-CIDR：源 IP 段匹配</li><li>GEOIP 数据库（国家代码）匹配GeoIP 是 IP 地理位置数据库，可以根据 IP 地址 (支持 IPv4 和 IPv6), 定位该 IP 所在的地理位置和 ASN 等信息。</li><li>DST-PORT：目标端口匹配</li><li>SRC-PORT：源端口匹配</li><li>PROCESS-NAME 表示进程名称</li><li>RULE-SET：Rule Provider 规则匹配</li><li>IP-CIDR6 IPV6匹配</li><li>MATCH 全匹配（一般放在最后）</li></ul><h4 id=dns污染httpsblogrssinsnetarchives1379><a href=https://blog.rssins.net/archives/1379>DNS污染</a><a hidden class=anchor aria-hidden=true href=#dns污染httpsblogrssinsnetarchives1379>#</a></h4><p>DNS服务器即是将用户请求的域名(网站URL)转换为IP地址的服务器。当年中国长城防火墙开始部署时就是通过DNS污染来屏蔽网站的。这项名为DNS污染的技术，就是对用户请求的域名回应一个错误的IP地址，使用户无法访问某个网站。至此，国内几乎所有的公共DNS服务器都被污染，用户无法请求到被屏蔽网站的正确IP地址。但是目前，防火墙的屏蔽功能早已不止DNS污染那么简单了，可以针对IP/域名直接阻断连接，甚至屏蔽了国外未受污染的DNS服务器，因此仅靠国内的DNS是不够翻墙的。</p><h5 id=对抗dns劫持>对抗DNS劫持<a hidden class=anchor aria-hidden=true href=#对抗dns劫持>#</a></h5><p>早期的DNS服务器（我们日常使用的基本也是）都是明文传输数据的，这就意味着防火墙可以探测出你访问的网站，并且直接篡改DNS服务器回应的IP地址。这不仅仅存在于长城防火墙，还存在于某些无良网络运营商，把用户的请求的网站劫持到某个假的网站上。</p><p>于是目前出现了DoH与DoT，可使用https/tls 加密传输DNS请求，这使得DNS不再容易被劫持了。国内的许多公共DNS也都提供了这项服务。以下是我所推荐的国内DNS。</p><ul><li><code>https://223.5.5.5/dns-query</code></li><li><code>https://223.6.6.6/dns-query</code></li><li><code>https://doh.pub/dns-query</code></li></ul><p>或许可以参考 <a href=https://blog.skk.moe/post/which-public-dns-to-use/>如何选择适合的公共 DNS？</a></p><h5 id=何时使用>何时使用<a hidden class=anchor aria-hidden=true href=#何时使用>#</a></h5><p>Clash只会在域名匹配为直连时使用配置文件的DNS，其余时刻均交给节点进行远程解析。当然，节点域名也会使用配置文件的DNS。</p><p>举个例子，访问 <code>google.com</code> 时，匹配到代理规则，那么这个流量将直接被发送至节点服务器，交给节点处理（通常是节点服务器的DNS解析，这个不用管了）。访问 <code>microsoft.com</code> 时，匹配到直连规则，Clash将使用配置文件的DNS设定进行解析。</p><h5 id=dns配置httpswwwxkww3ncyou20220208use-clash-dns-anti-dns-hijacking><a href=https://www.xkww3n.cyou/2022/02/08/use-clash-dns-anti-dns-hijacking/>DNS配置</a><a hidden class=anchor aria-hidden=true href=#dns配置httpswwwxkww3ncyou20220208use-clash-dns-anti-dns-hijacking>#</a></h5><p>首先，打开你的 Clash 配置文件（如果你使用 Clash for Windows 或 Clash for Android, 可以使用软件自带的“覆写/Mixin”功能），添加以下段落：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#f92672>dns</span>:
</span></span><span style=display:flex><span>  <span style=color:#f92672>enable</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>  <span style=color:#f92672>listen</span>: <span style=color:#ae81ff>0.0.0.0</span>:<span style=color:#ae81ff>53Copy</span>
</span></span></code></pre></div><p>这一段的意思是启用 Clash 的 DNS 服务并让其在 53 端口（这是绝大多数操作系统将 DNS 解析报文发送到的端口）监听来自任意网络界面的 DNS 请求。如果你的设备并不需要向其他设备提供解析服务，或你的设备常常需要接入不安全的网络（如手机，笔记本电脑），应当将第三行的 <code>0.0.0.0:53</code> 改为 <code>127.0.0.1:53</code> 让 Clash 仅监听本机的 DNS 解析报文。</p><p>（Clash 默认会同时监听 IPv4 和 IPv6 界面，如果你不需要后者，可以添加一行 <code>ipv6: false</code>）</p><p>由于连接到加密 DNS 服务时，需要解析服务器本身的域名，因此需要指定一些相对干净的国内 <strong>明文</strong> DNS 服务器地址。继续添加以下部分（注意缩进）：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>#--omitted--</span>
</span></span><span style=display:flex><span><span style=color:#f92672>default-nameserver</span>:
</span></span><span style=display:flex><span>   - <span style=color:#ae81ff>119.29.29.29</span>
</span></span><span style=display:flex><span>   - <span style=color:#ae81ff>223.5.5</span><span style=color:#ae81ff>.5Copy</span>
</span></span></code></pre></div><p>当收到 DNS 解析请求时，Clash 会使用以上 DNS 服务器解析加密 DNS 服务器地址并建立连接。</p><p>接下来，指定解析国内域名时使用的加密 DNS 服务器地址：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>#--omitted--</span>
</span></span><span style=display:flex><span><span style=color:#f92672>nameserver</span>:
</span></span><span style=display:flex><span>   - <span style=color:#ae81ff>https://doh.pub/dns-query</span>
</span></span><span style=display:flex><span>   - <span style=color:#ae81ff>https://dns.alidns.com/dns-queryCopy</span>
</span></span></code></pre></div><p>Clash 支持 DoH（<code>https://domain.tld/dns-query</code> 形式） 和 DoT（<code>tls://domain.tld</code> 形式）两种加密 DNS 协议，不支持 DoQ.（当然也支持在此指定备用的明文 DNS）</p><p>然后，指定解析国外域名时使用的加密 DNS 服务器地址，并设置分流规则：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=display:flex><span><span style=color:#75715e>#--omitted--</span>
</span></span><span style=display:flex><span><span style=color:#f92672>fallback</span>:
</span></span><span style=display:flex><span>   - <span style=color:#ae81ff>https://1.1.1.1/dns-query</span>
</span></span><span style=display:flex><span>   - <span style=color:#ae81ff>https://dns.google/dns-query</span>
</span></span><span style=display:flex><span><span style=color:#f92672>fallback-filter</span>:
</span></span><span style=display:flex><span>   <span style=color:#f92672>geoip</span>: <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>geoip-code</span>: <span style=color:#ae81ff>CN</span>
</span></span><span style=display:flex><span>   <span style=color:#f92672>ipcidr</span>:
</span></span><span style=display:flex><span>     - <span style=color:#ae81ff>240.0.0.0</span><span style=color:#ae81ff>/4Copy</span>
</span></span></code></pre></div><p>“fallback” 字段指定的 DNS 服务器将被用于解析非国外域名，而 “fallback-filter” 字段则实现我们想要的分流规则——当请求解析的域名在 GeoIP 数据库内的国家代码不是 <code>CN</code> 时，或是域名在前文设置的 DNS 服务器内的解析结果位于 <code>240.0.0.0/4</code> 这一 IP 段内时（被屏蔽的域名解析常常会被污染到这一段），使用 “fallback” 字段指定的 DNS 服务器解析域名。</p><p>最后，修改系统 DNS 服务器为 <code>127.0.0.1</code> 即可。</p><h4 id=代理环境中的-dns-解析行为httpsblogskkmoepostwhat-happend-to-dns-in-proxy><a href=https://blog.skk.moe/post/what-happend-to-dns-in-proxy>代理环境中的 DNS 解析行为</a><a hidden class=anchor aria-hidden=true href=#代理环境中的-dns-解析行为httpsblogskkmoepostwhat-happend-to-dns-in-proxy>#</a></h4><p>虽然 Fake IP 这个概念早在 2001 年就被提出来了，但是到 Clash 提供 fake-ip 增强模式以后，依然有很多人对 Fake IP 这个概念以及其作用知之甚少。本文就简单谈谈在代理环境中，TCP 连接建立之前发生的事。由于移动设备操作系统中网络栈相对复杂，本文的例子也并不一定适用于移动端环境。文章中也许会存在很多错误，也希望各路大佬的勘误和斧正。</p><h5 id=不使用代理>不使用代理<a hidden class=anchor aria-hidden=true href=#不使用代理>#</a></h5><p>如果在不使用任何代理的情况下，打开一个没有命中 DNS 缓存的网站（比如 <code>blog.skk.moe</code>）的时候，浏览器和操作系统大概会执行这么一些操作：</p><ol><li>浏览器自己都有 DNS 缓存机制，因此浏览器会先开始寻找自己的缓存，不过没有找到 <code>blog.skk.moe</code> 的解析结果</li><li>浏览器通过调用操作系统的 <code>getaddrinfo</code> 方法，向操作系统寻求解析结果</li><li>操作系统自己也有一层 DNS 缓存，但是现在操作系统从自己的缓存中依然找不到这一结果</li><li>在系统的网络设置之中有设置上游 DNS 地址，假设操作系统中设置的是 <code>119.29.29.29</code>，那么操作系统会向 <code>119.29.29.29</code> 发起解析请求（UDP 流量）拿到 <code>blog.skk.moe</code> 的 IP</li><li>当然如果 <code>119.29.29.29</code> 自己没有 <code>blog.skk.moe</code> 的解析结果会找它的上游去要。不过我们不关心这一点，反正最后 <code>119.29.29.29</code> 会把 <code>blog.skk.moe</code> 的解析结果返回给设备的操作系统</li><li>现在，浏览器已经可以开始向 <code>blog.skk.moe</code> 的 IP 发起 HTTPS 连接了</li></ol><p>以上是打开一个网页常见的 DNS 解析流程，对于其它非 HTTP 的 TCP 连接（比如 SMTP）也都差不多是这个流程——由于 TCP/IP 的协议特性，在应用发起 TCP 连接时，会先发出一个 DNS question（发一个 IP Packet），获取要连接的服务器的 IP 地址，然后直接向这个 IP 地址发起连接。</p><h5 id=设置代理并使用直连>设置代理并使用直连<a hidden class=anchor aria-hidden=true href=#设置代理并使用直连>#</a></h5><p>现在，我们在应用程序（比如我们的浏览器、或者其它应用）中设置了代理，但是这个代理不涉及到任何远端服务器（直连模式）。接下来以设置了 SOCKS5 代理的浏览器为例。</p><ol><li>浏览器不再需要从自己的 DNS 缓存中寻找 <code>blog.skk.moe</code>，因为已经有了 SOCKS5 代理，浏览器可以直接将域名封装在 SOCKS5 流量之中发往代理客户端</li><li>代理客户端从 SOCKS5 流量中抽出 <code>blog.skk.moe</code> 这个域名并设法获得解析结果</li><li>代理客户端将你的 SOCKS5 流量还原成标准的 TCP 请求</li><li>代理客户端将这个 TCP 连接建立起来，在这个例子之中 TCP 连接承载的是 HTTPS</li></ol><p>之前由于获取解析结果是浏览器在操作，而大部分浏览器都会选择调用系统的 <code>getaddrinfo</code> 方法，因此如果你想要在 DNS 上做一些黑魔法就只能在操作系统层面实现，比如在本机或者别处架设一个带黑魔法的 DNS 服务器，然后你系统中设置使用这个 DNS 服务器。现在 DNS 解析是由代理客户端执行，因此在代理客户端上就可以实现一些黑魔法。比如 Surge 自己实现了一个 DNS Server 可以并发向多个上游同时发起查询、比如 V2Ray 可以实现不同域名的查询分流，等等。当然代理客户端也可以使用操作系统的 <code>getaddrinfo</code> 方法。</p><h5 id=设置代理并将流量转发到远端服务器>设置代理并将流量转发到远端服务器<a hidden class=anchor aria-hidden=true href=#设置代理并将流量转发到远端服务器>#</a></h5><p>现在在上一步的基础之上，我们为代理服务器设置了一个远端服务器，这个代理会使用 某种协议 和远端服务器通信，并且这种协议和 SOCKS5 一样支持将域名封装在传输中。浏览器和代理客户端之间依然使用 SOCKS5 通信。</p><ol><li>因为已经有了 SOCKS5 代理，浏览器可以直接将域名 <code>blog.skk.moe</code> 和整个请求封装在 SOCKS5 流量之中发往代理客户端</li><li>代理客户端从 SOCKS5 流量中抽出 <code>blog.skk.moe</code> 这个域名以及其它数据</li><li>代理客户端使用 某种协议 将浏览器发出的 SOCKS5 的流量重组并发给远端服务器</li><li>远端服务器使用相同的 某种协议 从流量中获得其中的域名 <code>blog.skk.moe</code></li><li>远端服务器的代理服务端发起了一次 DNS 解析请求试图解析 <code>blog.skk.moe</code>。绝大部分情况下，代理的服务端都会直接使用操作系统的 <code>getaddrinfo</code> 方法、也就是由远端服务器的操作系统负责 DNS</li></ol><p>这一次，不论是代理客户端还是你的浏览器都没有进行 DNS 解析，DNS 解析是在远端服务器上进行的。因为 某种协议 支持封装域名，然后这一次和 <code>blog.skk.moe</code> 连接的是远端服务器，考虑到针对 CDN 优化，DNS 解析自然需要在远端服务器上执行。</p><p>现在我已经介绍了通过代理直连和通过代理发送给远端服务器了。但是毫无疑问，我相信本文所有的读者自己使用的上网方式都不会是全面直连或者全面代理。这就是接下来要讲的：</p><h5 id=设置代理并使用-ip-规则和域名规则进行分流>设置代理并使用 IP 规则和域名规则进行分流<a hidden class=anchor aria-hidden=true href=#设置代理并使用-ip-规则和域名规则进行分流>#</a></h5><p>分流是一个麻烦事。一般情况下，你可能会需要使用域名进行分流（不论是白名单还是黑名单）。不过更多情况下你会使用到基于 IP 的规则来进行分流。</p><p>先来看第一个例子：使用域名规则进行分流。</p><ol><li>浏览器将带有域名 <code>blog.skk.moe</code> 的 HTTPS 请求封装在 SOCKS5 流量之中发往代理客户端</li><li>代理客户端从 SOCKS5 流量中抽取出域名 <code>blog.skk.moe</code></li><li>代理客户端开始将<code>blog.skk.moe</code> 和域名规则列表开始比较。这个列表可以是白名单或黑名单，域名可能也没有匹配上。反正最终比较得出的结果就是 <code>blog.skk.moe</code> 是否需要走代理。</li><li>如果不需要走代理，代理客户端剩下会做的事情和本文第二部分「设置代理并使用直连」就完全一样了；同理，需要走代理的话就需要进行本文第三部分的那个流程</li></ol><p>使用域名规则分流很简单，除非 <code>blog.skk.moe</code> 最终是直连，否则代理客户端不需要进行 DNS 解析。</p><p>现在来看第二个例子：使用 IP 规则分流。</p><ol><li>浏览器将带有域名 <code>blog.skk.moe</code> 的 HTTPS 请求封装在 SOCKS5 流量之中发往代理客户端</li><li>代理客户端从 SOCKS5 流量中抽取出域名 <code>blog.skk.moe</code></li><li>代理客户端得到 <code>blog.skk.moe</code> 的解析结果</li><li>代理客户端开始将<code>blog.skk.moe</code> 的解析结果和 IP 规则列表开始比较。这个列表可以是 cnlist 或者 MaxMind IP 数据库。反正最终得出的结果就是 <code>blog.skk.moe</code> 解析结果的 IP 是否需要走代理。</li><li>如果不需要走代理，代理客户端剩下会做的事情和本文第二部分「设置代理并使用直连」就完全一样了；同理，需要走代理的话就需要进行本文第三部分的那个流程。</li></ol><p>使用 IP 规则分流，前提首先你得有一个 IP 拿来比较。所以代理客户端必须先进行一次 DNS 解析。使用什么方法进行 DNS 解析并不重要，之前已经说过代理客户端甚至可以使用自己的黑魔法，而我们只需要关心最终代理客户端拿到了一个 IP 并且可以用于规则判定。</p><p>此时需要注意的是，虽然代理客户端获得了一个 IP，但是你只有在直连的时候，代理客户端可能（并且基本上都会）复用这个 IP；如果是将流量交给远程服务器，由于 某种协议 支持封装域名，因此远程服务器拿到的还是域名不是 IP、还需要进行一次解析。也就是说，远端服务器连接的 IP 与 代理客户端解析得到的 IP 毫无关系。</p><h5 id=使用-redir--tun2socks-实现全局流量经过代理>使用 redir / tun2socks 实现全局流量经过代理<a hidden class=anchor aria-hidden=true href=#使用-redir--tun2socks-实现全局流量经过代理>#</a></h5><p>在开始之前，我们先复习一下 TCP/IP 协议怎么说的——「在应用发起 TCP 连接时，会先发出一个 DNS question（发一个 IP Packet），获取要连接的服务器的 IP 地址，然后直接向这个 IP 地址发起连接」</p><p>全局流量代理可能会出现在路由器上或者 TUN/TAP 型的支持全局代理客户端上。用户不再主动为每个应用程序设置代理。此时应用程序是不会感知到代理客户端的存在，它们会正常的发起 TCP 连接，并且由于 TCP/IP 协议，在拿到 DNS 解析结果之前，连接是不能建立的。</p><ol><li>浏览器自己都有 DNS 缓存机制，因此浏览器会先开始寻找自己的缓存，不过没有找到 <code>blog.skk.moe</code> 的解析结果</li><li>浏览器通过调用操作系统的 <code>getaddrinfo</code> 方法，向操作系统寻求解析结果</li><li>操作系统自己也有一层 DNS 缓存，但是现在操作系统从自己的缓存中依然找不到这一结果</li><li>在系统的网络设置之中有设置上游 DNS 地址。代理客户端可能会修改系统设置中的 DNS 到 127.0.0.1 或者别的 IP、也可能保留用户之前的设置，这无所谓，因为&mldr;</li><li>操作系统发出的 DNS 解析请求会经过代理客户端并最终被截获</li><li>代理客户端可以将这个解析请求原样发出去、或者用自己的黑魔法，总之代理客户端都会拿到一个解析结果</li><li>代理客户端将这个解析结果返回回去，操作系统拿到了这个解析结果并返回给浏览器</li><li>浏览器对这个解析结果的 IP 建立一个 TCP 连接并发送出去</li><li>这个 TCP 连接被代理客户端截获。由于之前代理客户端进行的 DNS 解析请求这一动作，代理客户端可以找到这个只包含目标 IP 的 TCP 连接原来的目标域名</li><li>如果是支持 redir 的代理客户端，那么代理客户端就会直接将域名和 TCP 连接中的其它数据封装成 某种协议 发给远端服务器；或者封装成 SOCKS5 后交给支持 SOCKS5 的代理客户端</li></ol><p>如果代理客户端需要按照域名进行分流，一般会在第 6 步代理客户端解析出一个 IP 或者第 9 步代理客户端拿到域名以后。FancySS、KoolSS、SSTap 的流程大抵都是如此。</p><p>和应用程序直接将流量封装成 SOCKS5 大有不同，在类似于透明代理的环境下浏览器和其它应用程序是正常地发起 TCP 连接。因此除非得到一个 DNS 解析结果，否则 TCP 连接不会建立；代理客户端也会需要通过这个 DNS 查询动作，才能找到之后的 TCP 连接的域名。
你大概能够发现，浏览器、应用程序直接设置 SOCKS5 代理的话，可以不在代理客户端发起 DNS 解析请求就能将流量发送给远端服务器；而在透明代理模式下，不论是否需要 IP 规则分流都需要先进行一次 DNS 解析才能建立连接。</p><p>有没有办法能像直接设置 SOCKS5 代理一样省掉一次 DNS 解析呢？有，就是代理客户端自己不先执行查询动作，丢一个 Fake IP 回去让浏览器、应用程序立刻建立 TCP 连接：</p><h5 id=在-redir--tun2socks-中使用-fake-ip>在 redir / tun2socks 中使用 Fake IP<a hidden class=anchor aria-hidden=true href=#在-redir--tun2socks-中使用-fake-ip>#</a></h5><p>Fake IP 的定义出自 <a href=https://tools.ietf.org/rfc/rfc3089>RFC3089</a>。这个 RFC 定义了一种新的将 TCP 连接封装成 SOCKS 协议的方法。</p><ol><li>浏览器自己都有 DNS 缓存机制，因此浏览器会先开始寻找自己的缓存，不过并没有找到 <code>blog.skk.moe</code> 的解析结果</li><li>浏览器通过调用操作系统的 <code>getaddrinfo</code> 方法，向操作系统寻求解析结果</li><li>操作系统自己也有一层 DNS 缓存，但是现在操作系统从自己的缓存中依然找不到这一结果</li><li>在系统的网络设置之中设置了一个专门的上游 DNS 地址，可能是用户手动设置的也可能是代理客户端设置的。不论如何，这个设置最终会使操作系统向代理客户端发起 DNS 请求</li><li>操作系统发出的 DNS 解析请求会经过代理客户端并最终被截获</li><li>代理客户端从解析请求中获得域名，从 Fake IP 池中选取一个 IP 建立映射</li><li>代理客户端将这个 Fake IP 返回回去，操作系统拿到了这个 Fake IP 并返回给浏览器</li><li>浏览器对 Fake IP 建立一个 TCP 连接并发送出去</li><li>这个 TCP 连接被代理客户端截获。代理客户端抽取出 Fake IP 并反查出这个 TCP 连接中对应的域名</li><li>有了 TCP 连接和域名，代理客户端可以轻易地将其使用 SOSCKS5 或者 某种协议 进行封装</li></ol><p>有了 Fake IP，代理客户端无需进行 DNS 解析。最后不论是浏览器、代理客户端还是远端服务器都不会去和 Fake IP 进行连接，因为在代理客户端这里就已经完成了截获、重新封装。</p><p>即使按照域名规则分流，代理客户端都没有进行 DNS 解析的需要。只有在遇到了按照 IP 进行分流的规则时，代理客户端才需要进行一次解析拿到一个 IP 用于判断。即便如此，这个 IP 只用于分流规则的匹配，不会被用于实际的连接。</p><h5 id=fancyss-和-surge--clash-的区别>FancySS 和 Surge / Clash 的区别<a hidden class=anchor aria-hidden=true href=#fancyss-和-surge--clash-的区别>#</a></h5><p>FancySS 是使用的 redir，Surge 的增强模式使用的是 Fake IP，Clash 的增强模式既有 redir-host 也有 Fake IP。首先把 FancySS 等路由器上常见的代理客户端和 Clash 的 redir-host 分为一类，Surge 的增强模式和 Clash 的 fake-ip 模式分为另一类。</p><p>路由器上常见的代理客户端一般内置了 dns2socks、dnscryp-proxy、PCap_DNSProxy 等等 DNS 方案、也支持按照一定的规则进行分流，但是都是用于答复应用程序的 DNS question 使其建立 TCP 连接的，除非直连，否则通过这些 DNS 方案拿到的解析结果的 IP 并不会被用上。
大部分路由器上的代理客户端，DNS 解析请求都是通过路由器本机发出（或转发到单一远端服务器进行解析），因此解析结果只能说「至少能用」（不一定是有 CDN 优化的，甚至有可能会有 DNS 污染），如果流量不经过代理客户端直接发往这些 IP 地址，一般也不会影响浏览器、应用程序的正常使用。因此路由器上的代理客户端可以实现通过 iptables 控制让某些端口、某些设备的流量不经过代理客户端。
而在 Fake IP 模式下，浏览器、应用程序都是对 Fake IP 发起连接，如果没有代理客户端对连接进行重新封转，那么这部分流量就不能被发往真实的目的 IP，因此所有流量都必须经过代理客户端，而根据端口、设备的分流就需要由代理客户端自己实现。</p><h5 id=如果操作系统或者浏览器缓存了-dns-解析结果>如果操作系统或者浏览器缓存了 DNS 解析结果<a hidden class=anchor aria-hidden=true href=#如果操作系统或者浏览器缓存了-dns-解析结果>#</a></h5><p>之前的透明代理的两个例子中，我们都假定浏览器和操作系统都没有缓存 DNS 解析结果。但是，如果操作系统或者应用程序缓存了 DNS 解析结果会发生什么？</p><p>如果是不使用 Fake IP 的 redir / tun2socks 情况下，由于操作系统、浏览器或者应用程序中的任何一个缓存了 DNS 解析结果，因此 TCP 连接可以直接根据缓存的解析结果的 IP 建立，代理客户端并没有预先收到对应的 DNS question。在这种情况下，代理客户端有可能直接将这个连接视为和 IP 连接而不是和域名连接，根据域名规则的分流可能就会因此失效，不过根据 IP 分流的规则没有失效。
如果为了避免域名分流规则失效，你可以设法阻止操作系统或者浏览器缓存 DNS 解析结果，这样每次建立 TCP 连接之前都会发送 DNS question 使代理客户端探测到域名。但是这意味着每次 TCP 连接建立都需要代理客户端进行一次 DNS 解析请求（当然代理客户端可以对 DNS 解析进行缓存避免出现延时激增）。</p><p>而对于 Fake IP 模式来说，由于代理客户端内存储有 Fake IP 和真实域名之间的映射表，因此即使操作系统或应用程序缓存了 Fake IP，在之后的 TCP 连接中，代理客户端收到流量后依然可以抽取出 Fake IP 反查出域名，因此不受 DNS 缓存的影响。</p><p>我在这里留几个问题给大家思考一下：</p><ul><li>如果使用了 Fake IP，代理客户端不论域名是否真实存在都会返回一个 Fake IP 给浏览器，那么浏览器在试图访问一个不存在的域名时，错误信息应该是什么样的？会不会出现 DNS 解析失败的错误信息？</li><li>如果操作系统或者浏览器缓存了 Fake IP，但是代理客户端中 Fake IP 和域名的映射表丢失以后，会出现什么状况？可能会出现什么错误信息？</li></ul><p>第二个问题很有趣。因为如果你找到了第二个问题的答案，你就会意识到 Clash 在 Fake IP 模式下偶发的无法上网的原因了。</p><h5 id=参考资料>参考资料<a hidden class=anchor aria-hidden=true href=#参考资料>#</a></h5><ul><li><a href=https://imququ.com/post/web-proxy.html>HTTP 代理原理及实现（一）</a> - 我的文章中举得都是 SOCKS5 的例子，如果想了解一下在 HTTP 代理中流量是如何被封装的，可以看看屈屈的这篇博客</li><li><a href=https://medium.com/@Blankwonder/surge-%E5%8E%9F%E7%90%86%E4%B8%8E%E5%AE%9E%E7%8E%B0-8aa3304fb3bb>Surge 原理与实现</a> - Surge 开发者写的 Surge 早期版本的工作原理，可以了解一下 Surge 是怎么处理各种协议的流量的</li><li><a href=https://medium.com/@TachyonDevel/%E6%BC%AB%E8%B0%88%E5%90%84%E7%A7%8D%E9%BB%91%E7%A7%91%E6%8A%80%E5%BC%8F-dns-%E6%8A%80%E6%9C%AF%E5%9C%A8%E4%BB%A3%E7%90%86%E7%8E%AF%E5%A2%83%E4%B8%AD%E7%9A%84%E5%BA%94%E7%94%A8-62c50e58cbd0>漫谈各种黑科技式 DNS 技术在代理环境中的应用</a> - Kitsunebi 开发者写的文章，详细地介绍了在不同的 V2Ray 配置下的 DNS 行为，同时还有对移动端网络栈的一些介绍</li></ul><h4 id=cfw-tun-模式httpsdocscfwlbyczfcomcontentstunhtmllinux><a href=https://docs.cfw.lbyczf.com/contents/tun.html#linux>CFW TUN 模式</a><a hidden class=anchor aria-hidden=true href=#cfw-tun-模式httpsdocscfwlbyczfcomcontentstunhtmllinux>#</a></h4><p>“系统代理”一般只是桌面环境下的约定，需要 app 遵循约定才行。也就是说 HTTP_PROXY 这种环境变量只是约定俗成的，大家都从这里面读取代理地址，但是程序里必须要有读取这个变量的相关代码才行。</p><p>因此某些软件&命令行软件不支持系统代理。</p><p>tun 模式对全部 app 生效——对于不遵循系统代理的软件，TUN 模式可以接管其流量并交由 CFW 处理。启动 TUN 模式需要进行如下操作：</p><ol><li><p>安装 nftables 和 iproute2 并重启</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install nftables iproute2
</span></span><span style=display:flex><span>$ sudo reboot
</span></span></code></pre></div></li><li><p>点击<code>General</code>中<code>Service Mode</code>右边<code>Manage</code>，在打开窗口中安装服务模式，安装完成应用会自动重启（某些系统需要手动重启 APP），Service Mode 右边地球图标变为<code>绿色</code>即安装成功</p></li><li><p>点击<code>General</code>中<code>TUN Mode</code>右边开关启动 TUN 模式</p></li><li><p>无法安装<a href=https://docs.cfw.lbyczf.com/contents/questions.html#linux>参考</a>：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ curl https://gist.githubusercontent.com/Fndroid/2119fcb5ccb5a543a8f6a609418ae43f/raw/592eba4f480c7ccb4f29c9b8e80d24bfd5dda8cf/linux.sh &gt; cfw-tun.sh <span style=color:#f92672>&amp;&amp;</span> chmod +x cfw-tun.sh <span style=color:#f92672>&amp;&amp;</span> sudo ./cfw-tun.sh install &lt;cfw安装目录&gt;
</span></span></code></pre></div><p>如要卸载则将 install 改为 uninstall，最后一部分位 CFW 安装目录</p></li></ol><h3 id=tproxyhttpsblogindigocodes20211120iptables-tproxy-and-home><a href=https://blog.indigo.codes/2021/11/20/iptables-tproxy-and-home/>TProxy</a><a hidden class=anchor aria-hidden=true href=#tproxyhttpsblogindigocodes20211120iptables-tproxy-and-home>#</a></h3><p>TProxy 含义：</p><ul><li><a href=https://github.com/zfl9/ss-tproxy/blob/master/README.md>透明代理</a>：在正向代理中，一个软件如果想走 client 的代理服务，我们必须显式配置该软件，对该软件来说，有没有走代理是很明确的，大家都“心知肚明”。而透明代理则与正向代理相反，当我们设置好合适的防火墙规则（仅以 Linux 的 iptables 为例），我们将不再需要显式配置这些软件来让其经过代理或者不经过代理（直连），因为这些软件发出的流量会自动被 iptables 规则所处理，那些我们认为需要代理的流量，会被通过合适的方法发送到 client 进程，而那些我们不需要代理的流量，则直接放行（直连）。这个过程对于我们使用的软件来说是完全透明的，软件自身对其一无所知。这就叫做 <strong>透明代理</strong>。注意，所谓透明是对我们使用的软件透明，而非对 client、server 或目标网站透明，理解这一点非常重要。</li><li><a href=https://blog.mmf.moe/post/tproxy-investigation/>内核模块</a>：内核里支持上面描述的透明代理的模块，<code>TProxy</code> 模块工作在 <code>mangle</code> 表上。</li></ul><h4 id=summaryhttpsguidev2flyorgapptproxyhtmle9858de7bdaee9808fe6988ee4bba3e79086e8a784e58899><a href=https://guide.v2fly.org/app/tproxy.html#%E9%85%8D%E7%BD%AE%E9%80%8F%E6%98%8E%E4%BB%A3%E7%90%86%E8%A7%84%E5%88%99>Summary</a><a hidden class=anchor aria-hidden=true href=#summaryhttpsguidev2flyorgapptproxyhtmle9858de7bdaee9808fe6988ee4bba3e79086e8a784e58899>#</a></h4><p>执行下面的命令开启透明代理。由于使用了 TPROXY 方式的透明代理，所以 TCP 流量也是使用 mangle 表。以下命令中，以 <code>#</code> 开头的为注释。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 设置策略路由</span>
</span></span><span style=display:flex><span>ip rule add fwmark <span style=color:#ae81ff>1</span> table <span style=color:#ae81ff>100</span> 
</span></span><span style=display:flex><span>ip route add local 0.0.0.0/0 dev lo table <span style=color:#ae81ff>100</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 代理局域网设备</span>
</span></span><span style=display:flex><span>iptables -t mangle -N V2RAY
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -d 127.0.0.1/32 -j RETURN
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -d 224.0.0.0/4 -j RETURN 
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -d 255.255.255.255/32 -j RETURN 
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -d 192.168.0.0/16 -p tcp -j RETURN <span style=color:#75715e># 直连局域网，避免 V2Ray 无法启动时无法连网关的 SSH，如果你配置的是其他网段（如 10.x.x.x 等），则修改成自己的</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -d 192.168.0.0/16 -p udp ! --dport <span style=color:#ae81ff>53</span> -j RETURN <span style=color:#75715e># 直连局域网，53 端口除外（因为要使用 V2Ray 的 DNS)</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -m mark --mark 0xff -j RETURN    <span style=color:#75715e># 直连 SO_MARK 为 0xff 的流量(0xff 是 16 进制数，数值上等同与上面V2Ray 配置的 255)，此规则目的是解决v2ray占用大量CPU（https://github.com/v2ray/v2ray-core/issues/2621）</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -p udp -j TPROXY --on-ip 127.0.0.1 --on-port <span style=color:#ae81ff>12345</span> --tproxy-mark <span style=color:#ae81ff>1</span> <span style=color:#75715e># 给 UDP 打标记 1，转发至 12345 端口</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -p tcp -j TPROXY --on-ip 127.0.0.1 --on-port <span style=color:#ae81ff>12345</span> --tproxy-mark <span style=color:#ae81ff>1</span> <span style=color:#75715e># 给 TCP 打标记 1，转发至 12345 端口</span>
</span></span><span style=display:flex><span>iptables -t mangle -A PREROUTING -j V2RAY <span style=color:#75715e># 应用规则</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 代理网关本机</span>
</span></span><span style=display:flex><span>iptables -t mangle -N V2RAY_MASK 
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -d 224.0.0.0/4 -j RETURN 
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -d 255.255.255.255/32 -j RETURN 
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -d 192.168.0.0/16 -p tcp -j RETURN <span style=color:#75715e># 直连局域网</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -d 192.168.0.0/16 -p udp ! --dport <span style=color:#ae81ff>53</span> -j RETURN <span style=color:#75715e># 直连局域网，53 端口除外（因为要使用 V2Ray 的 DNS）</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -m mark --mark 0xff -j RETURN    <span style=color:#75715e># 直连 SO_MARK 为 0xff 的流量(0xff 是 16 进制数，数值上等同与上面V2Ray 配置的 255)，此规则目的是避免代理本机(网关)流量出现回环问题</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -p udp -j MARK --set-mark <span style=color:#ae81ff>1</span>   <span style=color:#75715e># 给 UDP 打标记，重路由</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -p tcp -j MARK --set-mark <span style=color:#ae81ff>1</span>   <span style=color:#75715e># 给 TCP 打标记，重路由</span>
</span></span><span style=display:flex><span>iptables -t mangle -A OUTPUT -j V2RAY_MASK <span style=color:#75715e># 应用规则</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 新建 DIVERT 规则，避免已有连接的包二次通过 TPROXY，理论上有一定的性能提升</span>
</span></span><span style=display:flex><span>iptables -t mangle -N DIVERT
</span></span><span style=display:flex><span>iptables -t mangle -A DIVERT -j MARK --set-mark <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>iptables -t mangle -A DIVERT -j ACCEPT
</span></span><span style=display:flex><span>iptables -t mangle -I PREROUTING -p tcp -m socket -j DIVERT
</span></span></code></pre></div><p>执行了以上 ip 和 iptables 命令后，局域网同网段的设备以及网关本身就可以直接翻墙了。</p><h4 id=outputprerouting>OUTPUT&amp;PREROUTING<a hidden class=anchor aria-hidden=true href=#outputprerouting>#</a></h4><p>从本机出去的数据包会经过 OUTPUT 链，而从外部发往本机的数据包会经过 PREROUTING 链（当然也会经过 INPUT 链，但因为 tproxy 只能工作在 PREROUTING 链，所以我们只关心 PREOUTING 链）。</p><p>由于 tproxy 只能工作在 PREROUTING 链，从本机发出去的数据包会直接通过 OUTPUT 链出去了，本机数据包没有机会走一下 PREROUTING 链。为了让本机数据经过 PREROUTING，我们可以用的路由表解决。执行如下命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 设置策略路由</span>
</span></span><span style=display:flex><span>ip rule add fwmark <span style=color:#ae81ff>1</span> table <span style=color:#ae81ff>100</span> 
</span></span><span style=display:flex><span>ip route add local 0.0.0.0/0 dev lo table <span style=color:#ae81ff>100</span>
</span></span></code></pre></div><p>第一行添加一条 ip 规则，表示被标记为 1 的的数据包的走向要查表 100 。 第二行声明所有的 <code>IPv4</code> 地址在表 100 中均为 <code>local</code>（IP 数据包的目标IP与来源IP都为本机IP），大致是说对于表 100 的流量，都要发到本机（也就是说从 OUTPUT 链出去的包要回到 PREROUTING 链，原本 PREROUTING => FORWARD 的包改为 PREROUTING => INPUT => <code>Local Process</code>）。</p><p><img loading=lazy src=/Distributions/Iptables.gif alt></p><p>我们来观察这张图。只要 <code>OUTPUT</code> 的最后我们的<strong>目标恰好是本机</strong>的话，那么这份数据报就会重新回到 <code>iptables</code> 的手中，也就和局域网的其他机器所发送的报文一样了。（clash/v2ray 都是通过域名而非 ip 进行代理的，所以IP 数据包的目标IP与来源IP随便改）</p><p>在 OUTPUT 链上打标记命令如下：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>iptables -t mangle -A OUTPUT -p tcp -j MARK --set-mark <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>iptables -t mangle -A OUTPUT -p udp -j MARK --set-mark <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><h4 id=使用-chain>使用 Chain<a hidden class=anchor aria-hidden=true href=#使用-chain>#</a></h4><p>上面的规则虽然完成了重回 PREROUTING 的能力，但有些数据包应当直接从 OUTPUT 链出去，比如访问网关管理页面（192.168.22.1），或者是 NAS 的 192.168.22.2。所以我们需要跳过一部分的数据包避免标记上 1。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>iptables -t mangle -A OUTPUT -d 192.168.0.0/16 -j RETURN
</span></span></code></pre></div><p>这一条命令要在前面的 <code>-j MARK</code> 命令之前执行，匹配规则会根据创建的规则顺序按顺序执行。</p><p>此时我们将编写 iptables 规则类比一下： 写 iptables 规则，就像写代码，OUTPUT 等链是程序内置的函数，它会在对应时机调用，我们需要做是填充这个函数的逻辑。所以，链 = 函数。这就清晰很多了。 iptables 还给我们提供了创建自定义链（函数）的能力，有了自定义链（函数）我们可以更好地管理规则。</p><p>对于上面的 OUTPUT 管理，我们可以改写成：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>iptables -t mangle -N V2RAY_MASK 
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -d 192.168.0.0/16 -p tcp -j RETURN
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -d 192.168.0.0/16 -p udp -j RETURN
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -p udp -j MARK --set-mark <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -p tcp -j MARK --set-mark <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>iptables -t mangle -A OUTPUT -j V2RAY_MASK
</span></span></code></pre></div><h4 id=应用-tproxy>应用 tproxy<a hidden class=anchor aria-hidden=true href=#应用-tproxy>#</a></h4><p>有了以上的内容，我们可以开始把数据发的 tproxy，tproxy 翻译过来就是内核提供的透明代理能力。假定我们设置的 tproxy 端口为 12345，如下命令可以将数据包通过 tproxy 发给代理client：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>iptables -t mangle -A PREROUTING -p tcp -j TPROXY --on-port --tproxy-mark <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>iptables -t mangle -A PREROUTING -p udp -j TPROXY --on-port --tproxy-mark <span style=color:#ae81ff>1</span>
</span></span></code></pre></div><p>因为这里<code>TProxy</code> 的目标地址不是本机。也就是说，如果不设置 <code>mark</code>，那么这份报文就会<strong>被转发</strong>（被 <code>FORWARD</code> 链处理）而不是被 <code>INPUT</code> 链处理。为了实现透明代理，这份报文必须被本机处理，因此 <code>TProxy</code> 就必须设置 <code>--tproxy-mask</code>，结合上文理解。</p><p>然后创建自定义的链，上面的两行命令 PREROUTING 在增加更多的规则后会很难管理：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>iptables -t mangle -N V2RAY
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -d 192.168.0.0/16 -p tcp -j RETURN
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -p udp -j TPROXY --on-port <span style=color:#ae81ff>12345</span> --tproxy-mark <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -p tcp -j TPROXY --on-port <span style=color:#ae81ff>12345</span> --tproxy-mark <span style=color:#ae81ff>1</span>
</span></span><span style=display:flex><span>iptables -t mangle -A PREROUTING -j V2RAY
</span></span></code></pre></div><h4 id=解决回环问题>解决回环问题<a hidden class=anchor aria-hidden=true href=#解决回环问题>#</a></h4><p>这里产生了一个回环：</p><ul><li>本机发出来去往外网的数据包通过 mark 回到 PREROUTING</li><li>通过 tproxy 进入代理client</li><li>本机代理client发出来去往外网的数据包通过 mark 回到 PREROUTING</li><li>通过 tproxy 进入代理client</li><li>本机代理client发出来去往外网的数据包通过 mark 回到 PREROUTING</li><li>&mldr;..</li></ul><p>我们需要解决掉，即让本机代理client发出来的数据包直接从 OUTPUT 链出去。</p><p><strong>mark 规避</strong></p><p>一种方式是对出站流量再打一个 mark，通过设置 iptables 规则对对应 mark 的流量直连，来规避代理client流量，防止回环。</p><p>首先要在代理client的配置中给其包加一个 255 的 mark，这个 mark 与下文 iptables 命令配合，以直连代理client发出的 SO_MARK 为 0xff 的流量 (0xff 是 16 进制数，数值上等同与配置的 255)</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># OUTPUT</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 此规则目的是避免代理本机(网关)流量出现回环问题</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -m mark --mark 0xff -j RETURN
</span></span></code></pre></div><p>这么做有以下几个问题：</p><ol><li><p><strong><a href=https://github.com/v2ray/v2ray-core/issues/2621>莫名流量进入 PREROUTING 链</a></strong>，解决如下</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># PREROUTING</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 此规则目的是解决v2ray占用大量CPU</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -m mark --mark 0xff -j RETURN
</span></span></code></pre></div></li><li><p>安卓系统有自己的 mark 机制，该方案在安卓上不可用</p></li></ol><p><a href=https://xtls.github.io/document/level-2/iptables_gid.html#%E6%80%9D%E8%B7%AF><strong>gid/uid 规避</strong></a></p><p>思路：</p><ul><li>tproxy 流量只能被 root 权限用户(uid==0)或其他有 CAP_NET_ADMIN 权限的用户接收。</li><li>iptables 规则可以通过 uid(用户 id)和 gid(用户组 id)分流。</li><li>让代理client运行在一个 uid==0 但 gid!=0 的用户上，设置 iptables 规则不代理该 gid 的流量来规避 代理client流量。</li></ul><p>使用以下命令可以创建一个名为 clash，uid 为 0，gid 为 23333 的用户，用户名和 gid 可以自己定，uid 必须为 0。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># grep -qw clash /etc/passwd || echo &#34;clash❌0:23333:::&#34; &gt;&gt; /etc/passwd</span>
</span></span></code></pre></div><p>使用如下命令可以验证创建的用户是否正常：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo -u clash id
</span></span></code></pre></div><p>接下来我们使用这个用户启动 clash：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo -u clash /usr/local/bin/clash -d /etc/clash
</span></span></code></pre></div><p>iptables 执行在 OUTPUT 链改为如下命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># OUTPUT</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -m owner --gid-owner <span style=color:#ae81ff>23333</span> -j RETURN
</span></span></code></pre></div><h4 id=劫持-dns>劫持 DNS<a hidden class=anchor aria-hidden=true href=#劫持-dns>#</a></h4><p>使用 tproxy 能力时，需要让代理client接管 DNS 流量，有两种方式：</p><ul><li><p>停掉本地的 DNS 服务，将代理client的 DNS 服务端口改为 53</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># PREROUTING</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -d 192.168.0.0/16 -p udp ! --dport <span style=color:#ae81ff>53</span> -j RETURN
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># OUTPUT</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -d 192.168.0.0/16 -p udp ! --dport <span style=color:#ae81ff>53</span> -j RETURN
</span></span></code></pre></div></li><li><p>将 DNS 查询数据包转发到代理client</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># PREROUTING</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY -d 192.168.0.0/16 -p udp ! --dport <span style=color:#ae81ff>53</span> -j RETURN
</span></span><span style=display:flex><span>iptables -t nat -A V2RAY -p udp --dport <span style=color:#ae81ff>53</span> -j REDIRECT --to-ports <span style=color:#ae81ff>10053</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># OUTPUT</span>
</span></span><span style=display:flex><span>iptables -t mangle -A V2RAY_MASK -d 192.168.0.0/16 -p udp ! --dport <span style=color:#ae81ff>53</span> -j RETURN
</span></span><span style=display:flex><span>iptables -t nat -A V2RAY_MASK -p udp --dport <span style=color:#ae81ff>53</span> -j REDIRECT --to-ports <span style=color:#ae81ff>10053</span>
</span></span></code></pre></div><p>10053 是在代理client上设置的 DNS 服务端口。</p></li></ul><h3 id=wireguardhttpsfuckcloudnativeiopostswireguard-docs-practice><a href=https://fuckcloudnative.io/posts/wireguard-docs-practice/>WireGuard</a><a hidden class=anchor aria-hidden=true href=#wireguardhttpsfuckcloudnativeiopostswireguard-docs-practice>#</a></h3><p>官方文档：https://github.com/pirate/wireguard-docs</p><p><code>WireGuard</code> 是由 <code>Jason Donenfeld</code> 等人用 <code>C</code> 语言编写的一个开源 VPN 协议，被视为下一代 VPN 协议，旨在解决许多困扰 <code>IPSec/IKEv2</code>、<code>OpenVPN</code> 或 <code>L2TP</code> 等其他 VPN 协议的问题。它与 <code>Tinc</code> 和 <code>MeshBird</code> 等现代 VPN 产品有一些相似之处，即加密技术先进、配置简单。从 2020 年 1 月开始，它已经并入了 Linux 内核的 <code>5.6</code> 版本，这意味着大多数 Linux 发行版的用户将拥有一个开箱即用的 WireGuard。</p><h4 id=术语>术语<a hidden class=anchor aria-hidden=true href=#术语>#</a></h4><p><strong>Peer/Node/Device</strong></p><p>连接到 VPN 并为自己注册一个 VPN 子网地址（如 192.0.2.3）的主机。还可以通过使用逗号分隔的 CIDR 指定子网范围，为其自身地址以外的 IP 地址选择路由。</p><p><strong>中继服务器（Bounce Server）</strong></p><p>一个公网可达的对等节点，可以将流量中继到 <code>NAT</code> 后面的其他对等节点。<code>Bounce Server</code> 并不是特殊的节点，它和其他对等节点一样，唯一的区别是它有公网 IP，并且开启了内核级别的 IP 转发，可以将 VPN 的流量转发到其他客户端。</p><p><strong>子网（Subnet）</strong></p><p>一组私有 IP，例如 <code>192.0.2.1-255</code> 或 <code>192.168.1.1/24</code>，一般在 NAT 后面，例如办公室局域网或家庭网络。</p><p><a href=https://www.cnblogs.com/hark0623/p/6547432.html><strong>CIDR 表示法</strong></a></p><p>CIDR中文全称是无分类域间路由选择，英文全称是Classless Inter-Domain Routing，在平常，大家多称之为无分类编址，它也是构成超网的一种技术实现。CIDR在一定程度上解决了路由表项目过多过大的问题。CIDR之所以称为无分类编址，就是因为CIDR完全放弃了之前的分类IP地址表示法，它真正消除了传统的A类、B类、C类地址以及划分子网的概念，它使用如下的IP地址表示法：</p><pre tabindex=0><code>IP地址 ::= {&lt;网络前缀&gt;， &lt;主机号&gt;} / 网络前缀所占位数
</code></pre><p>CIDR仅将IP地址划分为网络前缀和主机号两个部分，可以说又回到了二级IP地址的表示，不过大家要注意，最后面用“/”斜线分隔，在其后写上了网络前缀所占的位数，这样就不需要告知路由器地址掩码，仅需要通过网络前缀所占的位数就可以得到地址掩码，为了统一，CIDR中的地址掩码依然称为子网掩码。</p><p><strong>NAT</strong></p><p>子网的私有 IP 地址由路由器提供，通过公网无法直接访问私有子网设备，需要通过 NAT 做网络地址转换。路由器会跟踪发出的连接，并将响应转发到正确的内部 IP。</p><p><strong>公开端点（Public Endpoint）</strong></p><p>节点的公网 IP 地址:端口，例如 <code>123.124.125.126:1234</code>，或者直接使用域名 <code>some.domain.tld:1234</code>。如果对等节点不在同一子网中，那么节点的公开端点必须使用公网 IP 地址。</p><p><strong>私钥（Private key）</strong></p><p>单个节点的 WireGuard 私钥，生成方法是：<code>wg genkey > example.key</code>。</p><p><strong>公钥（Public key）</strong></p><p>单个节点的 WireGuard 公钥，生成方式为：<code>wg pubkey &lt; example.key > example.key.pub</code>。</p><p><strong>DNS</strong></p><p>域名服务器，用于将域名解析为 VPN 客户端的 IP，不让 DNS请求泄漏到 VPN 之外。</p><h4 id=工作原理>工作原理<a hidden class=anchor aria-hidden=true href=#工作原理>#</a></h4><p><strong>中继服务器工作原理</strong></p><p>中继服务器（Bounce Server）和普通的对等节点一样，它能够在 <code>NAT</code> 后面的 VPN 客户端之间充当中继服务器，可以将收到的任何 VPN 子网流量转发到正确的对等节点。事实上 WireGuard 并不关心流量是如何转发的，这个由系统内核和 <code>iptables</code> 规则处理。</p><p>如果所有的对等节点都是公网可达的，则不需要考虑中继服务器，只有当有对等节点位于 NAT 后面时才需要考虑。</p><p>*在 WireGuard 里，客户端和服务端基本是平等的，差别只是谁主动连接谁而已。*双方都会监听一个 UDP 端口，谁主动连接，谁就是客户端。主动连接的客户端需要指定对端的公网地址和端口，被动连接的服务端不需要指定其他对等节点的地址和端口。如果客户端和服务端都位于 NAT 后面，需要加一个中继服务器，客户端和服务端都指定中继服务器作为对等节点，它们的通信流量会先进入中继服务器，然后再转发到对端。</p><p>WireGuard 是支持漫游的，也就是说，双方不管谁的地址变动了，WireGuard 在看到对方从新地址说话的时候，就会记住它的新地址（跟 mosh 一样，不过是双向的）。所以双方要是一直保持在线，并且通信足够频繁的话（比如配置 <code>persistent-keepalive</code>），两边的 IP 都不固定也不影响的。</p><p><strong>流量路由</strong></p><p>利用 WireGuard 可以组建非常复杂的网络拓扑，这里主要介绍几个典型的拓扑：</p><ol><li>端到端直接连接</li></ol><p>这是最简单的拓扑，所有的节点要么在同一个局域网，要么直接通过公网访问，这样 <code>WireGuard</code> 可以直接连接到对端，不需要中继跳转。</p><ol start=2><li>一端位于 NAT 后面，另一端直接通过公网暴露</li></ol><p>这种情况下，最简单的方案是：通过公网暴露的一端作为服务端，另一端指定服务端的公网地址和端口，然后通过 <code>persistent-keepalive</code> 选项维持长连接，让 NAT 记得对应的映射关系。</p><ol start=3><li>两端都位于 NAT 后面，通过中继服务器连接</li></ol><p>大多数情况下，当通信双方都在 NAT 后面的时候，NAT 会做源端口随机化处理，直接连接可能比较困难。可以加一个中继服务器，通信双方都将中继服务器作为对端，然后维持长连接，流量就会通过中继服务器进行转发。</p><ol start=3><li>两端都位于 NAT 后面，通过 UDP NAT 打洞</li></ol><p>上面也提到了，当通信双方都在 NAT 后面的时候，直接连接不太现实，因为大多数 NAT 路由器对源端口的随机化相当严格，不可能提前为双方协调一个固定开放的端口。必须使用一个信令服务器（<code>STUN</code>），它会在中间沟通分配给对方哪些随机源端口。通信双方都会和公共信令服务器进行初始连接，然后它记录下随机的源端口，并将其返回给客户端。这其实就是现代 P2P 网络中 <code>WebRTC</code> 的工作原理。有时候，即使有了信令服务器和两端已知的源端口，也无法直接连接，因为 NAT 路由器严格规定只接受来自原始目的地址（信令服务器）的流量，会要求新开一个随机源端口来接受来自其他 IP 的流量（比如其他客户端试图使用原来的通信源端口）。运营商级别的 NAT 就是这么干的，比如蜂窝网络和一些企业网络，它们专门用这种方法来防止打洞连接。更多细节请参考下一部分的 NAT 到 NAT 连接实践的章节。</p><p>如果某一端同时连接了多个对端，当它想访问某个 IP 时，如果有具体的路由可用，则优先使用具体的路由，否则就会将流量转发到中继服务器，然后中继服务器再根据系统路由表进行转发。你可以通过测量 ping 的时间来计算每一跳的长度，并通过检查对端的输出（<code>wg show wg0</code>）来找到 WireGuard 对一个给定地址的路由方式。</p><p><strong>报文格式</strong></p><p>WireGuard 使用加密的 UDP 报文来封装所有的数据，UDP 不保证数据包一定能送达，也不保证按顺序到达，但隧道内的 TCP 连接可以保证数据有效交付。WireGuard 的报文格式如下图所示：</p><p><img loading=lazy src=/Distributions/WireGuardMessage.png alt=img></p><p><strong>性能</strong></p><p>WireGuard 声称其性能比大多数 VPN 协议更好，但这个事情有很多争议，比如某些加密方式支持硬件层面的加速。</p><p>WireGuard 直接在内核层面处理路由，直接使用系统内核的加密模块来加密数据，和 Linux 原本内置的密码子系统共存，原有的子系统能通过 <code>API</code> 使用 WireGuard 的 <code>Zinc</code> 密码库。WireGuard 使用 UDP 协议传输数据，在不使用的情况下默认不会传输任何 UDP 数据包，所以比常规 VPN 省电很多，可以像 55 一样一直挂着使用，速度相比其他 VPN 也是压倒性优势。</p><p><img loading=lazy src=/Distributions/WireGuardPerformance.png alt=img></p><p><strong>安全模型</strong></p><p>WireGuard 使用以下加密技术来保障数据的安全：</p><ul><li>使用 <code>ChaCha20</code> 进行对称加密，使用 <code>Poly1305</code> 进行数据验证。</li><li>利用 <code>Curve25519</code> 进行密钥交换。</li><li>使用 <code>BLAKE2</code> 作为哈希函数。</li><li>使用 <code>HKDF</code> 进行解密。</li></ul><p>WireGuard 的加密技术本质上是 <code>Trevor Perrin</code> 的 <code>Noise</code> 框架的实例化，它简单高效，其他的 VPN 都是通过一系列协商、握手和复杂的状态机来保障安全性。WireGuard 就相当于 VPN 协议中的 <code>qmail</code>，代码量比其他 VPN 协议少了好几个数量级。</p><p><strong>密钥管理</strong></p><p>WireGuard 通过为每个对等节点提供简单的公钥和私钥来实现双向认证，每个对等节点在设置阶段生成密钥，且只在对等节点之间共享密钥。每个节点除了公钥和私钥，不再需要其他证书或预共享密钥。</p><p>在更大规模的部署中，可以使用 <code>Ansible</code> 或 <code>Kubernetes Secrets</code> 等单独的服务来处理密钥的生成、分发和销毁。</p><p>如果你不想在 <code>wg0.conf</code> 配置文件中直接硬编码，可以从文件或命令中读取密钥，这使得通过第三方服务管理密钥变得更加容易：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>Interface<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>PostUp <span style=color:#f92672>=</span> wg set %i private-key /etc/wireguard/wg0.key &lt;<span style=color:#f92672>(</span>cat /some/path/%i/privkey<span style=color:#f92672>)</span>
</span></span></code></pre></div><p>从技术上讲，多个服务端之间可以共享相同的私钥，只要客户端不使用相同的密钥同时连接到两个服务器。但有时客户端会需要同时连接多台服务器，例如，你可以使用 <code>DNS</code> 轮询来均衡两台服务器之间的连接，这两台服务器配置相同。大多数情况下，每个对等节点都应该使用独立的的公钥和私钥，这样每个对等节点都不能读取到对方的流量，保障了安全性。</p><h4 id=搭建使用与配置详解>搭建使用与配置详解<a hidden class=anchor aria-hidden=true href=#搭建使用与配置详解>#</a></h4><h5 id=快速开始>快速开始<a hidden class=anchor aria-hidden=true href=#快速开始>#</a></h5><p><strong>安装</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># Ubuntu ≥ 18.04</span>
</span></span><span style=display:flex><span>$ apt install wireguard
</span></span></code></pre></div><p>在中继服务器上开启 IP 地址转发：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;net.ipv4.ip_forward = 1&#34;</span> &gt;&gt; /etc/sysctl.conf
</span></span><span style=display:flex><span>$ echo <span style=color:#e6db74>&#34;net.ipv4.conf.all.proxy_arp = 1&#34;</span> &gt;&gt; /etc/sysctl.conf
</span></span><span style=display:flex><span>$ sysctl -p /etc/sysctl.conf
</span></span></code></pre></div><p>添加 iptables 规则，允许本机的 NAT 转换：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ iptables -A INPUT -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
</span></span><span style=display:flex><span>$ iptables -A FORWARD -m conntrack --ctstate RELATED,ESTABLISHED -j ACCEPT
</span></span><span style=display:flex><span>$ iptables -A FORWARD -i wg0 -o wg0 -m conntrack --ctstate NEW -j ACCEPT
</span></span><span style=display:flex><span>$ iptables -t nat -A POSTROUTING -s 192.0.2.0/24 -o eth0 -j MASQUERADE
</span></span></code></pre></div><p>需要把 <code>eth0</code> 改成你实际使用的网卡接口名称。</p><p><strong>配置文件</strong></p><p>配置文件可以放在任何路径下，但必须通过绝对路径引用。默认路径是 <code>/etc/wireguard/wg0.conf</code>。</p><p><strong>生成密钥</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e>#生成私钥</span>
</span></span><span style=display:flex><span>$ wg genkey &gt; example.key
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 生成公钥</span>
</span></span><span style=display:flex><span>$ wg pubkey &lt; example.key &gt; example.key.pub
</span></span></code></pre></div><p><strong>启动与停止</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ wg-quick up /full/path/to/wg0.conf
</span></span><span style=display:flex><span>$ wg-quick down /full/path/to/wg0.conf
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 启动/停止 VPN 网络接口</span>
</span></span><span style=display:flex><span>$ ip link set wg0 up
</span></span><span style=display:flex><span>$ ip link set wg0 down
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 注册/注销 VPN 网络接口</span>
</span></span><span style=display:flex><span>$ ip link add dev wg0 type wireguard
</span></span><span style=display:flex><span>$ ip link delete dev wg0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 注册/注销 本地 VPN 地址</span>
</span></span><span style=display:flex><span>$ ip address add dev wg0 192.0.2.3/32
</span></span><span style=display:flex><span>$ ip address delete dev wg0 192.0.2.3/32
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 添加/删除 VPN 路由</span>
</span></span><span style=display:flex><span>$ ip route add 192.0.2.3/32 dev wg0
</span></span><span style=display:flex><span>$ ip route delete 192.0.2.3/32 dev wg0
</span></span></code></pre></div><p><strong>查看信息</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 查看系统 VPN 接口信息</span>
</span></span><span style=display:flex><span>$ ip link show wg0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看 VPN 接口详细信息</span>
</span></span><span style=display:flex><span>$ wg show all
</span></span><span style=display:flex><span>$ wg show wg0
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 查看 VPN 接口地址</span>
</span></span><span style=display:flex><span>$ ip address show wg0
</span></span></code></pre></div><p><strong>路由</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#75715e># 查看系统路由表</span>
</span></span><span style=display:flex><span>$ ip route show table main
</span></span><span style=display:flex><span>$ ip route show table local
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#75715e># 获取到特定 IP 的路由</span>
</span></span><span style=display:flex><span>$ ip route get 192.0.2.3
</span></span></code></pre></div><p><strong>一键安装</strong></p><p>一键安装请参考这个项目：<a href=https://github.com/angristan/wireguard-install>WireGuard installer</a></p><h5 id=配置详解>配置详解<a hidden class=anchor aria-hidden=true href=#配置详解>#</a></h5><p>WireGuard 使用 <a href=https://zh.wikipedia.org/wiki/INI%E6%96%87%E4%BB%B6>INI</a> 语法作为其配置文件格式。配置文件可以放在任何路径下，但必须通过绝对路径引用。默认路径是 <code>/etc/wireguard/wg0.conf</code>。</p><p>配置文件的命名形式必须为 <code>${WireGuard 接口的名称}.conf</code>。通常情况下 WireGuard 接口名称以 <code>wg</code> 为前缀，并从 <code>0</code> 开始编号，但你也可以使用其他名称，只要符合正则表达式 <code>^[a-zA-Z0-9_=+.-]{1,15}$</code> 就行。</p><p>你可以选择使用 <code>wg</code> 命令来手动配置 VPN，但一般建议使用 <code>wg-quick</code>，它提供了更强大和用户友好的配置体验，可以通过配置文件来管理配置。</p><p>下面是一个配置文件示例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Interface]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Name = node1.example.tld</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Address</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.3/32</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ListenPort</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>51820</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PrivateKey</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>localPrivateKeyAbcAbcAbc=</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>DNS</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>1.1.1.1,8.8.8.8</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Table</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>12345</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>MTU</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>1500</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PreUp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/bin/example arg1 arg2 %i</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PostUp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/bin/example arg1 arg2 %i</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PreDown</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/bin/example arg1 arg2 %i</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PostDown</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>/bin/example arg1 arg2 %i</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[Peer]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Name = node2-node.example.tld</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>AllowedIPs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.1/24</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Endpoint</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>node1.example.tld:51820</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PublicKey</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>remotePublicKeyAbcAbcAbc=</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PersistentKeepalive</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>25</span>
</span></span></code></pre></div><p><strong>[Interface]</strong></p><p>这一节定义本地 VPN 配置。例如：</p><p>本地节点是客户端，只路由自身的流量，只暴露一个 IP。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Interface]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Name = phone.example-vpn.dev</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Address</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.5/32</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PrivateKey</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;private key for phone.example-vpn.dev&gt;</span>
</span></span></code></pre></div><p>本地节点是中继服务器，它可以将流量转发到其他对等节点（peer），并公开整个 VPN 子网的路由。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Interface]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Name = public-server1.example-vpn.tld</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Address</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.1/24</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>ListenPort</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>51820</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PrivateKey</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;private key for public-server1.example-vpn.tld&gt;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>DNS</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>1.1.1.1</span>
</span></span></code></pre></div><ol><li>Name</li></ol><p>这是 <code>INI</code> 语法中的标准注释，用于展示该配置部分属于哪个节点。这部分配置会被 WireGuard 完全忽略，对 VPN 的行为没有任何影响。</p><ol start=2><li>Address</li></ol><p>定义本地节点应该对哪个地址范围进行路由。如果是常规的客户端，则将其设置为节点本身的单个 IP（使用 CIDR 指定，例如 192.0.2.3/32）；如果是中继服务器，则将其设置为可路由的子网范围。</p><p>例如：</p><ul><li><p>常规客户端，只路由自身的流量：<code>Address = 192.0.2.3/32</code></p></li><li><p>中继服务器，可以将流量转发到其他对等节点（peer）：<code>Address = 192.0.2.1/24</code></p></li><li><p>也可以指定多个子网或 IPv6 子网：<code>Address = 192.0.2.1/24,2001:DB8::/64</code></p></li></ul><ol start=3><li>ListenPort</li></ol><p>当本地节点是中继服务器时，需要通过该参数指定端口来监听传入 VPN 连接，默认端口号是 <code>51820</code>。常规客户端不需要此选项。</p><ol start=4><li>PrivateKey</li></ol><p>本地节点的私钥，所有节点（包括中继服务器）都必须设置。不可与其他服务器共用。</p><p>私钥可通过命令 <code>wg genkey > example.key</code> 来生成。</p><ol start=5><li>DNS</li></ol><p>通过 DHCP 向客户端宣告 DNS 服务器。客户端将会使用这里指定的 DNS 服务器来处理 VPN 子网中的 DNS 请求，但也可以在系统中覆盖此选项。例如：</p><ul><li><p>如果不配置则使用系统默认 DNS</p></li><li><p>可以指定单个 DNS：<code>DNS = 1.1.1.1</code></p></li><li><p>也可以指定多个 DNS：<code>DNS = 1.1.1.1,8.8.8.8</code></p></li></ul><ol start=6><li>Table</li></ol><p>定义 VPN 子网使用的路由表，默认不需要设置。该参数有两个特殊的值需要注意：</p><ul><li><code>Table = off</code> : 禁止创建路由</li><li><code>Table = auto</code>（默认值） : 将路由添加到系统默认的 table 中，并启用对默认路由的特殊处理。</li></ul><p>例如：<code>Table = 1234</code></p><ol start=7><li>MTU</li></ol><p>定义连接到对等节点（peer）的 <code>MTU</code>（Maximum Transmission Unit，最大传输单元），默认不需要设置，一般由系统自动确定。</p><ol start=8><li>PreUp</li></ol><p>启动 VPN 接口之前运行的命令。这个选项可以指定多次，按顺序执行。</p><p>例如添加路由：<code>PreUp = ip rule add ipproto tcp dport 22 table 1234</code></p><ol start=9><li>PostUp</li></ol><p>启动 VPN 接口之后运行的命令。这个选项可以指定多次，按顺序执行。</p><p>例如：</p><ul><li><p>从文件或某个命令的输出中读取配置值：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PostUp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>wg set %i private-key /etc/wireguard/wg0.key &lt;(some command here)</span>
</span></span></code></pre></div></li><li><p>添加一行日志到文件中：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PostUp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>echo &#34;$(date +%s) WireGuard Started&#34; &gt;&gt; /var/log/wireguard.log</span>
</span></span></code></pre></div></li><li><p>调用 WebHook：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PostUp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>curl https://events.example.dev/wireguard/started/?key=abcdefg</span>
</span></span></code></pre></div></li><li><p>添加路由：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PostUp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>ip rule add ipproto tcp dport 22 table 1234</span>
</span></span></code></pre></div></li><li><p>添加 iptables 规则，启用数据包转发：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PostUp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o eth0 -j MASQUERADE</span>
</span></span></code></pre></div></li><li><p>强制 WireGuard 重新解析对端域名的 IP 地址：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PostUp</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>resolvectl domain %i &#34;~.&#34;; resolvectl dns %i 192.0.2.1; resolvectl dnssec %i yes</span>
</span></span></code></pre></div></li></ul><ol start=10><li>PreDown</li></ol><p>停止 VPN 接口之前运行的命令。这个选项可以指定多次，按顺序执行。</p><p>例如：</p><ul><li><p>添加一行日志到文件中：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PreDown</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>echo &#34;$(date +%s) WireGuard Going Down&#34; &gt;&gt; /var/log/wireguard.log</span>
</span></span></code></pre></div></li><li><p>调用 WebHook：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PreDown</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>curl https://events.example.dev/wireguard/stopping/?key=abcdefg</span>
</span></span></code></pre></div></li></ul><ol start=11><li>PostDown</li></ol><p>停止 VPN 接口之后运行的命令。这个选项可以指定多次，按顺序执行。</p><p>例如：</p><ul><li><p>添加一行日志到文件中：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PostDown</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>echo &#34;$(date +%s) WireGuard Going Down&#34; &gt;&gt; /var/log/wireguard.log</span>
</span></span></code></pre></div></li><li><p>调用 WebHook：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PostDown</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>curl https://events.example.dev/wireguard/stopping/?key=abcdefg</span>
</span></span></code></pre></div></li><li><p>删除 iptables 规则，关闭数据包转发：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>PostDown</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o eth0 -j MASQUERADE</span>
</span></span></code></pre></div></li></ul><p><strong>[Peer]</strong></p><p>定义能够为一个或多个地址路由流量的对等节点（peer）的 VPN 设置。对等节点（peer）可以是将流量转发到其他对等节点（peer）的中继服务器，也可以是通过公网或内网直连的客户端。</p><p>中继服务器必须将所有的客户端定义为对等节点（peer），除了中继服务器之外，其他客户端都不能将位于 NAT 后面的节点定义为对等节点（peer），因为路由不可达。对于那些只为自己路由流量的客户端，只需将中继服务器作为对等节点（peer），以及其他需要直接访问的节点。</p><p>举个例子，在下面的配置中，<code>public-server1</code> 作为中继服务器，其他的客户端有的是直连，有的位于 NAT 后面：</p><ul><li><p><code>public-server1</code>（中继服务器）</p><p>[peer] : <code>public-server2</code>, <code>home-server</code>, <code>laptop</code>, <code>phone</code></p></li><li><p><code>public-server2</code>（直连客户端）</p><p>[peer] : <code>public-server1</code></p></li><li><p><code>home-server</code>（客户端位于 NAT 后面）</p><p>[peer] : <code>public-server1</code>, <code>public-server2</code></p></li><li><p><code>laptop</code>（客户端位于 NAT 后面）</p><p>[peer] : <code>public-server1</code>, <code>public-server2</code></p></li><li><p><code>phone</code>（客户端位于 NAT 后面）</p><p>[peer] : <code>public-server1</code>, <code>public-server2</code></p></li></ul><p>配置示例：</p><ul><li><p>对等节点（peer）是路由可达的客户端，只为自己路由流量</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Peer]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Name = public-server2.example-vpn.dev</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Endpoint</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>public-server2.example-vpn.dev:51820</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PublicKey</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;public key for public-server2.example-vpn.dev&gt;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>AllowedIPs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.2/32</span>
</span></span></code></pre></div></li><li><p>对等节点（peer）是位于 NAT 后面的客户端，只为自己路由流量</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Peer]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Name = home-server.example-vpn.dev</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Endpoint</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>home-server.example-vpn.dev:51820</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PublicKey</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;public key for home-server.example-vpn.dev&gt;</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>AllowedIPs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.3/32</span>
</span></span></code></pre></div></li><li><p>对等节点（peer）是中继服务器，用来将流量转发到其他对等节点（peer）</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[Peer]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># Name = public-server1.example-vpn.tld</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>Endpoint</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>public-server1.example-vpn.tld:51820</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PublicKey</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&lt;public key for public-server1.example-vpn.tld&gt;</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 路由整个 VPN 子网的流量</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>AllowedIPs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.1/24</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>PersistentKeepalive</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>25</span>
</span></span></code></pre></div></li></ul><ol><li>Endpoint</li></ol><p>指定远端对等节点（peer）的公网地址。如果对等节点（peer）位于 NAT 后面或者没有稳定的公网访问地址，就忽略这个字段。通常只需要指定<strong>中继服务器</strong>的 <code>Endpoint</code>，当然有稳定公网 IP 的节点也可以指定。例如：</p><ul><li><p>通过 IP 指定：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>Endpoint</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>123.124.125.126:51820</span>
</span></span></code></pre></div></li><li><p>通过域名指定：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>Endpoint</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>public-server1.example-vpn.tld:51820</span>
</span></span></code></pre></div></li></ul><ol start=2><li>AllowedIPs</li></ol><p>允许该对等节点（peer）发送过来的 VPN 流量中的源地址范围。同时这个字段也会作为本机路由表中 wg0 绑定的 IP 地址范围。如果对等节点（peer）是常规的客户端，则将其设置为节点本身的单个 IP；如果对等节点（peer）是中继服务器，则将其设置为可路由的子网范围。可以使用 <code>,</code> 来指定多个 IP 或子网范围。该字段也可以指定多次。</p><p>当决定如何对一个数据包进行路由时，系统首先会选择最具体的路由，如果不匹配再选择更宽泛的路由。例如，对于一个发往 <code>192.0.2.3</code> 的数据包，系统首先会寻找地址为 <code>192.0.2.3/32</code> 的对等节点（peer），如果没有再寻找地址为 <code>192.0.2.1/24</code> 的对等节点（peer），以此类推。</p><p>例如：</p><ul><li><p>对等节点（peer）是常规客户端，只路由自身的流量：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>AllowedIPs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.3/32</span>
</span></span></code></pre></div></li><li><p>对等节点（peer）是中继服务器，可以将流量转发到其他对等节点（peer）：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>AllowedIPs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.1/24</span>
</span></span></code></pre></div></li><li><p>对等节点（peer）是中继服务器，可以转发所有的流量，包括外网流量和 VPN 流量，可以用来干嘛你懂得：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>AllowedIPs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>0.0.0.0/0,::/0</span>
</span></span></code></pre></div></li><li><p>对等节点（peer）是中继服务器，可以路由其自身和其他对等节点（peer）的流量：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>AllowedIPs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.3/32,192.0.2.4/32</span>
</span></span></code></pre></div></li><li><p>对等节点（peer）是中继服务器，可以路由其自身的流量和它所在的内网的流量：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>AllowedIPs</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>192.0.2.3/32,192.168.1.1/24</span>
</span></span></code></pre></div></li></ul><ol start=3><li>PublicKey</li></ol><p>对等节点（peer）的公钥，所有节点（包括中继服务器）都必须设置。可与其他对等节点（peer）共用同一个公钥。</p><p>公钥可通过命令 <code>wg pubkey &lt; example.key > example.key.pub</code> 来生成，其中 <code>example.key</code> 是上面生成的私钥。</p><p>例如：<code>PublicKey = somePublicKeyAbcdAbcdAbcdAbcd=</code></p><ol start=4><li>PersistentKeepalive</li></ol><p>如果连接是从一个位于 NAT 后面的对等节点（peer）到一个公网可达的对等节点（peer），那么 NAT 后面的对等节点（peer）必须定期发送一个出站 ping 包来检查连通性，如果 IP 有变化，就会自动更新<code>Endpoint</code>。</p><p>例如：</p><ul><li>本地节点与对等节点（peer）可直连：该字段不需要指定，因为不需要连接检查。</li><li>对等节点（peer）位于 NAT 后面：该字段不需要指定，因为维持连接是客户端（连接的发起方）的责任。</li><li>本地节点位于 NAT 后面，对等节点（peer）公网可达：需要指定该字段 <code>PersistentKeepalive = 25</code>，表示每隔 <code>25</code> 秒发送一次 ping 来检查连接。</li></ul><h2 id=gnome>Gnome<a hidden class=anchor aria-hidden=true href=#gnome>#</a></h2><p>GNOME 系统设置面板（gnome-control-center）和 GNOME 应用使用 <a href=https://en.wikipedia.org/wiki/Dconf>dconf</a> 配置系统存储设置。您可以使用 <code>gsettings</code> 或 <code>dconf</code> 命令行工具直接访问 dconf 数据库。这也可以让你修改用户界面不公开的设置。</p><p>GNOME 桌面拥有强大的搜索功能，按 <code>Super</code> 键并搜索一些东西，可以进入“Settings-Search”中来设置可以搜索的内容和顺序。</p><p>Do Not Disturb 使通知只在消息栏中，不会在桌面上弹出。</p><p>Gnome 3 自动切换的壁纸会有一个有时钟小图标。</p><h3 id=dconf>Dconf<a hidden class=anchor aria-hidden=true href=#dconf>#</a></h3><p><a href=https://www.reddit.com/r/gnome/comments/vuhrys/whats_the_best_way_to_clone_my_gnome_settings_to/><strong>backup dconf</strong></a></p><p>Install dconf and try the command below</p><pre tabindex=0><code>dconf dump / &gt; full-backup
</code></pre><p>If it doesn&rsquo;t work, try with -f flag. If you only want gnome related settings try this</p><pre tabindex=0><code>dconf dump /org/gnome &gt; gnome-backup
</code></pre><p>If you use custom theme and icon, backup those separately.</p><p>Restore</p><ul><li>Full restore <code>dconf load / &lt; full-backup</code></li><li>Gnome only restore <code>dconf load /org/gnome &lt; gnome-backup</code></li></ul><h3 id=浏览>浏览<a hidden class=anchor aria-hidden=true href=#浏览>#</a></h3><p><a href=https://wiki.gnome.org/Projects/GnomeShell/CheatSheet>GNOME Shell cheat sheet</a> 中解释了如何高效地使用 GNOME shell，它展示了 GNOME shell 的特色和快捷键，包括切换任务，使用键盘，窗口控制，面板，概览模式等等。以下是部分常用的快捷键：</p><ul><li><code>Super</code> + <code>m</code>：显示消息托盘</li><li><code>Super</code> + <code>a</code>：显示应用程序菜单</li><li><code>Alt-</code> + <code>Tab</code>：切换当前使用的应用</li><li><code>Alt-</code> + ` (美式键盘 <code>Tab</code> 上面的按键)：切换前台应用程序的窗口</li><li><code>Alt</code> + <code>F2</code>，然后输入 <code>r</code> 或 <code>restart</code>：在图形界面出问题时重启界面（仅用于 X/传统 模式，不适用于 Wayland 模式）。也可通过此运行后台应用，如 cfw。</li></ul><h3 id=gedit>Gedit<a hidden class=anchor aria-hidden=true href=#gedit>#</a></h3><p><strong>编码</strong></p><p>直接打开gedit（非通过文件打开），点击左上角 <code>Open</code>，点击左下角 <code>Automatically Detected</code>，下拉选择 <code>Add or Remove...</code>，将简体中文编码都选上。</p><p>或者：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gsettings list-keys org.gnome.gedit.preferences.encodings
</span></span><span style=display:flex><span>candidate-encodings
</span></span><span style=display:flex><span>$ gsettings set org.gnome.gedit.preferences.encodings candidate-encodings <span style=color:#e6db74>&#34;[&#39;UTF-8&#39;, &#39;ISO-8859-15&#39;, &#39;UTF-16&#39;, &#39;GBK&#39;, &#39;GB18030&#39;, &#39;GB2312&#39;]&#34;</span>
</span></span></code></pre></div><p><strong>配置</strong></p><ul><li>在 Perferences => View => Text Wrapping，都启用。</li><li>在 Perferences => Editor => Tap Stops，把 Tab width 设置为 2，勾选 Insert spaces instead of tabs。</li></ul><h3 id=nautilushttpswwwcnblogscomkeatonlaop12717071htmltop><a href=https://www.cnblogs.com/keatonlao/p/12717071.html#top>Nautilus</a><a hidden class=anchor aria-hidden=true href=#nautilushttpswwwcnblogscomkeatonlaop12717071htmltop>#</a></h3><p><a href=https://wiki.gnome.org/Apps/Files>Files</a> 是 GNOME 桌面环境的默认文件管理器。文件试图提供一种简化的方法来管理文件和应用程序。Files 在 3.6 版之前被称为 Nautilus。该应用程序被赋予了新的描述性名称，每种受支持的语言都有一个名称。 Nautilus 这个名称仍然在许多地方使用，例如可执行文件名称，某些程序包名称，某些桌面条目和某些 GSettings 模式。</p><h4 id=快捷键>快捷键<a hidden class=anchor aria-hidden=true href=#快捷键>#</a></h4><p>有时候鼠标操作效率低，比如新建标签页（汉堡菜单 > 新建标签页），我们要移动两次光标点两下，如果使用快捷键 <code>Ctrl+T</code>，一次就能迅速完成操作。所以，使用快捷键能提高效率。另一个让你多使用键盘快捷键的理由可能是，预防鼠标手。如果您经常使用某个软件，那么有必要学习它的快捷键，如果偶尔使用就没必要浪费时间。</p><p><code>Ctrl+F1</code>，查看 Files 快捷键。建议您参考列表多加练习。一些常用快捷键：</p><table><thead><tr><th>快捷键</th><th>功能</th></tr></thead><tbody><tr><td><code>Ctrl</code> <code>T</code></td><td>New tab</td></tr><tr><td><code>Ctrl</code> <code>N</code></td><td>New window</td></tr><tr><td><code>Ctrl</code> <code>W</code></td><td>Close window or tab</td></tr><tr><td></td><td></td></tr><tr><td><code>Ctrl</code> <code>F</code></td><td>Search</td></tr><tr><td><code>~</code></td><td>Location bar with home location</td></tr><tr><td><code>/</code></td><td>Location bar with root location</td></tr><tr><td><code>Ctrl</code> <code>L</code></td><td>Enter location</td></tr><tr><td></td><td></td></tr><tr><td><code>Backspace</code></td><td>Go Back to a Previous Folder</td></tr><tr><td><code>Ctrl</code> <code>+</code></td><td>Zoom in</td></tr><tr><td><code>Ctrl</code> <code>-</code></td><td>Zoom out</td></tr><tr><td><code>Ctrl</code> <code>0</code></td><td>Reset zoom</td></tr><tr><td><code>Ctrl</code> <code>H</code></td><td>Show/hide hidden files</td></tr><tr><td></td><td></td></tr><tr><td><code>F2</code></td><td>Rename</td></tr><tr><td><code>Delete</code></td><td>Move to trash</td></tr><tr><td><code>Shift</code> <code>Delete</code></td><td>Delete permanently</td></tr><tr><td><code>Ctrl</code> <code>C</code></td><td>Copy</td></tr><tr><td><code>Ctrl</code> <code>V</code></td><td>Paste</td></tr><tr><td><code>Ctrl</code> <code>X</code></td><td>Cut</td></tr><tr><td><code>Ctrl</code> <code>Z</code></td><td>Undo</td></tr><tr><td><code>Shift</code> <code>Ctrl</code> <code>Z</code></td><td>Redo</td></tr><tr><td></td><td></td></tr><tr><td><code>Ctrl</code> <code>A</code></td><td>Select all</td></tr><tr><td><code>Shift</code> <code>Ctrl</code> <code>I</code></td><td>Invert selection</td></tr><tr><td></td><td></td></tr><tr><td><code>Ctrl</code> <code>Q</code></td><td>Quit</td></tr></tbody></table><h4 id=从右键菜单创建新文档>从右键菜单创建新文档<a hidden class=anchor aria-hidden=true href=#从右键菜单创建新文档>#</a></h4><p>只需要将模板文件放到用户根目录下的 <code>Templates</code> / <code>模板</code> 文件夹里面。比如：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>touch ~/Templates/sh.sh
</span></span><span style=display:flex><span>touch ~/Templates/python.py
</span></span><span style=display:flex><span>touch ~/Templates/Markdown.md
</span></span></code></pre></div><p>当你右键时，就可以直接以该模板新建文件。</p><p>Templates 目录可以在 <code>~/.config/user-dirs.dirs</code> 中配置。默认为：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>XDG_TEMPLATES_DIR</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;$HOME/Templates&#34;</span>
</span></span></code></pre></div><p>你可以设置为其他目录。比如我的为：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>XDG_TEMPLATES_DIR</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/DATA/Templates&#34;</span>
</span></span></code></pre></div><p><code>/DATA</code> 不在系统分区，是一个单独的分区，我专门用来存放个人数据。</p><h4 id=直接搜索匹配>直接搜索匹配<a hidden class=anchor aria-hidden=true href=#直接搜索匹配>#</a></h4><p>常用的目录可以添加为书签，但访问其他目录时，我们经常是按路径逐个点击文件夹。对于文件夹路径较深或者周围有其他文件夹干扰的情况，操作起来其实非常低效。不知你是否意识到、思考过。</p><p>人们习惯鼠标操作后，往往不会再去思考如何提升效率，一直呆在舒适区域：这个我已经会用了。但是，有一些你不知道的技巧能够提高办事效率。</p><p>实际上，只要你身处 Files 中，直接输入英文字符即可搜索匹配。Files 像浏览器一样合并了搜索栏和地址栏，你可以直接输入 <code>关键词</code> 或者 <code>路径</code> 。但是，中文关键词需要在搜索栏（<code>Ctrl+F</code>）中输入。</p><p>一个实例：打开 GNOME 桌面系统图标所在文件夹 <code>/usr/share/icons</code>。</p><p>方法一：鼠标点击 <code>/</code> <code>usr</code> <code>share</code> 直接输入 <code>icons</code> 然后 <code>Enter</code> 打开。</p><blockquote><p>这是目标文件夹周围有其他文件夹干扰的情况。</p></blockquote><p>方法二：Files 中直接输入 <code>/usr/share/icons</code>（操作时可利用 Tab 自动补全）。</p><blockquote><p>这是路径较深的情况。</p></blockquote><h3 id=gnome-tweaks>Gnome Tweaks<a hidden class=anchor aria-hidden=true href=#gnome-tweaks>#</a></h3><p>GNOME 桌面有称为“扩展”的小插件或附加组件，学会使用 GNOME 扩展来扩展系统的可用性。安装必须的 packages：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install gnome-tweaks gnome-shell-extensions chrome-gnome-shell -y
</span></span></code></pre></div><ul><li><a href=https://wiki.gnome.org/Apps/Tweaks>gnome-tweaks</a>: Graphical interface for advanced GNOME settings. 可以设置主题、字体等。</li><li>gnome-shell-extensions：管理附加组件，可以禁用桌面图标、Ubuntu Dock。</li><li>chrome-gnome-shell：<a href=https://wiki.gnome.org/Projects/GnomeShellIntegrationForChrome/Installation#Ubuntu_Linux>GNOME Shell integration for Chrome</a>，可从浏览器安装 <a href=https://extensions.gnome.org/>GNOME Shell extensions</a>。</li></ul><p>主题相关目录：</p><ul><li>主题目录： <code>/usr/share/themes</code> 或 <code>~/.themes</code></li><li>图标鼠标目录： <code>/usr/share/icons</code> 或 <code>~/.icons</code></li><li>壁纸： <code>/usr/share/background</code> , <code>/usr/share/wallpapers</code></li></ul><p>主题选择：<a href=https://designmodo.com/flat-vs-material/>Skeuomorphism vs Flat Design vs Material Design</a></p><ul><li><p><a href=https://github.com/PapirusDevelopmentTeam/papirus-icon-theme>Papirus Icon Theme</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo add-apt-repository ppa:papirus/papirus
</span></span><span style=display:flex><span>$ sudo apt-get update
</span></span><span style=display:flex><span>$ sudo apt-get install papirus-icon-theme
</span></span></code></pre></div><p>如果直接安装官方仓库的，则可能 <a href=https://github.com/EXALAB/AnLinux-App/issues/199>Stuck on &ldquo;Unpacking papirus-icon-theme (20220204-1) over (20220204-1) &mldr;&rdquo;</a>: stuck unpacking papyrus-icon-theme doesn&rsquo;t mean stuck forever. depending on the speed of storage and device to unpack the .deb file</p></li><li><p><a href=https://github.com/nana-4/materia-theme>Materia Theme</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install materia-gtk-theme
</span></span></code></pre></div></li></ul><p>如果要在不同发行版上统一 Gnome 界面，那么最好的方法就是使用自定义主题了。</p><h4 id=ubuntu-dockhttpsblogcsdnneta6864657articledetails103606669><a href=https://blog.csdn.net/a6864657/article/details/103606669/>Ubuntu Dock</a><a hidden class=anchor aria-hidden=true href=#ubuntu-dockhttpsblogcsdnneta6864657articledetails103606669>#</a></h4><p>Ubuntu Dock 就是 Dash to Dock。安装：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt-get install  gnome-shell-extension-dashtodock
</span></span></code></pre></div><p>重启，在 Extension 中设置 Dash to Dock，Dash to Dock 与 Ubuntu Dock 只能开启一个，否则有两个 Dock，但是就算关闭 Dash to Dock，Dash to Dock 设置依旧起作用到 Ubuntu Dock。</p><p>重新登录。</p><h4 id=gsconnecthttpsgithubcomgsconnectgnome-shell-extension-gsconnectwikiinstallation><a href=https://github.com/GSConnect/gnome-shell-extension-gsconnect/wiki/Installation>GSConnect</a><a hidden class=anchor aria-hidden=true href=#gsconnecthttpsgithubcomgsconnectgnome-shell-extension-gsconnectwikiinstallation>#</a></h4><p>Files and links. Shared between devices.</p><p><a href=https://userbase.kde.org/KDEConnect#I_have_two_devices_running_KDE_Connect_on_the_same_network.2C_but_they_can.27t_see_each_other><strong>Firewall Blocking Port</strong></a></p><p>使用 ufw：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo ufw allow proto tcp from 192.168.2.0/24 to any port 1714:1764
</span></span><span style=display:flex><span>$ sudo ufw allow proto udp from 192.168.2.0/24 to any port 1714:1764
</span></span><span style=display:flex><span>$ sudo ufw reload
</span></span></code></pre></div><p>有时候正确设置了防火墙，还是会发送文件失败，可以考虑重启应用。</p><p><a href=https://github.com/GSConnect/gnome-shell-extension-gsconnect/issues/1203#issuecomment-974631548>mounting does not work</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sftp -P <span style=color:#ae81ff>1740</span> kdeconnect@192.168.0.105
</span></span><span style=display:flex><span>Unable to negotiate with 192.168.88.245 port 1740: no matching host key type found. Their offer: ssh-rsa
</span></span><span style=display:flex><span>Connection closed.  
</span></span><span style=display:flex><span>Connection closed
</span></span><span style=display:flex><span>$ vim ~/.ssh/config
</span></span><span style=display:flex><span>Host 192.168.0.*
</span></span><span style=display:flex><span>   HostkeyAlgorithms +ssh-rsa
</span></span><span style=display:flex><span>   PubkeyAcceptedAlgorithms +ssh-rsa
</span></span><span style=display:flex><span>$ ssh kdeconnect@192.168.0.105 -p <span style=color:#ae81ff>1740</span>
</span></span></code></pre></div><p>After that the mounting works again.</p><p><a href=https://github.com/GSConnect/gnome-shell-extension-gsconnect/issues/1025><strong>GSConnect cannot send multiple files at once</strong></a></p><p>GSConnect cannot send multiple files at once. If I try sending multiple files to my phone, only one file is received by my phone.</p><p>GSConnect shows &ldquo;Transfer Successful&rdquo; notification only for the first file, and &ldquo;Transferring File&rdquo; notifications for the other files remain.</p><p><a href=https://github.com/GSConnect/gnome-shell-extension-gsconnect/wiki/Installation#files-integration-nautilus--nemo><strong>Files Integration</strong></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install python3-nautilus gir1.2-nautilus-3.0
</span></span><span style=display:flex><span>$ nautilus -q <span style=color:#f92672>&amp;&amp;</span> nautilus
</span></span></code></pre></div><p><a href=https://userbase.kde.org/KDEConnect><strong>KDE Connect</strong></a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install kdeconnect nautilus-kdeconnect
</span></span></code></pre></div><p>有时候总也连不上，可以通过路由器将 PC 端 IP 固定，然后在 Android 端用 <code>Add devices by IP</code> 连接。</p><h4 id=desktop-icons-ng-dinghttpsextensionsgnomeorgextension2087desktop-icons-ng-ding><a href=https://extensions.gnome.org/extension/2087/desktop-icons-ng-ding/>Desktop Icons NG (DING)</a><a hidden class=anchor aria-hidden=true href=#desktop-icons-ng-dinghttpsextensionsgnomeorgextension2087desktop-icons-ng-ding>#</a></h4><p>with these advantages:</p><ul><li>Drag&rsquo;n&rsquo;Drop, both inside the desktop, between desktop and applications, and nautilus windows</li><li>Allows to use &ldquo;Open with&mldr;&rdquo; option with several files</li><li>When hovering or clicking on an icon with a name too large to fit, it shows the full name</li><li>Doesn&rsquo;t hang the compositor when there is too much activity in the desktop folder</li></ul><h4 id=lunar-calendar-农历httpsextensionsgnomeorgextension675lunar-calendar><a href=https://extensions.gnome.org/extension/675/lunar-calendar/>Lunar Calendar 农历</a><a hidden class=anchor aria-hidden=true href=#lunar-calendar-农历httpsextensionsgnomeorgextension675lunar-calendar>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install gir1.2-lunar-date-2.0
</span></span><span style=display:flex><span>$ sudo cp /usr/share/locale/zh_CN/LC_MESSAGES/lunar-date.mo /usr/share/locale/en/LC_MESSAGES/
</span></span></code></pre></div><p>你正在必须把系统语言改成中文它才会显出来:-(</p><h4 id=paperwmhttpsgithubcompaperwmpaperwm><a href=https://github.com/paperwm/PaperWM>PaperWM</a><a hidden class=anchor aria-hidden=true href=#paperwmhttpsgithubcompaperwmpaperwm>#</a></h4><p>Tiled scrollable window management for Gnome Shell</p><blockquote><p>&ldquo;<a href=https://github.com/paperwm/PaperWM/issues/425#issuecomment-1284622580>Something went wrong</a>&rdquo; at the end has been happening for a while and doesn&rsquo;t necessarily mean the install failed. It might just fail to enable and it will start the next time you restart gnome-shell (e.g. by logging out and in) or enable the extension manually. I believe there is already a ticket somewhere about this.</p></blockquote><h4 id=其他扩展推荐>其他扩展推荐<a hidden class=anchor aria-hidden=true href=#其他扩展推荐>#</a></h4><ul><li><a href=https://extensions.gnome.org/extension/104/netspeed/>NetSpeed</a>: Displays Internet Speed</li><li><a href=https://extensions.gnome.org/extension/779/clipboard-indicator/>Clipboard Indicator</a>: Clipboard Manager extension for Gnome-Shell - Adds a clipboard indicator to the top panel, and caches clipboard history.</li><li><a href=https://extensions.gnome.org/extension/97/coverflow-alt-tab/>Coverflow Alt-Tab</a>: Replacement of Alt-Tab, iterates through windows in a cover-flow manner.</li><li><a href=https://extensions.gnome.org/extension/1401/bluetooth-quick-connect/>Bluetooth Quick Connect</a>: Allow to connect to paired devices from gnome control panel.</li><li><a href=https://extensions.gnome.org/extension/2/move-clock/>Frippery Move Clock</a>: Move clock to left of status menu button</li><li><a href=https://extensions.gnome.org/extension/261/kimpanel/>Input Method Panel</a>: Input Method Panel using KDE&rsquo;s kimpanel protocol for Gnome-Shell</li><li><a href=https://extensions.gnome.org/extension/36/lock-keys/>Lock Keys</a>: Numlock & Capslock status on the panel</li><li><a href=https://extensions.gnome.org/extension/750/openweather/>OpenWeather</a>: Weather extension to display weather information from <a href=https://openweathermap.org/>https://openweathermap.org/</a> or <a href=https://darksky.net>https://darksky.net</a> for almost all locations in the world.
需设置 Location，Units 为公制单位，Layout为Right</li><li><a href=https://extensions.gnome.org/extension/1462/panel-date-format/>Panel Date Format</a>: Allows to customize the date format on the panel.</li><li><a href=https://extensions.gnome.org/extension/905/refresh-wifi-connections/>Refresh Wifi Connections</a>: This extension adds a refresh button to the Wi-Fi connection selection dialog to manually request for a network scan.</li><li><a href=https://extensions.gnome.org/extension/1112/screenshot-tool/>Screenshot Tool</a>: Conveniently create, copy, store and upload screenshots. Please log out and log in again after updating.</li><li><a href=https://extensions.gnome.org/extension/906/sound-output-device-chooser/>Sound Input & Output Device ChooserLivepatch</a>: Shows a list of sound output and input devices (similar to gnome sound settings) in the status menu below the volume slider.</li><li><a href=https://extensions.gnome.org/extension/355/status-area-horizontal-spacing/>Status Area Horizontal Spacing</a>: Reduce the horizontal spacing between icons in the top-right status area</li><li><a href=https://extensions.gnome.org/extension/1287/unite/>Unite</a>: Unite is a GNOME Shell extension which makes a few layout tweaks to the top panel and removes window decorations to make it look like Ubuntu Unity Shell.</li><li><a href=https://extensions.gnome.org/extension/19/user-themes/>User Themes</a>: Load shell themes from user directory.</li><li><a href=https://extensions.gnome.org/extension/1460/vitals/>Vitals</a>: A glimpse into your computer&rsquo;s temperature, voltage, fan speed, memory usage, processor load, system resources, network speed and storage stats. This is a one stop shop to monitor all of your vital sensors. Uses asynchronous polling to provide a smooth user experience.</li><li><a href=https://extensions.gnome.org/extension/7/removable-drive-menu/>Removable Drive Menu</a>: A status menu for accessing and unmounting removable devices.</li><li><a href=https://extensions.gnome.org/extension/8/places-status-indicator/>Places Status Indicator</a>: Add a menu for quickly navigating places in the system. This extension is part of Classic Mode and is officially supported by GNOME. Please do not report bugs using the form below, use GNOME&rsquo;s GitLab instance instead.</li><li><a href=https://extensions.gnome.org/extension/72/recent-items/>Recent Items</a></li><li><a href=https://extensions.gnome.org/extension/28/gtile/>gTile</a>: Tile windows on a grid.</li><li><a href=https://extensions.gnome.org/extension/701/top-panel-workspace-scroll/>Top Panel Workspace Scroll</a>: Change workspaces by scrolling over the top panel</li><li><a href=https://extensions.gnome.org/extension/21/workspace-indicator/>Workspace Indicator</a>: Put an indicator on the panel signaling in which workspace you are, and give you the possibility of switching to another one.</li><li><a href=https://extensions.gnome.org/extension/16/auto-move-windows/>Auto Move Windows</a>: Move applications to specific workspaces when they create windows.</li><li><a href=https://extensions.gnome.org/extension/6/applications-menu/>Applications Menu</a>: Add a category-based menu for applications. This extension is part of Classic Mode and is officially supported by GNOME. Please do not report bugs using the form below, use GNOME&rsquo;s GitLab instance instead.</li><li><a href=https://extensions.gnome.org/extension/3433/fly-pie/>Fly-Pie</a>: A marking menu which can be used to launch applications, simulate hotkeys, open URLs and much more.</li><li><a href=https://extensions.gnome.org/extension/615/appindicator-support/>AppIndicator and KStatusNotifierItem Support</a>: Adds AppIndicator, KStatusNotifierItem and legacy Tray icons support to the Shell</li><li><a href=https://extensions.gnome.org/extension/1238/time/>Time ++</a>: A todo.txt manager, time tracker, timer, stopwatch, pomodoro, and alarm clock. 番茄钟</li><li><a href=https://extensions.gnome.org/extension/543/backslide/>BackSlide</a>: Automatic background-image (wallpaper) slideshow for Gnome Shell</li><li><a href=https://extensions.gnome.org/extension/2741/remove-alttab-delay-v2/>Remove Alt+Tab Delay v2</a>: Another extension that removes the 0.15 second popup delay in switcher pop-ups. This extension is actively maintained.</li><li><a href=https://extensions.gnome.org/extension/690/easyscreencast/>EasyScreenCast</a> : This extension simplifies the use of the video recording function integrated in gnome shell, allows quickly to change the various settings of the desktop recording.</li><li><a href=https://extensions.gnome.org/extension/545/hide-top-bar/>Hide Top Bar</a>: Hides the top bar, except in overview. However, there is an option to show the panel whenever the mouse pointer approaches the edge of the screen. And if &ldquo;intellihide&rdquo; is enabled, the panel only hides when a window takes the space.</li><li><a href=https://extensions.gnome.org/extension/1475/battery-time/>Battery Time</a>: Show the remaining time until fully charged/discharged instead of the battery charge in percent in the panel.</li><li><a href=https://extensions.gnome.org/extension/517/caffeine/>Caffeine</a>: Disable the screensaver and auto suspend</li><li><a href=https://extensions.gnome.org/extension/570/todotxt/>Todo.txt</a>: A Gnome shell interface for todo.txt.</li><li><a href=https://extensions.gnome.org/extension/836/internet-radio/>Internet Radio</a>: Listen to an Internet Radio Stream</li><li><a href=https://extensions.gnome.org/extension/1121/ibus-font-setting/>ibus font setting</a>: use ibus font setting of ibus setup dialog to enhance the user experience</li></ul><h3 id=遗留名称>遗留名称<a hidden class=anchor aria-hidden=true href=#遗留名称>#</a></h3><p><strong>注意：</strong> 一些 GNOME 程序在文档和对话框中的名称已经更改，但执行文件名称却没有。下面表格列出了一些这样的应用程序。</p><p><strong>提示：</strong> 在搜索栏中搜索应用的遗留名称将成功找到对应的应用，例如搜索 <em>nautilus</em> 将返还 <em>文件</em>。</p><table><thead><tr><th style=text-align:center>当前</th><th style=text-align:center>遗留</th></tr></thead><tbody><tr><td style=text-align:center>文件</td><td style=text-align:center>Nautilus</td></tr><tr><td style=text-align:center>Web</td><td style=text-align:center>Epiphany</td></tr><tr><td style=text-align:center>视频</td><td style=text-align:center>Totem</td></tr><tr><td style=text-align:center>主菜单</td><td style=text-align:center>Alacarte</td></tr><tr><td style=text-align:center>文档查看器</td><td style=text-align:center>Evince</td></tr><tr><td style=text-align:center>磁盘使用情况分析器</td><td style=text-align:center>Baobab</td></tr><tr><td style=text-align:center>图像查看器</td><td style=text-align:center>EoG (Eye of GNOME)</td></tr><tr><td style=text-align:center>密码和密钥</td><td style=text-align:center>Seahorse</td></tr></tbody></table><h3 id=默认应用程序>默认应用程序<a hidden class=anchor aria-hidden=true href=#默认应用程序>#</a></h3><p><strong>mime类型文件</strong></p><p>存在于以下的两个路径：</p><ul><li><code>/usr/share/mime/</code></li><li><code>~/.local/share/mime/</code></li></ul><p>例如：<code>/usr/share/mime/text/makrdown.xml</code></p><p><a href=https://askubuntu.com/questions/3395/how-to-get-the-mime-type-of-a-file-from-the-command-line>Get the mime type of a file</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ file --mime-type -b filename
</span></span></code></pre></div><p><strong>应用程序 desktop文件</strong></p><p>存在于以下的两个路径：</p><ul><li><code>/usr/share/applications/</code></li><li><code>~/.local/share/applications/</code></li></ul><p>例如 typora.desktop 文件：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#f92672>[</span>Desktop Entry<span style=color:#f92672>]</span>
</span></span><span style=display:flex><span><span style=color:#75715e># 应用名称，即开始菜单中的名称</span>
</span></span><span style=display:flex><span>Type<span style=color:#f92672>=</span>ApplicationName<span style=color:#f92672>=</span>name 
</span></span><span style=display:flex><span><span style=color:#75715e># 应用执行文件位置</span>
</span></span><span style=display:flex><span>Exec<span style=color:#f92672>=</span>appPath
</span></span><span style=display:flex><span><span style=color:#75715e># 应用图标位置</span>
</span></span><span style=display:flex><span>Icon<span style=color:#f92672>=</span>typora
</span></span><span style=display:flex><span><span style=color:#75715e># 是否显示终端</span>
</span></span><span style=display:flex><span>Terminal<span style=color:#f92672>=</span>false
</span></span><span style=display:flex><span><span style=color:#75715e># 所属分类</span>
</span></span><span style=display:flex><span>StartupNotify<span style=color:#f92672>=</span>trueCategories<span style=color:#f92672>=</span>Office
</span></span><span style=display:flex><span><span style=color:#75715e># MIME 类型</span>
</span></span><span style=display:flex><span>MimeType<span style=color:#f92672>=</span>text/x-markdown
</span></span></code></pre></div><p><strong>应用图标</strong></p><p>默认位置为 <code>~/.local/share/icons</code>，一个直接放入，如 <code>~/.local/share/icons/typora.png</code>，一个根据分辨率放入，如 <code>~/.local/share/icons/hicolor/256x256/typora.png</code></p><p><strong>应用程序默认关联文件</strong></p><p>存在于以下的两个路径：</p><ul><li><code>/usr/share/applications/mimeapps.list</code></li><li><code>~/.local/share/applications/mimeapps.list</code></li></ul><p>例如</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#a6e22e>text/plain</span><span style=color:#f92672>=</span><span style=color:#e6db74>org.gnome.gedit.desktop</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>text/html</span><span style=color:#f92672>=</span><span style=color:#e6db74>firefox.desktop</span>
</span></span></code></pre></div><h3 id=桌面卡死httpsblogcsdnnetsonggu1996articledetails87712546><a href=https://blog.csdn.net/SongGu1996/article/details/87712546>桌面卡死</a><a hidden class=anchor aria-hidden=true href=#桌面卡死httpsblogcsdnnetsonggu1996articledetails87712546>#</a></h3><p>总的来说，就是杀死相关进程，或者避免使用造成卡死相关软件。</p><ul><li><p>选择其他 tty：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ pkill Xorg 
</span></span></code></pre></div><p>pkill 用于杀死一个进程，与 kill 不同的是它会杀死指定名字的所有进程。kill 命令杀死指定进程 PID，需要配合 ps 使用。</p></li><li><p>安全重启：同时按住 Ctrl 和 Alt 键，按住不要放，按一下 <code>SysRq</code> 键（有的键盘是PrtSc），按一下 <code>R</code> 键，按一下 <code>E</code> 键，依次按下 <code>I</code> , <code>S</code> , <code>U</code> , <code>B</code> 键。</p></li><li><p><a href=https://www.cnblogs.com/schips/p/10167168.html>解决 Ubuntu 经常卡死</a>：ubuntu 的卡死可能与显卡驱动不兼容有关。用 nvidia 代替 nouveau显卡驱动。其中 <a href=https://askubuntu.com/questions/1262401/what-is-the-nvidia-server-driver>nvidia-driver-470-server</a> 是 server 版，最好用 nvidia-driver-470</p></li></ul><h3 id=nvidia>NVIDIA<a hidden class=anchor aria-hidden=true href=#nvidia>#</a></h3><h4 id=nvidia-drivers-on-ubuntuhttpslinuxconfigorghow-to-install-the-nvidia-drivers-on-ubuntu-20-04-focal-fossa-linux><a href=https://linuxconfig.org/how-to-install-the-nvidia-drivers-on-ubuntu-20-04-focal-fossa-linux>NVIDIA drivers on Ubuntu</a><a hidden class=anchor aria-hidden=true href=#nvidia-drivers-on-ubuntuhttpslinuxconfigorghow-to-install-the-nvidia-drivers-on-ubuntu-20-04-focal-fossa-linux>#</a></h4><p>First, detect the model of your nvidia graphic card and the recommended driver.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ ubuntu-drivers devices
</span></span></code></pre></div><p>If you agree with the recommendation feel free to use the <code>ubuntu-drivers</code> command again to install all recommended drivers:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo ubuntu-drivers autoinstall
</span></span></code></pre></div><h4 id=nvidia-optimushttpswikiarchlinuxorgtitlenvidia_optimus_e7ae80e4bd93e4b8ade69687><a href=https://wiki.archlinux.org/title/NVIDIA_Optimus_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87)>NVIDIA Optimus</a><a hidden class=anchor aria-hidden=true href=#nvidia-optimushttpswikiarchlinuxorgtitlenvidia_optimus_e7ae80e4bd93e4b8ade69687>#</a></h4><p><a href=https://en.wikipedia.org/wiki/NVIDIA_Optimus>NVIDIA Optimus</a> 是一项允许英特尔（Intel）集成图形处理器（GPU）和英伟达（NVIDIA）独立图形处理器置入并通过一台笔记本电脑访问的技术。</p><h4 id=prime-synchronizationhttpswikidebianorgnvidia20optimusprime_synchronization><a href=https://wiki.debian.org/NVIDIA%20Optimus#PRIME_synchronization>PRIME Synchronization</a><a hidden class=anchor aria-hidden=true href=#prime-synchronizationhttpswikidebianorgnvidia20optimusprime_synchronization>#</a></h4><p>You can enable <a href=https://forums.developer.nvidia.com/t/prime-and-prime-synchronization/44423>PRIME synchronization</a> to prevent <a href=https://en.wikipedia.org/wiki/Screen_tearing>screen tearing</a>. It requires:</p><ul><li>Linux kernel 4.5 or higher;</li><li>X server 1.19 or higher;</li><li>NVIDIA driver 370.23 or higher.</li></ul><p>PRIME synchronization will be enabled automatically after you enable <a href=https://en.wikipedia.org/wiki/Mode_setting>KMS</a> for <code>nvidia-drm</code> module.</p><ol><li><p>Add this line to the end of <code>/etc/modprobe.d/nvidia.conf</code>:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>options nvidia-drm modeset<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
</span></span></code></pre></div></li><li><p>Regenerate your <a href=https://wiki.debian.org/initramfs>initramfs</a> image by running:</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo update-initramfs -u
</span></span></code></pre></div></li><li><p>Reboot.</p></li></ol><p>要检查重新启动后以前的更改是否有效，请运行命令：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo cat /sys/module/nvidia_drm/parameters/modeset
</span></span><span style=display:flex><span>Y
</span></span></code></pre></div><p>see more about nvidia on uat <a href=https://help.ubuntu.com/community/BinaryDriverHowto/Nvidia>BinaryDriverHowto/Nvidia</a></p><h4 id=nvidia-powermizerhttpsrastatinggithubiohow-to-permanently-set-nvidia-powermizer-settings-in-ubuntu><a href=https://rastating.github.io/how-to-permanently-set-nvidia-powermizer-settings-in-ubuntu/>NVIDIA PowerMizer</a><a hidden class=anchor aria-hidden=true href=#nvidia-powermizerhttpsrastatinggithubiohow-to-permanently-set-nvidia-powermizer-settings-in-ubuntu>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ nvidia-settings -q GpuPowerMizerMode
</span></span><span style=display:flex><span>  Attribute <span style=color:#e6db74>&#39;GPUPowerMizerMode&#39;</span> <span style=color:#f92672>(</span>rastating-PC:1<span style=color:#f92672>[</span>gpu:0<span style=color:#f92672>])</span>: 0.
</span></span><span style=display:flex><span>    Valid values <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#39;GPUPowerMizerMode&#39;</span> are: 0, <span style=color:#ae81ff>1</span> and 2.
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;GPUPowerMizerMode&#39;</span> can use the following target types: GPU.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ nvidia-settings -a <span style=color:#e6db74>&#34;[gpu:0]/GpuPowerMizerMode=1&#34;</span>
</span></span><span style=display:flex><span>  Attribute <span style=color:#e6db74>&#39;GPUPowerMizerMode&#39;</span> <span style=color:#f92672>(</span>rastating-PC:1<span style=color:#f92672>[</span>gpu:0<span style=color:#f92672>])</span> assigned value 1.
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>$ nvidia-settings -q GpuPowerMizerMode
</span></span><span style=display:flex><span>  Attribute <span style=color:#e6db74>&#39;GPUPowerMizerMode&#39;</span> <span style=color:#f92672>(</span>rastating-PC:1<span style=color:#f92672>[</span>gpu:0<span style=color:#f92672>])</span>: 1.
</span></span><span style=display:flex><span>    Valid values <span style=color:#66d9ef>for</span> <span style=color:#e6db74>&#39;GPUPowerMizerMode&#39;</span> are: 0, <span style=color:#ae81ff>1</span> and 2.
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#39;GPUPowerMizerMode&#39;</span> can use the following target types: GPU.
</span></span></code></pre></div><p>添加到开机启动</p><ul><li><p>Name：<code>NVIDIA X Server Performance Settings</code></p></li><li><p>Command：<code>/usr/bin/nvidia-settings -a "[gpu:0]/GpuPowerMizerMode=1"</code></p></li><li></li></ul><h3 id=密钥环httpslinuxcnarticle-12093-1html><a href=https://linux.cn/article-12093-1.html>密钥环</a><a hidden class=anchor aria-hidden=true href=#密钥环httpslinuxcnarticle-12093-1html>#</a></h3><p>如果你用过 Ubuntu 或者其他的 Linux 发行版里的<a href=https://itsfoss.com/ubuntu-automatic-logon/>自动登录功能</a>, 你可能遇到过这种弹出消息：</p><blockquote><p>请输入密码以解锁你的登录密钥环</p><p>登录密钥环在你登录系统时未解锁。</p></blockquote><p><img loading=lazy src=/Distributions/230422m0xvgv0oj4fjdk7d.jpg alt="Enter Password To Unlock Your Login Keyring Ubuntu"></p><p>如果你一直点击取消，它会不断弹出几次才会消失。你可能想知道，为什么你会一直看到这个密钥环信息呢？</p><p>让我来告诉你吧。它其实不是错误，而是一个安全特性。</p><p>奇怪吗？下面就让我来解释下 Linux 里的密钥环概念。</p><h4 id=密钥环是什么为什么需要它>密钥环是什么，为什么需要它？<a hidden class=anchor aria-hidden=true href=#密钥环是什么为什么需要它>#</a></h4><p>在现实生活中你为什么要用钥匙环（也叫<a href=https://en.wikipedia.org/wiki/Keychain>钥匙链</a>）？你用它把一把或多把钥匙串到一起, 以便于携带和查找。</p><p>Linux 里也是类似的。密钥环特性使你的系统可以将各种密码放在一起，并将其保存在一个地方。</p><p>大多数 Linux 桌面环境，如 GNOME、KDE、Xfce 等采用 <a href=https://wiki.archlinux.org/index.php/GNOME/Keyring>GNOME 密钥环</a>来提供这个功能。</p><p>该密钥环保存了 ssh 密钥、GPG 密钥以及使用此功能的应用程序（例如 Chromium 浏览器）的密钥。默认情况下，<strong>“密钥环”通过主密码来保护</strong>，该密码通常是帐户的登录密码。</p><p>系统上的每个用户都有自己的密钥环，（通常）密码与用户帐户本身的密码相同。当你使用密码登录系统时，你的密匙环将使用你帐户的密码自动解锁。</p><p>当你启用 Ubuntu 中的自动登录功能时时，就有问题了。这意味着你无需输入密码即可登录系统。在这种情况下，你的密钥环不会自动解锁。</p><p><strong>密钥环是一个安全特性</strong></p><p>记得我说过密钥环是一个安全特性吗？现在想象一下你在 Linux 电脑上开启了自动登录功能。有权访问你电脑的任何人无需密码就能进入你的系统。但是你可能不会在意，因为你只是用它来访问互联网。</p><p>但是，如果你在 Ubuntu 中使用 Chromium 或 Google Chrome 之类的浏览器，并使用它来保存各种网站的登录密码，那么你将遇到麻烦。任何人都可以使用浏览器并利用你在浏览器中保存的密码登录网站。这不很危险吗？</p><p>这就是为什么当你使用 Chrome 时，它将反复地提示你先解锁密钥环。这确保了只有知道密钥环密码（即账户密码）的人才能使用在浏览器中保存的密码来登录它们相关的网站。</p><p>如果你反复取消解锁密钥环的提示，它最终将消失，并允许你使用浏览器。但是，保存的密码将不会被解锁，你在 Chromium/Chome 浏览器上将会看到“同步暂停”的提示。</p><p><strong>如果密钥环一直存在，为什么你从来没有见过它呢?</strong></p><p>如果你在你的 Linux 系统上从没见过它的话，这个问题就很有道理。</p><p>如果你从没有用过自动登录功能（或者修改你的账户密码），你可能都没有意识到这个特性的存在。</p><p>这是因为当你通过你的密码登录系统时，你的密钥环被你的账户密码自动解锁了。</p><p>Ubuntu（和其他发行版）在执行普通的管理任务如修改用户、安装新软件等需要输入密码，无论你是否是自动登录的。但是对于日常任务像使用浏览器，它不需要输入密码因为密钥环已经被解锁了。</p><p>当你切换到自动登录时，你不再需要输入登录密码。这意味着密钥环没有被自动解锁，因此当你使用利用了密钥环特性的浏览器时，它将提示你来解锁密钥环。</p><p><strong>你可以轻松地管理密钥环和密码</strong></p><p>这个密钥环放在哪里？它的核心是一个守护任务（一个后台自动运行的程序）。</p><p>别担心。你不必通过终端来操作守护任务。大多数桌面环境都自带一个可以和这个守护进程进行交互的图形化应用程序。KDE 上有 KDE 钱包，GNOME 和其他桌面上叫做“密码和密钥”（Password And Keys）。</p><p>你可以用这个 GUI 程序来查看哪些应用程序在用密钥环来管理/保护密码。</p><p>你可以看到，我的系统有自动创建的登录密钥环。也有一个存储 GPG 和 SSH 密钥的密钥环。那个<a href=https://help.ubuntu.com/lts/serverguide/certificates-and-security.html>证书</a>用来保存证书机构颁发的证书（如 HTTPS 证书）。</p><p><img loading=lazy src=/Distributions/230426pr9jj9ifjsgiez9i.png alt="Password and Keys application in Ubuntu"></p><p>你也可以使用这个应用程序来手动保存网站的密码。</p><p>这里有一个潜在的问题，如果你格式化你的系统，手动保存的密码必然会丢失。通常，你会备份你的个人文件，但并不是所有的用户特定数据，如密钥环文件。</p><p>有一种办法能解决它。密钥环数据通常保存在 <code>~/.local/share/keyrings</code> 目录。在这里你可以看到所有的密钥环，但是你不能直接看到它们的内容。如果你移除密钥环的密码（我会在这篇文章的后面描述操作步骤），你可以像一个普通的文本文件一样读取密钥环的内容。你可以将这个解锁后的密钥环文件完整地复制下来，并在其他的 Linux 机器上运行“密码和密钥”应用程序导入到其中。</p><p>总结一下目前为止所学的内容：</p><ul><li>大多数 Linux 系统缺省已经安装并激活了密钥环特性</li><li>系统上的每个用户都拥有他自己的密钥环</li><li>密钥环通常是用账户密码锁定的（保护）</li><li>当你通过密码登录时密钥环会被自动解锁</li><li>对于自动登录，密钥环不会自动解锁，因此当你试图使用依赖密钥环的应用程序时会被提示先解锁它</li><li>并不是所有的浏览器或应用程序利用了密钥环特性</li><li>（Linux 上）安装一个 GUI 程序可以和密钥环交互</li><li>你可以用密钥环来手动存储加密格式的密码</li><li>你可以自己修改密钥环密码</li><li>你可以通过导出（需要先解锁密钥环）并导入到其他计算机上的方式来获取手工保存的密码。</li></ul><h4 id=修改密钥环密码>修改密钥环密码<a hidden class=anchor aria-hidden=true href=#修改密钥环密码>#</a></h4><p>假设你修改了你的账户密码。当你登录时，你的系统试图通过新的登录密码来自动解锁密钥环。但是密钥环还在使用老的登录密码。</p><p>这种情况下，你可以修改密钥环密码为新的登录密码，这样密码环才能在你登录系统时自动解锁。</p><ul><li>从菜单中打开“密码和密钥”应用程序</li><li>在“Login”密钥环上右击并点击“修改密码”：</li></ul><p><a href=https://askubuntu.com/questions/65281/how-to-recover-reset-forgotten-gnome-keyring-password><strong>如果你不记得老的登录密码怎么办？</strong></a></p><p><strong>Resetting everything (delete all passwords and start new keyring):</strong></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ rm ~/.local/share/keyrings/login.keyring
</span></span></code></pre></div><p>Then, log out and log back in. Ubuntu will automatically create a new login.keyring for you.</p><h4 id=禁用密钥环密码>禁用密钥环密码<a hidden class=anchor aria-hidden=true href=#禁用密钥环密码>#</a></h4><p>在你想用自动登录但又不想手动解锁密钥环时，你可以把禁用密钥环密码作为一个规避方法。记住你正在禁用一个安全特性，因此请三思。</p><p>操作步骤和修改密钥环相似。打开“密码和密钥”应用程序，然后修改密钥环密码。</p><p>技巧在于当它提示修改密码时，不要输入新密码，而是点击“继续”按钮。这将移除密钥环的密码。</p><p>这种方法，密钥环没有密码保护，并将一直处于解锁状态。</p><h3 id=gnome-apps>Gnome Apps<a hidden class=anchor aria-hidden=true href=#gnome-apps>#</a></h3><p><a href=https://www.reddit.com/r/gnome/comments/n936xy/gnome_40_how_to_sort_the_app_grid_alphabetically/>Sort the App Grid alphabetically</a></p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ gsettings set org.gnome.shell app-picker-layout <span style=color:#e6db74>&#34;[]&#34;</span>
</span></span></code></pre></div><h4 id=bookshttpswikignomeorgappsbooks><a href=https://wiki.gnome.org/Apps/Books>Books</a><a hidden class=anchor aria-hidden=true href=#bookshttpswikignomeorgappsbooks>#</a></h4><p>GNOME Books is a simple application to access and organize your ebooks. It is meant to be a simple and elegant replacement for using a file manager to deal with ebooks. The app supports comic books and ePub books.</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install gnome-books
</span></span></code></pre></div><p>e-book 需放在特定的目录，gnome-boos 自动扫描，在其他目录不扫描，而且也无法用 <code>gnome-books file</code> 方式打开，例如 ~/Public 目录。</p><h4 id=calendarhttpswikignomeorgappscalendar><a href=https://wiki.gnome.org/Apps/Calendar>Calendar</a><a hidden class=anchor aria-hidden=true href=#calendarhttpswikignomeorgappscalendar>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>$ sudo apt install gnome-calendar
</span></span><span style=display:flex><span>$ gsettings set org.gnome.GWeather temperature-unit centigrade
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags><li><a href=https://sakamotokurome.github.io/tags/unix/>Unix</a></li><li><a href=https://sakamotokurome.github.io/tags/linux/>Linux</a></li><li><a href=https://sakamotokurome.github.io/tags/ubuntu/>Ubuntu</a></li></ul><nav class=paginav><a class=prev href=https://sakamotokurome.github.io/posts/ubuntup1applications/><span class=title>« Prev Page</span><br><span>Ubuntu Applications</span></a>
<a class=next href=https://sakamotokurome.github.io/posts/hexo/><span class=title>Next Page »</span><br><span>Hexo</span></a></nav></footer></article><script src=https://giscus.app/client.js data-repo=SakamotoKurome/SakamotoKurome.github.io data-repo-id=R_kgDOGhTL4w data-category=Announcements data-category-id=DIC_kwDOGhTL484CSh4m data-mapping=pathname data-strict=0 data-reactions-enabled=1 data-emit-metadata=0 data-input-position=top data-theme=dark data-lang=en data-loading=lazy crossorigin=anonymous async></script></main><footer class=footer><span>&copy; 2023 <a href=https://sakamotokurome.github.io/>Sakamoto Kurome</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script></body></html>