<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Di Shi Zhi Hui | Sakamoto Kurome</title>
<meta name=keywords content="Dairy">
<meta name=description content="23030816 需求：备份一个 repo 到另一个 github 账号的 repo，首先需要同步所有分支，然后更改 remote url，最后推送所有分支到新仓库。 How do I fetch all Git branches? How do I change the URI (URL) for">
<meta name=author content="Sakamoto Kurome">
<link rel=canonical href=https://blog.g7n3.me/posts/dishizhihui/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.06402d745029223a9231706eea1dd82e107754f4ad625acbe7fd336a5e59566c.css integrity="sha256-BkAtdFApIjqSMXBu6h3YLhB3VPStYlrL5/0zal5ZVmw=" rel="preload stylesheet" as=style>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=https://blog.g7n3.me/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=https://blog.g7n3.me/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=https://blog.g7n3.me/favicon-32x32.png>
<link rel=apple-touch-icon href=https://blog.g7n3.me/apple-touch-icon.png>
<link rel=mask-icon href=https://blog.g7n3.me/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.90.0">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
</noscript>
<link rel=stylesheet href=https://blog.g7n3.me/custom.css>
<meta name=google-site-verification content="i2r403EffR8m-KBf7EHi6AYg7tfnMshaXTAynoYPnpE">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-K2Y212LPQ2"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag('js',new Date),gtag('config','G-K2Y212LPQ2',{anonymize_ip:!1})}</script>
<meta property="og:title" content="Di Shi Zhi Hui">
<meta property="og:description" content="23030816 需求：备份一个 repo 到另一个 github 账号的 repo，首先需要同步所有分支，然后更改 remote url，最后推送所有分支到新仓库。 How do I fetch all Git branches? How do I change the URI (URL) for">
<meta property="og:type" content="article">
<meta property="og:url" content="https://blog.g7n3.me/posts/dishizhihui/"><meta property="article:section" content="posts">
<meta property="article:published_time" content="2023-08-24T14:33:34+08:00">
<meta property="article:modified_time" content="2023-08-24T14:33:34+08:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Di Shi Zhi Hui">
<meta name=twitter:description content="23030816 需求：备份一个 repo 到另一个 github 账号的 repo，首先需要同步所有分支，然后更改 remote url，最后推送所有分支到新仓库。 How do I fetch all Git branches? How do I change the URI (URL) for">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://blog.g7n3.me/posts/"},{"@type":"ListItem","position":2,"name":"Di Shi Zhi Hui","item":"https://blog.g7n3.me/posts/dishizhihui/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Di Shi Zhi Hui","name":"Di Shi Zhi Hui","description":"23030816 需求：备份一个 repo 到另一个 github 账号的 repo，首先需要同步所有分支，然后更改 remote url，最后推送所有分支到新仓库。 How do I fetch all Git branches? How do I change the URI (URL) for","keywords":["Dairy"],"articleBody":"23030816   需求：备份一个 repo 到另一个 github 账号的 repo，首先需要同步所有分支，然后更改 remote url，最后推送所有分支到新仓库。\n How do I fetch all Git branches? How do I change the URI (URL) for a remote Git repository? Set up git to pull and push all branches  git branch -r | grep -v '\\-' | sed \"s,\\x1B\\[[0-9;]*[a-zA-Z],,g\" | while read remote; do git branch --track \"${remote#origin/}\" \"$remote\"; done git fetch --all git pull --all # change the URLs git remote set-url origin new.git.url/here # push tags and branches. git push --all origin   20230812   Web 调试\n ❤️❤️超详细的fiddler教程【原理+功能讲解+实战（应用场景）】❤️❤️ - 简书 使用 Whistle 作为你的 Web 调试工具吧 - 知乎 Wireshark使用教程_俭平的博客-CSDN博客    safari 上哪个拓展的拦截最好用？ - V2EX\n  远程兼职一年后 - Hyoban： Grow in Public 文档\n  让你的飞书更好用：破解飞书的复制限制\n  信息收集之js文件 | 安全小白团\n  bregman-arie/devops-exercises\n  用了很久的全拼改为双拼值得吗？ - 韦易笑的回答 - 知乎\n  Deploying IPFS on Linux with Docker Containers\n  ipfs/kubo - Docker Image | Docker Hub\n  Install IPFS Kubo inside Docker | IPFS Docs：主要看这个部署单个节点\ndocker logs -f ipfs_host docker exec ipfs_host ipfs    ipfs/ipfs-cluster - Docker Image | Docker Hub\n  IPFS Cluster | IPFS Docs\n    20230811  ga-tracker：适用于UniApp和微信小程序的谷歌统计 (Google Analytics) SDK，只支持 Universal Analytics，即形式如 UA-XXXXXXXX-1 的 ID。（2023 年 7 月 1 日起就用不了了，最后我直接将 script 代码放到 index.html head 中去了，不知道起不起作用） Google Analytics分析终极入门指南  20230809  List of applications - ArchWiki：Arch Wiki 万岁，可以很方便地去找 Linux 下的各种工具及其 wiki。 NCurses Disk Usage PHP 设置 UTC 0 时区时间：默认就是 UTC 0 时区时间；或者指定 timezone 为 UTC；再或者设置为格林威治当地时间 Etc/Greenwich，其值与 UTC 0 时区时间相同。   date_default_timezone_set\n  Setting timezone to UTC (0) in PHP：\necho date('Y-m-d H:i:s T', time()) . \"\n\\n\"; date_default_timezone_set('UTC'); echo date('Y-m-d H:i:s T', time()) . \"\n\\n\";   Is there a difference between the UTC and Etc/UTC time zones?: That is, they’re long and short names for the same timezone\n   iOS 终于支持了 PWA，一起来认识一下这个强化版「小程序」 | 科普 - 少数派 如何用 Xcode 安装 Github 中的未上架 iOS App - 少数派 写给5年前端妹子的三万字脚手架教程 - 掘金 macOS 平台最好的 PDF 阅读器是什么？ - 知乎：对于绝大部分人来说 Preview.app 是最佳的选择。系统自带、速度极快、兼容性尚可、有基本的编辑功能、支持批注。只有极少数需要填表、数字签名、高级编辑的情况下才会需要 Acrobat。  20230808  Java8 是没有 Mac M1 版本的，但是 Java11 有，虽然 On Java8 用的是 Java8，但是还是只能安装 Java11 了，Java11 是继 Java8 使用率最高的 LTS。 How to pronounce “Gradle”?: /'ɡreɪdl̩/ Gradle从0入门到实战系列 环境变量除了 PATH 外（即原本有的），不能放在 .zprofile 中，通过 env 即可查看添加的环境变量没有生效，而应该在 .zshrc 中进行 export。 How to prevent Homebrew from installing a certain formula dependency?: brew install --ignore-dependencies formula  20230807  JSON fromatter：可以将 json file 键去重 How to find out the virtualization type of an linux VPS?: hostnamectl status  20230805   【 seq 】コマンド――数字の列を出力する\n  Linux envsubst Command with Examples\n  Deploying Redis on Linux with Docker Containers\n redis - Official Image | Docker Hub Docker で Redis コンテナを作る方法 Docker搭建Redis Cluster集群及扩容和收容：至少6个节点。    Deploying RabbitMQ on Linux with Docker Containers\n rabbitmq - Official Image | Docker Hub Docker Composeで立てたRabbitMQにpikaで接続してみる - Qiita java - 手把手教你搭建 RabbitMQ 集群 - 个人文章 - SegmentFault 思否    husky\n  husky: yarn add -D husky\n  commitlint:\n# Install commitlint cli and conventional config yarn add -D @commitlint/{config-conventional,cli}; # Configure commitlint to use conventional config echo \"module.exports = {extends: ['@commitlint/config-conventional']}\"  commitlint.config.js; # add hook npx husky add .husky/commit-msg 'npx --no -- commitlint --edit ${1}'   lint-staged\n    每周轮子之 husky：统一规范团队 Git Hooks\n  hook was ignored because it’s not set as executable: I think it’s probably a problem that wasn’t created taking into account the file permissions of Linux at the time of init on Windows. chmod ug+x .husky/*\n    Docker privileged オプションについて：允许容器中运行一些特权命令，比如调用宿主机的所有设备。\n  Defining an array as an environment variable in node.js：通用的是 split()，还有一种是 JSON.parse()\nFESTIVALS = \"bonnaroo, lollapalooza, coachella\" var festivals = process.env.FESTIVALS.split(\", \"); ANY_LIST = [\"A\", \"B\", \"C\"] const LIST = JSON.parse(process.env.ANY_LIST);   vscode markdown 中 ```shell语法基本上没颜色 怎样添加？：grep rm find 等这些并不是 shell 里的关键字，而是需要特定环境变量，所以没高亮，而比如 if then cd 等这些会高亮的。\n  no matching manifest for linux/arm64/v8 in the manifest list entries：这个原因是M1的CPU是linux/arm64/v8，但是想要使用的image不支持这个；指定模拟 platform: linux/amd64 就可以正常运行了。\n  COPY with docker but with exclusion: Create file .dockerignore in your docker build context directory。.dockerignore 文件从入门到实践\n  问题：我有一个 Nest.js 项目，它需要的基础服务有 MySQL、Redis 和 RabbitMQ，然后我将它们放到一个 docker-compose.yml 文件中进行部署，遇到的问题是 nest.js 服务无法连接数据库，但是进入容器后是可以直接用 container_name 和容器 ip 地址连接上数据库的。\n  这里 Prisma doesn’t resolve the names of docker containers from within other containers in OSX Docker 有一个讨论，反正我尝试了依旧没用，所以决定单独部署 api，不再浪费时间了。\n  env_file：可以将 enviroment 部分都放到文件中去，docker-compose.yaml 也支持 project-${VAR} 使用环境变量。\n  docker-compose 手工指定容器IP - 永远的幻想 - 博客园: ipam\n  Access mysql remote database from command line:\napk add mysql-client mysql -u {username} -p'{password}' \\ -h {remote server ip or name} -P {port} \\ -D {DB name}   Build a real-time chat application with Nestjs and PostgreSQL\n    20230804   需求：评论要显示刚刚、几分钟前、几个小时前、几天前、几个月前等等状态。考虑使用现成库，但是要注意将时间转换为相同时区再计算。\n  现状：Response Header 返回的是没有时区差的标准 UTC 时间 Fri, 04 Aug 2023 07:10:11 GMT，Response Body 返回的内容的时间是服务器所在日本本地时间 2023-08-04 15:08:28，dayjs() 返回的是客户端（中国）本地时间 Fri Aug 04 2023 15:19:17 GMT+0800 (China Standard Time)。\n  相关文章\n Day.js | 更优雅的处理JavaScript中的日期 Day.js：Moment.js 的 2kB 轻量化方案  RelativeTime：相对时间 国际化 (i18n) 时区  UTC Timezone     ISO格式的UTC时间与本地时间的互相转化 聊一聊 GMT、UTC 以及 ISO8601 时区名称：List of tz database time zones 或 タイムゾーン一覧    解决方案：将 Body 返回的日本时间解析成当时的 UTC 时间；获取当前 UTC 时间；两者计算相对时间；然后加入国际化。\nimport dayjs from 'dayjs' import utc from 'dayjs/plugin/utc' import timezone from 'dayjs/plugin/timezone' import relativeTime from 'dayjs/plugin/relativeTime' import 'dayjs/locale/zh-cn' dayjs.extend(utc) dayjs.extend(timezone) dayjs.extend(relativeTime) const commentCreateTimeUTC = dayjs.tz('2023-08-04 17:18:28', 'Asia/Tokyo') const nowTimeUTC = dayjs.utc() console.log('relative time: ', nowTimeUTC.locale('zh-cn').to(commentCreateTimeUTC))     我觉得写代码有两种状态，一种状态是使用非常合适的非常好用的库，可以非常简单方便的实现各种需求，几行代码就可以达到非常不错的效果；另一种状态，就是不存在这样合适的库，这种情况，要么是使用不那么合适的库，结果你需要各种 Hack，代码写的很乱，几百行都不够，要么就是自己去实现一个合适的好用的库，当然这个不仅花费时间更长，对开发者的要求更高。我们都认同，合适的工具能够达到事半功倍的效果，在编程的世界里，就是找到那些合适的编程语言、框架、库来实现自己的需求，找不到就去实现；这就是编程的乐趣，你既可以成为工具的受益者，也可称为工具的创造者。（PS：使用 dayjs 有感）\n  20230803   类似 ts-ignore 忽略某行的类型检测，可以用 eslint-disable-next-line 忽略某行的 ESLint 规则，参考 Disabling Rules\n  UI Bakery RegEx Library，正则表达式规则集，常用的根本不需要自己写\n  classnames 方法，用于将多种类型变量合并成 css class 的值（string）。\n  Deploying MySQL on Linux with Docker Containers\n mysql - Official Image | Docker Hub：例子过于简单 Mysql 的 Docker 部署文档：之后 docker 命令的例子 docker-compose でMySQL環境簡単構築：单个 MySQL 服务 How to create Master-Slave MySQL 8 with docker-compose.yml/MySQL 主从复制原理及配置： MySQL服务的主从架构 A step by step how to start docker-compose container at boot：Container 使用 restart: always 后会跟随 Docker daemon 一起启动。    ProgrammersLevelUp：用20年时间跟着皓叔刷“程序员练级攻略”。\n READ: 《入门篇》和《专业基础篇》中的那些书和文章，你肯定是得认真精读的，这是基础。 WRITE: 你需要完成一个能用的项目，对于选择什么样的项目，这里，我也有几个建议。第一，从自己的痛点出发，写一个能解决自己问题的东西。第二，临摹别人的作品，复刻一个其它的成功产品。有人说，学好一门语言或是一个开源软件最好的方式，就是用想学 / 喜欢的编程语言翻译下这个开源软件，比如，你用 Go 语言翻译一下某个 Java 的组件。第三，深度参与一些你喜欢的开源项目。第四，在工作中找到风险可控的项目和需求。    20230802   自动国际化/多语言/i18n\n 前端自动国际化解决方案：通过 \\p{Han} 这个正则，就可以写一个脚本，将原本中文翻译成英文并替换为 $t('English') 或 t('English')，同时所有中文提取到一个文件中用于接下来的翻译。  How to match chinese characters with grep?: cat /tmp/test | grep -P '[\\p{Han}]'，参见 Unicode Scripts。 JS 中的 Unicode：修饰符 “u” 和类 \\p{…}/Javascript unicode string, chinese character but no punctuation: /\\p{Script=Han}/u.test(char))   i18n-ally：vue-i18n 官方推荐的插件，配置好了后就大大减轻了工作了，虽然还是需要调整。   Doesn’t work with Vue and vuex-i18n：我安装好后发现只识别 vi.json 文件，之后通过查看 output 中 i18n-ally 的 log 发现其他语言文件语法错误，最后一个键值对带了逗号，导致 i18n-ally 报错。\n  配置 sourceLanguage=\"locale\" 即提取的键值存到对应的 locale.json 文件中；displayLanguage=\"locale\" 即能够将 $t(‘key’) 中的 key 映射为 locale.json 中 key 对应的 value，从而实现预览。\n  现代 Vue 工程之「国际化 i18n 开发」 - JOYK Joy of Geek, Geek News, Link all geek\n  Nuxt3 下配置如下\n{ \"i18n-ally.localesPaths\": \"./lang\", \"i18n-ally.keystyle\": \"nested\", \"i18n-ally.sourceLanguage\": \"zh-CN\", \"i18n-ally.displayLanguage\": \"zh-CN\", \"i18n-ally.sortKeys\": true, \"i18n-ally.keepFulfilled\": false, \"i18n-ally.pathMatcher\": \"{locale}.{ext}\", \"i18n-ally.enabledParsers\": [ \"json\", \"json5\" ], \"i18n-ally.translate.engines\": [ \"google\", \"google-cn\", \"deepl\", ], \"i18n-ally.translate.deepl.useFreeApiEntry\": true, }       Regular-Expressions.info\n  多语言切换，域名会变成服务器的私有 IP 10.2.0.10，再刷新后又正常了，在本地测试没有问题，但是实际上线后就有这个问题。\n 之前为了获取语言切换后后台返回的多语言数据，使用了 window.location.reload()，现在考虑不用，而是在语言切换的时候重新请求相关的接口；但是之前请求用的是 cookie，会比语言切换慢一步，比如从中文=日文=繁体，那么选择日文展示的是之前选择的中文，选择繁体展示的是之前选择的日文，因此考虑用 pinia store 这个状态管理来存 locale，这样就可以获取最新的值；但是第一次使用时会检测浏览器默认语言，store 就没办法知道了检测的值了，只能考虑同时用 store 和 cookie，store 默认值为空，这样第一次用 cookie 的值。关于重新请求接口，Nuxt3 有一个 refreshNuxtData API，重新请求当前页面请求的 API，其他的则需要手动重新请求。 上面修改多语言行为后，发现没有解决跳向私有 IP 的问题，问题重新描述为—— npx nuxi generate 生成静态文件，通过 Nginx 部署到服务器，访问的时候如果 reload 页面，会跳到服务器局域网 IP。   具体描述：直接 https://testweb.iruca.ai/create 会跳到 http://10.2.0.10/create； 但 https://testweb.iruca.ai/abcd 正确显示 404，因为正确 404 了，我猜测应该是前端的问题，但是前端实在找不到问题在哪里。之后我又尝试了 https://testweb.iruca.ai/create/（多了个斜杠），发现可以访问了，因此猜测是 nginx 配置问题。之前一访问就直接跳转了，其实可以用 curl -i https://testweb.iruca.ai/create 可以查看跳转前的内容，显示为 301 Moved Permanently（最好用这个来测，由于浏览器有缓存，更改 nginx 后并不能马上在浏览器上看到结果，还以为修改的无效呢！）。配置 Nginx 将 try_files 行中的 $uri/ 替换成了 $uri/index.html，问题就被解决了。\n  Nginx二级子路径请求，如何去掉尾部多余的\"/“以及避免301重定向请求：导致 301 是 Nginx 默认行为——当访问URI时，如果访问资源为一个目录，并且URI没有以正斜杠（/）结尾，Nginx 服务就会返回一个301跳转，目标地址就是加一个正斜杠。\n  搞懂前端技術名詞 SSR與SPA：这次部署的就是 SPA 应用，特点是生成的 index.html 文件的主要内容是挂载点 ，部署的特点是始终返回这个 index.html，nuxt 生成的静态文件中，pages下的页面都单独一个目录，目录中都是内容完全一样的 index.html。\n  Prepare NuxtJS for static deployment • Today I Learned：Nuxt SPA 部署的 Nginx 配置可以参考这个。\nlocation /. { # Remove trailing slash and redirect it  rewrite ^(.+)/+$ $1 permanent; # Redirect index.html  rewrite ^(.+)/index.html$ $1 permanent; # Serve folder path via index.html  try_files $uri $uri/index.html =404; # Serve a custom static error page  error_page 404 /404.html; }       Nginx\n Nginx 极简教程 连前端都看得懂的《Nginx 入门指南》：代理其实就是一个中介，A和B本来可以直连，中间插入一个C，C就是中介。刚开始的时候，代理多数是帮助内网client访问外网server用的（比如HTTP代理），从内到外 . 后来出现了反向代理，“反向\"这个词在这儿的意思其实是指方向相反，即代理将来自外网client的请求forward到内网server，从外到内。 增加nginx虚拟主机配置文件(conf.d)：域名.conf 只是一个用于区分的名字而已。 nginx配置url重写 Nginx 的正确发音是？：恩静克思 [ˈendʒɪnks] Nginx的server_name和location配置    现代 JavaScript 教程\n  20230731  维基百科有一个 Simple English 的版本，用最常用的单词解释各种事情。 coinphd 的 admin 项目的路由，不是那种固定的路由，不像 nuxt 或 uniapp 那样，在 pages 目路下的路径就是路由路径，uniapp 还需要修改 manifest.json，而 nuxt 则是完全不需要了。admin 项目是根据调用 api 返回的路由数组，在全局前置守卫中动态地添加对应的路由。总的来说，路由方便程度 nuxt(web)  uniapp(mobie)  vite(admin)，路由安全程度及自由程度 vite(admin)  uniapp(mobie)  nuxt(web)。 不论是前端、后端还是运维，掌握程序运行流程是开发的前提，一个是你要知道如何看现有的代码，一个是你要知道到哪里去改代码。就前端来说，运行流程就是路由，你在浏览器上输入网址，网址对应具体的页面，而该页面就是执行特定的代码文件所产生的，而你的任务就是根据网址找到对应的执行文件；像 Nuxt、Next 这种，网址的路径对应 pages 下的路径，就比较简单直接；像 uniapp、antd 这种，网址与执行文件由路由配置来进行映射，这种关键就是找到路由配置文件。就后端来说，与前端基本上一致，像 Nest 这种，路由就自动对应着 routes 目录下 controller 文件；像 PHP 这种，默认路由就是在 controller 目录下的路径，但是也可以通过配置文件来进行配置。就运维来说，执行文件变成了运行的 docker，你的任务，就是根据特定的域名，找到对应的docker容器，将来自互联网的请求交予它处理。掌握了路由后，你就可以在路由的某个阶段，或者某个路由中添加东西了，进行开发了。万事开头难，掌握了第一步后，接下来的就简单了。你看图灵机，程序的本质，就是按照顺序执行一个又一个的任务的，面向过程、面向对象、函数式等编程方法，还有各种框架，各种工具辅助等等，本质还是按照顺序执行一个又一个的任务，而要去理解，也就是自己去按照顺序执行一个又一个的任务。 项目中前端如何实现无感刷新 token！：评论很有意思。  第一种，accessToken + refreshToken：accessToken的特点是使用频繁但有效期短。使用频繁是因为它会在每个请求中传输，所以它更容易泄露。refreshToken的特点是有效期长，但使用频率很低。它长期存在本地，不会随着每个请求传输，所以不容易泄露，但又能延长真正的过期时间。所以两个token的搭配，既保证了用户可以长时间不退出，又尽量降低了token泄漏的风险。 第二种，单token后端动态延长有效期：当用户一直在操作页面调用接口且当前token没过期时，后端统一在拦截器中自动续时确保token永远不会过期，这样就可以避免突然让用户去登录。当用户长时间未操作页面token失效时，拦截器返回401跳转登录。也起到使用token鉴权的目的。    20230729  2023 年香港手机卡完全攻略：hahasim 程序员劳动法赔偿 101 WARP：旨在确保您的数据在传输过程中得到保护，不是用来让你访问受地理限制的内容的。  WARP现已问世 WARP+ 刷无限流量   aircrack-ng 破解 WIFI 密码: https://github.com/conwnet/wpa-dictionary Stable Diffusion 新手入门手册：像素图片模型 Pixel art style xLog  五分钟拥有一个区块链和 IPFS 上的去中心化博客 从 xLog 到加密币：区块链小白的购币指南   Coursera（/kɔːrsˈɛrə/） 如何用3个月零基础入门「机器学习」？ 网易公开课vs网易云课堂：网易公开课能学到幸福是什么、公正的意义等等具有普世价值的形而上层面的内容，而云课堂则更加入世，直接教你谋生的技能。两者的部分免费课程有重叠，但是凡事免费内容，都可以在BiliBili 找到的。  20230726  如果发现 vscode 报错 Cannot find module，但是 tsconfig.json 确实配置好了的，可以考虑重启 vscode，这样就行了。 聊聊 EventStream 服务器端推送 JS 中的 Reflect 和 Proxy CSS gap属性进化史 String.prototype.split() 是支持正则表达式的。 Microsoft Learn：Microsoft 的教程！  区块链开发入门 机器学习简介   Blockchain  区块链入门指南 blockchainHome    20230725  PHP 部署问题  file_put_contents (/chat/server/runtime/cache/…): Failed to open stream: No such file or directory  file_put_contents：没有文件就创建前提是——你资源路径得存在，并且有权限 在docker-compose.yaml中，./server 目录是 mount 到容器的 chat/server/，因此实际是问题是 ./server/runtime/ 不存在或者没有权限，解决办法就是创建或者加权限 还是没有仔细的看报错，而是去试各种方法期望能幸运地解决问题，对 PHP 有一种新人的恐惧，停留在不知道、不了解的心理状态，失去了对 PHP 的深入学习的动力。   SQLSTATE php_network_getaddresses: getaddrinfo failed: Temporary failure in name resolution：原因是没有添加 .env 文件，也就没有提供 mysql host。 Turning expose_php OFF in php.ini：the X-Powered-By header. 关键文件：server 即为 thinkphp 项目根目录，被直接 mount 到 docker 中  /server/.env 环境变量 /server/runtime 应用的运行时目录，是一个存储程序运行时生成的临时文件的地方。通常，它包含了缓存文件、日志文件、临时文件等，这些文件不是程序的核心部分，但是却非常重要。在程序运行过程中，这些文件可以被动态生成和更新，以满足程序的运行需求。当程序关闭后，这些文件通常会被删除，因此它们不会对系统造成永久性的影响。 /server/public/uploads 上传或者生成的图片等资源 /server/public/debug.txt file_put_contents('debug.txt', 'info') 输出位置     Nested CSS was detected, but CSS nesting has not been configured correctly：uniapp 项目，给  添加上 lang=\"scss\" 属性就行了—— 谈谈像素以及微信小程序的 rpx TypeScript 中的代码清道夫：非空断言操作符：ts变量函数后面的感叹号有什么用处？  20230722   OAuth2\n  理解OAuth 2.0：在前后端分离的项目中，客户端是前后端的整体，具体某个步骤由前端执行还是后端执行，在不同的实现之中并不相同。\n 流程如下：  用户访问客户端，后者将前者导向认证服务器。（client_id） 用户选择是否给予客户端授权。 假设用户给予授权，认证服务器将用户导向客户端事先指定的\"重定向URI”（redirection URI），同时附上一个授权码。 客户端收到授权码，附上早先的\"重定向URI”，向认证服务器申请令牌。这一步是在客户端的后台的服务器上完成的，对用户不可见。（client_secret） 认证服务器核对了授权码和重定向URI，确认无误后，向客户端发送访问令牌（access token）和更新令牌（refresh token）。   实现方式：要理清，就需要抓住关键的输入参数，分别是 client_id、client_secret、redirect_uri，这些参数由前端给还是后端给，就导致实现的不同。  前后端交互 OAuth 认证：参见前后端分离基于Oauth2的SSO单点登录怎样做？图示。这种方式，前端用 client_id 去获取授权码 code，redirect_uri指向前端，然后前端将 code 传给后端，后端用 client_secret 去获取 access_token，最后生成 token 给前端。 后端 OAuth2 认证：例如 passport-google-oauth20。在这种方式中，前端只需要添加一个指向后端链接，剩下的所有操作都由后端完成；redirect_uri 指向后端，后端通过 client_id 和 client_secret 去获取授权码 code 与 access_token，最后生成 token 给前端。      How to send JWT to front end server after successful login for storage on localStorage?：在后端 OAuth2 认证认证方式中，所有操作都在后端执行，后面就有一个向前端发送 token 的问题。可以参考文章 NODE AUTHENTICATION WITH GOOGLE OAUTH: PART 2 (JWTS)\n redirect 到前端，token 放在 url 中，如果 CDN 缓存了 token，会导致安全问题。 redirect 到前端，url 中放一个一次性的 code，前端再去 code 请求 token。 同域直接种植 Cookie，然后 redirect 到前端。 window.open \u0026 window.postMessage 方式：前后端分离下的第三方登陆处理（最优）   Why does JavaScript “window.postMessage” create duplicate messages?\nconst receiveMessage = (event)= { window.removeEventListener('message', receiveMessage, false); console.log(event.data) // do something else } window.addEventListener('message', receiveMessage, false);   Specifying multiple targetOrigin uris in postMessage：postMessage 不支持多个域名，只能重复发送了\ntargetWindow.postMessage(message, \"https://domain1.com\"); targetWindow.postMessage(message, \"https://domain2.com\");   Open a URL in a new tab (and not a new window): window.open(url, '_blank').focus();\n      移花接木：针对OAuth2的CSRF攻击：加入了 state 后，攻击者需要被攻击者的 cookie，攻击者的 Authorization Code，随机的 state 才能攻击进入被攻击者的第三方账户。\n    CORS\n Cors跨域(一)：深入理解跨域请求概念及其根因 Cors跨域(二)：实现跨域Cookie共享的三要素：服务器要向不同域名的网站种植 Cookie，要求服务器 Access-Control-Allow-Credentials为true、客户端请求withCredentials为true。 Cors跨域(三)：Access-Control-Allow-Origin多域名？ Cors跨域(四)：解决方案对决JSONP vs CORS    PHP使用OAuth2实现Google登录：从前端获取授权码\n  20230721  setTimeout 与 setInterval —— 实现优雅轮询：使用 setTimeout 做轮询比 setInterval 更好。 5000 多字，让你一文掌握 TS 枚举：可以直接打印 enum 看看数据结构是怎么样的；要遍历 ts enum，要么用字符串枚举，要么通过 isNaN(Number(item)) 过滤掉数字枚举数字；但是不推荐使用在运行时代码逻辑里，因为 enum 用于类型定义，只不过由于TS设计的特殊性它混入了运行时。 socket 到底是个啥  20230720  Safari Reader 打印 PDF。  腾讯云开发者社区的文章很适合打印的。 对于 51CTO，主要是行号导致的问题，通过代码删除：document.querySelectorAll('.pre-numbering').forEach(item = item.parentElement.removeChild(item))   微前端究竟是什么？微前端核心技术揭秘！  20230719   PromptArt 图片提示词优化\n  Mac-AI-fy 智能化操作\n  Can HTTrack download a subdirectory?:\nhttrack www.example.com/subdirectory/ -D -O \"C:\\Users\\subdirectory\" -D makes it so the process “can only go down into subdirs”。注意 subdirectory 要带反斜杠，即 subdirectory/\n  表达式全集\n  grep -P no longer works on MacOS.: brew install grep\n  20230718   Mobile （uniapp）写的多语言选择没有显示出来（why？），在本地测试是有的啊！草！经过查找发现是 GitHub PAT 过期了，报错 Support for password authentication was removed on August 13, 2021.。\n  博客：Eric Fu\n  0xaaiapiphp\n  Error: php@7.4 has been disabled because it is a versioned formula!: 原因是php7.4已经不在维护，可通过第三方源安装（注意，下面都是用 docker 进行开发，其实是不需要安装 php 的）\nbrew tap shivammathur/php brew install shivammathur/php/php@7.4   OrbStack：替代 Docker Desktop。项目整体用 docker 来开发测试，后面也直接通过此方式来部署。项目是直接将源文件 mount 到容器中，所以更改之后能够立马测试。若说 redis 与 mysql 可以远程，但是 php-fpm 与 nginx 则是必须的，所以直接本地开发还是比较麻烦的。通过看 docker-compose.yml 来了解项目是怎样运行的，核心是 nginx 的配置，root 指向 ThinkPHP 的入口文件；php-fpm 用的likeshop/php:8.0.22-fpm镜像，这个镜像在 Google 中搜不出来，需要到 Docker Hub 中先搜索 likeshop 仓库，然后进入 likeshop/php 镜像页面中选择 tag。\n  Clash 启用自定义DNS后，系统本地的hosts文件解析被绕过了：Change default system ignore list\n  Mysql docker container keeps restarting: 是因为下面这一句，docker 容器将 lib 目录挂在在了系统目录上，我以为是我需要配置的，因此是直接复制过来的，但实际是容器本身的内容给挂载出来。我的系统是 arm，服务器是 amd4，因此不断重启。\n./config/mysql/mysql5.7.29/lib:/var/lib/mysql   DBeaver Restore a database from a SQL export:\n Right-click the database and click Tools  Execute script. dbeaver: native client is not specified for connection: “Local Client …” = “Browse …” = mysqldump executable Mac OS X 快速访问根目录的4种方法：使用快捷键 Command + Shift + G 快速激活“前往文件夹”功能 Install only mysqldump on macOS: brew install mysql-client Can’t connect to local MySQL server through socket ‘/tmp/mysql.sock’: Changing host from localhost to 127.0.0.1 helped. ‘Access denied; you need (at least one of) the PROCESS privilege(s) for this operation’ when trying to dump tablespaces: --no-tablespaces      Javascript中对象如何检查key（键）是否存在：in操作符、hasOwnProperty方法。\n  Omniinfer: Fast and cheap AI image generation API.\n  PhpStorm：\n Single Click To Open File：project 的设置图标  Enable Preview Tab Always Select Opened File Presss Ctrl+R or select Edit | Find | Replace from the main menu to open the Replace in File window.   升级 macos 13 后 intellij 系列编辑器闪屏?：在 Help | Edit Custom VM Options 添加配置项目 -Dsun.java2d.metal=false How to use directly function key (F1 - F9) instead of pressing fn + function key in IDE in OSX?: Preferences  Keyboard  Shortcuts  Function Keys，之后用 fn + function key 方式来调亮度与声音等。 IntelliJ - Upper|Lower: ⌘ + Shift + U 全局查找文件：Shift + Shift 全局查找文件内容：Command + Shift + F IDEA 如何快速跳到下一行：Command + Shift + Enter    20230717  Paypal怎么用？Paypal使用教程详解 一起学Docker JS URL()和URLSearchParams() API接口详细介绍 【前端开发技巧】npm install xxxx –legacy-peer-deps到底做了些什么？ 彻底搞懂Vue中的Mixin混入（保姆级教程） 教你如何实现单卡iPhone实现双卡双待。  移动卡：无忧行（打电话、收短信）+和飞信（发短信） 两台 iPhone：iMessage 短信转发+呼叫转移   折磨人的携号转网：看清楚这4点再动手！：携号转网每个运营商 App 都有通道并且有教程。  CXXZ#用户姓名#证件号码 发送至拟转出的运营商（电信10001，移动10086，联通10010） SQXZ#用户姓名#证件号码 申请授权码   携号转网，用不完的话费余额怎么办？ iCloud账号转区教程 2022最全美版Paypal注册教程（绑定美版Apple ID+如何解除风控+注意事项）  20230715  CGI是什么 How To Install PHP 7.4 and Set Up a Local Development Environment on Ubuntu20.04：~~其实可以直接通过 docker 运行，这样就可以不考虑平台了。~~只用于部署的话，docker很合适，但是用于开发的话，就不大方便了，但不是不行。 How to develop PHP inside a Docker Container using VS Code：核心是 devcontainer.json，不过要考虑到 apple m1 是 arm 而不是 amd64，这个可能导致问题，arm 服务器并不是主流。 LearnKu：LearnKu 诞生的故事 Python常用魔术方法：魔术方法在类或对象的某些事件出发后会自动执行，让类具有神奇的“魔力”。如果希望根据自己的程序定制自己特殊功能的类，那么就需要对这些方法进行重写。 压缩即泛化，泛化即智能 关于SIM和eSIM，看这一篇就够啦！ DigitalOcean是如何计算费用 DNS域名解析中A、AAAA、CNAME、MX、NS、TXT、SRV、SOA、PTR各项记录的作用 Azure免费服务用量注意点集合，避免扣费暗坑  20230714  如果是 PC 跳到 web.iruca.ai，如果是 Mobile 跳到 m.iruca.ai：方法就是加一个判断，然后跳转；可以在服务端判断，也可以在客户端判断；可以用 UserAgent 判断，也可以通过 viewport 尺寸来判断。   Detect Mobile Browsers\n  VUE判断当前设备是PC还是移动端\nexport function useWebSelection() { const pcDomain = import.meta.env.VITE_PC_DOMAIN || '' const mobileRegex = /(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i const isMobile = navigator.userAgent.match(mobileRegex) const isWide = matchMedia('(min-width: 1200px)').matches if (!isMobile \u0026\u0026 isWide) { window.location.href = pcDomain } }     20230713  经验  Apifox：API 文档、API 调试、API Mock、API 自动化测试 Mac 配置  安装 Xcode Command Line Tools，包含 git：xcode-select --install 安装 Clash for Windows 或 ClashX/ClashX Pro：否则无法安装 Homebrew。推荐 ClashX Pro 搭配 Clash Premium 开启 Enhanced Mode （tun 模式）使用。 安装 Homebrew：/bin/bash -c \"$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)\" 开启 openssh server：How to Turn On SSH on Mac 安装 Caffeine: Don’t let your Mac fall asleep. 复制配置文件：.oh-my-zsh、.zshrc、.zprofile、.npmrc、.ssh、.vimrc 安装开发 GUI 工具：item2、visual-studio-code、google-chrome、firefox、tailscale、postman、dbeaver-community、another-redis-desktop-manager 安装开发 CLI 工具：node@16、yarn、rust、openjdk@11 克隆公司仓库：coinphd、iruca 克隆个人仓库：dishizhihui-codes、dishizhihui-logs 安装其他软件：lark、wpsoffice、shottr、adrive、vlc、keyboardcleantool、neteasemusic 复制目录 Movies；备份 Projects      20230712   How to copy with cp to include hidden files and hidden directories and their contents?\n# 将 dir1 复制到 dir2 下，即 dir2/dir1 cp -av dir1 dir2 # 将 dir1 的内容复制到 dir2 目录下 cp -av dir1/. dir2 cp -av dir1/ dir2   COINPHD 项目技术栈\n  Vue3\n  组合式API\n  6 个你必须明白 Vue3 的 ref 和 reactive 问题（入门篇）\n  Vue.js Guide\n Reactivity  Class and Style Bindings Watchers: watch(source, (newValue, oldValue) = {}, config)   Components   : .vue 顶层  下的  不会直接显示，需要带有指令来控制其怎样显示 \n  Props：\n Binding Multiple Properties Using an Object：在 React 中是 ，而在 Vue 中是  设置多个类型与默认   Prop Validation/How can I set the local default value in defineProps?\nconst props = defineProps({ index: { type: [String, Number], required: true, default: 0 } })   withDefaults/How to import interface for defineProps\nconst props = withDefaults( defineProps{ msg?: string labels?: string[] }(), { msg: 'hello', labels: () = ['one', 'two'] } )       Events\n  v-model\n  Slots：\n Named Slots 可以在指定 slots 位置渲染 Scoped Slots 让父组件访问子组件状态。列子如 How to handle a slot’s onClick event in VueJS。    Template Refs\n   Plugins API   $nextTick(): await nextTick()\n  $forceUpdate(): example\nscript setup lang=\"ts\" import { getCurrentInstance } from 'vue' const instance = getCurrentInstance(); instance?.proxy?.$forceUpdate(); /script         Vue i18n\n vue-i18n@9(Vue3 i18n)/vue-i18n(Vue2 i18n)  Getting started：大致用法 Scope and Locale Changing Composition API：Vue3 的选项式 API。   Add i18n and manage translations of a Vue.js powered website：不同于 lingui，vue-i18 是可以翻译变量的。 @intlify/unplugin-vue-i18n for vite4，安装后可以使用 json 文件作为 message    Vite\n Env Variables and Modes: import.meta.env.VITE_SOME_KEY Glob Import: const modules = import.meta.glob('./dir/*.js', { eager: true }) Static Asset Handling vite-plugin-svg-icons：把 svg 处理为组件的库，需要重启以生效新 svg vue-social-sharing：社交媒体分享组件，同 react-share  nuxt 下报错 Cannot read properties of undefined (reading ‘Index’)   nprogress: progress bars    Nuxt: Vue.js Web Framework\n  nuxt.config.ts\n The CSS Property The modules Property useRuntimeConfig    Routing:\n useRoute useRouter navigateTo：跳外站要用 navigateTo(url, { external: true })    Data fetching: useFetch, useAsyncData and $fetch\n ofetch: Works on node, browser and workers. nuxt 用于发送 ajax 请求的库。    Deployment\n  Components Directory: Nuxt automatically imports any components in your components/ directory（同 uniapp，Nuxt @/components 下组件也是自动引用与注册的）\n  useState\n  refreshNuxtData：类似 useSWR 的 mutate，重新请求 API，只限于当前页面。\n  device-module: detecting device type.\n  process.server and process.client：用于判断是否是 SSR，文档中没有相关词条，但是在别的词条的例子中有使用。\n  Set process.server and process.client in nuxt.config.js\n  How can I get window.location.href in Nuxtjs V3\nif (process.client) { console.log(window.location.href) }     Nuxt Image： 只支持 public 下的图片；使用原生 ，可以使用 vue + vite 项目的各种特性。\n Assets：因为 assets/ 下的资源需要对应 build tool，因此  方式可以访问，中即使 imagePath='@/assets/img/nuxt.png' 依旧不可以访问。 Static Asset Handling/How to import and use image in a Vue single file component?   Importing Asset as URL：直接 import png 文件\n  new URL(url, import.meta.url)/Nuxt dynamic image - Require is not defined\nconst imgUrl = (png: string) = { return new URL(`../../assets/${png}`, import.meta.url).href }       Nuxt Lifecycle：client 中，plugin 在 middleware 之前进行处理，要根据设备类型跳转到指定网址，那么我认为放在 plugin 比放在 middleware 更合适，原则是在跳转前执行最少的步骤。\n Lifecycle Hooks/Plugins Directory Middleware Directory      nuxt/i18n\n Basic Usage：使用 const { locale } = useI18n() 报错 Cannot find name 'useI18n'.，原因是因为要从 ‘#i18n’ 导入而非 ‘#imports’ 导入，而这些就定义在 tsconfig.json 的 paths 属性中，这表明自己对 ts 并不熟悉啊！ Routing \u0026 Strategies：为多语言添加路由前缀。Strategies 如果是 no_prefix，要用 @click=\"setLocale(code)\" 方式以保存 cookie，如果是包含 prefix 方式，那么要用  方式。 Browser language detection：检测浏览器语言并存入 cookie。本地开发没有看到存的 cookie 键值对，但是上线后确实看到了 cookie 键值对。 Lazy-load translations：通过目录 lang 下的 json 加载多语言。写在 i18n.config.ts 找不到 message，写在 nuxt.config.js 正常运行 Lang Switcher  Property 'code' does not exist on type 'string | LocaleObject'.，在返回的时候 computed 断言返回类型 locales.value as LocaleObject[]，从 '#i18n' 中导入。 这个会直接更改 Browser language detection 初始化的 i18n_redirected cookie 值。   Locale fallback Per-component translations：可以从 useI18n() 中解构出 t 函数，让后通过 watch(locale, () = t('key')) 在 中翻译。 Composables: useCookieLocale    Element Plus: Vue 3 based component library\n Dropdown Dialog：多数组件库的 dialog 都是在 body 下，跟框架的根目录同级，这样就可以不用z-index了。 Drawer Popover    scss\n  uni-app：uniapp 的文档不怎么好，定位是参考手册而非教程，不适合通过直接阅读来学习；它要求拥有 vue 基础，适合在编写项目过程中，通过解决各种问题来学习如何使用。uni-app 的 api 都是适用于多端的 api，因此最好使用它的提供的 api，而非原生的 h5 等 api；除非实在没有，那么就通过条件编译分别调用各平台 API。\n  教程\n 页面：  每次新建页面，均需在pages.json中配置pages列表。 onLoad生命周期函数: 其回调函数的参数为上个页面传递的数据 onReachBottom、onPageScroll、getCurrentPages()   互相引用：通过 easycom，组件只要安装在项目根目录的components目录下，就可以不用引用、注册，直接在页面中使用。也不能去引用，比如 lang-switch 可以手动导入，lang-switcher 却提示找不到。这也将导致无法快速跳到组件定义文件。自定义配置查看 package.json 下 easycom 条件编译处理多端差异：可以指定某部分代码只编译到特定的终端平台。    组件\n view：替代 div，设置 p-3 后，会发现 div 右边没有 padding；h-full 无效，用 h-screen 代替。 text：有些平台无法在组件包裹文本。 input：有个 placeholder-class 属性 image: mode widthFix 是最常用的。    API\n 网络 页面和路由  uni.navigateTo(OBJECT)：要打开web url，参考 u-link uniapp-router-next  适用于 uniapp 的 vue3 router，提供 router-navigate 组件用于路由。 使用 useRoute() 替代 getCurrentPages() ，更方便地获取当前的路由信息。   uni-app 页面应用内跳转与应用外跳转的实现方式：即 web-view 方式 uni-simple-router：支持路由别名 aliasPath   数据缓存  非 H5 端不支持自动保持 cookie，服务器应避免验证 cookie。   设备  剪贴板: uni.setClipboardData(OBJECT)   界面  uni.showToast(OBJECT) uni.showLoading(OBJECT): uni.setClipboardData(OBJECT) uni.createIntersectionObserver()：观察者模式 api，用例 u-lazy-load      vk-uview-ui/uView：UI 库，组件都以 u-* 开头。\n Image  Loading Empty：自动居中展示。   Select：从底部滑出菜单。本来想用 Dropdown，但是没有显示item的内容。 Tabs Waterfall  Button：要设置 :hair-line=\"false\"，否则显示 CJK 字体右侧空白与边框没对齐 Icon LoadMore BackTop   Card：只展示主题内容 :showHead=\"false\" LazyLoad  表现为不能显示默认的 loadingImg 和 errorImg。只有 Safari，原因是 Safari 不会渲染字符数不能被 4 整除的 base64 图像。我将base64转为png图片再替代。 表现为首次进入页面高度很高，与宽度不成比例，过一会儿宽高成比例。Chrome 遇到几次，很快恢复正常；Safari 是每次，并且刷新才正常。（Safari即前端地狱）  原因是先使用默认高度450rpx，之后再用 widthFix 计算的高度值。尝试用 height: auto，Safari 直接不显示图片，因为 Safari 的 height默认值为 0，Chrome 为图片高度。 要解决 Safari 中 height 默认值为 0，就必须给出具体的 height 值。通过获取容器宽度与图片的宽高，依照图片宽高比例计算出容器的高度。  console.log 在safari中调试不显示：用console.debug代替console.log来解决 uni.getImageInfo(OBJECT)：获取图片比例 uni.createSelectorQuery()：获取容器宽度 在 Safari 中不 height 能用 rpx，会转换成 rem，导致图片变形，必须使用 px 才能正确够显示。 参见 lazy-load.vue       Popup：可从上下左右四个方向弹出。  Grid Layout：12 分栏   Field: type=\"textarea\" 使用文本框；默认label占有宽度，可以设置 :label-width=\"0\" 以使输入框占据全部宽度 tabs：不能用 v-show 控制要显示的组件，因为会导致第二个组件宽度不对，与 SwipeAction 会导致其不能显示按钮（草，这里浪费了好多时间），应该用 v-if。    uni-z-paging：下拉刷新、上拉加载\n    ThinkPHP：编程语言是编程的基础，必须要整体学一下；框架则只需要看基础部分，剩下的用到哪些就看哪些，毕竟光看是学不会，也是很枯燥的；总之，判断的标准就是能不能开始写东西了，可以了就说明可以通过遇到问题来学习知识。\n  PHP 手册：官方教程部分没有翻译完，并且讲的太细，适合做参考手册，并不适合新人的教程。\n Unix 系统下的安装 魔术常量：__DIR__ 当前文件所在的目录。 implode：同 js 的 Array.prototype.join() 方法。    PHP 入门到实战教程：非常好的入门教程，看完之后完全可以开始写东西了。\n  玩转 PhpStorm 系列\n 基于 Xdebug 进行代码调试    ThinkPHP6.0完全开发手册\n 配置目录：  use think\\facade\\Config; 相同的数组名，下面的 [ArrayName] 定义会覆盖了上面定义，不会自动合并，因此要写在一起。   架构：至少看这部分，知道怎么个执行的流程（路由），如果要写，要在哪里加东西。  入口文件：这个与 PHP 应用部署相关。PHP 的运行方式与 node 项目不同，node 需要 build，PHP 是动态解释型语言，无须编译即可执行，可以直接当作 html 来用，配置 nginx 就指向 php 文件就可以访问了，root /chat/server/public; URL访问：http://serverName/index.php/应用/控制器/操作/参数/值... 中间件：中间件主要用于拦截或过滤应用的HTTP请求，并进行必要的业务处理。   模型：即数据表的定义与操作 调试模式  Trace调试 变量调试：内置了一个对浏览器友好的dump方法，用于输出变量的信息到浏览器查看。单个 api 可以直接输入 url 在浏览器中查看；对于复杂联动的api，在web端，可以在浏览器中选择对应的请求，然后选择 Preview 查看。   缓存：Redis 多语言：  allow_lang_list 写的是全称，如 en-US，那么即使客户端 Accept-Language 为 en，依旧可以被识别为 en-US。 Accept-Language 先于 use_cookie，但是最好还是一开始就设定好 cookie 的值，而不是去改变 Accept-Language。   Libraries  thinkphp-social：社会化登录扩展 orhanerday/open-aiZ: OpenAI PHP SDK stripe/stripe-php   ThinkPHP 6.0 速查表    Composer中文文档\n  ThinkTemplate开发指南\n How do I embed PHP code in JavaScript?: 可以使用原生php代码 var my_var = ;        Erase your Mac and reset it to factory settings: Erase All Content and Settings\n  20230711  把查词做到极致的 macOS 原生词典，其实很好用：可以开启三指轻点快速翻译 Practical rc.d scripting in BSD: rc.d.template.sh  20230710  经验   什么是回归测试？\n  ZeroTier实现内网穿透、异地组网\n  FreeBSD：ZeroTier 不需要开放端口\nsudo pkg install zerotier sudo service zerotier enable # 自带 service，Nice！ sudo service zerotier start sudo zerotier-cli join 233ccaac270f677c   How can zerotier on OSX be paused?\n# You can stop the service with: sudo launchctl unload /Library/LaunchDaemons/com.zerotier.one.plist # It will start on next boot or: sudo launchctl load /Library/LaunchDaemons/com.zerotier.one.plist     利用frp工具实现内网穿透、随时随地访问内网服务\n  Syncthing - P2P文件同步工具：\n  Syncthing Docs\n 首先看一下 Getting Started 然后在 Community Contributions 中找到要安装的平台的安装包 最后设置防火墙 Firewall Setup：要打开 22000/TCP、22000/UDP、21027/UDP    Ubuntu 参考 Syncthing – Install and Setup Syncthing on Ubuntu/Debian：两个命令就安装好了\nsudo apt install syncthing sudo systemctl enable syncthing@username.service   MacOS\n# Install brew install syncthing # Test /opt/homebrew/opt/syncthing/bin/syncthing -no-browser -no-restart # Run as serivce brew services start syncthing # Access the GUI via the following URL: http://127.0.0.1:8384/   FreeBSD：需要打开对应的端口\nsudo pkg install syncthing sudo sh -c \"echo 'pass in proto tcp from ue0:network to port 22000'  /etc/pf.conf\" sudo pfctl -f /etc/pf.conf sudo crontab -e @reboot kurome:kurome sleep 60;/usr/local/bin/syncthing\u0026   Tips:\n 在连接设置中，只打开了本地发现；传输速度受限于路由设备（随身 WIFI，不到 5MB/s） 只需要在一个设备添加文件夹就可以了，不需要两个设备同时添加，分享后就是双向同步的了      Pkg Primer: pkg search -f packageName 展示 remote package info；pkg info packageName 展示 installed packageName。\n    20230707  经验   VS Code Remote Development\n  Remote via SSH\n  The VS Code Server\n  coder-server\ncurl -fsSL https://code-server.dev/install.sh | sh sed -i.bak 's/auth: password/auth: none/' ~/.config/code-server/config.yaml sudo systemctl restart code-server@$USER ssh -N -L 8080:127.0.0.1:8080 [user]@     How to configure static IP Address on FreeBSD\n  JS 反调试\n JavaScript AntiDebugging Tricks JS禁止打开控制台    NixOS 与 Nix Flakes 新手入门：NixOS 与 Flakes 一份非官方的新手指南\n    20230706  经验   The Twelve-Factor App\n  面试官：项目中常用的 .env 文件原理是什么？如何实现？\n  使用 JMeter 进行压力测试\n  Jest 实践指南：很好的教程\n  整合 Line 登录：Line 注册要手机号，国内手机号不支持\n  Integrating LINE Login with your web app\n  passport-line-auth：Line 的 Strategies 比较少，这个最近一年内更新了的，实际测试可用\n  nodejs/passport - Error: OAuthStrategy requires session support\n// Authentication configuration app.use(session({ resave: false, saveUninitialized: true, secret: 'bla bla bla' }));     整合 Apple 登录：Apple 登录需要开发者账号，开发者账号要钱\n How to implement Apple Login with Nestjs in seconds      20230705  经验  iPhone 怎么复制短信中的部分内容？：选择转发，就可以在编辑栏再复制部分短信了。 How to Fix PR_END_OF_FILE_ERROR: 3 Methods That Work：我配置 Firefox 的 Proxy DNS when using SOCKsv5 解决了访问 Gooogle 产生 Secure onnection failed 这个问题。 Static Exports：Next.js 是可以来写静态博客部署到 Github Pages 的。 How can I keep the code formatted as original source when I paste them to vim?: :set paste, then after :set nopaste 静态博客全文搜索简单调查 Safari Translation Not Working On Mac/IPhone: How To Fix: Download Language for Offline Translation. System Settings  General  Language \u0026 Region.    20230704  经验  CSS实现footer“吸底”效果 冷知识：不起眼但有用的String.raw方法 How to set up NTP Clock Synchronization on FreeBSD with ntpd Using ssh_config Match to connect to a host using multiple IP or Hostnames Hugo setup：用 Github Action 部署 hugo 博客 Hugo quietly builds empty index.html files: FreeBSD 上使用从 gihub release 上下载的 hugo 遇到此问题，没有报错，就是不 build content 下的博客，搞了一晚上都没有解决，最终通过 pkg install gohugo 解决，这个版本也是 freebsd hugo 的 extended edition，这在 github release 上是没有的。具体思路就是尝试 hugo 的 quick start 教程看看能不能正常运行，结果不能，主题报错，要求 extended edition。这也告诉我们，像 FreeBSD 这样本身更新很及时的，没有特殊需求，最好就用包管理安装软件。    20230703  经验   如何修改Mac电脑默认视频播放软件\n 在Mac电脑中找出并选中要播放的视频 点击键盘按键command+I，打开文件简介 在文件简介窗口，找到打开方式一栏里单击下拉框，选择想要修改的程序 选择好后点选下面的“全部更改”在弹出的窗口中，点击“继续”即可完成。    视频直播方案\n HTTP Live Streaming直播(iOS直播)技术分析与实现 C++实现RTMP协议发送H.264编码及AAC编码的音视频 MP4大文件虚拟HLS分片技术，避免点播服务器的文件碎片    What’s a quick way to comment/uncomment lines in Vim?\n First, go to the first line you want to comment, press Ctrl``V. This will put the editor in the VISUAL BLOCK mode. Then using the arrow key and select until the last line Now press Shift``I, which will put the editor in INSERT mode and then press #. This will add a hash to the first line. Then press Esc (give it a second), and it will insert a # character on all other selected lines.    Can’t access Hugo @ localhost\nhugo server --theme=hugo_theme_robust --buildDrafts --bind \"0.0.0.0\" --baseURL \"http://192.168.1.10:1313\"     20230701  经验   A link to GitHub for downloading a file in the latest release: Get the latest release\ncurl -s https://api.github.com/repos/boxbilling/boxbilling/releases/latest | grep browser_download_url | cut -d '\"' -f 4   crontab @reboot does not execute bash script when server is rebooted\n@reboot root:wheel sleep 60;/home/kurome/clash/clash.sh @reboot root:wheel sleep 60;/home/kurome/bhyve/bhyve.sh   How to disable “screen blackening”\n# !/bin/bash # screenblank - Toggle screen blanking/powersaving on/off XBLANKTEXT=$(xset -q | grep timeout | awk '{printf $2}') DPMSTEST=$(xset -q | grep \" DPMS is Enabled\") if [[ \"$XBLANKTEXT\" -gt 0 ]] || [[ -n \"$DPMSTEST\" ]]; then xset s off; xset -dpms echo \" Disabled screen blanking and powersaving\"; else xset s on; xset +dpms echo \" Enabled screen blanking and powersaving\" fi 或者直接添加到 .xinitrc\nxset -dpms xset s off   Using “#define” in .Xdefaults?\n Try using xrdb(1) (it runs cpp(1)) in ~/.xinitrc, e.g. xrdb -merge ~/.Xdefaults And make sure macros are substituted, e.g. xrdb -query | egrep '(fore|back)ground'    How can I convert .svg files to a font?\n  ohmyzsh tmux plugin\n  Autostart X at login\n  VSCode Extension: Markdown Paste: Command + Alt + V\n    20230630  任务   JavaScript 媒体查询\nconst [isDesktop, setIsDeskop] = useState(true) useEffect(() = { const mql = matchMedia('(max-width: 1024px)') const handleMediaChange = () = { if (mql.matches) { // console.log('match')  setIsDeskop(false) } else { // console.log('unmatch')  setIsDeskop(true) } } handleMediaChange() // 首次查询  mql.addEventListener('change', handleMediaChange) return () = { mql.removeEventListener('change', handleMediaChange) } }, [])   设置锚点居页面顶部距离：页面滚动高度 = 元素到页面顶部高度 - 固定导航栏高度\nconst toAnchor = (id: string) = { const el = document.getElementById(id) if (el) { const react = el.getBoundingClientRect() const win = el.ownerDocument.defaultView if (win) { const offset = react.top + win.document.body.scrollTop const headerEl = document.getElementById('desktop-header') if (headerEl) { console.log('header height', headerEl.offsetHeight) window.document.body.style.scrollBehavior = 'smooth' window.document.body.scrollTop = offset - headerEl.offsetHeight } } } }   其他方法：锚点定位被顶部固定导航栏遮住的解决方案\n  JS中各种距离:\nlet scrollTop = document.documentElement.scrollTop || window.pageYOffset || document.body.scrollTop   详解a标签中href=“javascript:“的几种用法：在a中调用js函数最适当的方法推荐使用\na href=\"javascript:void(0);\" onclick=\"js_method()\"/a a href=\"javascript:;\" onclick=\"js_method()\"/a a href=\"#\" onclick=\"js_method();return false;\"/a   jQuery源码解析之offset()\nlet p = document.getElementById(\"pTwo\"); let rect=p.getBoundingClientRect() let win = p.ownerDocument.defaultView; let offsetObj={ top: rect.top + win.pageYOffset, left: rect.left + win.pageXOffset } console.log(offsetObj,'win18')     FFMPEG\n ffmpeg - Convert MP4 to WebM, poor results  ffmpeg -i input.mp4 -c:v libvpx-vp9 -crf 30 -b:v 0 -b:a 128k -c:a libopus output.webm   AV1 Video Encoding Guide\n  ffmpeg を使って mp4 を HLS に変換する\nffmpeg -i video.mp4 -c:v copy -c:a copy -f hls -hls_time 9 -hls_playlist_type vod -hls_segment_filename \"video%3d.ts\" video.m3u8 ffplay ./video.m3u8     视频优化\n 合适的视频格式：WebM(VP9) 相较于 MPEG-4(x264) 来说会更小 视频压缩：HandBrake Video Streaming with Node.js / HLS   HLS.js\n  example\nuseEffect(() = { const hlsVideoSrc = '/videos/hls/chathomeai.m3u8' const videoEl = videRef.current if (videoEl) { videoEl.muted = true if (videoEl.canPlayType('application/vnd.apple.mpegurl')) { videoEl.src = hlsVideoSrc videoEl.onloadeddata = () = { videoEl.play() } } else if (Hls.isSupported()) { const hls = new Hls() hls.loadSource(hlsVideoSrc) hls.attachMedia(videoEl) hls.on(Hls.Events.MANIFEST_PARSED, () = { videoEl.play() }) } else { setIsSupportHls(false) } } }, [])   报错 SyntaxError: Unexpected keyword or identifier.，则需要在 tsconfig.json、.eslintignore 和 .prettierignore 中将 HLS ts 文件忽略。\n        20230629   经验\n  Curl to grab remote filename after following location\n# Specify --remote-header-name / -J curl -O -J -L $url curl --remote-name --remote-header-name --location $url # If you can use wget instead of curl: wget --content-disposition $url   解压 Arch 的 pkg.tar.zst\nunzstd filename.pkg.tar.zst tar -xvf filename.pkg.tar   How to untar an archive without the root folder, but keeping the full hierarchy inside it?: Easy. Just use tar --strip-components=1 on the archive.\n  FreeBSD Touchpad configuration：参考 libinput\n$ sysctl hw.psm.elantech_support=1 $ sysctl kern.evdev.rcpt_mask=12 $ cat /usr/local/etc/X11/xorg.conf.d/30-touchpad.conf Section \"InputClass\" Identifier \"touchpad\" MatchIsTouchpad \"true\" MatchDriver \"libinput\" Option \"AccelSpeed\" \"0.1\" Option \"ClickMethod\" \"clickfinger\" # 用点击的手指代替触摸板实际的按键 Option \"DisableWhileTyping\" \"on\" Option \"HorizontalScrolling\" \"off\" Option \"LeftHanded\" \"off\" Option \"NaturalScrolling\" \"true\" Option \"ScrollMethod\" \"twofinger\" Option \"Tapping\" \"on\" # tap-to-click Option \"TappingButtonMap\" \"lrm\" # 1/2/3 指对应 left/right/middle 按键 EndSection     bspwm 没有创建 desktop，不能切换 desktop: bspwmrc 本质就是 shell 脚本，需要执行权限 chmod +x bspwmrc\n  20230628  经验  next env   Environment Variables\n  next.config.js Options\n env Runtime Config    Iconfont：图标库\n  ICONFINDER：图标库\n  seeklogo：图标库\n  ShareButtons 关于图标对齐\n// 如下两个不对齐，后面的比前面的矮一点，但是实际并没有 margin 或 padding 存在 button aria-label={singleService} key={singleService} className='cursor-pointer bg-yellow-500 text-white rounded-full mx-1'  div onClick={copyUrl}  i className='fas fa-link w-8' / /div /button button aria-label={singleService} key={singleService} className='cursor-pointer bg-yellow-500 text-white rounded-full mx-1'  div onClick={copyUrl} className=\"w-8 h-8 flex justify-center items-center\" // 为了居中 icon 用 flex   LinkIcon width={24} height={24} / /div /button // 后面的用如下写法则对齐 button aria-label={singleService} key={singleService} className=\"cursor-pointer bg-yellow-500 text-white rounded-full mx-1\"  div onClick={copyUrl} LinkIcon width={32} height={32} className=\"p-1\" / // 利用 padding 居中 icon  /div /button   内容整体要水平居中，内容间要对齐：包一层\ndiv className=\"flex flex-col justify-start items-center\" div pa very long sentencep pa wordp div div       20230627  经验   iphone frame：iPhone 边框\n  关于css position定位 top百分比的问题：css设置绝对定位后 top,bottom,设置百分比定位是按父元素的高度来计算的，同样left,right,设置百分比定位是按父元素的宽度度来计算的。\n  XFengCloud-小逢云：免费一天试用，可以看有哪些用户使用，感觉靠谱，openvpn 方式免流了 90%，shadowsocket 方式免流了 30%，价格10元/月，还行。\n  OpenVPN 简明手册\n  Windows OpenVPN GUI记住用户名和密码：在ovpn配置文件里增加 auth-user-pass pass.txt，之后在ovpn配置文件所在目录建立一个pass.txt的文件，第一行为用户名，第二行为密码即可。\n  failed to negotiate cipher with server.：很多时候，把第一个错误解决了，剩下的错误都会消失（即所有剩下的错误都是由于第一个错误的产生而存在的）\ncipher none # 在 data-ciphers 最后加上 cipher 指定的加密算法，即 none data-ciphers AES-256-GCM:AES-128-GCM:CHACHA20-POLY1305:none     How to use curl to get public IP address\ncurl ifconfig.me curl icanhazip.com curl ipecho.net/plain curl ipinfo.io/ip     20230626  经验  CFW 开启 TUN 模式后，homebrew 报错 LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443。原因是有些地址解析到了 ipv6，但是 clash 设置中没有打开 ipv6，开启就好了。 CFW 开启 TUN 模式后，git clone 报错 kex_exchange_identification: Connection closed by remote host。添加规则 - DST-PORT,22,DIRECT，或改成通过443端口    20230625  经验  如果不想配置，Motrix 是替代 aria2 的一个好选择 批踢踢實業坊：一个台湾bbs    20230621  经验  Paste a rectangular block in Visual Studio: Click to the beginning of what you want to copy, press and hold Shift+Alt (Mac: Shift + Option) then click to the end of what you want to copy. Then release the keys and copy. When pasting, do the same for the column you want to insert.（快速翻译：首先选择并复制冒号后值为空的键放入Google进行翻译翻译，翻译后的文本做为值，之后利用块复制粘贴为值添加键，先放置值再放置键就可以保证同一个column实现块粘贴） Visual studio code - how to copy search results?  CTRL + F Type your search string CTRL + SHIFT + L to select all occurrences found (max. 999) ESC (or close search dialog with top-right X) CTRL + I to select whole lines CTRL + C Open new file CTRL + V   \\u3000 是全角的空白符 JS给数字加千位分隔符: numObj.toLocaleString([locales [, options]])    20230620  经验  JS给数字加千位分隔符    20230619  经验   “You must be an administrator to delete this job”\ncancel -a -x   整合 Google 登录：其他的 OAuth2 认证基本类似。具体流程是，访问 api/google controller 执行 google.strategy 进行 Google 登录；获取信息后 validate 成功后 redirect 到 api/google/redirect controller，首先先通过 upsert 将用户信息保存到数据库，然后根据信息生成 token 放入 cookie 中，最后 redirect web 页面，web 页面使用 axios request interceptor，读取 cookie 中的token。\n  How to Implement Login with Google in Nest JS：done callback should not be used in validate method, because it is invoked internally by nestjs/passport. It is better to just return user object from validate.\n  OAuth 客户端 ID 凭据\n  Error: redirect_uri_mismatch: The redirect URI (where the response is returned to) has to be registered in the APIs console, and the error is indicating that you haven’t done that, or haven’t done it correctly.\n  Access to fetch at https://accounts.google.com/o/oauth2/v2/auth has been blocked by CORS: The authentication flow must happen in a visible browsing context, not with a fetch request. In other words: You must navigate the current tab to (or open a new tab at) http://localhost:8000/api/mail/login.\n  InternalOAuthError: Failed to obtain access token 0：原因是在 google/redirect controller 中执行没有正确返回，用的 return { url: 'https://testweb.chathome.ai'}，之后参考 Send a set-cookie header to a redirect url in node.js，就成功了\nres.cookie('access_token', token, { maxAge: 24 * 60 * 60, sameSite: true, secure: true, }) res.redirect(302, 'https://testweb.chathome.ai');   Attach Authorization header for all axios requests\n// Add a request interceptor axios.interceptors.request.use(function (config) { const token = store.getState().session.token; config.headers.Authorization = token; return config; });       20230617   经验\n  ssh connection speed\n  pv: test transfer speed\nyes | pv | ssh remote_host \"cat /dev/null\"  如何使用 pv 命令监控 linux 命令的执行进度：数据量，花费的时间，传输速率，进度条，进度的百分比，以及剩余的时间。 Linux命令之yes：重复输出字符串    sshping: MacOS - linking help with libssh?\n+CFLAGS=-I /opt/homebrew/include -I ext -L /opt/homebrew/lib -lssh  -bin/sshping: src/sshping.cxx /usr/include/libssh/libssh.h - g++ -Wall -I ext/ -o bin/sshping src/sshping.cxx -lssh +bin/sshping: src/sshping.cxx + g++ -Wall -I ext/ -o bin/sshping $(CFLAGS) src/sshping.cxx -lssh   Test ssh connection speed: scp transfer speed\n    Tmux 使用教程\n  How can I set my default shell to start up tmux\nif command -v tmux \u0026 /dev/null \u0026\u0026 [ -n \"$PS1\" ] \u0026\u0026 [[ ! \"$TERM\" =~ screen ]] \u0026\u0026 [[ ! \"$TERM\" =~ tmux ]] \u0026\u0026 [ -z \"$TMUX\" ]; then if [ -n \"$SSH_CLIENT\" ] || [ -n \"$SSH_TTY\" ]; then exec tmux new-session -A -s \"${USER}0\" fi fi   command命令 – 调用并执行指定的命令: -v 搜索命令信息但是不执行\n  How to start tmux with attach if a session exists: The -A flag makes new-session behave like attach-session if session-name already exists; in this case, -D behaves like -d to attach-session.\ntmux new-session -A -s main   How to determine if I’m logged in via SSH?\n If one of the variables SSH_CLIENT or SSH_TTY is defined, it’s an ssh session. The login shell’s parent process can be checked with ps -o comm= -p $PPID. If it is sshd, it’s an ssh session.  if [ -n \"$SSH_CLIENT\" ] || [ -n \"$SSH_TTY\" ]; then SESSION_TYPE=remote/ssh else case $(ps -o comm= -p $PPID) in sshd|*/sshd) SESSION_TYPE=remote/ssh;; esac fi       How to append multiple lines to a file\n# possibility 2: echo \"line 1 line 2\"  greetings.txt # possibility 3: cat  greetings.txt line 1 line 2 EOT ``     使用 SSH 密钥密码\nssh-keygen -p -f ~/.ssh/id_rsa echo ' AddKeysToAgent yes UseKeychain yes'  ~/.ssh/config   重新生成公钥：Create a public SSH key from the private key?\nssh-keygen -f ~/.ssh/id_rsa -y  ~/.ssh/id_rsa.pub   从流量控制算法谈网络优化 – 从 CUBIC 到 BBRv2 算法：是拥塞控制算法。作用是决定发送方应该以多快的速度发送数据，并同时适应网络的变化。BBRv1 对带宽延迟积大、丢包率高的网络非常有效，能保持一个不错的吞吐量数字。\n  How to enable BBR on Ubuntu 20.04\necho ' net.core.default_qdisc=fq net.ipv4.tcp_congestion_control=bbr'  /etc/sysctl.conf sysctl -p sysctl net.ipv4.tcp_congestion_control   给VPS上的FreeBSD开启BBR：要编译内核\n    KCP协议：从TCP到UDP家族QUIC/KCP/ENET：KCP是一个快速可靠协议，能以比 TCP浪费10%-20%的带宽的代价，换取平均延迟降低 30%-40%，且最大延迟降低三倍的传输效果。\n  Problem With Transmission Receive Buffer on FreeBSD\n  临时\nsysctl kern.ipc.maxsockbuf=5242880 sysctl net.inet.udp.recvspace=4194304   永久：添加到 /etc/sysctl.conf\n    serverspeeder/LotServer/锐速\n virt-what：检测VPS是Openvz还是KVM还是Xen，apt install -y virt-what; virt-what    VPS 初体验（一）基础配置\n bench.sh：测试传输速度 wget -qO- bench.sh | bash    教程：记录 Linux 的点滴\n  Bhyve started from tmux：Start a virtual machine in background，在后台运行 bhyve 虚拟机，如下部分脚本只适用于 freebsd\n# start bhyveload -m 8G -S -d /vm/freebsd/freebsd1.img freebsd1 sleep 8 /usr/local/bin/tmux new-session -d -s freebsd1 'bhyve -S -m 8G -c 8 -AHP -s 0,hostbridge -s 1,lpc -s 2:0,ahci-hd,/vm/freebsd/freebsd1.img -s 5:0,passthru,132/0/0 -s30,xhci,tablet -l com1,stdio freebsd1' # stop pkill bhyve sleep 10 bhyvectl --destroy --vm=freebsd1 tmux kill-server   ApacheCN Linux 译文集\n  KVM总结-KVM性能优化之CPU优化：绑定物理 CPU 到虚拟 CPU。\n unixbench    20230616  经验  ForbiddenException: Forbidden resource 产生的原因来自于 guard。 Oh-My-Zsh Git: Git Aliases Build a real-time chat application with Nestjs and PostgreSQL    20230615  经验  博客：PJCHENder：當前端工程師是想幫助更多人：PJ 陳柏融的技術寫作之路    20230614  经验   伪元素改变number类型input框的默认样式实例页面\n.deal::-webkit-textfield-decoration-container { background-color: #f0f3f9; } .deal::-webkit-inner-spin-button { -webkit-appearance: none; } .deal::-webkit-outer-spin-button { -webkit-appearance: none; /*有无看不出差别*/ }   How can I do Base64 encoding in Node.js?\nBuffer.from(\"Hello World\").toString('base64') // encode Buffer.from(\"SGVsbG8gV29ybGQ=\", 'base64').toString('ascii') // decode   原来浏览器原生支持JS Base64编码解码：就是 window 的方法 atob 和 btoa\n  踩坑日记：如何修复“System limit for number of file watchers reached”错误\n  执行如下命令\nsudo sysctl fs.inotify.max_user_watches=524288 echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf sudo sysctl -p   Increase fs.inotify.max_user_watches in docker container: Docker mounts /proc as read-only since many of its knobs are global. If you run that same command on the host, the container will transparently inherit the new setting.\n    how to make non root user as sudo user in docker alpine image?\n  command: docker exec -it --user root mycontainer sh\n  dockerfile:\nUSERroot# Run root operation here# Change user back to cassandraUSERcassandraRUN whoami    node中__dirname、__filename、process.cwd()、process.chdir()表示的路径\n __dirname 表示__dirname所在文件所在的目录的绝对路径 __filename 表示__filename所在文件的绝对路径 module.filename ==== __filename 等价 process.cwd() 返回Node.js 进程执行时的工作目录的路径 process.chdir() 改变工作目录。    frp 将内网服务穿透到公网，可以在公网访问内网服务；tailscale 是 VPN，组件虚拟局域网，局域网内的设备可以相互访问。两者都通过公网路线访问，区别在于 frp 是暴露在公网，任何人都可以访问服务，tailscale是成员可以访问服务。就个人需求来说，当然是两者都用，一些服务能暴露到公网，一些服务只能成员访问。\n Configuring IPv6：FreeBSD 自己添加的 wlan0 并没有自动启用 ipv6 Pv4 Gateway to access IPv6：有的路由器并没有支持或开启 ipv6，frp 报错 no route to host，可以利用 hax 的 share ipv4 端口来连接 frps 服务 woiden.id 变为 non-renewable 的了，总比永远抢不到服务的好，现在至少能用3天，用来测试也够了。 支持 KCP 协议：降低延迟。报错 i/o deadline reached，用不了啊，quic 也一样。      20230613  经验  Node+Puppeteer生成海报：其实就是利用 chrome 的 Capture node screenshot 将 node 节点内容转为图片 自定义二维码：了解QrCode的结构原理与实战  添加 Logo  二维码挡住哪些部分，不会影响扫描识别？：只要四角的定位符（就是那个方形的黑色粗线框）没有被挡住就行，剩下的其他地方与纠错级别相关，纠错级别越高，可被覆盖的地方越多。 前端如何优雅的制作带LOGO的二维码：用 canvas 将 logo 绘制到二维码上。   添加背景图：纯前端实现自定义二维码背景图，方法是把二维码黑色的部分数据拿到，然后将黑色的部分按照对应的背景图的颜色进行填充。 qrcode.react      20230612  经验  Prisma 给数据库填充初始数据: Seeding your database  upsert是一种数据库操作，如果表中已存在指定值，则更新现有行，如果指定值不存在，则插入新行。   Prisma Models: autoincrement() optionnally starting at 0 ?: It’s not possible from the schema directly but you can modify the migration file to achieve this. 我有一台服务器能做什么：自架的服务整理 / Awesome-Selfhosted：免费或便宜的小鸡做打洞，实际服务在家里电脑中。    20230610   FreeBSD 最重要的信息还是安装软件后的 pkg message，这个是最适用的：\npkg info -D pkgname   wpa_supplicant/wpa_cli\n  wpa_supplicant.conf\n  wpa_cli\n  wpa_cli error “Could not connect to wpa_supplicant: wlan0 - re-trying”?\n  在 MacOS 上查看 BSSID：如果多个 Wi-Fi 具有相同的 SSID，或者连接隐藏 SSID 的 Wi-Fi，则 FreeBSD 需要指定具体的 BSSID，在 FreeBSD 上可直接通过 ifconfig wlan0 scan 查看，在 Mac 上通过如下命令查看\nsudo /System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport -I | grep BSSID   注意：用 wpa_passphrase 生成的 psk 可能导致 FreeBSD 无法连接 wifi，可尝试使用原本的 psk\n    How to mount exFAT formatted SD memory card on FreeBSD.\npkg install fusefs-exfat sysrc kld_list+=fusefs reboot mount.exfat /dev/da0s1 /mnt umount /mnt   How to check if a string contains a substring in Bash\n# 1 [[ $string == *\"My long\"* ]] # 2 [ -z \"${string##*$reqsubstr*}\" ]   BHyVe\n  How to install Linux VM on FreeBSD using bhyve and ZFS：wlan0 与 tap0 组成 bridge0 后，vm 无法访问网络，因为只能用 wlan0，因此考虑 nat 模式；一般认同使用 zfs 比 truncate 可以获取更高的磁盘性能。另一篇文章RUNNING CENTOS WITH BHYVE\n  bhyve wireless NAT vm setup：nat 依托于防火墙，即 PF\n PF：  以 PF 架設 NAT 路由器及防火牆  em1:network 相当于 em1 的局域网，但是不支持变量     需要为 VM 设置 static ip 和 gateway   Setting a Static IP in Ubuntu – Linux IP Address Tutorial\n  How to Set the Default Gateway on Ubuntu\n  编辑 /etc/netplan/00-installer-config.yaml，然后运行 netplan try 以应用配置\n#  # This is the network config written by 'subiquity' network: ethernets: enp0s2: dhcp4: no addresses: [10.0.0.2/24] nameservers: addresses: [114.114.114.114] routes: - to: default via: 10.0.0.1 version: 2       resize truncated bhyve .img file\nsudo pkg install e2fsprogs truncate -s ubuntu.img mdconfig ubuntu.img gpart show md0 gpart recover md0 # in case of GPT you should run this before resizing gpart resize -iN md0 # N - the partition index resize2fs /dev/md0sN # could be md0pN in case of GPT scheme mdconfig -d -u0   sudo: ‘‘who where = (as_whom) what’’\n    20230609  经验  在部署的时候，GRPC 服务的 GRPC_CHATBOT=host:port 不能写在 .env 之中，否则报错 No connection established，写在 docker-compose.yaml 的 environment 中则可以正常连接。查看 Dockerfile 得知，COPY .env ./ 在 RUN yarn build 之后，这是报错原因。 Tools for managing and deploying Redis：AnotherRedisDesktopManager 替代收费的 RedisDesktopManager RabbitMQ CLI 管理工具 rabbitmqadmin（管理和监控）    20230608   IPFS\n 站在Web3.0 理解IPFS是什么 IPFS 使用入门 IPFS 新手指北 IPFS 日用优化指南：在发布内容后，马上通过公开的 IPFS 网关访问，通常会很慢很慢，甚至到超时都无法访问，这是由 IPFS 的寻址过程导致的。随着访问内容的用户越来越多，他们的 IPFS 节点上会缓存你内容的数据，这个时候新节点再访问同一份内容，通常就会很快。这就是 IPFS 的特性，就跟 BT 下载的原理类似，数据在网络中存在的副本越多，就越能利用 P2P 网络的性能。    Zeal/Dash: offline documentation browser for software developers.\n  博客：https://aandds.com/\n  20230607  经验  RESTful API 设计指南 Docker ENTRYPOINT 入口点：实际执行时，将变为  \"\"。 搞懂异地多活，看这篇就够了    20230606  经验   MailGun 同一个账号的 APIKEY 是一样的，但是 DOMAIN（ses.chatfo.ai） 可以不一样。\n  MySQLDump的备份小技巧\n  Easiest way to copy a table from one database to another?：跨 mysql server 复制数据表\nmysqldump --user=user1 --password=password1 database1 table1 \\ | mysql --user=user2 --password=password2 database2   腾讯工程师带你深入解析 MySQL binlog：二进制日志，主要用来达到 master-slave 数据一致的目的。\n    20230605  经验   DBeaver：干掉付费的 Navicat，操作所有数据库就靠它了！：DBeaver 好用！可以格式化查看数据内容。\n  Kong Admin API: Supported Content Types\n  sed changing all occurrences in a folder/How to limit directory depth with find command\nfind . -maxdepth 2 -type f -exec sed -i.bak \"s/foo/bar/g\" {} \\;   sed fails with “unknown option to `s'” error: The problem is with slashes: your variable contains them and the final command will be something like sed “s/string/path/to/something/g”, containing way too many slashes.\nreplacement=\"/my/path\" sed --expression \"s@pattern@$replacement@\"   Quick Reference: 英文版 Reference 的中文版本\n    20230602  经验  Jenkins 有个 View，用于对 Jobs 分组。 Linux终端下生成随机复杂密码的五种姿势：最通用的，能在 ubuntu \u0026 macOS 都可使用的，且不需要安装软件的是 openssl rand -base64 14 Safari 阅读模式可以替代 Chrome 的 Reader View：Command + Shift + R ChatGPT: AiMapPro.com - 轻松探索 AI 世界 我的职业是前端工程师 MySQL Workbench使用教程：MacOS Monterney M1 上使用 Select Rows–Limit 1000 来编辑表中的数据就会闪退。    20230601  经验   Replace all whitespace characters: You want \\s\n  How do I replace all occurrences of a string in JavaScript?: str.replace(/abc/g, '') or str.replaceAll('abc', '')\n  how do I check whether its a jpg/png/gif?: There is a comprehensive table of magic numbers here\nvar magic = { jpg: 'ffd8ffe0', png: '89504e47', gif: '47494638' }; const buffer: Buffer = (file as Express.Multer.File).buffer buffer.toString('hex',0,4) === magic.jpg \u0026\u0026 doSomeThing()   Using the Buffer toString() Function in Node.js: buf.toString([encoding[, start[, end]]]) 是 node 的 api，非 js 原生的 toString(radix)\n  如何在 Node.js 中判断一个文件/文件夹是否存在？：不用fs.exists，因为不是错误优先的回调函数，以及会产生竞态条件\nprivate async makeDirExist(dir: string) { const accessAsync = promisify(fs.access) try { await accessAsync(dir, fs.constants.W_OK) } catch (e) { fs.mkdirSync(dir, { recursive: true }) } }   util.promisify 的那些事儿\n    20230531  经验   问题：正式版，PDF Steam web 端无法显示。原因：通过 devtool 查看，发现数据正确返回了，对比 www.chathome.jp 与 chathome.jp，发现 www.chathome.jp api 调用都多了一个 preflight请求。解决：在部署环境中注释掉 env 中的 NEXT_PUBLIC_WEB_API_DOMAIN=https://chathome.jp 环境变量，让 api 调用自动使用相应的域名，从而不产生 preflight请求。经过排查，发现是 response.headers['content-disposition'].split['='](1) 报错 error TypeError: Cannot read properties of undefined (reading 'split')，因为 www.chathome.jp 的 response header 只有 content-type: \"application/force-download\"，这里可以将 split 放在 try…catch 块中。为什么只返回改 header 字段呢？因为后台在跨域下只允许了特定的 header 可以被访问：allowedHeaders: [...allowedHeaders, 'content-type', 'Authorization'],。\n  为啥JavaScript里，数组正常的索引不能用负数呢？：因为JS的Array实际是个Object，并不是真的array，arr[-1] = 'a'，但可以反向索引 arr.reverse()[1] 或 使用 arr.at(-1)\n    20230530  经验   聊聊JS的二进制家族：Blob、ArrayBuffer和Buffer\n  vConsole：针对手机网页的前端开发者调试面板。\n  PDF.js\n 如何用js实现pdf文件转图片 Setting up fake worker failed    User-Agent\n HTTP请求头之User-Agent UAParser.js app内置浏览器是什么：App内置浏览器指的是一个手机应用程序内部包含的浏览器功能，可以让用户在应用程序内部直接浏览网页，而不需要跳转到手机自带的浏览器应用程序中。在技术上，应用程序内置浏览器通常是基于WebView技术实现的。 解决微信内置浏览器不能下载文件：判断用户的浏览器是否为微信内置浏览器，如果是弹出一个图层，提示用户点击在默认浏览器中打开。判断主流内嵌浏览器userAgent：  export const webView = () = { return /Feishu|DingTalk|MicroMessenger|Bytedance|NewsArticle|Zhihu|Weibo|AlipayClient|MQQBrowser/gi.test(window.navigator.userAgent); };     20230529  经验   生产环境的配置里面都不要用 10 开头的 ip 地址，10 开头的是虚拟lan 地址，依赖于 tailscale 服务器，万一这个服务器出问题了，会有影响；但是在本地运行 api 项目的时候，需要使用 10 开头的 ip 地址，例如 ClusterAllFailedError: Failed to refresh slots cache. 问题就是用 192 开头 ip 没有连接上 redis。\n  PDF stream：\n 后台：Streaming files：用 file stream 替代之前的 pdf url，解决安全隐患，防盗链，防爬虫遍历 static pdf 文件。 前台：  前端如何下载文件流：注意 a 标签的 download=\"filename.pdf\"，Safari 没这个下载为 Unknow.pdf。结果是 IOS QQ浏览器无法显示无法下载；IOS Chrome 可以显示，可以下载到本地 Chrome 目录；Safari 可以显示，点击下载后打开新页面，新页面可以选择 save to files ；IOS Firefox 可以显示，点击下载后打开新页面，无法下载；IOS Lark 打开的内嵌网页可以显示，点击下载无反应。 这将是你看到过最全的pdf预览解决方案：使用的是 iframe 来预览，在 chrome 浏览器开发者工具中选择手机端 device 后无法预览 pdf，但在 IOS 的 Safari 可以直接预览。 file-saver: Due to restrictions in iOS saveAs opens in a new window instead of downloading。IOS 下无法实现点击直接下载文件，除了 Safari 开发者没有解决办法。        20230526  经验  5 款 iOS Safari 广告拦截插件横评——看完你就知道用哪个了： Adblock 最有用，但还需要设定语言，才会下载对应语言的规则。    20230525  经验  useSWR 如果验证没变，那么返回的应该是 304（作用于 GET，用的 etag 字段），如果是重新请求成功，POST 是 201，GET 是 200. Jackson Wu：研究某个复杂软件的源代码是一件很难的事情，推荐的做法是看它最早期版本，比如说 Linux Kernel，别看它现在有千万行代码，但其实它的核心设计在它只有几万行的时候就确定了。另一个推荐的做法是卡马克说的，自己尝试着去克隆某个项目，做一个玩具版的 xx，这样就能深刻理解它的运行原理。(500 Lines or Less)    20230524  经验  1-1评审了20份前端简历，其实每个人都有亮点：简历美化 伟大的公司需要多少人：不融资，不追求团队规模，更关注公司盈利能力 ip 地址怎么到 kong 服务？：在域名解析只能解析到服务器的ip地址，不能具体指定到某一个端口，只有域名默认解析到 80 端口。要使用 kong 网关，需要将 80 端口转发到 kong 服务的 8000 端口，如果 kong 是通过 docker 运行，则有端口映射 0.0.0.0:80-8000/tcp, :::80-8000/tcp, 0.0.0.0:443-8443/tcp, :::443-8443/tcp。 Next Image 以 width 为主，height 是等比例缩放的，高度值其实可以是任意值的，完全不会影响 width。    20230523  经验   扇形进度条：Filling circle sector in CSS\n  原理是，渐变函数相当于画一个圆，这个圆一半为红色，一半为透明色；两个渐变函数就是画两个这样的圆叠起来，透明重叠的部分即为小扇形，红色重叠部分即为大扇形。面积大的扇形用渐变函数涂，面积小的扇形用背景色。\n  代码如下\nif (radius  180) { return ( div className=\"h-5 w-5 rounded-full border-2 border-solid border-[#6fba2c] bg-[#6fba2c]\" style={{ backgroundImage: `linear-gradient(${90}deg, #fff 50%, transparent 50%), linear-gradient(${ radius - 90 }deg, #fff 50%, transparent 50%)`, }} /div ) } else { return ( div className=\"h-5 w-5 rounded-full border-2 border-solid border-[#6fba2c] bg-white\" style={{ backgroundImage: `linear-gradient(${-90}deg, #6fba2c 50%, transparent 50%), linear-gradient(${ (radius + 90) % 360 }deg, #6fba2c 50%, transparent 50%)`, }} /div ) }     Spring 中文文档\n  Closing a stale SSH connection\n    20230522  经验  How to Use TeamViewer Remote 小课堂：  举个例子，给你 1000块钱，100一张 ，10张，这10张100的，有没区别？从价值角度来说，没区别，因为都是100的，这个就是同质化的；从防伪角度来说，是不是一样的，不是，每个100的纸币，都有防伪码，唯一不可篡改的编码，这个就是非同质化。明白了吗？非同质化代币，对于区块链网络来说，就是在区块链上，不同编号的币，你先这么理解。 RAW，real assets wrod ，他的目的是引入真实世界的资产到虚拟世界。在股票市有一个名词：资产证券化，和这个比较接近。例如你有一个价值100w的房子，你抵押给银行，银行给你 80万人民币。这个就可以理解为你把真的房子的资产映射到了金融世界。因为从物理角度来说，房子和钱币来说属于两个世界，raw 在区块链世界，就是你抵押你的房子，给你虚拟世界的资产，例如比特币。抵押给银行了，这个动作发生在真实世界，在虚拟世界就不能抵押，虚拟世界也没有真实世界的房子。但是你抵押给银行了，可以在虚拟世界，给你虚拟世界的账户，打一笔钱，这样你房子的价值，是不是映射到虚拟世界了。明白了吗？记住是价值映射，raw 本质就是价值传导      20230521  经验  负责淘宝业务前端开发9年，聊聊我的心得：第一步做好本职工作——既快又好（保质保量）的完成业务需求，并尝试做些改变（纯粹造个轮子、换个理念重新实现轮子、尝试前端领域一些新特性或者新框架）。 软件开发团队如何高质量、高效率？：软件开发要达到高质量、高效率，就需要在代码可读性、可维护性和可扩展性等多方面都达到较好的水平才可以。“代码编程”是软件开发中最关键的环节。首先要保证质量，才能提升进度。遵照“权限编程”的实践思路来进行培养高水平的开发人员（其实就是大佬轮流带队，向大佬学习） 技术的广度与深度：我提这个问题，目标是提升自己在就业大军中的竞争优势  全能程序员 vs 特长程序员：“绝大多数成熟的程序员都专攻某一个技术栈，因为这样更容易找到工作。 一些专家甚至认为，在不同的技术栈中工作是简历的污点。\"（以公司角度） 知识广度 vs 知识深度：知识的广度能告诉你什么是正确的方向，知识的深度则可以让你在该方向上快速前进。雇主愿意为知识深度买单。因为你克服了技术难题，才有机会来领导团队。（以各自优势为角度） 技术的深度与广度，该如何取舍？：取决于你的屁股坐在哪一边。如果你的职业规划是在企业里步步高升，那么专注某个领域，并且努力成为那个领域的专家，会更符合企业对人才的要求。而如果你的志向在于体制之外，则各方面都懂一点，眼观六路耳听八方，时刻保持警惕，才是在残酷的大自然中繁衍生息的不二法则。（以人的不同位置为角度） 对于一个领域，深度重要还是广度重要？（可以拿自己所在领域举例，为后来人提供一些经验）?：初期的广度重要，“选择大于努力”；中期的深度重要，“高端人才永远短缺，初级人才永远内卷”；成熟期又变成广度重要。（以人发展的不同时期为角度） 如何平衡知识结构广度与深度？：知识的广度往往并不会产生直接的自我增值，知识广度本身是附着在某一个专业深度上的。（以学习的先后顺序为角度，先深后广）      20230520  经验   对于服务端来说，params 是动态路由，定义如 /test/:key，如果实际 url 为 /test/value，则 params 对象为 { key: value }，query 是查询参数，url 为 /test?key1=value1\u0026test2=value2，则 query 对象为 { key1: value1, key2: value2 }；对于客户端来说，查询参数就是 params，即 url ? 后面的部分。\n  next.js 下 css modules 选择器 .privacypolicy  p:first-child 不起作用，经过测试，我的写法是有效的，最后解决办法是不使用伪类，用 .privacypolicy  nav 。\n  How can I get (query string) parameters from the URL in Next.js?\nconst router = useRouter() console.log(router.query);     20230519  经验   Property ‘scrollTop’ does not exist on type ‘EventTarget’\nconst st = (e.target as HTMLElement).scrollTop;   JavaScript 中那些不会冒泡的事件： 滚动事件不会冒泡，需要在捕获阶段或者直接在该滚动元素上完成委托。\n  vscode在自动填充后失去常规代码提示的问题（连续自动补充失效）:\n\"editor.suggest.snippetsPreventQuickSuggestions\": false,     20230518  任务 经验  vue中使用setInterval()循环定时器的注意事项 问题：pinia 没有在多页面共享状态  解决方案：使用 vue router 的  组件 问题分析：vue 或 react 的 store 作用是在多页面共享状态，都是在页面不 reload 下生效的，而 a 标签会 reload 页面，因此需要第三方 router 库的路由组件来路由，防止页面 reload。   Vue关于data为什么是函数这件事 轻松理解JS 原型原型链：JS 只有对象，关键就在于清楚 .__proto__、.prototype 和 .constructor 变量的指向。 前端们，贺老 Live 面试你了！：会一个知识点不能代表你牛逼，只能代表你知道，所以还需要继续考察，但要是你不会，三言两语就学会了，那你肯定牛逼了。 rar/unrar for macOS: brew install rar; unrar x filename    20230517  任务 经验   div内显示两行或三行，超出部分用省略号显示\noverflow: hidden; text-overflow: ellipsis; display: -webkit-box; -webkit-box-orient: vertical; -webkit-line-clamp: 2;   How to listen for specific property changes in Redux store after an action is dispatched\nconst unsubscribe = store.subscribe(() = console.log('State after dispatch: ', store.getState().additon))   How can you replace entire state in Redux Toolkit reducer?: return action.payload\n  vue3.0+vite (二) vite.config.js基本配置：主要是 Vue Vite 解决 CORS 部分，官方文档 server.proxy\nserver: { cors: true, // 默认启用并允许任何源  open: true, // 在服务器启动时自动在浏览器中打开应用程序  //反向代理配置，注意rewrite写法，开始没看文档在这里踩了坑  proxy: { '/api': { target: 'http://192.168.99.223:3000', //代理接口  changeOrigin: true, rewrite: (path) = path.replace(/^\\/api/, '') } } }     20230516  经验  form 的 action 属性，就是 api 的路径，比如 action='/api/v1/i' 电信光猫F450——破解超级密码并配置无线IPTV How to Filter an Object by Key in JavaScript    20230515 纪念左耳朵耗子\n20230512  经验   问题：受控的 input checkbox 选中后，依次点击浏览器后退、前进，会发现该 checkbox 值是 false，但是 ui 还是选中状态，点击两次该 checkbox ui 会变为非选中状态。原因：如果该页面是通过正常的路由进行访问的，而不是直接输入地址访问，则会正确的卸载与重建。\n  Getting HTML form values\nfunction getData(form) { var formData = new FormData(form); // iterate through entries...  for (var pair of formData.entries()) { console.log(pair[0] + \": \" + pair[1]); } // ...or output as an object  console.log(Object.fromEntries(formData)); } document.getElementById(\"myForm\").addEventListener(\"submit\", function (e) { e.preventDefault(); getData(e.target); });   使用 for ... of 报错：Type 'IterableIterator' can only be iterated through when using the '--downlevelIteration' flag or with a '--target' of 'es2015' or higher，解决。\n  Redux 变化很大。\n  Array() vs new Array(): The spec says: When Array is called as a function rather than as a constructor, it creates and initialises a new Array object. Thus the function call Array(…) is equivalent to the object creation expression new Array(…) with the same arguments.\n  How to access all the direct children of a div in tailwindcss?: [\u0026*]:text-gray-200 or [\u0026*:hover]:text-blue-500\n  乌苏啤酒为什么被称为夺命大乌苏？：归根结底就是酿酒工艺差，杂醇多，导致上头感强，后劲极大，第二天醒来生不如死。\n  27岁转行风雨路\n 私活：国内的程序员客栈/飞援，国外的电鸭/upwork（更好）。（接私活不仅是赚钱，也能将学习的知识用于实际、增长经验） 经验：封装api/封装store/封装路由/封装公共方法，这四个大块做好了，其他的就是基本的页面逻辑，根据设计图填充就行了。 产品：原型——设计——开发，三个环节缺一不可。    Pure CSS Custom Checkbox Style\n  FormData使用方法详解\n  因为写不出拖拽移动效果，我恶补了一下Dom中的各种距离\n  redux middleware 详解\n  问题：整个页面都是表单，数量非常多，考虑要在前进、后退中保存表单状态，使用了redux，但是非常繁琐。解决方案：考虑使用 keep alive 保存整个页面的状态，使用 form 的 onSubmit 自动获取表单数据。\n React状态保存（Keep-Alive）实现方式概览 Next.js 适合用 React Activation，但不能使用 React.StrictMode 模式了    浅析Number.EPSILON及JavaScript中的数值误差问题\n    20230511  经验  margin: 0 auto; 水平居中条件  父元素有剩余空间 目标子元素为块级元素      20230510  经验   职场上好的沟通是生存优势。\n  代码不是先想好了再写，而是一边写一边想好。一个组件不知道怎么写，哪怕是看了文章后，虽然有思路，但是还是不知道具体怎么写，这是因为没有动手写，而不是你不会写。\n  double range slider input\n  看巧用两个type=range input实现区域范围选择的说明\n  看js使用input实现双向slider的实际代码\n  了解CSS3 pointer-events:none应用举例及扩展\n  通过Creating A Custom Range Input That Looks Consistent Across All Browsers了解 range input 自定义样式相关选择器\n  JS基础篇–了解JS的clientX、pageX、screenX等方法来获取鼠标坐标详解\n  React’s mouseEvent doesn’t have offsetX/offsetY: Get it from e.nativeEvent.offsetX.\n  How to round to at most 2 decimal places, if necessary\nMath.round(num * 100) / 100 Math.round((num + Number.EPSILON) * 100) / 100     Vant：轻量、可定制的移动端 Vue 组件库\n  谈研发人员怎么专注\n    20230509  经验  文章：图解 QUIC 连接 文章：Next.js小记    20230508  经验  Chatfo 分享到微信：在桌面浏览器与不支持的手机浏览器中将展示二维码；在支持的手机浏览器上利用原生分享组件直接跳转：   为博客添加分享到微信功能：使用qrcode展示二维码\n  JS 调用浏览器的原生分享组件\n Reference Error:Navigator not defined with nextjs: Browser objects like window , navigator etc should be define in useEffect first before use. Window it’s browser object, and the hook will run after it’s loaded, that’s why it will work.  useEffect(() = { // @ts-ignore TYPE NEEDS FIXING  import('nativeshare').then((res) = { const nativeShare = new res.default() nativeShare.setShareData({ icon: `${window.location.origin}/icons/icon-192x192.png`, link: window.location.href, title: `问题 ${qid}| 佛说 AI`, desc: '佛说，AI智能平台。', }) setNativeShare(nativeShare) }) }, [qid])   Web Share API 的使用 - navigator.share\n  react-share：社交媒体分享组件，同 vue-social-sharing\n      20230506 20230505  任务  群发邮件的api + UI接口，做到管理后台（要一个邮件模版）  Mailgun  奇技淫巧——整合Gmail与Mailgun实现免费域名邮箱 How Do I Send the Same Message to Multiple Users Using Mailgun?  Batch Sending Mailing Lists     中后台前端  Ant Design Pro  新增页面 Umi  路由 代理   环境变量   ProComponents：ProComponents 是 antd 的超集，但文档没有 antd 细。  PageContainer ProTable ProForm ProFormFields   Ant Design  社区精选组件：富文本编辑器 react-quill，修改样式参考 codepen 中的例子，基本上是通过类选择器来调整样式的。 Pagination分页：ProTable 的分页设置 国际化：首先，需要写对 language code，这样才能自动为支持的语言添加图标；其次就是修改一下locales根目录的ts文件的导入     HTML Email Template  Build an HTML Email Template From Scratch An Introduction To Building And Sending HTML Email For Web Developers HTML Email 编写指南 mjml - 如何快速編寫響應式電子郵件？        20230428  经验   ubuntu 自动更新导致 docker 服务全宕机：How to Disable Automatic Updates in Ubuntu\n$ sudo nano /etc/apt/apt.conf.d/20auto-upgrades APT::Periodic::Update-Package-Lists \"0\"; APT::Periodic::Download-Upgradeable-Packages \"0\"; APT::Periodic::AutocleanInterval \"0\"; APT::Periodic::Unattended-Upgrade \"0\";   「入坑指南」老司机带你玩转PSN账号：国服机器，外服需要备份还原大法，国服直接登录就行。\n 求助备份添加账号的问题 备份还原：让国行PS4主机用上港服账号      20230427  经验  Vue深层级过渡与显式过渡时长：要在在深层级的元素上触发过渡效果，关键在于传入 duration prop 来显式指定过渡。 通过项目驱动来学习技术，这里的项目不是指学习者从零开始自己写一个项目，对于新人来说，这太难了，而且很容易走错方向，这个项目指的是现有的需求类似的项目，学习者这参照这个项目从头来实现，在实现的过程中，学习其写法、添加自己的想法等，最终实现自己的需求、学会这套技术栈。 PlayStation®4用户指南    20230426  经验  How can I accept all current changes in VSCode at once?: Its very easy just go to vs code and press Ctrl+shift+p (command palette) or go to view and open command palette manually and type “merge” in your command palette, now you can see the Accept all current changes.    20230425  经验   [module not defined in Vue Project](https://stackoverflow.com/a/73353382: Add this to .eslintrc.cjs\nenv: { node: true, },   How can I import a svg file to a Vue component?\n  一种安装包 vue-svg-loader，把 svg 处理为组件\nimport SomeIcon from './assets/some-icon.svg'; SomeIcon class=\"icon\" /   一种是直接导入，不需要安装任何包\ntemplate img src=\"@/assets/my-svg-file.svg\" / /template     Using USB tethering on FreeBSD with Android\n  FreeBSD Wireless Quickstart\n    20230424  经验   NextJS Image component with fixed witdth and auto height\nImage src={img1} width=\"0\" height=\"0\" sizes=\"100vw\" className=\"w-full h-auto\" /   Vue 报错 Virtual script not found, may missing / \"allowJs\": true / jsconfig.json，在 tsconfig.json 或 jsconfig.json 中加入如下内容\n{ \"compilerOptions\": { \"allowJs\": true } } 作用是在 ts 中导入 js 模块：Allow JS\n  Vue: How do I call multiple functions with @click?\ndiv v-on:click=\"firstFunction(); secondFunction();\"/div // or div @click=\"firstFunction(); secondFunction();\"/div   关于vue ，v-on 绑定事件时，函数名加括号和不加括号的区别\n  vue.js中的data和props的区别\n    20230423  经验  写后端 api 不仅是后端的事情，前端也需要根据自己的需要来向后端提供需求，帮助其完善 api。前端最好再自己画 UI 之前，把需要的 api 列表交给后端，这样前端 UI 与后端 api 可以同步进行。    20230421  经验  公司自动化流程是：GitHub =webhook= Jenkins =ssh= Shell 脚本 = Kong 服务。一般先写脚本，脚本是核心，当脚本能够正确运行了，再添加到 Jenkins，配置 kong 服务的等。    20230420  经验   Lingui 删除多余 message：lingui extract --clean --overwrite\n  Prisma 存储中文字符串到 Mysql 后，通过命令行在 Mysql 查看，会发现中文显示为?????????????，这是因为默认用的 latin1 显示，参考两步解决MySQL无法显示中文即可解决\nshow variables like '%character%'; set character_set_client=utf8mb3; set character_set_results=utf8mb3;   Java Unicode编码 及 Mysql utf8 utf8mb3 utf8mb4 的区别与utf8mb4的过滤\n  TypeError: (intermediate value)(intermediate value)(intermediate value) is not iterable\n// 错误原因 You cannot destruct array value from undefined const filterValues = undefined const [startDate, endDate] = filterValues?.dateRange // 解决方案一 const [startDate, endDate] = filterValues?.dateRange ?? [] // 解决方案二 const dateRange = filterValues?.dateRange const startDate = dateRange?.[0] const endDate = dateRange?.[1]   TypeScript里的空值合并运算符(双问号)用法：当左侧操作数为 null 或 undefined 时，其返回右侧的操作数，否则返回左侧的操作数。\n  Bearer token in postman: You can just manually add an Authorization Request Header with a Bearer  value.\n  MySQL高级 —— 查询性能优化：查询性能低下最根本的原因是访问的数据太多。\n  get full type on prisma client\nimport { Prisma, PrismaClient } from \"@prisma/client\"; const prisma = new PrismaClient(); const userInclude = Prisma.validatorPrisma.UserInclude()({ cars: true, }); type UserWithCars = Prisma.UserGetPayload{ include: typeof userInclude; }; const usersWithCars = await prisma.user.findMany({ include: userInclude, });     20230419   经验\n  部署：正向合并 main = test = dev，反向合并 dev = test = main。\n  Github PAT\n 创建个人访问令牌 查看和撤销组织中的个人访问令牌    可以通过爱思助手将音乐导入 iphone apple music 中，如果提示有重复文件，就选择覆盖，否则可能出现音乐图片与音乐不匹配的情况，虽然我确实是删除了的。\n  待定的地方用 ### 填位置，也方便搜索。\n  如果页面分别写了手机端与电脑端的页面，且页面差异较大，在客户端用媒体查询切换非常不自然，那么可以通过 Next Middleware 实现在服务端切换 UI，如：\n// middleware.ts import type { NextRequest } from 'next/server' import { NextResponse } from 'next/server' import { UAParser } from 'ua-parser-js' // This function can be marked `async` if using `await` inside export function middleware(request: NextRequest) { const locale = request.nextUrl.locale const ua = request.headers.get('user-agent') const uap = UAParser(ua || '') const type = uap.device.type if (type \u0026\u0026 type.toLowerCase() === 'mobile') { if (!locale || locale === 'en' || locale === 'default') { return NextResponse.redirect(new URL('/mobile', request.url)) } return NextResponse.redirect(new URL(`/${locale}/mobile`, request.url)) } return NextResponse.next() } // See \"Matching Paths\" below to learn more export const config = { matcher: '/', }   密码学系列之:bcrypt加密算法详解\n  彻底搞清楚JS的模块化import/export/require…问题\n  大部分 require 改写 import，需安装 @types/bcrypt\n  // require 写法 const bcrypt = require('bcrypt') // 对应的 import 写法 import * as bcrypt from 'bcrypt'   20230418  经验   写 api 的时候，要想着，如果要换一个产品，那么当下产品哪些东西可以轻松地复用，而无关的东西可以轻松的删除掉，即，要把所有功能解耦合，这样才能在各个产品中方便地复用各种功能。\n  不论是写 api 还是看 api，都是通过 client 请求到 server 处理的流程来进行的。在 nest 中，就是先写 controller，在写 service，然后再不断完善相关的东西。比如写用户登录api也是如此，先添在 controller 中添加 register 的路由，在 service 中实现 register，先只考虑操作数据库，然后加上参数验证、验证码之类的东西。总之，先从简单的开始写起来，然后再在基础上不断添加东西。\n  nest.js grpc 遇到一个天坑\n// 写法一：这样写无法调用 grcp 服务 await this.grpcMailService.sendMail({ from: '', to: captchaDto.email, ...this.getMailContent(code) }) return this.redis.set(key, code, 'EX', 3 * 60) // 写法二：这样写可以调用对应的 grpc 服务 await this.redis.set(key, code, 'EX', 3 * 60) return this.grpcMailService.sendMail({ from: '', to: captchaDto.email, ...this.getMailContent(code) }) 参照 How to get non-Observable response when calling service from gRPC client?，原因是 sendMail 定义的返回类型是 Promise，实际的返回类型是 Observable，如果按照写法一来写，那么就不会等待 sendMail 执行完成就直接返回了。下面这样写就没问题了。\nconst result = firstValueFrom( this.grpcMailService.sendMail({ from: '', to: captchaDto.email, ...this.getMailContent(code), }) as unknown as Observableunknown, ) await result 这也表明 js 根本不知道数据的实际类型，也不回去检查。\n    20230417  经验   Lingui.js 在 React Component 之外使用翻译\n  Question: Can I use Translation outside react component ?: The t function uses the React context to know the available language and namespaces to use during the translation. Then, you can use the t function outside components as long as you pass the t function（这位其实已经给了思路，但是在不同项目中，细节是不同的。这里的 t 在我司项目里其实指的是 const { i18n } = useLingui() 中的 i18n）\n  Localizing your app\n  最终结果\nimport { I18n } from '@lingui/core' import { t } from '@lingui/macro' export const translate = (i18n: I18n) = { const result = i18n._(t`The Buddha said, AI intelligent platform.`) console.log(result) return result }     部署的时候，如果是网页应用，则只需要部署 test 与 prod，dev 相当前端本地起的服务，网页应用两个端口交替使用。如果是后端 api，则是需要部署 dev、test 与 prod，dev 用于前端本地起的服务使用，api 只需要一个端口。\n  花了三天时间终于搞懂 Docker 网络了\n    20230414   经验\n  问题：本地开发即使开了代理也无法访问 openai api，但是服务器可以正常访问\n  chatbot 服务：建立一个 chatbot 服务，部署在服务器端，处理 openai api 相关的请求（唐伟现在使用的）\n 搭建 OpenAI 代理（成功的解决方案）: Express + http-proxy-middleware 进行反向代理    代理 TinyProxy（无效）\n  Unauthorized connection：在于 Allow host，要么注释允许所有，要么正确设置\n  Node.js behind a proxy\nnpm config set proxy http://10.2.0.10:8888 npm config set https-proxy http://10.2.0.10:8888   axios proxy\naxios.post(url, data, { proxy: { host: \"127.0.0.1\", port: 7890, protocol: \"http\" } })   运行命令\ndocker run --rm --name tinyproxy -p 8888:8888 -e \"ALLOWED=10.2.0.9\" ajoergensen/tinyproxy curl --proxy 10.2.0.10:8888 -k https://www.google.com/     Remote Development using SSH\n    Docker compose global level logging\n  配置 Dockerfile\n  YAML anchor\nversion: \"2\" services: proxy: build: proxy image: kinoulink/proxy ports: - 80:80 - 443:443 volumes: - /var/run/docker.sock:/var/run/docker.sock:ro container_name: ktv_manager_proxy environment: - HTTP_AUTH_PASSWORD=$KTV_MANAGER_PASSWORD logging: \u0026logging driver: \"awslogs\" options: awslogs-region: eu-west-1 awslogs-group: docker rancher: image: rancher/server:v1.1.3 volumes: - rancher_mysql:/var/lib/mysql - rancher_cattle:/var/lib/cattle labels: ktv.infra.proxy.domain: 'rancher' ktv.infra.proxy.port: '8080' logging: : *logging   Extension field\nversion: \"3.4\" x-logging: \u0026default-logging driver: \"awslogs\" options: awslogs-region: eu-west-1 awslogs-group: docker services: proxy: build: proxy image: kinoulink/proxy ports: - 80:80 - 443:443 volumes: - /var/run/docker.sock:/var/run/docker.sock:ro container_name: ktv_manager_proxy environment: - HTTP_AUTH_PASSWORD=$KTV_MANAGER_PASSWORD logging: *default-logging rancher: image: rancher/server:v1.1.3 volumes: - rancher_mysql:/var/lib/mysql - rancher_cattle:/var/lib/cattle labels: ktv.infra.proxy.domain: 'rancher' ktv.infra.proxy.port: '8080' logging: *default-logging     配置 Daemon configuration file\ncat /etc/docker/daemon.json { \"log-driver\": \"json-file\", \"log-opts\": { \"max-size\": \"10m\", \"max-file\": \"3\" } } EOF systemctl restart docker   其他\n# 在重启 docker 前记住哪些容器是启动的，重启后对比一下（唐伟） docker container ls | awk '{print $1, $2}'  ~/containers # 在配置好后通过如下命令验证 docker inspect 89c551bd7ca0 | grep -i LogConfig -A 5     openai api stream\n  How to use stream: true?\ntry { const res = await openai.createCompletion({ model: \"text-davinci-002\", prompt: \"It was the best of times\", max_tokens: 100, temperature: 0, stream: true, }, { responseType: 'stream' }); res.data.on('data', data = { const lines = data.toString().split('\\n').filter(line = line.trim() !== ''); for (const line of lines) { const message = line.replace(/^data: /, ''); if (message === '[DONE]') { return; // Stream finished  } try { const parsed = JSON.parse(message); console.log(parsed.choices[0].text); } catch(error) { console.error('Could not JSON parse stream message', message, error); } } }); } catch (error) { if (error.response?.status) { console.error(error.response.status, error.message); error.response.data.on('data', data = { const message = data.toString(); try { const parsed = JSON.parse(message); console.error('An error occurred during OpenAI request: ', parsed); } catch(error) { console.error('An error occurred during OpenAI request: ', message); } }); } else { console.error('An error occurred during OpenAI request', error); } }   HTTP Stream using Axios (Node JS)\nconst response = await axios.get('https://stream.example.com', { headers: {Authorization: `Bearer ${token}`, responseType: 'stream' }); const stream = response.data; stream.on('data', data = { console.log(data); }); stream.on('end', () = { console.log(\"stream done\"); });     Nestjs Docs\n Configuration：管理自定义配置 HTTP module：用的 axiosInstance，返回的是 Observable Cookies：在服务端，需要通过多语言调用 chatgpt api，那么可以通过 cookies 获取客户端选择的语言，客户端应该尽量将语言存储到 cookies 中。 Prisma：数据库  Circular dependency   Redis：缓存  @liaoliaots/nestjs-redis。   RabbitMQ：消息队列  @types/amqplib Lifecycle Events：Consume 在 onMountInit 中调用   Authentication：使用 JWT 作认证   Passport\n  Validation：Dto 添加参数验证，支持类型自动转换\n  Exception filters：过滤 Exception\n  gRPC：通过 grpc 调用 mail microserver。\n  Assets：通过在 nest-cli.json 添加如下配置，自动将 .proto 文件复制到 dist 目录下\n{ \"compilerOptions\": { \"assets\": [{ \"include\": \"**/*.proto\", \"outDir\": \"dist/src\" }], \"watchAssets\": false } }     Rate Limiting：限流\n  Guards：\n JwtGuard 或者 RoleGuard。 注意 SetMetadata 只作用于特定的请求，不能作用于整个的 controller。     Interceptors：用于自定定义返回格式，如 { code: 1, message: 'ok', data } Swagger：  自动生成 api 文档，方便测试 api，可替代 postman 使用 DTO 和 @ApiProperty()；如果是可选参数，参考 Automatically detect optional @Query，应该使用 swagger 的 @ApiPropertyOptional() 而非 class-validator 的 @IsOptional() Bearer authentication：在 swagger 中测试需要认证的 api   CORS：允许特定域名跨域资源共享，设置在跨域下哪些 headers、methods 可以使用，详细配置查阅 Configuration Options File upload：文件上传。如果包含多个字段，只能用 FileFieldsInterceptor。    前端js如何根据文字识别语种？\n  文本内容相似度计算方法：simhash\n  redis可以多key对应一个value吗？：以手机号可以直接查询用户数据（mobile-hash），如使用身份证的话，先找出对应的手机号（id-mobile），再根据手机号取hash数据；\n    Prisma：The table (not available) does not exist in the current database：执行package.json中如下命令\n Generating the client：在本地生成 node_modules/.prisma/client Prototype your schema：会创建、修改相应的数据库（危险）  \"generate\": \"prisma format \u0026\u0026 prisma generate\", \"dbpush\": \"yarn generate \u0026\u0026 prisma db push\"   20230413  经验   后续技术组的所有docker文件，都加上log的最大限制\nlogging: options: max-size: 10m      20230412  经验   清除 Mac DNS 缓存：sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder\n  lark 基于现有表格建立新表格：右键表格tab栏，选择 dulicate，然后在新表格中最左侧勾选选择全部checkbox，删除即可。\n  多语言不能存储在 state 中，否则更新不及时，如果要为多语言文本设置相关状态，可以用数组下标来对应\nconst { prompts } = usePrompts() // 多语言内容 const initSelectedPrompts = prompts.map(() = ({ selected: false })) // 对应的状态 const [selectedPrompts, setSelectedPrompts] = useState(initSelectedPrompts) // 对应的状态用于 state  selectedPrompts .map((item, index) = ({ prompt: prompts[index], selected: item.selected })) .filter((item) = item.selected) .map((item) = item.prompt) .join(', ') // 处理   138 张图带你 MySQL 入门\n    20230411  任务  看接口实现  RabbitMQ  超详细的RabbitMQ入门，看这篇就够了！ nodejs使用rabbitmq示例   Redis  Redis入门，这一篇就够了       经验  chatfo-mail  用于发送验证码，没有自建邮件服务器，而是使用 Mailgun，可通过 post 或 grpc 调用。      20230410  经验  多种方式实现前端图片下载    20230407  任务  chatfo SEO：   参考 FreeFrom 及如下文章做 SEO（只考虑技术性 SEO）\n  Next.js SEO相关知识总结\n  網站 SEO 優化\n next-seo：实现 Meta 标签内容多语言关键点——NextSEO 和 DefaultSEO 類似，這裡提供的信息可以覆蓋掉 DefaultSEO 內相同種類的結果。 什么是 Open Graph 标签？不懂你还做什么社交营销优化？  Preview and Generate Open Graph Meta Tags   使用 JSON-LD 處理 SEO  JSON for Linking Data      NEXTJS添加 Google Analytics\nScript strategy=\"afterInteractive\" src={`https://www.googletagmanager.com/gtag/js?id=${GOOGLE_ANALYTICS_TRACKING_ID}`} / Script id=\"gtag-init\" strategy=\"afterInteractive\" dangerouslySetInnerHTML={{ __html: ` window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', '${GOOGLE_ANALYTICS_TRACKING_ID}', { page_path: window.location.pathname, }); `, }} /   提交 sitemap.xml \u0026 robots.txt\n  为站点生成 sitemap 要注意这 4 件事\n  Google 如何解读 robots.txt 规范\n  next-sitemap\nconst siteUrl = process.env.NEXT_PUBLIC_WEB_API_DOMAIN || 'http://localhost:3000' module.exports = { siteUrl: siteUrl, priority: 1.0, alternateRefs: [ { href: `${siteUrl}/en`, hreflang: 'en', }, { href: `${siteUrl}/ja`, hreflang: 'ja', }, { href: `${siteUrl}/zh_CN`, hreflang: 'zh-CN', }, { href: `${siteUrl}/zh_TW`, hreflang: 'zh-TW', }, { href: `${siteUrl}`, hreflang: 'x-default', }, ], generateIndexSitemap: false, generateRobotsTxt: true, robotsTxtOptions: { policies: [ { userAgent: '*', allow: '/', disallow: ['/*.js', '/*?*'], }, ], }, }       了解 SEO：\n The Beginner’s Guide to SEO 搜索引擎优化 (SEO) 新手指南 百度搜索引擎优化指南       经验   Error response from daemon: conflict: unable to delete … (must be forced): Both images have the same IMAGE ID. You can remove the image by its name instead of its ID\n  node 的环境变量写在 .env 文件中而非 docker-compose.yaml 中，万一构建失败，就可以使用原来的镜像，而不需要添加环境变量了。\n  EACCES: permission denied, unlink ‘/app/node_modules/.prisma/client/index.js’：原因在于混合使用 npm 与 yarn，全部使用 yarn 即可解决。\n# RUN npm i -g @nestjs/cli RUN yarn global add @nestjs/cli #RUN npx prisma generate RUN yarn generate     20230406  任务  帮忙迁移服务器：整体参考Docker容器迁移到其他服务器的5种方法   一个一个地备份：用 docker commit、save 备份运行中的容器，参考docker：export/save/commit谁才是你心中那个她；然后备份相应的 volume，参考Docker 使用数据卷容器备份、恢复、迁移数据卷\n# 备份容器 docker commit container-hash image-name docker save image-hash  image-name.tar # 恢复容器 cat image-name.tar | docker load # 备份数据卷 docker run --volumes-from volume-name -v $(pwd):/backup image-name tar cvf /backup/backup.tar /volume-moutpoint # 恢复数据卷 docker run -v /volume-moutpoint --name volume-name image-name /bin/bash # 创建一个空数据卷 docker run --volumes-from volume-name -v $(pwd):/backup busybox tar xvf /backup/backup.tar   迁移整个 /var/lib/docker：\n stat /var/lib/docker/overlay2/f7e0: no such file or directory：与镜像层有关，删除对应的容器与镜像 failed to create rwlayer：docker 残留影响的，执行一下 docker 清理 docker system prune       经验   How to copy an SSH public key to a server：\n# 生成密钥对 ssh-keygen -t rsa -C \"ubuntu@test\" # 拷贝公钥 ## 方法一 ssh-copy-id -i ~/.ssh/other_key.pub user@remote-host ## 方法二 cat ~/.ssh/id_rsa.pub | ssh user@remote-host 'cat  ~/.ssh/authorized_keys'   sudo sshd -T 输出有效 sshd_config 配置\n  Is a central location for authorized_keys a good idea?: Simply set up the sshd_config file like this: AuthorizedKeysFile /etc/ssh/authorized_keys/%u\n  Linux ps 命令查看进程启动及运行时间：ps -eo pid,lstart,etime |grep pid\n  top命令之TIME+：指的进程所使用的CPU时间，不是进程启动到现在的时间\n    20230405  经验  后端开发除了增删改查还有什么？：使用某种技术的目的，是为了解决问题、满足需求。对于平凡公司的平凡工人，我觉得提升自我的一个方法就是自己创造需求，只有喜欢钻研折腾的人，才能深挖技术。关键是你要有兴趣，去做了，才会遇到问题，去查了，才会学习成长。 重学 TS 一个项目并不是独立的，而是各种库、框架有机结合而成的。项目学习法，是以解决某个问题、满足某个需求为导向的，而不是以学会某个库、框架为导向的。因此，项目学习法，首先是去看能解决该问题、满足该需求的现有的项目；其次，是使其运行起来，有个直观感受；然后在阅读代码过程中，不断去学习相关的知识，使自己能够读懂代码；最后是，动手写一写代码，使其满足自己的具体需求、解决具体问题。（纯粹地阅读学习效果很不好，不仅没有学会、用不起来，而且还很容易枯燥，导致削减了学习兴趣，打击了学习热情） 独立博客：JSPang，技术胖 二十行代码，搞懂 Observable How do you grep a file and get the next 5 lines: grep -A 5 '19:55' file Hard reset of a single file:  git checkout HEAD -- my-file.txt The special “option” – means “treat every argument after this point as a file name, no matter what it looks like.” This is not Git-specific, it’s a general Unix command line convention. e.g. rm -- -f deletes a file named “-f”.ref 06.Git从放弃到入门： 命令checkout图解: git checkout -- ./ 回滚整个项目到最近一次的暂存或提交状态。      20230404  任务  解决 chatfo 头像缩略图：公司使用 node:16 作为基础 docker 镜像，要求在该 docker 中可以方便使用的方案。  webp-converter  优点：自带 precompiled executables of WebP，无需额外 linux 包 缺点：只能压缩图片大小（KB），而非缩小图片尺寸（200x200） 替代：   可以更改尺寸的 Jimp，使用纯 JS 实现。\n  How convert jimp object to image buffer in node?\nconst Jimp = require('jimp'); const img = Jimp.read('img.png'); img.getBuffer(Jimp.MIME_PNG, (err, buffer) = { console.log(buffer); });   maxMemoryUsageInMB limit exceeded by at least 217MB：使用的时候遇到这个问题，还未解决，巨坑。\n    压缩大小的 Squoosh!/imagemin\n     gm：参考nodejs使用graphicsmagick生成缩略图  优点：使用业界知名的处理库，功能比较全 缺点：额外依赖 linux 包 ImageMagick 或 GraphicsMagick 替代：   同样知名的 sharp ，自带编译好了的 libvips，next.js 同样推荐使用 Sharp Missing In Production\nlet useThumb = thumbPrefer let thumbUrl = '' if (thumbPrefer) { try { const thumbFile = path.join(uploadPath, `${fileNameWithoutExt}_thumb.${ext}`) const img = sharp(fileFullPath) const { width, height } = await img.metadata() const thumbSize = this.configService.getnumber('upload.thumbSize') if (width  thumbSize || height  thumbSize) { if (width = height) { await img.resize({ width: thumbSize }).toFile(thumbFile) } else { await img.resize({ height: thumbSize }).toFile(thumbFile) } } else { useThumb = false } thumbUrl = new URL(thumbFile.replace(uploadConfig.rootPath, ''), uploadConfig.staticUrl).href } catch (e) { console.log('Sharp: ', e) } }   node-canvascanvas 也可以生成缩略图\n     imaginary: image processing microservice。  优点：本身是微服务，还有 node-imaginary 作为 client 搭配使用。 替代：nginx-lua-GraphicsMagick，这个就很复杂了。       经验  VisBug：助力前端开发的浏览器插件 gRPC：  首先了解 gRPC 是什么：[gRPC初探——概念介绍以及如何构建一个简单的gRPC服务](https://www.cnblogs.com/takumicx/p/10059448.html） 然后了解怎么在 node 中使用 gRPC：开发基于 gRPC 协议的 Node 服务 最后把项目运行起来，使之可以用 bloomRPC 测试：[gRpc接口调试工具BloomRpc](https://juejin.cn/post/7129414359419191303）   Prisma  ORM 实例教程 精读《Prisma 的使用》 Environment variable not found: DATABASE_URL.   add .env file\nDATABASE_URL=mysql://root:0xAGroupu7e3@10.2.0.2:6306/chatfo-chatbot GRPC_CHATBOT=10.2.0.2:51151 GRPC_MAIL=10.2.0.2:51052 REDIS_NODE1_HOST=10.2.0.2 REDIS_NODE1_PORT=7001 REDIS_NODE2_HOST=10.2.0.2 REDIS_NODE2_PORT=7002 REDIS_NODE3_HOST=10.2.0.2 REDIS_NODE3_PORT=7003 STATIC_URL=https://teststatic.chatfo.ai URL=http://10.2.0.2:9188   run yarn generate\n        20230403   经验\n  前端组件讲究复用，但 api 讲究调用次数越少越好，能一次返回就一次性返回。\n  How to Fix “localStorage is not defined” in Next.js: Next.js performs a server render before the client render.\nif (typeof window !== 'undefined') { // Perform localStorage action  const item = localStorage.getItem('key') }   你真的知道 Cookie 吗？ SameSite 、 Secure 、 HttpOnly\n  …expression of type string cannot be used to index…\nconst someObj:ObjectType = data; const field = 'username'; // This gives an error const temp = someObj[field]; // Solution 1: When the type of the object is known const temp = someObj[field as keyof ObjectType] // Solution 2: When the type of the object is not known const temp = someObj[field as keyof typeof someObj]   js判断当前系统语言、浏览器语言：\n  需求是：\n 分享的时候，根据 url 链接中语言参数来选择语言；（通过 router.locale 来判断） 初次使用自动加载浏览器默认语言；可以通过语言选择按钮切换语言。（通过 cookie 来判断） 总结：路由中的 locale  cookie 中的语言选择  浏览器语言偏好  默认英文    解决方案：\nuseEffect(() = { async function load(locale: string) { // @ts-ignore TYPE NEEDS FIXING  i18n.loadLocaleData(locale, { plurals: plurals[locale.split['_'](0)] }) const { messages } = await import(`@lingui/loader!./../../locales/${locale}.json?raw-lingui`) i18n.load(locale, messages) console.log(locale) i18n.activate(locale) } const LANG_TO_LANG = { 'zh-CN': 'zh_CN', 'zh-TW': 'zh_TW', ja: 'ja', } const defaultLanguage = LANG_TO_LANG[navigator.language as keyof typeof LANG_TO_LANG] // 路由中的 locale 参数  if (locale) { const localeCache = Cookies.get('NEXT_LOCALE') if (Object.values(LANG_TO_LANG).includes(locale)) { if (!localeCache || localeCache !== locale) { Cookies.set('NEXT_LOCALE', locale, { sameSite: 'lax', }) } load(locale) } else { // cookie 中的 locale 设定  if (localeCache === 'en') { load('en') } else { // 浏览器中的语言偏好  if (defaultLanguage) { router.replace(router.asPath, undefined, { locale: defaultLanguage }) } else { // 默认语言  load('en') } } } } else { load('en') } }, [locale, router])       js-cookie: A simple, lightweight JavaScript API for handling cookies\n  20230401  经验   使用 next/image 的理由\n 自动优化图片的格式、大小 延迟（lazy）加载 利于 Google 搜索的 SEO    Mac中Chrome全屏模式工具栏和书签栏消失如何解决\n shift+command+f 在视图中勾“选在全屏模式下始终显示工具栏”    Mac 固定窗口顺序方法：点击左上角的小苹果=选择系统偏好设置=选择调度中心=进入调度中心界面（Mission Control），去掉“根据最近使用情况自动重新排列空间”选项即可。\n  useSWR 文档：useSWR 适合 Get 方法获取数据，不适合 post 调用传输数据，因为其要写在顶层，不能写在回调函数之中。\n 分页 useSWRInfinite：Global Mutate with useSWRInfinite，使用时需注意 getKey 函数的 if (previousPageData \u0026\u0026 !previousPageData.length) return null 行，因为不同接口放回的数据不一样，比如 previousPageData 不是数组，previousPageData.data 是数组，导致调用失败。 理解 SWR  isLoading 和 isValidating  无论数据是否已加载，只要有一个正在进行中的请求，isValidating 都会变为 true 。 当数据尚未加载并且有一个正在进行的请求时，isLoading 会变为 true 。     基于SWR的应用与实践 用 useSWR 实现轮询(Polling)，这种方式比使用 setInterval 来手写轮询要简单得多得多啊！   函数方式\n swr-polling useSWR successfully fetches , but data returns undefined：要直接返回 axios 的 res，但是项目用了 interceptors 处理    整数方式\nexport function useImage(aid: number) { const refreshInterval = useRef(100) const { data, error } = useSWR(image(aid), getImage, { refreshInterval: refreshInterval.current, onSuccess: (data, key, config) = { if (data) { if (data.image === '') { refreshInterval.current = 100 } else { refreshInterval.current = 0 } } }, }) return { data, error } }       上拉加载和下拉刷新是什么，如何实现，一文看懂\n  Prevent back navigation out of the app and redirect to home page instead.：如果直接通过 URL 访问 app 某个页面，后退会跳出 app 到浏览器首页，期望是跳到 app 首页。解决办法是：\nexport const getServerSideProps: GetServerSideProps = async (context) = { const previousRoute = context.req.headers?.referer || '/' return { props: { previousRoute, }, } }   Dynamic Router 的 [id] 可以是任意大小的数字，但是实际上并没有那么多的页面，因此，对于超过范围的页面，需要跳到 404。解决办法参考 How to Redirect to 404 Page in NextJS When Using Dynamic Routes，在 getServerSideProps 添加如下内容：\nconst flag = Number(context.query.flag) if (flag) { if (flag  0 || flag  5) { return { notFound: true, // 关键部分  } } }   HTML audio基础API完全使用指南\n    20230331  经验   剪贴板操作 Clipboard API 教程\nawait navigator.clipboard.writeText('Text');   所有文章链接尽量写进日记中，这样也方便搜索，文件搜的话还是不怎么方便。\n  可能这些是你想要的H5软键盘兼容方案\n  GitHub Clone With OAuth Access Token: https://oauth2:@github.com//.git。\n  CSS scroll-behavior和JS scrollIntoView让页面滚动平滑\nscroll-behavior: smooth;   上拉加载和下拉刷新是什么，如何实现，一文看懂\n  武汉人才安居：这个可以先申请资格，而不是一申请就需要去租一个房子，而是在需要的、合适的时候用在上面找房子。\n    20230330  任务   在手机上调试（访问 macbook 上开启的 node 服务）\n 手机访问，加 http，因为默认是 https，可能访问不了 打开关闭飞行模式 关闭移动网络    课堂：\n  域名 = DNS解析 = IP（服务器）\n 域名（web） = Kong Router (Path 规则 /) = Service (web) = Host:Port 域名（api） = Kong Router (Path 规则 /api/v1) = Service (api) = Host:Port 细节：   Router 通过 Path 规则将不同域名请求分配给对应的 service 处理，而 service 对应实际的服务。\n  主要关注 Service 的 Host 与 Port（容器宿主机 ip 与 port），Router 的 Hosts 与 Paths（域名与 path）\n Router 需关闭 Strip path（默认开启），作用是将 /api/v1/hello 改为 /hello Unable to add a Route to a Service：不是普通的输入框，输入内容后需按 Enter    每一个正式发布都需要给源码打一个 tag(v1.0.0)\n# 列出标签 git tag # 新增本地标签 git tag -a v1.0.0 -m \"v1.0.0\" # 删除本地标签 git tag -d  # 推送标签到远程 git push origin --tags # 列出远程标签 git ls-remote --tags origin # 删除远程标签 git push --delete origin tagname       如果 svg 图标显示不全，可以尝试清除 id 属性和  与  元素，如果不能删除的考虑修改 id 属性名称，保持不冲突。实在不行，就使用其他图标替代掉。\n  团队合作注意多沟通，编写页面时看看某个部分是否有在多个页面使用，考虑某一个人编写，其他人使用。\n    grep display filename before matching line: Try this little trick to coax grep into thinking it is dealing with multiple files, so that it displays the filename\ngrep 'pattern' file /dev/null   “url” parameter is not allowed next.js：为了保护您的应用程序免受恶意用户的侵害，需要进行配置才能使用外部图像。如果用 domain 的话，就不能指定 pathname，对于在子路径中的图片，可能会报错。\nmodule.exports = { images: { remotePatterns: [ { protocol: 'https', hostname: 'example.com', port: '', pathname: '/account123/**', }, ], }, }   原创 | 微服务网关 Kong 科普\n    20230328  经验   安装新 npm 包，需要 yarn build 看能否打包，否则就不使用。\n  React Hooks: useEffect() is called twice even if an empty array is used as an argument：useEffect(() = {}, []) 执行了两次，原因是因为启用了 React.StrictMode，对生产环境无影响。\n StrictMode renders components twice (on dev but not production) in order to detect any problems with your code and warn you about them (which can be quite useful).\n   Sourcetree：查看 Git 代码树\n  变量以 $ 符号结尾，可能他是写 angular 来的。\n $ suffix (popularized by Cycle.js) is used to indicate that the variable is an Observable. It could make it to the official style guide too but it’s not there yet\n   React Hot Toast：一个 Toast 库，主要还是改 Styling\n  du 命令计算隐藏文件夹或文件：du -sh *.[^.]*\n    20230327  经验   Attach Authorization header for all axios requests：\n  Login 成功后，存储 token 在本地并设置默认 Heaer\nlocalStorage.setItem('token', `Bearer ${result.token}`) axiosInstance.defaults.headers.common['Authorization'] = `Bearer ${result}`   页面刷新后，需从本地重新取回 token\naxiosInstance.interceptors.request.use((config) = { if (localStorage.getItem('token')) { config.headers.Authorization = localStorage.getItem('token') } return config })     接口要考虑别人使用，不要只考虑自己用着方便。\n  返回类型要写全，不要只写自己需要的部分。例如\nexport type UserInfoType = { id: number email: string username: string createdAt: string }   像这种信息可以存储在全局，而不是每次都需要获取。\n    React 滚动到底部加载数据\nfunction DataInfo() { const [dom, setDom] = useState(HTMLDivElement | null); const [logData, setLogData] = useState(''); // 获取数据的方法  function getLogPages () { ... } // 监听页面滚动  const handleOnScroll = () = { if (dom) { const contentScrollTop = dom.scrollTop; //滚动条距离顶部  const clientHeight = dom.clientHeight; //可视区域  const scrollHeight = dom.scrollHeight; //滚动条内容的总高度  if (contentScrollTop + clientHeight = scrollHeight) { getLogPages(); // 获取数据的方法  } } }; return ( div className=\"modal-body logHeight\" style={{ height: '480px' }} ref={(dom) = { setDom(dom); }} onScrollCapture={() = handleOnScroll()}  {logData} /div  ) }   React keyboard 事件\nconst keyDownHandler = (e: React.KeyboardEventHTMLDivElement) = { const key = e.code; }   How to create an array containing 1…N: Array.from(Array(10).keys())\n  react-simple-pull-to-refresh：下拉更新组件\n  CSS loaders and Spinners\n Pure CSS Loaders React Spinners     ChatGPT: AI提示词玩家  20230325  经验   du 命令计算隐藏文件夹或文件：du -sh * .[^.]*\n  web查看当前是哪个元素触发了滚动\nfunction findscroller(element){ element.onscroll = function () { console.log(element) } Array.from(element.children).forEach(findscroller) } findscroller(document.body)   getServerSideProps 函数：与 getStaticProps 只在build时生成一遍静态页面，或者定期重新生成页面不同，使用getServerSideProps，页面在每接收到一条传入请求就重新生成一遍。因为每次请求都是从数据库读数据重新生成页面，页面加载速度会变慢。但是使用getServerSideProps 可以访问 request 对象。如果页面不是需要每秒更新几次，或者不需要访问 request 对象，那么使用 getStaticProps 函数更好。getStaticProps 和 getServerSideProps 不能同时使用，参见 Use getStaticProps and getServerSideProps together\n    20230324  经验  记住，不要好逸恶劳，要生产自己的价值，要被人需要。 小课堂：  后端接口还没好，依旧要考虑接口，模拟接口返回数据，考虑全，后面可以直接改个链接。 在 fetcher.js，不知道接口请求参数、返回数据类型，可以用对象，方便添加内容。 付费的 copilot 与免费的 codeium：这个真的超赞，如果没人教的话，不知道怎么写，那么这个会给你一个范例。   公司的部署流程：本地项目 push 到 Github = 触发 Github hooks = Jenkins 执行宿主机脚本 = 脚本拉取 Github 源码、build docker 镜像、运行镜像 = 其他（Kong服务、域名绑定等）。每一个 web 服务拥有两个端口，新的端口用起来后，停用旧端口，保证服务可用性。    20230323  经验  适配任意尺寸方法  宽度不写死，100% 宽度（w-full），然后加一个最大宽度（max-w-），加 padding 调整间距。 高度不写死，内容撑高，然后加一个最大高度（max-h-），加 padding 调整间距，文本框还可用 row。 不能说为了 UI 而写死，也要考虑程序的写法。   整个页面高度为 100vh，最后一个元素占据剩余空间，其仅有的子元素占据所有高度，子元素内容如果超过高度，则出现滚动条。  最后一个元素占满剩余可用高度：用 flex-grow: 1，其他元素为 flex-grow: 0 还需要在父元素上添加 overflow: hidden;，子元素添加 overflow-y: auto;。即 How to make child div scrollable when it exceeds parent height?   navigator.clipboard.writeText() not working on specific IOS devices：There are security limitations on this API in (Mobile) Safari, one of which is it has to be executed on a site secured with https, so will not work on localhost. iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天：有不错的系列中文文章。    20230322  经验   获取焦点时移除placeholder，失去焦点重新获得placeholder内容\n  css\n/*WebKit browsers*/ input:focus::-webkit-input-placeholder { color:transparent; } /*Mozilla Firefox 4 to 18*/ input:focus:-moz-placeholder { color:transparent; } /*Mozilla Firefox 19+*/ input:focus::-moz-placeholder { color:transparent; } /*Internet Explorer 10+*/ input:focus:-ms-input-placeholder { color:transparent; }     lodash.shuffle：将数组打乱顺序\n  Next SEO - Title Template\n 在 seo.ts：{ titleTemplate = 'Next SEO | %s'; } 在某个页面：This is my title)} /      20230321  经验   md: 作为 Desktop 与 Mobile 的短点比 sm: 要好。\n  Viewport meta tags should not be used in _document.js's \n  Set your viewport meta tag in pages/_app.js\n  Next.js 暴露了一个内置组件 Head，用于将 HTML 标签添加到页面的 head 中。\nHead meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no\" / Head     禁止 IOS 移动端缩放\nconst lastTouchEnd = useRef(0) useEffect(() = { // 双指缩放  const handleTouchstart = (event: TouchEvent) = { if (event.touches.length  1) { event.preventDefault() } } // 双击缩放  const handleTouchend = (event: TouchEvent) = { var now = Date.now() if (now - lastTouchEnd.current  300) { event.preventDefault() } lastTouchEnd.current = now } document.documentElement.addEventListener('touchstart', handleTouchstart, { passive: false }) document.documentElement.addEventListener('touchend', handleTouchend, false) return () = { document.documentElement.removeEventListener('touchstart', handleTouchstart, false) document.documentElement.removeEventListener('touchend', handleTouchend, false) } }, [])     20230320  经验   Apple Cannot Check It for Malicious Software：在 Finder 中右键打开就行。\n  首先考虑移动端怎么做，移动端优先；用 devTool 开手机模式，然后可以拖放检查。\n  daisyUI 可以选主题，可以配置主题，在 tailwindcss.config 中 daisyui 部分修改。\n  Tailwinds 有 vscode 插件 Tailwind CSS IntelliSense。可以看到像素对应的 tailwind css 类，选择最近似的就行。\n  Dropdown CSS 代码是看的懂得吧！\nstyle .dropdown { position: relative; display: inline-block; } .dropdown-content { display: none; position: absolute; background-color: #f9f9f9; min-width: 160px; box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2); padding: 12px 16px; } .dropdown:hover .dropdown-content { display: block; } style div class=\"dropdown\" span鼠标移动到我这！span div class=\"dropdown-content\" p菜鸟教程p pwww.runoob.comp div div     20230318  任务  调查google登录和apple登录的整合登录情况  使用 passport 使用 Bass：Firebase Authentication/Day26 前端福音(1/4): Firebase-介紹 \u0026 建立專案 使用第三方库：  使用 NextAuth.js 给 Next.js 应用添加鉴权与认证 JustAuth   使用官方库手动整合：Google Identity Services/Configuring your webpage for Sign in with Apple     经验   开发规范\n git 使用技巧  git rebase 合并 commit，p 选择该 commit，s 向上合并，注意只能 rebase 没有 push 的 commit； git commit —amend 修改 commit message； git add -p 进入 patch mode ，让我们可以挑选一部分改动进行提交。   对开发的新功能，则命名为 feat-[功能名称]；对修复的bug，则命名为 fix-[bug描述]；命名时使用 - 减号来分割单词。 从dev上开新分支，完成后，合并dev分支到功能分支上，解决冲突（如果有）后提交PR到dev上。 在框架自动生成的多语言内容时，如果对应语言没有翻译内容，则不提交该文件。如果需要添加翻译内容，则运行yarn lingui让程序重新补充未翻译的内容。 网站内的路由跳转，使用链接（Next Link 标签）的方式跳转，而非 onClick 和 router.push，利于 SEO。站外链接统一用 “_blank” 方式打开。 可以使用 yarn lingui 生产对应的条目，git push 时需删除没有翻译的条目。    headlessui 写的手机端菜单侧滑动画，关键在于清楚 CSS 的 transition 和 transform，不要被 tailwindcss 迷惑了。\nTransition show={isShow} as={Fragment} div className={classNames('fixed left-0 top-0 h-full w-full', maskClass)} onClick={onMaskClick} Transition.Child className={classNames('relative h-full w-1/2 bg-white', menuClass)} style={{ marginLeft: reverse ? 'auto' : '0' }} enter=\"transition ease-out duration-100\" enterFrom={reverse ? 'translate-x-full' : '-translate-x-full'} enterTo=\"translate-x-0\" leave=\"transition ease-in duration-90\" leaveFrom=\"translate-x-0\" leaveTo={reverse ? 'translate-x-full' : '-translate-x-full'} as=\"div\" onClick={handleClick}  {children} /Transition.Child /div /Transition   监听 window 的 resize 事件，如果调整窗口大于1280 (preWidth = 1280) 或小于 1280 (preWidth  1280 \u0026\u0026 width reload 一次页面。\nconst { width } = useWindowSize() const preWidth = usePrevious(width) if (preWidth \u0026\u0026 width) { if ((preWidth  1280 \u0026\u0026 width  1280) || (preWidth  1280 \u0026\u0026 width = 1280)) { window.location.reload() } }   next/image 要求固定的 width 和 height，可通过一下方式实现 next/image 响应式改变大小\ndiv className=\"relative w-16 h-16 shrink-0\" Image src={avatar || DEFAULT_AVATAR} alt=\"avatar\" fill className=\"object-cover rounded-full\" / /div   在 React 中，不再 useEffect 中清除 timerID，通过 useRef 实现。\nconst timer = useRefNodeJS.Timeout() timer.current = setTimeout(() = {}, delay * 1000); clearTimeout(timer.current as number | undefined)   Material Design 指南中文版\n  Prevent scroll when modal is open\nuseEffect(() = { if (isShow) { document.body.style.overflow = 'hidden' return () = { document.body.style.overflow = 'auto' } } }, [isShow])     20230317  经验  有问题，一定要说出来，就不是自己的锅了，而是大家的。 产品问题找产品负责人，技术问题找技术负责人，但最终所有问题都属于产品问题，由产品负责人负责。 所有问题（UI、产品、测试）都汇总在一个表格之中，解决后@负责人。 编写代码后，本地测试通过，自测通过后合并需再测试，总之，在所有问题解决之前，不要说完成了，不要部署到正式服务器。    20230316  经验   How to Darken an Image with CSS：影响最小、符合预期的是使用图片的线性渐变\nbackground-image: linear-gradient(rgba(0, 0, 0, 0.5),rgba(0, 0, 0, 0.5)) , url(bg.jpg);   How to get a key in a JavaScript object by its value?\nconst getKeyByValue = (object: { [props: string]: string }, value: string) = { return Object.keys(object).find((key) = object[key] === value) }     20230315  经验   要在 Dropdown menu 中使用 Next.js 的 Link 标签，需要将 Link 标签放在最顶层，并且参考 Closing menus manually 手动关闭。\nMenu Menu.ButtonMenu/Menu.Button Menu.Items {menuItems.map((menuItem) = ( Menu.Item key={menuItem.name} {({ close }) = ( // get close function  Link href={menuItem.href} legacyBehavior a // Component  div onClick={close}{menuItem.name}/div /a /Link )} /Menu.Item ))} /Menu.Items /Menu   Using different API url for development and production with React and axios：利用 .env.development 和 .env.production 文件来自动切换生产环境与开发环境的 API 的域名：\nconst API_ENDPOINT = process.env.REACT_APP_API_ENDPOINT     20230314  经验   next/router：路由\nconst router = useRouter() router.push(url)   项目所有 url 都放在 src/config/share_url\n  Lark 日历使用文档\n  next-seo：每一个 Page 都需要 ，至少要有 title 属性，用于 SEO，具体位置不限——不要求放在最顶层，因为最后其会生成在 head 标签中作为 meta 元素存在。\n  Next Link 链接写法：\nLink legacyBehavior key={item.key} href={item.href} a className=\"underline\" target=\"_blank\"{item.text}/a /Link 我偏向使用原生的 a 标签，没懂这样写是干嘛的。写法具体参考 next/link - If the child is a functional component，也就是如果你想使用 Link 组件，必须遵守对应的语法规则。\n采用这种写法，可用通过 DevTool 来检查是否生效，可以看到其渲染为普通的带 href 属性的 a 元素，具体缘由参考 Next.JS “Link” vs “router.push()” vs “a” tag——即 Link 生成 a 元素并且不 reload page，单独用 a 元素会 reload page。\n  How to deploy a react app to a subdirectory: 今天张新勇老大遇到个问题，需要将 React App 到服务器 register 子目录，但是一直报错，因为其访问的资源指向根目录，解决办法需要将所有资源引用指向 register 这个子目录，解决方法如下：In package.json add homepage like below\n{ \"homepage\": \"https://domain-name.com/directory-name\", //OR  \"homepage\": \"/directory-name\", } 但问题并没有结束，其结果能让静态资源的引用指向 /directory-name 目录（index.html 中引用），但并没有解决超链接跳转问题。该项目使用 react 的类组件，使用 react-router-dom@5 来做路由。主要参考 React Router V4 but on a different homepage in package.json… fix 404 not found? 这篇文章\n  方法一：除了要在 package.json 添加 homepage 属性外，还需要在  中添加 basename 属性，即，并且将所有 a 标签替换为 react-router-dom 的 Link 标签，因为其自动添加 basename。\n  方法二：使用  来解决，除了不需要添加 basename 外，其他一样，然后可以如下方式写（马梦圆喜欢这样写😂）\nonClick={() = { window.location.href = \"#/Privacy_Policy\"; }} HashRouter 作用参考 React-router URLs don’t work when refreshing or writing manually，即客户端生成的路由，如  hash history，即  就可以绕过这个问题，因为总是请求根域名 \n  总之，这些配置基于这样一个目的：在本地（开发环境）下可以直接运行，方便代码编写与调试；打包的时候自动处理从开发环境到生产环境的迁移，例如调整链接、精简代码之类的；打包后可以直接在服务器上部署运行。\n  为了告诉开发环境的服务器去代理任何开发环境中未知的请求到我们自己的api服务器，添加一个proxy到package.json的字段，但在 next 中无效，需要使用下面的 next-http-proxy-middleware\n    20230313  经验：   在谷歌浏览器中对颜色进行十六进制、rgba、hsl切换：按住shift键，点击颜色快，即可切换。\n  ESLint\n  彻底搞懂ESLint\n  ESLint + Prettier + Typescript and React in 2022：\n 除了需要安装对应的 modules 外，还需要在 vscode 安装对应的插件才能起作用 ESLint：代码检测工具，Prettier：格式化代码。    ESLint + VSCode: How to Format Your Code Using .eslintrc：ESLint 可以将 prettier 作为插件，具备格式化代码的功能，参考 Integrating with Linters同时如下配置以启用\n{ \"eslint.format.enable\": true, \"editor.codeActionsOnSave\": { \"source.fixAll.eslint\": true } }   搞懂 ESLint 和 Prettier：eslint-config-prettier 和 eslint-plugin-prettier\n    Automatic Class Sorting with Prettier: yarn add -D prettier-plugin-tailwindcss\n  Gradient Color\ndiv className=\"bg-gradient-to-r from-[#9b4ae6] to-[#2b81e4]\"/   ‘tsc command not found’ in compiling typescript: npm install typescript@4.6.2 -g，版本与项目一致\n  How to View Page Source in Safari on Mac\n Choosing “Preferences”, going to “Advanced” and checking the box to enable the developer menu Press Command + Option + U keyboard combination to view the page source    Typescript interface 任意数量的属性\ninterface Test{ name: string; age: number; //可有可无  sex?:boolean, hobby:()=string, //自定义key 任意值  [propname:string]:any, }   Typescript 传递子组建：利用解构赋值将变量重命名为大写\nconst SocialMedia: React.FCSocialMediaProps = ({ comp: SvgIcon, ...reset }) = { return SvgIcon {...reset} / }   macOS批量图片处理：例如 resize 图片 sips -Z 256 input --out output\n  Command-line application for converting SVG to PNG on Mac OS X\nqlmanage -t -s 1000 -o . picture.svg It will produce picture.svg.png that is 1000 pixels wide.（PS：除非必要——文件太大，否则就使用原本的图片）\n  通过 // @ts-ignore 提示信息 注释隐藏 .ts 文件中的错误\n    20230311(🛌)   IBM LinuxONE Community Cloud：Virtual Server Deployment Guide\n成功注册了。很简单，不需要银行卡，就一个 icloud 邮箱，理由写的 “open source“。说是有 120 天的试用，不知道试用时间完了之后怎么说，反正如果邮箱足够的话，是不是有无线使用期限呢？反正我现在有个小鸡使用就行了，也没有什么复杂的需求，也有不了，因为用的 IBM s390x 架构。\nssh linux1@148.100.79.64   How to Kill user sessions in Linux\npkill -9 -t pts/2   Are IPv4 ports separated from IPv6 ports?：是的，在防火墙中需要分别为 IPv4 与 IPv6 设置端口与协议。但是要确定 VPS 的 IPv6 地址是公网地址，不是就没必要设置了。\n  How to curl using IPv6 address?：浏览器也是同样格式\ncurl -g -6 'http://[fe80::3ad1:35ff:fe08:cd%eth0]:80/'   20230311  经验   知道一个工具能干什么的比知道该工具具体怎么用更重要，很多教程一上来就讲这样做、那样做就成了，但是没讲我为什么要这样做、那样做。\n  tailscale 是 VPN（虚拟私有网络），作用是让你可以在公开的网络线路上建立一个私有的子网，起连接设备作用。要翻墙需要配合 proxy server，作用是将客户端请求流量转发到目标网站或应用程序，然后将响应转发回客户端。\n  先有现在，才有未来，先把公司任务完成了，才有机会去学习更多的知识。总之，学习知识和掌握技能不是目的，发挥自己的价值获取报酬才是目的。\n  画 UI 的话，先把内容填上去，然后再逐渐地添加样式，最后添加行为（即先只写 HTML，再写 CSS，最后再写 JS）。\n  Change Visual Studio Code’s title bar color\n\"workbench.colorCustomizations\": { \"[Name of the Current Theme you are using]\": { \"titleBar.activeBackground\": \"#191919cc\", \"titleBar.activeForeground\":\"#ffffff\", }, }, \"window.titleBarStyle\": \"custom\"     20230310  任务  我司流程：Github = CI/CD 工具（调用外部脚本打包并直接启动 web 服务器）   经验  即时设计：类 Figma cloudping.info：测试你的机器 ping 世界各地的亚马逊云服务器的速度。（AWS 云测速，一般需要关闭代理） 利用Docker 实现自动热部署  『前端进阶』🐳 Docker 部署 — GitHub Active 自动部署 世界互联网基础设施地图 printfriendly    20230309   任务\n  配置 Jenkins 的仓库同步与 docker 构建：关注点 Jenkinfile\n  中文文档比较旧，但是接触概念比较快，具体设置应该配合英文文档来看。\n  Pull Repository（Freestyle project 方式）\n  credentials: Manage Jenkins  Manage Credentials\n  How to use Github Personal Access Token in Jenkins：username 随意，password 为 GitHub 的 PAT。（这里花了好长时间）\n Go to credentials  System  Global credentials  Add credentials a page will open. In Kind drop-down select Username and password. In User put a non-existing username like jenkins-user or user. Add Personal Access Token in the password field    ERROR: Couldn’t find any revision to build：master 改为 main\n  例子\n  How to use Jenkins to Sync between your code repository on Acquia and GitHub?：用 cron 做 tigger，即勾选 Poll SCM。\n  Jenkins GitHub Integration：用 Webhooks 做 tigger，即勾选 GitHub hook trigger for GITScm polling，需要 GitHub Plugin，这样仓库一有 push 就会执行 build 流程。\n go to your GitHub repository and click on ‘Settings’. Click on Webhooks and then click on ‘Add webhook’ Click on Webhooks and then click on **‘Add webhook’**In the ‘Payload URL’ field, paste your Jenkins environment URL. $JENKINS_BASE_URL/github-webhook/ — for example: https://ci.example.com/jenkins/github-webhook/        Pull Repository（Pipeline 方式）\n  Jenkins Pipeline Github | Complete Tutorial With Example\npipeline { agent any stages { stage('Build') { steps { git url: 'https://github.com/naiveskill/devops_cred.git', branch: 'main', credentialsId: 'github_creds' } } } }     Build Docker Image（Pipeline 方式）\n 流程   先在本地编写 .dockerignore 与 Dockerfile 并运行通过\n  .dockeringore\n.git node_modules     然后编写 Jenkinsfile\ndocker.withRegistry('https://registry.example.com', 'credentials-id') { def customImage = docker.build(\"react-app-test\", \"-f ${dockerfile} ./dockerfiles\") customImage.inside { sh 'echo \"Stage Build Finished\"' } customImage.push() }       Docker: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock\n  The user jenkins needs to be added to the group docker, Then restart Jenkins.\nsudo usermod -a -G docker jenkins   或者，直接在 Jenkinsfile 中用 sudo（如果可以的话）\nsh 'sudo docker image build -t react-app-test .'     How to tell jenkins not to kill processes after successful execution of job in multijob project?: Jenkins : ProcessTreeKiller for pipelines: JENKINS_NODE_COOKIE=dontKillMe /your/mongodb/process\n  参考\n Using Docker with Pipeline Building your first Docker image with Jenkins 2: Guide for developers    其他\n  How to restart Jenkins manually?\n (jenkins_url)/safeRestart - Allows all running jobs to complete. New jobs will remain in the queue to run after the restart is complete. (jenkins_url)/restart - Forces a restart without waiting for builds to complete.    Fix the ‘expected a step’ Jenkins error: Surround all code snippets in a script { } block\n  10分钟搞定让你困惑的 Jenkins 环境变量\n  How to keep environment variables when using sudo: -E, --preserve-env\nexport HTTP_PROXY=foof sudo -E bash -c 'echo $HTTP_PROXY'     jenkins/jenkins：公司使用的部分\n Publish Over SSH：通过 ssh 执行宿主机脚本 jenkins/ssh-agent：参见 Using Jenkins agents，用于 Jeinks master 连接、管理 slave。        经验：\n 区块链业界新闻：ODAILY、区块律动    20230308   经验\n  Hardhat：帮助开发人员管理和自动化构建智能合约和dApp的过程中固有的重复任务。\n  iTerm2 相关问题\n  Dedicated Hotkey Windows：设置系统快捷键 Command + Return 在其他 Window 上打开一个 iTerm Session\n  iterm2 default window size\nYou have to specify the default window size in rows and columns. The setting can be found in iTerm  Preferences  Profiles  Window. (160 x 35)\n  How to open a new tab in iTerm in the same folder as the one that is open\nSelect “Reuse previous session’s directory” from the preferences of your profile.\n  How can I set an environment variable only for the duration of the script? VAR=value 是我想要的， env VAR=value 会 export 到当前环境之中。\nhttps_proxy=http://127.0.0.1:7890 http_proxy=http://127.0.0.1:7890 all_proxy=socks5://127.0.0.1:7890 sh -c \"$(curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh)\"   ohmyzsh Git 镜像\ngit clone https://mirrors.tuna.tsinghua.edu.cn/git/ohmyzsh.git cd ohmyzsh/tools REMOTE=https://mirrors.tuna.tsinghua.edu.cn/git/ohmyzsh.git sh install.sh   ohmyzsh plugin\ngit clone --depth=1 git@github.com:zsh-users/zsh-autosuggestions.git $ZSH_CUSTOM/plugins/zsh-autosuggestions git clone --depth=1 git@github.com:zsh-users/zsh-syntax-highlighting.git $ZSH_CUSTOM/plugins/zsh-syntax-highlighting .zshrc\nplugins=(git macos zsh-autosuggestions zsh-syntax-highlighting)       运维相关\n  服务器：hp server、orcale server、google cloud、desktop、pi\n  操作系统：Ubuntu\n  mysql/mongodb\n  redis cluster\n  elasticsearch\n  ipfs\n  ribbitmq 消息队列\n  koa/nest.js 服务\n  管理：Portainer、Kong\n  ansible：批量系统配置、批量程序部署、批量运行命令等功能。\n  auditd：审计工具\n  cloud-init：云平台为Linux操作系统的虚拟机做系统初始化配置的开源服务软件。\n  tailscale P2P VPN 工具：\n  安装配置：\nbrew install --cask tailscale defaults write io.tailscale.ipn.macsys ControlURL http://104.199.128.36:8082   运行tailscale，点击log in，获取类似headscale nodes register --user USERNAME --key nodekey:...命令，发给管理员让他加你进入。\n 注意关闭系统代理。 注意设置防火墙让 tailscale 通过。 如果无网则取消勾选 Use Tailscale DNS Setting。（Mac dns 也在 resolve.conf 中看）    最后与管理员沟通获取登陆具体服务器的信息，登陆用 VLAN IP。\n  连接之后是可以与 CFW 一起使用的！\n    OneDev CI/CD 工具：配置仓库同步（已弃，彭梓旭不喜欢 yaml）\n 获取 Github Person Token：就在个人设置的 Developer settings 中。 在面板中 Projects 栏中，点击 Import 导入 Github 仓库，根据提示填入对应内容。 查看 Commit and Push in Job配置 job secret，并为项目设置一个 checkout step（关键，否则不能 pull push），用 http(s) 认证。 参考在《OneDev里配置仓库同步》：  添加一个 pull（勾选 force） step（定义做什么），用于拉取 github 仓库。 设定 Cron Tigger 的 trigger（定义何时运行）。（Bruch update 只适合 push，pull 是不会自动的，除非用 github webhooks） 编辑后查看 .onedev-buildspec.yml 源文件，添加到项目中并同步到 github。 运行 Job 拉取 github 进行测试。 解释：同时加 push 与 pull step 的并勾选 force （必须，否则不能拉取最新的内容）的话，如果先 push，则会将 github 所有更改删除，先 pull 则会将 onedev 所有修改删除（即 .onedev-buildspec.yml 文件），因此干脆只用一个。   关键点在于 .onedev-buildspec.yml 这个文件。      20230307  经验   Mac 与 Windows 传输文件。我尝试了 FileZilla 与 Samba，都没成功，很烦。尝试使用 Snapdrop，体验没有 Aridrop 好（只有 2 MB/s 左右），问题例如：不能刷新，不能开代理，传输大文件中断。最后通过 python3 -m http.server 起个 http server 解决，http 本来就是分享资源的，完全可行。这里有个误区，传输老想着用传输工具，而不是使用现有的能够传输的东西。这里也发现 Mac 默认不开防火墙。\n  Orcale 永久免费云服务：很难申请成功。\n  Docker 相关问题：\n  How do I start the docker daemon on macOS?：\n 我用的 Macbook air 是 arm（M1），安装不了 virtualbox 啊！ 用 brew install --cask docker 安装，在桌面启动 docker.app，在 terminal 运行 docker 命令就行了。    Dockerfile RUN，CMD，ENTRYPOINT命令区别\n  Dockerfile 中的 COPY 与 ADD 命令：COPY 可用于 multistage 场景下，把前一阶段构建的产物拷贝到另一个镜像中；ADD 解压压缩文件并把它们添加到镜像中。\n  常用命令：\n# 创建 image 文件 docker image build -t freefrom -f Dockerfile.hardhat --platform linux/amd64 . # 查看镜像元数据，Layers 可看到镜像所有层 docker image inspect hello-world # 新建容器，容器的 3000 端口映射到本机的 8000 端口。 docker container run --rm -p 8000:3000 --name container-name -it koa-demo /bin/sh # 通过 docker-compose 新建容器 docker-compose up --build -d # 查看容器 logs，不论是 running 的还是 stop 的 docker contianer logs 69d1 # 进入容器 docker container exec -it 11fd20be74b6 sh # 清理 image、container、network、build cache docker system prune -af # 查看容器状态 docker container stats b901a13001a0   Puppeteer 报错：Puppeteer is a Node.js library which provides a high-level API to control Chrome/Chromium over the DevTools Protocol.\n  问题一：The chromium binary is not available for arm64\n因该是默认用当前系统架构，改架构用 --platform linux/amd64。 但是问题是成功创建了 linux/amd64 镜像后，在 M1 的 Mac 上也运行运行不了啊！\n  问题二：ERROR: Failed to set up Chromium r800071!\n因为只是测试 node_modules layer，所以暂时通过 --ignore-scripts 跳过。\n      How to copy multiple files in one layer using a Dockerfile?\nCOPY README.md package.json gulpfile.js __BUILD_NUMBER ./COPY dir1/* dir2/* ./  docker build 前端项目的话，每次都需要下载 node_modules，这也太耗费流量了吧。 解决：\nFROMnode:16COPY package.json /tmp/package.jsonCOPY yarn.lock /tmp/yarn.lockRUN cd /tmp \u0026\u0026 yarn install --frozen-lockfileRUN mkdir -p /usr/app \u0026\u0026 cp -a /tmp/node_modules /usr/appWORKDIR/usr/app解析：\n 所有docker 只用在命令“没有变化”时才会用缓存。而且，一但某一条命令没能利用缓存，那么后续的所有命令都不会使用缓存。除了 COPY 跟 ADD，只要 Dockerfile 里的指令行没有变化就认为没有变化。对于 COPY 跟 ADD ，还要比较文件内容跟属性。所以，如果先 COPY 整个项目，那么大多数情况下会有变化（没变化就不需要重打镜像了），于是不能使用缓存。 docker image 是分层的 (layer) ，每一个命令增加一个新的 layer 。打包结束之后，在打包的机器上，dockerfile 每一条命令执行之后“镜像”都存在，只要把相应的 layer 取出来就可以了。dockerfile 指令的执行，其实是先拿到上一个指令生成的镜像，执行当前指令，再把结果保存成一个新的镜像。两次执行 dockerfile ，如果发现执行当前指令的镜像已经存在，就直接拿过来用了，而不会重新执行指令，这就是所谓“缓存”。      20230306  经验：   OpenSea, the largest NFT marketplace\n  帕依提提-人工智能数据集开放平台\n  UNPKG - three.js\n  骨骼动画—从基础建模到Threejs渲染\nloader.load('./girl.fbx', function (fbx) { fbx.scale.set(0.1, 0.1, 0.1); scene.add(fbx); loader.load('./Walking.fbx', function (anim) { //创建了一个针对于该模型的混合器  mixer = new THREE.AnimationMixer(fbx); // 动画片段  var clip = anim.animations[0]; // 使用混合器和动画片段创建一个动画播放器来播放  var action = mixer.clipAction(clip); action.setDuration(1); action.play(); }); }); var clock = new THREE.Clock(); function animate() { // 向浏览器发送请求我希望你稍后调用函数，默认是每秒调用60次  requestAnimationFrame(animate) var time = clock.getDelta(); if (mixer) { mixer.update(time); } }     20230305(🛌)  three.js 关注点（笔记）：  render（渲染器） 渲染 scene（场景） 和 camera（相机），scene 中添加 mesh（模型）和 light（光源），mesh 由 geometry（几何体） 和 material（材质） 构成。 OrbitControls 鼠标操作三维场景。 参数widthSegments、heightSegments约束的是球面的精度，球体你可以理解为正多面体，就像圆一样是正多边形，当分割的边足够多的时候，正多边形就会无限接近于圆，球体同样的的道理。 辅助三维坐标系AxisHelper，光源辅助对象SpotLightHelper、PointLightHelper、DirectionalLightHelper，骨骼辅助显示 SkeletonHelper。 漫反射、镜面反射分别对应两个构造函数MeshLambertMaterial()、MeshPhongMaterial()。 类型数组之所以有类型这个定语，就是因为每一个构造函数对应一种 number类型里面细分的数据类型，例如构造函数Int8Array()创建的数组每个元素占据的内存是8位。 对于网格模型Mesh而言，几何体geometry由三个顶点为一组渲染出来的三角形组成。 平行光漫反射简单数学模型：漫反射光的颜色 = 网格模型材质颜色值 x 光线颜色 x 光线入射角余弦值 可以通过 .traverse() 递归遍历的算法去遍历Threejs一个模型对象的所有后代 所谓本地坐标系或者说模型坐标系，就是模型对象相对模型的父对象而言。世界坐标系默认就是对Threejs整个场景Scene建立一个坐标系，一个模型相对世界坐标系的坐标值就是该模型对象所有父对象以及模型本身位置属性.position的叠加。 纹理坐标：以图片左下角为坐标原点，右上角为坐标(1.0,1.0)，图片上所有位置纵横坐标都介于0.0~1.0之间。纹理UV坐标和顶点位置坐标是一一对应关系。 关键帧KeyframeTrack和剪辑AnimationClip两个API来完成关键帧动画，通过操作AnimationAction和混合器AnimationMixer两个API播放已有的帧动画数据。 通过Bone类可以实例化一个骨关节对象，然后通过多个骨关节对象可以构成一个骨骼层级系统；通过Skeleton类可以把所有骨关节对象Bone包含进来；SkinnedMesh类的字面意思就是骨骼网格模型。 导出模型信息：console.log(JSON.stringify(geometry.toJSON()));    20230304(🛌)  2022大前端总结和2023就业分析：  未来：AI 和 Cropto（PS：公司之前为区块链，现在人工智能机器人，完美覆盖啊） 2022年前端主流趋势  性能——构建工具：make = Grunt = Gulp = Webpack = Vite = Turbopack 运行时：Node.js、Deno、Bun 体积：SSR  通常产品开发都是先实现功能，然后再优化，然后再做周边 当你想提升性能的时候，除了万金油缓存外，减小体积就是最简单的方式 跨度领域：Gluon、Electron、Tauri、Neutralinojs   Rust 写前端基建，是当下趋势 前端垂类，其实是最吃香的部分：比如互动游戏，3d，webrtc，比如可视化编辑器，AFFiNE，QUill，X6      20230303  经验  在 vscode 中，Command+点击 lingo 组件属性，就可以到类型定义文件 d.ts，然后就可以看到支持哪些属性及其类型，然后见名知意，或查找这些属性都起什么作用。 像 onClick 这样的属性，按照上面操作后定位到类型定义文件后，就可以看其路径，然后在原文件中导入类型就可以使用了。 VSCode 插件 Live Server 解决跨域问题。   任务：  看完 Lingo3d.js 后，继续学 three.js（我司急需）  three.js：首先看《Three.js入门》这篇入门文章，然后以《Three.js零基础入门教程》为主，加上配套视频教程，以《three.js 官方中文文档》为辅（主要用于看最新的API）进行学习。      20230302  经验  lingo3d 关注点：官网可以用来调各种属性，看其作用（不完善且旧）；GitHub 上有以 example- 开头的仓库，都是例子。  World 组件  Model 组件：放人物或场景模型  src 属性：加载模型 fbx 文件，建议使用绝对路径 animations 属性：加载自定义动画 fbx 文件 animation 属性：使用模型本身包含的动画或自定义动画 physics 属性：值为 map 时，src 需要使用相应 scene（场景）模型，否则会发现，人物模型加了physics=\"character\"后，会不断的往下掉 ref 属性：控制模型的移动  ref.current.lookAt() 方法：人物看向目标点 ref.current.moveForward(-1) 方法：往自己前方走 onLoop 方法：每帧 ref.current.lookTo 方法：看向，最后为转向速度 ref.current.moveTo 方法：移动，最后为移动速度 ref.current.onMoveToEnd 方法：移动结束事件   innerY 属性：模型相对于 xyz 中心移动 intersectIDs 和 onIntersect 属性：当碰撞 intersectIDs 中指定 id 的模型时，会触发 onIntersect 事件 roughnessFactor 属性：粗糙度系数 Find 组件：定鼠标瞄准时状态   Dummy 组件：官方提供的人体模型 Cube 组件：立方体  x 和 y 和 z/depth 属性: x 轴、y 轴、z 轴 id 属性：可用于碰撞检测 texture 属性：材质 textureRepeat 属性：如果糊的话，就使之重复次数变高 onClick 属性：  e.point：位置（x、y、z）     OrbitCamera 组件：使相机按照一定的路径运动  autoRotate：自动绕y轴旋转   ThirdPersonCamera 组件：使相机看向并跟随放入其中的人物模型（Model 是其子元素）  ative 属性：激活相机 mouseControl 属性：鼠标控制 innerY 属性：移动内部的相机 lockTargetRotation 属性：解决人物不受控制 fov 属性：焦距，人眼在 50 左右，焦距越小，中心面越广   Skybox 组件：需要360度环绕背景图片（equirectangular），或者 Poly Haven Keyboard 组件：同 useKeyboard LingoEditor 组件：同 Editor HTML 组件：直接添加 html Editor 组件：需要关闭相机的 active，同失效的 map-debug（放在 Word 外部会在屏幕中间挡住内容）   Reticle 组件：准星 Setup 组件：代替在 World 组件中设置属性 Reflector 组件：反光板 useLoop(function, boolean) hook：循环，不断做某事 useKeyboard hook：鼠标事件 usePreload hook：预加载模型，返回 progress   Mixamo：  绑好骨骼的模型： with skin 下载（t-pose） 仅动作： without skin 下载，in place 复选框就不往前走（原地走）   @xstate/react：状态机（超赞）,例子链接，还有 xstate vscode 插件。 VSCode 快捷键  Ctrl+鼠标左击：跳到定义 Ctrl+-：返回 Command+i：显示智能补全 Command+.：quick fix Shift+Option+F：格式化代码 Command+Option+左方括号：折叠代码块 Command+Option+右方括号：展开代码块 Command+/：单行注释 Shift+Option+A：多行注释   typescript 自定义类型：TypeScript 入门教程：如果需要看源代码的话，例如 lingo.js 官方文档不全，那么只能通过源码来看如何使用了，这就要求有足够的 typescript 知识。我之前虽然系统学过 typescript，但是在看 lingo 源码还是疑惑 class 即是类又是类型的，经过查找回忆了起来，总结如下  在定义 class 的时候会创建同名的实例类型  定义：class ClassName {} 使用：  let a: ClassName = new ClassName() class ClassNameB extends classNameA     interface 定义接口类型  定义：interface InterfaceName 使用：  let b: InterfaceName class ClassNameB extends classNameA implements InterfaceNameA, InterfaceNameB     type 用于类型别名  定义：type TypeName = ClassName 使用：let c: TypeName   declare 声明类型：例如指定某变量为某种类型，用于代码补全、接口提示，多写在 d.ts 类型声明文件中  定义：declare let d: ClassName        20230301   文章\n 任意两个点的曲线连接JS算法：衡量自己Web前端技术的一个简单办法就是，如果让你实现这样一个产品，你能否立刻在脑中形成实现方案，并完成之。    任务\n 学习 lingo3d  官网有点问题，因此以别卷了，快来玩 | React+Lingo 实现一个超好玩的3D游戏：美女与龙珠这篇文章做入门，一边看一边做，然后看其参考的Lingo3D官方B站视频，看一遍，之后根据具体需求，在 Github 上 lingo3d organizations 的仓库集中选择一个对应场景的 example- 开头的仓库作为例子来学习，最后尝试自己完成一个项目，用到所学习的知识。      20230227  经验   VSCode Bookmarks 用于代码间跳转\n 使用 Command+Shift+P 搜索 bookmarks 可以看到所有快捷键 使用 Option+Command+K 为 Toggle 使用 Option+Command+L/J 为跳转    scrollbar 滚动到底部\n 在 typescript 中，需使用 useRef 并注意类型  创建时需要设定初始值范型 const inputEl = useRef(null); 访问时需要在条件语句中 if (inputEl.current) { inputEl.current.focus(); // Works! }   可在 componentDidMount/componentDidUpdate 或 useEffect 中调用 作用在父容器，滚动到最底部方法为： $div.scrollTop = $div.scrollHeight 作用在子元素，可用 scrollIntoView：例子    在 useEffect 中访问之前的状态（How to compare oldValues and newValues on React Hooks useEffect?）：使用 usePrevious\n// modified from https://usehooks.com/usePrevious/ export default function usePreviousT(value: T) { // The ref object is a generic container whose current property is mutable ...  // ... and can hold any value, similar to an instance property on a class  const ref = useRefT() // Store current value in ref  useEffect(() = { ref.current = value }, [value]) // Only re-run if value changes  // Return previous value (happens before update in useEffect above)  return ref.current } 原理：jsx的渲染比useEffect早，ref.current 是 preState，useEffect 是最新 state\n  Mutation：类似 useState，用来修改更改远程数据及相关缓存\n mutate()/mutate(key)：将数据标记为已过期并触发重新获取(revalidate is deprecated) mutate(key, data, options)：修改本地缓存数据，可选是否重新获取      20230226   经验\n  如果不想在 useEffect 第二个参数数组中加入某个状态，但是在 useEffect 中又需要改变与访问该状态，则可以将一个返回新状态的函数传递给 setState。\nconst [currentState, setCurrentState] = useState(defaultState) useEffect(() = { // prevState为上一次的状态(previous)  setCurrentState(prevState) = { const newState = { ...prevState, ...appendState } return newState }) },[])     setInterval in React：我记得在 React 文档中看到过，但是找不到了。\nuseEffect(() = { const interval = setInterval(() = { console.log('This will be called every 2 seconds'); }, 2000); return () = clearInterval(interval); }, []);   判断数组中是否存在某个元素：indexOf、find、some、includes\n  GitLens 可以增强 VSCode 内置 Git 的功能。例如 commits 搜索，历史记录和显示的代码作者身份\n  20230225  经验   参考建议添加以下规则，osx下有可能会导致偷跑流量 添加如下规则\n- DOMAIN-SUFFIX,googletraveladservices.com,DIRECT - DOMAIN,dl.google.com,DIRECT - DOMAIN,mtalk.google.com,DIRECT - DOMAIN,safebrowsing.googleapis.com,DIRECT   最小的屏幕是 280px，Galaxy Fold\n  监听动画结束\n transitionEnd事件会在CSS transition动画结束后触发。 当存在多个属性过渡变化时，结束时会多次触发transitionend事件。      20230224   经验\n  NEXT_PUBLIC_DEFAULT_CHAINID 就是不同的区块链，其是固定的，97 是公司测试链，1 是以太坊\n  ETIMEDOUT：This is caused when your request response is not received in given time(by timeout request module option).\n  代理下 git 无法 clone，cfw 可以绕过系统代理，这样就 OK 了，但在 TUN 模式下这个是无效的。\nbypass: - \"github.com\" # 下面字段可不删除 - 127.0.0.1 - ... 更新：这种方式不好，这样用 git 确实是可以 clone 了，但是浏览 github 网页却很慢（即没被代理）——我的需求是，可以 git clone，同时在网页也能快速访问 github，即 git clone 不被代理，github 被代理。 尝试配置文件预处理 一直没成功，烦，现在暂时只能在需要 git clone 的时候关闭代理了。 CFW 本身就是用的 clash Premium，因此可以参考clash更新订阅时保留自己的规则，自己写一个带 proxy-providers 的配置文件，然后添加以下 rule 即可\n- PROCESS-NAME,git,DIRECT   SVG Screenshot：可以将网页保存为 svg （选择框或视口内容）\n    任务\n 除了 UI 图，还有产品文档，还有测试网站。根据产品文档+测试网站开发网站（我觉得应该用开发网站，即用最新的nofar分支，yarn dev 来体验，这是最新的，bug 也是最新的）走通流程，然后去细看 UI 设计+项目代码，快速熟悉。    观点\n APP 的价值在于其对用户是有用的，要有用，前提是能用，所以没有 bug ，或者说没有影响正常使用的 bug 至关重要。 没有 bug 比各种新奇或者强大的功能更重要，老话说：”不要没学会走就开始跑“；比现代化、炫酷的 UI 更重要，Linux 上有很对 ui 简陋的工具，但是却是许多人的生活的一部分， 我还是赞同 Polly 总结的：产品没 bug + 很多人知道    20230223   经验\n  Error: Run autofix to sort these imports!：与simple-import-sort/imports相关，就是 import 导入顺序问题，需要在 VSCode 中安装 ESLint 插件，并在相关页面用 Command+. 快速 fix。\n  commit 提交需要根据 https://github.com/conventional-changelog/commitlint/#what-is-commitlint 填写信息。例如 git commit -m \"feat(官网页面) : 多语言修改\"\n  可以看《i18n与lingui-js总结》了解国家化原理：1.0 为哈希表，键为原文，值为翻译的文本，通过键取值；2.0 为键为原文，值为函数，通过函数实现支持变量插入；3.0 是引入 babel 实现开发友好。\n  CSS实战–实现侧边栏滑进滑出：菜单的遮罩层是必要的，这样就可以通过点击遮罩层来隐藏侧边栏菜单了。滑进滑出原理就是利用定位移出元素到视口外。\n.mask { position: fixed; left: 0; top: 0; width: 100%; height: 100%; }   MouseEeventHander 区别于 MouseEvent\nconst handleAsideClick = (e: React.MouseEventHTMLElement) = { e.stopPropagation() }   next-http-proxy-middleware：用于在开发环境中测试 api 调用，解决跨域问题。在 next.config.js 中添加\nasync rewrites() { return [ { source: '/api/v1/:path*', destination: 'http://10.2.0.10:9188/api/v1/:path*', }, ] }, 添加还需要重启服务。\n  【flex布局】解决view中两个元素一个居左一个居中：其实就是建立第三个元素，其与第一个元素一样宽度，但是没有内容。\ndiv className=\"flex justify-between items-center\" Menu className=\"w-[50px]\" / LogoIcon / div className=\"w-[50px]\" / /div     观点：\n  关于Tailwind CSS是一切堆到class里的歪门邪道这种说法如何评价？\n Tailwind解决了”CSS 类命名“、“样式冲突“、“模块复用”等问题 如果说传统的编程箴言是 DRY(Do not repeat yourself)，那 Tailwind CSS 就应该是 TRY (Try to repeat yourself)    Tailwind CSS （可能）是名过其实的：一大堆类名污染 HTML 结构中的每一个元素\n    问题：\n Is there a difference between storing a const value in a variable vs in state?: Runs useState and compares the value with the previous state on every render which is “much more expensive” than declaring a variable.    20230222   经验：\n  Icon 都在 components/Icon/index.tsx 中\nexport const AppleIcon = (props: React.ComponentProps'svg') = { return (svg {...props} svg); } 这里需要删除原图标的 wedith 与 height 属性，并用 {...props} 代替。还需要将 clip-path 等替换为小驼峰命名方式 clipPath。\n  - 先完成大致的 UI 与 页面逻辑，细节之后再慢慢调。先完成任务，再把任务完成得好。\n 遇到什么页面问题需要与 UI 沟通调整的，可以先记录在记事本中，之后再在 UI 能回应时处理。 移动 UI 图为 750px，其是 2 倍图，需要除以 2 才等于实际的值，包括元素的宽度与字体大小，反像素值都除以 2。 用 tailwind css 的 last: 与 first: 选取元素。    问题：\n  How to hide scroll bar in react app with allowing scrolling\n可以在全局 css 样式表 src/styles/index.css 中添加如下内容\n.noscrollbar { /* hide scrollbar for IE, Edge and Firefox */ -ms-overflow-style: none; scrollbar-width: none; } .noscrollbar::-webkit-scrollbar { display: none; }   Horizontal Scroll Image Pure CSS\n.scroll-container{ overflow: auto; white-space: nowrap; } .gridscroll{ display:inline-block; } .gridscroll img { margin: 0 15px; }     20230221   任务\n 基于 dev 分支开发新 Freefrom 官网。    经验\n Figma 导出 3x 图片就很清晰了 svg 可以作为 React 组件，不能作为 img 的 src。使用为  随便点击某个颜色属性，就会弹出color palettes（调色板），其中有 color picker    前端工具：\n Lighthouse：可以在 DevTools 中使用 Lighthouse 来审核页面的可访问性并生成报表。 Measuremate：页面元素距离检查工具    20230220   任务\n 翻译NTFTOPSHOW官网内容 新建项目，迁移 Freefrom 官网，只要静态页面，不要多语言，能删的都删掉 图片要优化，不能太大，考虑webp格式。  可以使用 https://convertio.co/ 转换要不断切换页面，限制最多转换两个 可以使用 cwebp，brew install webp   学习优化，如优化工具 https://www.pingdom.com/。    经验\n  使用多语言步骤\n// 引入 import { t } from '@lingui/macro' import { useLingui } from '@lingui/react' // 使用，需提前在在 locale 添加相应的翻译 const { i18n } = useLingui() {i18n._(t`Translation`)}   简单的库的话，直接看官方文档；大型的如 React 就先看入门教程\n  使用的话优先使用 import 而非 requires，因为有些时候 requires 无报错，但import话就有报错。\n  因为要支持多语言，因此最好不要使用 uppercase 等 text-transfrom 属性\n  公司项目使用的 UI/CSS 库\n @fullpage/react-fullpage: A simple and easy to use library that creates fullscreen scrolling websites (also known as single page websites or onepage sites) and adds landscape sliders inside the sections of the site. react-responsive: Media queries in react for responsive design Swiper: The Most Modern Mobile Touch Slider。主要通过看 Swiper Demos 来学习使用  Safari jumps two slides on mouse-wheel with trackpad or magic-mouse：我也遇到这个问题，无法解决 How to change swiper-slide width?：设置 slidesPerView=\"auto\" 后自适应容器宽度，否则 width: 3.35544e7px; How to disable vertical mouse wheel swiper react: forceToAxis: true,   daisyUI components: Use Tailwind CSS but write fewer class names tailwindcss-border-gradient-radius: Border Gradients Plugin for Tailwind CSS based on background-origin and background-image @fontsource/dm-sans: The CSS and web font files to easily self-host the “DM Sans” font. react-virtualized: React components for efficiently rendering large lists and tabular data heroicons: Beautiful hand-crafted SVG icons（Font icon 可以直接用 svg 代替），图标库 @headlessui/react: UI components for React tailwindcomponents      featrues 特色的地方：\n 内容即NFT - 发布内容自动生成NFT，让内容上链，确定权利。 完全去中心化 - 通过集成开放性协议nostr，没有任何平台可以禁止或审查你。你可以控制你的数据和言论。 发帖赚钱 - 通过创造高质量内容获得粉丝的打赏奖励，同时获得平台激励。 DAO社区增强 - 通过团结内容及粉丝来创建自己的去中心化的DAO社区 数字ID - 通过建立DID，创建一个Web3的独特身份，组织自己链上资产建立自己的Profile。 加密私信 - 端到端的加密的私人信息，让大公司远离你的DMs。    Mac 快捷键\n 切换vscode页面上面的标签 Option+Command+左右方向键 Shift+Command+3 拍摄截屏幕 Shift+Control+Command+3键会在剪贴板里获取整个屏幕的截图 Shift+Command+4 捕捉的屏幕区域，再按下空格键可捕捉窗口 Shift+Control+Command+4键则能使你通过拖动鼠标来截取部分屏幕，并复制图片到剪贴板，再按下空格键可捕捉窗口 退出全屏 Ctrl+Command+F 或 Fn+F 刷新浏览器：Command+R，强制刷新：Command+Shift+R Option + 方向键左，将光标移动到前一个单词 Option + 方向键右，将光标移动到后一个单词    问题\n  Property ‘credits’ is not recognized as an available option\nReactFullpage licenseKey='REDACTED' scrollingSpeed={500} credits={{ enabled: false }}     20230218   公司 next.js 项目流程和目录含义\n 首先看 src/layout：布局类 其次看 src/pages：页面，pages 页面对应着路由，src/pages/home/ 路由就是 localhost:3000/home/，开发的时候也可以根据浏览器 URL 找对应的页面。 然后看 src/features：每个 pages 对应的组件 tailwind.config.js 有些样式写在这里  src/styles/index.css 为全局样式表 src/src/styles/variables.css 定义全局字体   Typography 组件用来排版的，主要是字体相关的属性    任务：\n  https://pancakeswap.finance/ 首页的图片，后续我们换成这样会动的，用css的来实现，你研究下他们这个。\n  首先通过 devtool 的 animation 找到对应的元素为 path.eye。\n  由于页面这个部分不断地跳（好像是不断的重新创建），因此用 command + s 保存离线网页。之后看到\n.cSXBDs .eye { animation-delay: 20ms; } 实现动画的底层技术就是CSS或JS，这里可以看到用了 css 控制动画时长\n  通过 devtool 的 network 获取 css 样式表，用 css fromatter 格式化，找到 @keyframe，但好像都无关动画定义。\n  参考 SVG 动画 与 SVG 闪烁动画（Blink） 我认为使用 JS 实现的动画可能性更大。而且仔细看 devtool 的 animation 中的动画时长为 280 ms，远大于 animation-delay 的 20ms，而这个类主要用于 JS 控制元素。\n      技巧：\n  用 flex flex-1 justify-center align-center gap-[74px] 的 gap 来控制两个子元素间距，而非 margin\n  尽量不要用 absolute 之类的定位写 ui，尽量让元素在正常文档流之内。\n  React.jsでlocation.hrefを用いた外部URLへの遷移\ndiv onClick={() = { window.location.href = \"https://google.com\"; }}Googleへ/div   Mailto on submit button\nform action=\"mailto:youraddr@domain.tld\" method=\"GET\" input name=\"subject\" type=\"text\" / textarea name=\"body\"textarea input type=\"submit\" value=\"Send\" / form   Chrome 原生截长图\n打开浏览器，f12 进入开发者模式，使用快捷键 Ctrl+shift+p 呼出命令面板，输入 full 来过滤命令，找到一个 名叫 Screenshot capture full size screenshot 的那一项，点击后稍等一会就会生成一整图片保存到本地。\n  使用yarn英文官方网站corepack 安装yarn方法在m1上老是失败，报错must be built because it never has been before or the last one failed，如果用普通的 npm -g 则没这个问题。\n    20230217   数支用到的工具：\n team task manager：asana 沟通工具：前端 钉钉，后端 teams（一星期两会） API：postman    现公司用\n 沟通工具 Lark（一天一会） team task manager：Trello    感悟：\n 我发现如果只是编写简单的 UI 的话，可以直接开个项目，当 UI 编写完毕之后再迁移到原来的项目。因为原项目东西太多，加载运行都非常慢，非常浪费时间，不如直接在简单环境中达到目标，然后再在复杂环境中。    问题：\n  冒号垂直对齐：可以使用 table\n  使用线性渐变使图片变暗\nbackgroundImage: 'linear-gradient(rgba(0, 0, 0, 0.4),rgba(0, 0, 0, 0.4)) , url(/images/home/bg.webp)'   React onHover Event Handling (with Examples)\nbutton onMouseEnter={() = setIsShown(true)} onMouseLeave={() = setIsShown(false)} Hover over me! button     MacOS pkg（例如 node.js）清理工具 UninstallPKG\n  20230216   如何学习 Tailwind CSS？\n 针对特定框架安装 Tailwindcss 首先看Tailwind CSS中文文档核心概念部分 再在 Tailwind 英文 直接搜索需要使用的 CSS 属性    问题\n  Background image in tailwindcss using dynamic url (React.js)\nstyle={{backgroundImage: `url(${fetchedImgSrc})`}}   How to work with background images in Tailwind CSS\ndiv class=\" bg-no-repeat bg-cover bg-center bg-[url('../public/images/hero-mobile.jpg')] md:bg-none xl:bg-[url('../public/images/hero-desktop.jpg')] \"div   react如何定义全局变量\n// 定义，例如起一个文件名为globalData.js global.全局变量名称= { aaa:'111', bbb:[]', }; // 使用 // 方式一 import 全局变量名称 from './globalData'; // 方式二 div名称：{global.全局变量名称.aaa}/div   Factory resetting your MacBook\n Click the Apple logo on the top left corner of your screen, and select System Preferences from the dropdown menu. Click the System Preferences option which appears next to the Apple logo in the menu bar and pick Erase All Contents and Settings in the dropdown menu*.*      20230215  经验：  next/image，包装 NextImage next/config tsconfig/paths 设置别名后，import 报 Module not found: Error: Can't resolve，如果不设置别名就无此问题，或者用tsconfig-paths VSCode 噴 Unknown at rule @tailwind 解決方式 TailwindCSS 有使用到一些 TailwindCSS 自己自定義的 CSS 語法，所以在許多編譯器在會無法辨別而導致出現錯誤或警告，而我們本身使用 TailwindCSS 都會搭配 PostCSS，所以就會有一個 postcss.config.js 設定檔，這時候我們只需要替自己的 VSCode 安裝 PostCSS Language Support 套件就可以解決 Unknown at rule @tailwind 的問題囉。 在 Create React App 中修改 Webpack 設定，以調整 Webpack Alias 為例    20230214   问题：在无法用 export 导出 i18n 的路由\n 方法：  用现成解决方案  Static HTML Export with i18n compatibility in Next.js next-export-i18n   用传统打包 不用 i18n   解决步骤：  了解逻辑，大致了解 next.js，linugui 选择破坏或者更改最少的 或许可以使用 exportMapPath   链接：  Static HTML Export i18n support is not compatible with next export. (SSR - NextJS 10) i18n support is not compatible with next export      技能：\n VSCode regex find \u0026 replace submatch math? Given a regular expression of (foobar) you can reference the first group using $1 and so on if you have more groups in the replace input field. Match linebreaks - \\n or \\r\\n? (\\r\\n|\\r|\\n) is more correct.（这里正则匹配是一行为单位的，即使可以匹配空白符，也无法匹配多行）    其他：\n  Error: Image Optimization using Next.js default loader is not compatible with next export\n$ yarn add akamai $ vim next.config.js module.exports = { images: { loader: 'akamai', path: '', }, }   How to run Next Js application build (out) directory?\n{ \"private\": true, \"scripts\": { \"dev\": \"next\", \"build\": \"next build\", \"preexport\": \"npm run build\", \"export\": \"next export\", \"prestart\": \"npm run export\", + \"start\": \"serve out\",  \"lint\": \"next lint\" },     Meta Mask: table sister month eight offer dentist hair trophy field process define lady\n  ","wordCount":"52891","inLanguage":"en","datePublished":"2023-08-24T14:33:34+08:00","dateModified":"2023-08-24T14:33:34+08:00","author":{"@type":"Person","name":"Sakamoto Kurome"},"mainEntityOfPage":{"@type":"WebPage","@id":"https://blog.g7n3.me/posts/dishizhihui/"},"publisher":{"@type":"Organization","name":"Sakamoto Kurome","logo":{"@type":"ImageObject","url":"https://blog.g7n3.me/favicon.ico"}}}</script>
</head>
<body class=dark id=top>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=https://blog.g7n3.me/ accesskey=h title="Sakamoto Kurome (Alt + H)">Sakamoto Kurome</a>
<span class=logo-switches>
</span>
</div>
<ul id=menu>
<li>
<a href=https://blog.g7n3.me/archives/ title=Archives>
<span>Archives</span>
</a>
</li>
<li>
<a href=https://blog.g7n3.me/search/ title="Search (Alt + /)" accesskey=/>
<span>Search</span>
</a>
</li>
<li>
<a href=https://blog.g7n3.me/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<h1 class=post-title>
Di Shi Zhi Hui
</h1>
<div class=post-meta><span title="2023-08-24 14:33:34 +0800 +0800">August 24, 2023</span>&nbsp;·&nbsp;106 min&nbsp;·&nbsp;Sakamoto Kurome
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#23030816 aria-label=23030816>23030816</a></li>
<li>
<a href=#20230812 aria-label=20230812>20230812</a></li>
<li>
<a href=#20230811 aria-label=20230811>20230811</a></li>
<li>
<a href=#20230809 aria-label=20230809>20230809</a></li>
<li>
<a href=#20230808 aria-label=20230808>20230808</a></li>
<li>
<a href=#20230807 aria-label=20230807>20230807</a></li>
<li>
<a href=#20230805 aria-label=20230805>20230805</a></li>
<li>
<a href=#20230804 aria-label=20230804>20230804</a></li>
<li>
<a href=#20230803 aria-label=20230803>20230803</a></li>
<li>
<a href=#20230802 aria-label=20230802>20230802</a></li>
<li>
<a href=#20230731 aria-label=20230731>20230731</a></li>
<li>
<a href=#20230729 aria-label=20230729>20230729</a></li>
<li>
<a href=#20230726 aria-label=20230726>20230726</a></li>
<li>
<a href=#20230725 aria-label=20230725>20230725</a></li>
<li>
<a href=#20230722 aria-label=20230722>20230722</a></li>
<li>
<a href=#20230721 aria-label=20230721>20230721</a></li>
<li>
<a href=#20230720 aria-label=20230720>20230720</a></li>
<li>
<a href=#20230719 aria-label=20230719>20230719</a></li>
<li>
<a href=#20230718 aria-label=20230718>20230718</a></li>
<li>
<a href=#20230717 aria-label=20230717>20230717</a></li>
<li>
<a href=#20230715 aria-label=20230715>20230715</a></li>
<li>
<a href=#20230714 aria-label=20230714>20230714</a></li>
<li>
<a href=#20230713 aria-label=20230713>20230713</a></li>
<li>
<a href=#20230712 aria-label=20230712>20230712</a></li>
<li>
<a href=#20230711 aria-label=20230711>20230711</a></li>
<li>
<a href=#20230710 aria-label=20230710>20230710</a></li>
<li>
<a href=#20230707 aria-label=20230707>20230707</a></li>
<li>
<a href=#20230706 aria-label=20230706>20230706</a></li>
<li>
<a href=#20230705 aria-label=20230705>20230705</a></li>
<li>
<a href=#20230704 aria-label=20230704>20230704</a></li>
<li>
<a href=#20230703 aria-label=20230703>20230703</a></li>
<li>
<a href=#20230701 aria-label=20230701>20230701</a></li>
<li>
<a href=#20230630 aria-label=20230630>20230630</a></li>
<li>
<a href=#20230629 aria-label=20230629>20230629</a></li>
<li>
<a href=#20230628 aria-label=20230628>20230628</a></li>
<li>
<a href=#20230627 aria-label=20230627>20230627</a></li>
<li>
<a href=#20230626 aria-label=20230626>20230626</a></li>
<li>
<a href=#20230625 aria-label=20230625>20230625</a></li>
<li>
<a href=#20230621 aria-label=20230621>20230621</a></li>
<li>
<a href=#20230620 aria-label=20230620>20230620</a></li>
<li>
<a href=#20230619 aria-label=20230619>20230619</a></li>
<li>
<a href=#20230617 aria-label=20230617>20230617</a></li>
<li>
<a href=#20230616 aria-label=20230616>20230616</a></li>
<li>
<a href=#20230615 aria-label=20230615>20230615</a></li>
<li>
<a href=#20230614 aria-label=20230614>20230614</a></li>
<li>
<a href=#20230613 aria-label=20230613>20230613</a></li>
<li>
<a href=#20230612 aria-label=20230612>20230612</a></li>
<li>
<a href=#20230610 aria-label=20230610>20230610</a></li>
<li>
<a href=#20230609 aria-label=20230609>20230609</a></li>
<li>
<a href=#20230608 aria-label=20230608>20230608</a></li>
<li>
<a href=#20230607 aria-label=20230607>20230607</a></li>
<li>
<a href=#20230606 aria-label=20230606>20230606</a></li>
<li>
<a href=#20230605 aria-label=20230605>20230605</a></li>
<li>
<a href=#20230602 aria-label=20230602>20230602</a></li>
<li>
<a href=#20230601 aria-label=20230601>20230601</a></li>
<li>
<a href=#20230531 aria-label=20230531>20230531</a></li>
<li>
<a href=#20230530 aria-label=20230530>20230530</a></li>
<li>
<a href=#20230529 aria-label=20230529>20230529</a></li>
<li>
<a href=#20230526 aria-label=20230526>20230526</a></li>
<li>
<a href=#20230525 aria-label=20230525>20230525</a></li>
<li>
<a href=#20230524 aria-label=20230524>20230524</a></li>
<li>
<a href=#20230523 aria-label=20230523>20230523</a></li>
<li>
<a href=#20230522 aria-label=20230522>20230522</a></li>
<li>
<a href=#20230521 aria-label=20230521>20230521</a></li>
<li>
<a href=#20230520 aria-label=20230520>20230520</a></li>
<li>
<a href=#20230519 aria-label=20230519>20230519</a></li>
<li>
<a href=#20230518 aria-label=20230518>20230518</a></li>
<li>
<a href=#20230517 aria-label=20230517>20230517</a></li>
<li>
<a href=#20230516 aria-label=20230516>20230516</a></li>
<li>
<a href=#20230515 aria-label=20230515>20230515</a></li>
<li>
<a href=#20230512 aria-label=20230512>20230512</a></li>
<li>
<a href=#20230511 aria-label=20230511>20230511</a></li>
<li>
<a href=#20230510 aria-label=20230510>20230510</a></li>
<li>
<a href=#20230509 aria-label=20230509>20230509</a></li>
<li>
<a href=#20230508 aria-label=20230508>20230508</a></li>
<li>
<a href=#20230506 aria-label=20230506>20230506</a></li>
<li>
<a href=#20230505 aria-label=20230505>20230505</a></li>
<li>
<a href=#20230428 aria-label=20230428>20230428</a></li>
<li>
<a href=#20230427 aria-label=20230427>20230427</a></li>
<li>
<a href=#20230426 aria-label=20230426>20230426</a></li>
<li>
<a href=#20230425 aria-label=20230425>20230425</a></li>
<li>
<a href=#20230424 aria-label=20230424>20230424</a></li>
<li>
<a href=#20230423 aria-label=20230423>20230423</a></li>
<li>
<a href=#20230421 aria-label=20230421>20230421</a></li>
<li>
<a href=#20230420 aria-label=20230420>20230420</a></li>
<li>
<a href=#20230419 aria-label=20230419>20230419</a></li>
<li>
<a href=#20230418 aria-label=20230418>20230418</a></li>
<li>
<a href=#20230417 aria-label=20230417>20230417</a></li>
<li>
<a href=#20230414 aria-label=20230414>20230414</a></li>
<li>
<a href=#20230413 aria-label=20230413>20230413</a></li>
<li>
<a href=#20230412 aria-label=20230412>20230412</a></li>
<li>
<a href=#20230411 aria-label=20230411>20230411</a></li>
<li>
<a href=#20230410 aria-label=20230410>20230410</a></li>
<li>
<a href=#20230407 aria-label=20230407>20230407</a></li>
<li>
<a href=#20230406 aria-label=20230406>20230406</a></li>
<li>
<a href=#20230405 aria-label=20230405>20230405</a></li>
<li>
<a href=#20230404 aria-label=20230404>20230404</a></li>
<li>
<a href=#20230403 aria-label=20230403>20230403</a></li>
<li>
<a href=#20230401 aria-label=20230401>20230401</a></li>
<li>
<a href=#20230331 aria-label=20230331>20230331</a></li>
<li>
<a href=#20230330 aria-label=20230330>20230330</a></li>
<li>
<a href=#20230328 aria-label=20230328>20230328</a></li>
<li>
<a href=#20230327 aria-label=20230327>20230327</a></li>
<li>
<a href=#20230325 aria-label=20230325>20230325</a></li>
<li>
<a href=#20230324 aria-label=20230324>20230324</a></li>
<li>
<a href=#20230323 aria-label=20230323>20230323</a></li>
<li>
<a href=#20230322 aria-label=20230322>20230322</a></li>
<li>
<a href=#20230321 aria-label=20230321>20230321</a></li>
<li>
<a href=#20230320 aria-label=20230320>20230320</a></li>
<li>
<a href=#20230318 aria-label=20230318>20230318</a></li>
<li>
<a href=#20230317 aria-label=20230317>20230317</a></li>
<li>
<a href=#20230316 aria-label=20230316>20230316</a></li>
<li>
<a href=#20230315 aria-label=20230315>20230315</a></li>
<li>
<a href=#20230314 aria-label=20230314>20230314</a></li>
<li>
<a href=#20230313 aria-label=20230313>20230313</a></li>
<li>
<a href=#20230311 aria-label=20230311(🛌)>20230311(🛌)</a></li>
<li>
<a href=#20230311-1 aria-label=20230311>20230311</a></li>
<li>
<a href=#20230310 aria-label=20230310>20230310</a></li>
<li>
<a href=#20230309 aria-label=20230309>20230309</a></li>
<li>
<a href=#20230308 aria-label=20230308>20230308</a></li>
<li>
<a href=#20230307 aria-label=20230307>20230307</a></li>
<li>
<a href=#20230306 aria-label=20230306>20230306</a></li>
<li>
<a href=#20230305 aria-label=20230305(🛌)>20230305(🛌)</a></li>
<li>
<a href=#20230304 aria-label=20230304(🛌)>20230304(🛌)</a></li>
<li>
<a href=#20230303 aria-label=20230303>20230303</a></li>
<li>
<a href=#20230302 aria-label=20230302>20230302</a></li>
<li>
<a href=#20230301 aria-label=20230301>20230301</a></li>
<li>
<a href=#20230227 aria-label=20230227>20230227</a></li>
<li>
<a href=#20230226 aria-label=20230226>20230226</a></li>
<li>
<a href=#20230225 aria-label=20230225>20230225</a></li>
<li>
<a href=#20230224 aria-label=20230224>20230224</a></li>
<li>
<a href=#20230223 aria-label=20230223>20230223</a></li>
<li>
<a href=#20230222 aria-label=20230222>20230222</a></li>
<li>
<a href=#20230221 aria-label=20230221>20230221</a></li>
<li>
<a href=#20230220 aria-label=20230220>20230220</a></li>
<li>
<a href=#20230218 aria-label=20230218>20230218</a></li>
<li>
<a href=#20230217 aria-label=20230217>20230217</a></li>
<li>
<a href=#20230216 aria-label=20230216>20230216</a></li>
<li>
<a href=#20230215 aria-label=20230215>20230215</a></li>
<li>
<a href=#20230214 aria-label=20230214>20230214</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h2 id=23030816>23030816<a hidden class=anchor aria-hidden=true href=#23030816>#</a></h2>
<ul>
<li>
<p>需求：备份一个 repo 到另一个 github 账号的 repo，首先需要同步所有分支，然后更改 remote url，最后推送所有分支到新仓库。</p>
<ul>
<li><a href=https://stackoverflow.com/a/10312587>How do I fetch all Git branches?</a></li>
<li><a href=https://stackoverflow.com/a/2432799>How do I change the URI (URL) for a remote Git repository?</a></li>
<li><a href=https://stackoverflow.com/a/10479068>Set up git to pull and push all branches</a></li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>git branch -r | grep -v <span style=color:#e6db74>&#39;\-&gt;&#39;</span> | sed <span style=color:#e6db74>&#34;s,\x1B\[[0-9;]*[a-zA-Z],,g&#34;</span> | <span style=color:#66d9ef>while</span> read remote; <span style=color:#66d9ef>do</span> git branch --track <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>remote#origin/<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#e6db74>&#34;</span>$remote<span style=color:#e6db74>&#34;</span>; <span style=color:#66d9ef>done</span>
git fetch --all
git pull --all

<span style=color:#75715e># change the URLs</span>
git remote set-url origin new.git.url/here

<span style=color:#75715e># push tags and branches.</span>
git push --all origin
</code></pre></div></li>
</ul>
<h2 id=20230812>20230812<a hidden class=anchor aria-hidden=true href=#20230812>#</a></h2>
<ul>
<li>
<p>Web 调试</p>
<ul>
<li><a href=https://www.jianshu.com/p/37b99349eb03>❤️❤️超详细的fiddler教程【原理+功能讲解+实战（应用场景）】❤️❤️ - 简书</a></li>
<li><a href=https://zhuanlan.zhihu.com/p/79037633>使用 Whistle 作为你的 Web 调试工具吧 - 知乎</a></li>
<li><a href=https://blog.csdn.net/CHUANZExiaodaima/article/details/122200235>Wireshark使用教程_俭平的博客-CSDN博客</a></li>
</ul>
</li>
<li>
<p><a href=https://www.v2ex.com/t/811293>safari 上哪个拓展的拦截最好用？ - V2EX</a></p>
</li>
<li>
<p><a href=https://blog.hyoban.cc/work-one-year>远程兼职一年后 - Hyoban</a>： <a href=https://datadata.feishu.cn/wiki/ZSrDw1ioji9vPIkfSrNcJBREnWd>Grow in Public 文档</a></p>
</li>
<li>
<p><a href=https://greasyfork.org/zh-CN/scripts/452651-%E8%AE%A9%E4%BD%A0%E7%9A%84%E9%A3%9E%E4%B9%A6%E6%9B%B4%E5%A5%BD%E7%94%A8>让你的飞书更好用</a>：破解飞书的复制限制</p>
</li>
<li>
<p><a href=https://noob-sec.github.io/%E4%BF%A1%E6%81%AF%E6%94%B6%E9%9B%86%E4%B9%8Bjs%E6%96%87%E4%BB%B6/>信息收集之js文件 | 安全小白团</a></p>
</li>
<li>
<p><a href=https://github.com/bregman-arie/devops-exercises>bregman-arie/devops-exercises</a></p>
</li>
<li>
<p><a href=https://www.zhihu.com/question/383416202/answer/2584564433>用了很久的全拼改为双拼值得吗？ - 韦易笑的回答 - 知乎</a></p>
</li>
<li>
<p>Deploying <strong>IPFS</strong> on Linux with Docker Containers</p>
<ul>
<li>
<p><a href=https://hub.docker.com/r/ipfs/kubo>ipfs/kubo - Docker Image | Docker Hub</a></p>
</li>
<li>
<p><a href=https://docs.ipfs.tech/install/run-ipfs-inside-docker/>Install IPFS Kubo inside Docker | IPFS Docs</a>：主要看这个部署单个节点</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>docker logs -f ipfs_host
docker exec ipfs_host ipfs &lt;args...&gt;
</code></pre></div></li>
<li>
<p><a href=https://hub.docker.com/r/ipfs/ipfs-cluster>ipfs/ipfs-cluster - Docker Image | Docker Hub</a></p>
</li>
<li>
<p><a href=https://docs.ipfs.tech/install/server-infrastructure/>IPFS Cluster | IPFS Docs</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230811>20230811<a hidden class=anchor aria-hidden=true href=#20230811>#</a></h2>
<ul>
<li><a href=https://github.com/ouduidui/ga-tracker>ga-tracker</a>：适用于UniApp和微信小程序的谷歌统计 (Google Analytics) SDK，只支持 Universal Analytics，即形式如 UA-XXXXXXXX-1 的 ID。（2023 年 7 月 1 日起就用不了了，最后我直接将 script 代码放到 index.html head 中去了，不知道起不起作用）</li>
<li><a href=https://zhuanlan.zhihu.com/p/214289762>Google Analytics分析终极入门指南</a></li>
</ul>
<h2 id=20230809>20230809<a hidden class=anchor aria-hidden=true href=#20230809>#</a></h2>
<ul>
<li><a href=https://wiki.archlinux.org/title/List_of_applications>List of applications - ArchWiki</a>：Arch Wiki 万岁，可以很方便地去找 Linux 下的各种工具及其 wiki。</li>
<li><a href=https://dev.yorhel.nl/ncdu>NCurses Disk Usage</a></li>
<li>PHP 设置 UTC 0 时区时间：默认就是 UTC 0 时区时间；或者指定 timezone 为 <code>UTC</code>；再或者设置为格林威治当地时间 <code>Etc/Greenwich</code>，其值与 UTC 0 时区时间相同。
<ul>
<li>
<p><a href=https://www.php.net/manual/en/function.date-default-timezone-set.php>date_default_timezone_set</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/questions/7587435/setting-timezone-to-utc-0-in-php>Setting timezone to UTC (0) in PHP</a>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-php data-lang=php><span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>date</span>(<span style=color:#e6db74>&#39;Y-m-d H:i:s T&#39;</span>, <span style=color:#a6e22e>time</span>()) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;&lt;br&gt;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
<span style=color:#a6e22e>date_default_timezone_set</span>(<span style=color:#e6db74>&#39;UTC&#39;</span>);
<span style=color:#66d9ef>echo</span> <span style=color:#a6e22e>date</span>(<span style=color:#e6db74>&#39;Y-m-d H:i:s T&#39;</span>, <span style=color:#a6e22e>time</span>()) <span style=color:#f92672>.</span> <span style=color:#e6db74>&#34;&lt;br&gt;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>;
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/15521957>Is there a difference between the UTC and Etc/UTC time zones?</a>: That is, they&rsquo;re long and short names for the same timezone</p>
</li>
</ul>
</li>
<li><a href=https://sspai.com/post/44027>iOS 终于支持了 PWA，一起来认识一下这个强化版「小程序」 | 科普 - 少数派</a></li>
<li><a href=https://sspai.com/post/36604>如何用 Xcode 安装 Github 中的未上架 iOS App - 少数派</a></li>
<li><a href=https://juejin.cn/post/7260144602471776311>写给5年前端妹子的三万字脚手架教程 - 掘金</a></li>
<li><a href=https://www.zhihu.com/question/19556605/answer/12214990>macOS 平台最好的 PDF 阅读器是什么？ - 知乎</a>：对于绝大部分人来说 Preview.app 是最佳的选择。系统自带、速度极快、兼容性尚可、有基本的编辑功能、支持批注。只有极少数需要填表、数字签名、高级编辑的情况下才会需要 Acrobat。</li>
</ul>
<h2 id=20230808>20230808<a hidden class=anchor aria-hidden=true href=#20230808>#</a></h2>
<ul>
<li>Java8 是没有 Mac M1 版本的，但是 Java11 有，虽然 On Java8 用的是 Java8，但是还是只能安装 Java11 了，<a href=https://newrelic.com/resources/report/2022-state-of-java-ecosystem>Java11 是继 Java8 使用率最高的 LTS</a>。</li>
<li><a href=https://github.com/ythy/blog/issues/109>How to pronounce “Gradle”?</a>: <code>/'ɡreɪdl̩/</code></li>
<li><a href="https://developer.aliyun.com/article/1039481?spm=a2c6h.12873639.article-detail.3.61193846wazAel">Gradle从0入门到实战系列</a></li>
<li>环境变量除了 PATH 外（即原本有的），不能放在 .zprofile 中，通过 env 即可查看添加的环境变量没有生效，而应该在 .zshrc 中进行 export。</li>
<li><a href=https://stackoverflow.com/a/55236535>How to prevent Homebrew from installing a certain formula dependency?</a>: <code>brew install --ignore-dependencies formula</code></li>
</ul>
<h2 id=20230807>20230807<a hidden class=anchor aria-hidden=true href=#20230807>#</a></h2>
<ul>
<li><a href=https://jsonformatter.org>JSON fromatter</a>：可以将 json file 键去重</li>
<li><a href=https://serverfault.com/a/838344>How to find out the virtualization type of an linux VPS?</a>: <code>hostnamectl status</code></li>
</ul>
<h2 id=20230805>20230805<a hidden class=anchor aria-hidden=true href=#20230805>#</a></h2>
<ul>
<li>
<p><a href=https://atmarkit.itmedia.co.jp/ait/articles/1705/18/news033.html>【 seq 】コマンド――数字の列を出力する</a></p>
</li>
<li>
<p><a href=https://www.baeldung.com/linux/envsubst-command>Linux envsubst Command with Examples</a></p>
</li>
<li>
<p>Deploying <strong>Redis</strong> on Linux with Docker Containers</p>
<ul>
<li><a href=https://hub.docker.com/_/redis>redis - Official Image | Docker Hub</a></li>
<li><a href=https://lazesoftware.com/ja/blog/230223/>Docker で Redis コンテナを作る方法</a></li>
<li><a href=https://www.cnblogs.com/dooor/p/docker-redis0227.html>Docker搭建Redis Cluster集群及扩容和收容</a>：至少6个节点。</li>
</ul>
</li>
<li>
<p>Deploying <strong>RabbitMQ</strong> on Linux with Docker Containers</p>
<ul>
<li><a href=https://hub.docker.com/_/rabbitmq>rabbitmq - Official Image | Docker Hub</a></li>
<li><a href=https://qiita.com/h_tyokinuhata/items/1097a3a0ad018366ecec>Docker Composeで立てたRabbitMQにpikaで接続してみる - Qiita</a></li>
<li><a href=https://segmentfault.com/a/1190000041104410>java - 手把手教你搭建 RabbitMQ 集群 - 个人文章 - SegmentFault 思否</a></li>
</ul>
</li>
<li>
<p><a href=https://github.com/typicode/husky>husky</a></p>
<ul>
<li>
<p><a href=https://github.com/typicode/husky#install>husky</a>: <code>yarn add -D husky</code></p>
<ul>
<li>
<p><a href=https://github.com/conventional-changelog/commitlint#getting-started>commitlint</a>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># Install commitlint cli and conventional config</span>
yarn add -D @commitlint/<span style=color:#f92672>{</span>config-conventional,cli<span style=color:#f92672>}</span>;

<span style=color:#75715e># Configure commitlint to use conventional config</span>
echo <span style=color:#e6db74>&#34;module.exports = {extends: [&#39;@commitlint/config-conventional&#39;]}&#34;</span> &gt; commitlint.config.js;

<span style=color:#75715e># add hook</span>
npx husky add .husky/commit-msg  <span style=color:#e6db74>&#39;npx --no -- commitlint --edit ${1}&#39;</span>
</code></pre></div></li>
<li>
<p><a href=https://github.com/okonet/lint-staged#installation-and-setup>lint-staged</a></p>
</li>
</ul>
</li>
<li>
<p><a href=https://4ark.me/post/weekly-npm-packages-02.html>每周轮子之 husky：统一规范团队 Git Hooks</a></p>
</li>
<li>
<p><a href=https://github.com/typicode/husky/issues/1177#issuecomment-1212831091>hook was ignored because it&rsquo;s not set as executable</a>: I think it&rsquo;s probably a problem that wasn&rsquo;t created taking into account the file permissions of Linux at the time of init on Windows. <code>chmod ug+x .husky/*</code></p>
</li>
</ul>
</li>
<li>
<p><a href=https://qiita.com/muddydixon/items/d2982ab0846002bf3ea8>Docker privileged オプションについて</a>：允许容器中运行一些特权命令，比如调用宿主机的所有设备。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/31552514>Defining an array as an environment variable in node.js</a>：通用的是 split()，还有一种是 JSON.parse()</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>FESTIVALS</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;bonnaroo, lollapalooza, coachella&#34;</span>
<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>festivals</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>FESTIVALS</span>.<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#34;, &#34;</span>);

<span style=color:#a6e22e>ANY_LIST</span> <span style=color:#f92672>=</span> [<span style=color:#e6db74>&#34;A&#34;</span>, <span style=color:#e6db74>&#34;B&#34;</span>, <span style=color:#e6db74>&#34;C&#34;</span>]
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>LIST</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>ANY_LIST</span>);
</code></pre></div></li>
<li>
<p><a href=https://segmentfault.com/q/1010000042360101>vscode markdown 中 ```shell语法基本上没颜色 怎样添加？</a>：grep rm find 等这些并不是 shell 里的关键字，而是需要特定环境变量，所以没高亮，而比如 if then cd 等这些会高亮的。</p>
</li>
<li>
<p><a href=https://zenn.dev/marumarumeruru/articles/55173a98863d4e>no matching manifest for linux/arm64/v8 in the manifest list entries</a>：这个原因是M1的CPU是linux/arm64/v8，但是想要使用的image不支持这个；指定模拟 <code>platform: linux/amd64</code> 就可以正常运行了。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/43747867>COPY with docker but with exclusion</a>: Create file .dockerignore in your docker build context directory。<a href=https://blog.csdn.net/qianghaohao/article/details/87902806>.dockerignore 文件从入门到实践</a></p>
</li>
<li>
<p>问题：我有一个 Nest.js 项目，它需要的基础服务有 MySQL、Redis 和 RabbitMQ，然后我将它们放到一个 docker-compose.yml 文件中进行部署，遇到的问题是 nest.js 服务无法连接数据库，但是进入容器后是可以直接用 container_name 和容器 ip 地址连接上数据库的。</p>
<ul>
<li>
<p>这里 <a href=https://github.com/prisma/prisma/issues/12598>Prisma doesn&rsquo;t resolve the names of docker containers from within other containers in OSX Docker</a> 有一个讨论，反正我尝试了依旧没用，所以决定单独部署 api，不再浪费时间了。</p>
</li>
<li>
<p><a href=https://docs.docker.com/compose/compose-file/05-services/#env_file>env_file</a>：可以将 enviroment 部分都放到文件中去，docker-compose.yaml 也支持 <code>project-${VAR}</code> 使用环境变量。</p>
</li>
<li>
<p><a href=https://www.cnblogs.com/xuanmanstein/p/10576476.html>docker-compose 手工指定容器IP - 永远的幻想 - 博客园</a>: <a href=https://docs.docker.com/compose/compose-file/06-networks/#ipam>ipam</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/36451787>Access mysql remote database from command line</a>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>apk add mysql-client
mysql -u <span style=color:#f92672>{</span>username<span style=color:#f92672>}</span> -p<span style=color:#e6db74>&#39;{password}&#39;</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-h <span style=color:#f92672>{</span>remote server ip or name<span style=color:#f92672>}</span> -P <span style=color:#f92672>{</span>port<span style=color:#f92672>}</span> <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>-D <span style=color:#f92672>{</span>DB name<span style=color:#f92672>}</span>
</code></pre></div></li>
<li>
<p><a href=https://arctype.com/blog/postgres-nestjs/>Build a real-time chat application with Nestjs and PostgreSQL</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230804>20230804<a hidden class=anchor aria-hidden=true href=#20230804>#</a></h2>
<ul>
<li>
<p>需求：评论要显示刚刚、几分钟前、几个小时前、几天前、几个月前等等状态。考虑使用现成库，但是要注意将时间转换为相同时区再计算。</p>
<ul>
<li>
<p>现状：Response Header 返回的是没有时区差的标准 UTC 时间 <code>Fri, 04 Aug 2023 07:10:11 GMT</code>，Response Body 返回的内容的时间是服务器所在日本本地时间 <code>2023-08-04 15:08:28</code>，dayjs() 返回的是客户端（中国）本地时间 <code>Fri Aug 04 2023 15:19:17 GMT+0800 (China Standard Time)</code>。</p>
</li>
<li>
<p>相关文章</p>
<ul>
<li><a href=https://zhuanlan.zhihu.com/p/411324396>Day.js | 更优雅的处理JavaScript中的日期</a></li>
<li><a href=https://day.js.org/zh-CN/>Day.js</a>：Moment.js 的 2kB 轻量化方案
<ul>
<li><a href=https://day.js.org/docs/en/plugin/relative-time>RelativeTime</a>：相对时间</li>
<li><a href=https://day.js.org/docs/zh-CN/i18n/i18n>国际化 (i18n)</a></li>
<li><a href=https://day.js.org/docs/zh-CN/timezone>时区</a>
<ul>
<li><a href=https://day.js.org/docs/zh-CN/plugin/utc>UTC</a></li>
<li><a href=https://day.js.org/docs/zh-CN/plugin/timezone>Timezone</a></li>
</ul>
</li>
</ul>
</li>
<li><a href=https://xiao555.github.io/post/conversion-between-utc-time-and-local-time-in-iso-format/>ISO格式的UTC时间与本地时间的互相转化</a></li>
<li><a href=https://juejin.cn/post/7077380097484783623>聊一聊 GMT、UTC 以及 ISO8601</a></li>
<li>时区名称：<a href=https://en.wikipedia.org/wiki/List_of_tz_database_time_zones>List of tz database time zones</a> 或 <a href=https://www.hulft.com/help/ja-jp/WebFT-V3/COM-ADM/Content/WEBFT_ADM_COM/TimeZone/timezonelist.htm>タイムゾーン一覧</a></li>
</ul>
</li>
<li>
<p>解决方案：将 Body 返回的日本时间解析成当时的 UTC 时间；获取当前 UTC 时间；两者计算相对时间；然后加入国际化。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>dayjs</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;dayjs&#39;</span>
<span style=color:#66d9ef>import</span> <span style=color:#a6e22e>utc</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;dayjs/plugin/utc&#39;</span>
<span style=color:#66d9ef>import</span> <span style=color:#a6e22e>timezone</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;dayjs/plugin/timezone&#39;</span>
<span style=color:#66d9ef>import</span> <span style=color:#a6e22e>relativeTime</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;dayjs/plugin/relativeTime&#39;</span>
<span style=color:#66d9ef>import</span> <span style=color:#e6db74>&#39;dayjs/locale/zh-cn&#39;</span>

<span style=color:#a6e22e>dayjs</span>.<span style=color:#a6e22e>extend</span>(<span style=color:#a6e22e>utc</span>)
<span style=color:#a6e22e>dayjs</span>.<span style=color:#a6e22e>extend</span>(<span style=color:#a6e22e>timezone</span>)
<span style=color:#a6e22e>dayjs</span>.<span style=color:#a6e22e>extend</span>(<span style=color:#a6e22e>relativeTime</span>)

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>commentCreateTimeUTC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dayjs</span>.<span style=color:#a6e22e>tz</span>(<span style=color:#e6db74>&#39;2023-08-04 17:18:28&#39;</span>, <span style=color:#e6db74>&#39;Asia/Tokyo&#39;</span>)
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>nowTimeUTC</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dayjs</span>.<span style=color:#a6e22e>utc</span>()
<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;relative time: &#39;</span>, <span style=color:#a6e22e>nowTimeUTC</span>.<span style=color:#a6e22e>locale</span>(<span style=color:#e6db74>&#39;zh-cn&#39;</span>).<span style=color:#a6e22e>to</span>(<span style=color:#a6e22e>commentCreateTimeUTC</span>))
</code></pre></div></li>
</ul>
</li>
<li>
<p>我觉得写代码有两种状态，一种状态是使用非常合适的非常好用的库，可以非常简单方便的实现各种需求，几行代码就可以达到非常不错的效果；另一种状态，就是不存在这样合适的库，这种情况，要么是使用不那么合适的库，结果你需要各种 Hack，代码写的很乱，几百行都不够，要么就是自己去实现一个合适的好用的库，当然这个不仅花费时间更长，对开发者的要求更高。我们都认同，合适的工具能够达到事半功倍的效果，在编程的世界里，就是找到那些合适的编程语言、框架、库来实现自己的需求，找不到就去实现；这就是编程的乐趣，你既可以成为工具的受益者，也可称为工具的创造者。（PS：使用 dayjs 有感）</p>
</li>
</ul>
<h2 id=20230803>20230803<a hidden class=anchor aria-hidden=true href=#20230803>#</a></h2>
<ul>
<li>
<p>类似 ts-ignore 忽略某行的类型检测，可以用 <code>eslint-disable-next-line</code> 忽略某行的 ESLint 规则，参考 <a href=https://eslint.org/docs/latest/use/configure/rules#disabling-rules>Disabling Rules</a></p>
</li>
<li>
<p><a href=https://uibakery.io/regex-library>UI Bakery RegEx Library</a>，正则表达式规则集，常用的根本不需要自己写</p>
</li>
<li>
<p><a href=https://www.npmjs.com/package/classnames>classnames</a> 方法，用于将多种类型变量合并成 css class 的值（string）。</p>
</li>
<li>
<p>Deploying <strong>MySQL</strong> on Linux with Docker Containers</p>
<ul>
<li><a href=https://hub.docker.com/_/mysql>mysql - Official Image | Docker Hub</a>：例子过于简单</li>
<li><a href=https://dev.mysql.com/doc/mysql-installation-excerpt/8.0/en/docker-mysql-getting-started.html>Mysql 的 Docker 部署文档</a>：之后 docker 命令的例子</li>
<li><a href=https://qiita.com/A-Kira/items/f401aea261693c395966>docker-compose でMySQL環境簡単構築</a>：单个 MySQL 服务</li>
<li><a href=https://pierreabreu.medium.com/how-to-create-master-slave-mysql-8-with-docker-compose-yml-c137f45e28c7>How to create Master-Slave MySQL 8 with docker-compose.yml</a>/<a href=https://dongzl.github.io/2020/03/15/12-MySQL-Master-Slave-Replication/index.html>MySQL 主从复制原理及配置</a>： MySQL服务的主从架构</li>
<li><a href=https://jason19970210.medium.com/a-step-by-step-how-to-start-docker-compose-container-at-boot-effe9964e57f>A step by step how to start docker-compose container at boot</a>：Container 使用 <code>restart: always</code> 后会跟随 Docker daemon 一起启动。</li>
</ul>
</li>
<li>
<p><a href=https://github.com/leesper/ProgrammersLevelUp>ProgrammersLevelUp</a>：用20年时间跟着皓叔刷“程序员练级攻略”。</p>
<ul>
<li>READ: 《入门篇》和《专业基础篇》中的那些书和文章，你肯定是得认真精读的，这是基础。</li>
<li>WRITE: 你需要完成一个能用的项目，对于选择什么样的项目，这里，我也有几个建议。第一，从自己的痛点出发，写一个能解决自己问题的东西。第二，临摹别人的作品，复刻一个其它的成功产品。有人说，学好一门语言或是一个开源软件最好的方式，就是用想学 / 喜欢的编程语言翻译下这个开源软件，比如，你用 Go 语言翻译一下某个 Java 的组件。第三，深度参与一些你喜欢的开源项目。第四，在工作中找到风险可控的项目和需求。</li>
</ul>
</li>
</ul>
<h2 id=20230802>20230802<a hidden class=anchor aria-hidden=true href=#20230802>#</a></h2>
<ul>
<li>
<p>自动国际化/多语言/i18n</p>
<ul>
<li><a href=https://juejin.cn/post/7174082242426175525>前端自动国际化解决方案</a>：通过 <code>\p{Han}</code> 这个正则，就可以写一个脚本，将原本中文翻译成英文并替换为 <code>$t('English')</code> 或 <code>t('English')</code>，同时所有中文提取到一个文件中用于接下来的翻译。
<ul>
<li><a href=https://stackoverflow.com/a/41318257>How to match chinese characters with grep?</a>: <code>cat /tmp/test | grep -P '[\p{Han}]'</code>，参见 <a href=https://www.regular-expressions.info/unicode.html#script>Unicode Scripts</a>。</li>
<li>JS 中的 <a href=https://zh.javascript.info/regexp-unicode>Unicode：修饰符 &ldquo;u&rdquo; 和类 \p{&mldr;}</a>/<a href=https://stackoverflow.com/a/61151122>Javascript unicode string, chinese character but no punctuation</a>: <code>/\p{Script=Han}/u.test(char))</code></li>
</ul>
</li>
<li><a href=https://github.com/lokalise/i18n-ally>i18n-ally</a>：vue-i18n 官方推荐的插件，配置好了后就大大减轻了工作了，虽然还是需要调整。
<ul>
<li>
<p><a href=https://github.com/lokalise/i18n-ally/issues/224#issuecomment-611577407>Doesn&rsquo;t work with Vue and vuex-i18n</a>：我安装好后发现只识别 vi.json 文件，之后通过查看 output 中 i18n-ally 的 log 发现其他语言文件语法错误，最后一个键值对带了逗号，导致 i18n-ally 报错。</p>
</li>
<li>
<p>配置 <code>sourceLanguage="locale"</code> 即提取的键值存到对应的 locale.json 文件中；<code>displayLanguage="locale"</code> 即能够将 $t(&lsquo;key&rsquo;) 中的 key 映射为 locale.json 中 key 对应的 value，从而实现预览。</p>
</li>
<li>
<p><a href=https://www.joyk.com/dig/detail/1639659664355914>现代 Vue 工程之「国际化 i18n 开发」 - JOYK Joy of Geek, Geek News, Link all geek</a></p>
</li>
<li>
<p>Nuxt3 下配置如下</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
    <span style=color:#f92672>&#34;i18n-ally.localesPaths&#34;</span>: <span style=color:#e6db74>&#34;./lang&#34;</span>,
    <span style=color:#f92672>&#34;i18n-ally.keystyle&#34;</span>: <span style=color:#e6db74>&#34;nested&#34;</span>,
    <span style=color:#f92672>&#34;i18n-ally.sourceLanguage&#34;</span>: <span style=color:#e6db74>&#34;zh-CN&#34;</span>,
    <span style=color:#f92672>&#34;i18n-ally.displayLanguage&#34;</span>: <span style=color:#e6db74>&#34;zh-CN&#34;</span>,
    <span style=color:#f92672>&#34;i18n-ally.sortKeys&#34;</span>: <span style=color:#66d9ef>true</span>,
    <span style=color:#f92672>&#34;i18n-ally.keepFulfilled&#34;</span>: <span style=color:#66d9ef>false</span>,
    <span style=color:#f92672>&#34;i18n-ally.pathMatcher&#34;</span>: <span style=color:#e6db74>&#34;{locale}.{ext}&#34;</span>,
    <span style=color:#f92672>&#34;i18n-ally.enabledParsers&#34;</span>: [
        <span style=color:#e6db74>&#34;json&#34;</span>,
        <span style=color:#e6db74>&#34;json5&#34;</span>
    ],
    <span style=color:#f92672>&#34;i18n-ally.translate.engines&#34;</span>: [
        <span style=color:#e6db74>&#34;google&#34;</span>,
        <span style=color:#e6db74>&#34;google-cn&#34;</span>,
        <span style=color:#e6db74>&#34;deepl&#34;</span>,
    ],
    <span style=color:#f92672>&#34;i18n-ally.translate.deepl.useFreeApiEntry&#34;</span>: <span style=color:#66d9ef>true</span>,
}
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://www.regular-expressions.info>Regular-Expressions.info</a></p>
</li>
<li>
<p>多语言切换，域名会变成服务器的私有 IP 10.2.0.10，再刷新后又正常了，在本地测试没有问题，但是实际上线后就有这个问题。</p>
<ul>
<li>之前为了获取语言切换后后台返回的多语言数据，使用了 window.location.reload()，现在考虑不用，而是在语言切换的时候重新请求相关的接口；但是之前请求用的是 cookie，会比语言切换慢一步，比如从中文=>日文=>繁体，那么选择日文展示的是之前选择的中文，选择繁体展示的是之前选择的日文，因此考虑用 pinia store 这个状态管理来存 locale，这样就可以获取最新的值；但是第一次使用时会检测浏览器默认语言，store 就没办法知道了检测的值了，只能考虑同时用 store 和 cookie，store 默认值为空，这样第一次用 cookie 的值。关于重新请求接口，Nuxt3 有一个 <a href=https://nuxt.com/docs/api/utils/refresh-nuxt-data>refreshNuxtData</a> API，重新请求当前页面请求的 API，其他的则需要手动重新请求。</li>
<li>上面修改多语言行为后，发现没有解决跳向私有 IP 的问题，问题重新描述为—— <code>npx nuxi generate</code> 生成静态文件，通过 Nginx 部署到服务器，访问的时候如果 reload 页面，会跳到服务器局域网 IP。
<ul>
<li>
<p>具体描述：直接 <a href=https://testweb.iruca.ai/create>https://testweb.iruca.ai/create</a> 会跳到 <a href=http://10.2.0.10/create>http://10.2.0.10/create</a>； 但 <a href=https://testweb.iruca.ai/abcd>https://testweb.iruca.ai/abcd</a> 正确显示 404，因为正确 404 了，我猜测应该是前端的问题，但是前端实在找不到问题在哪里。之后我又尝试了 <a href=https://testweb.iruca.ai/create/>https://testweb.iruca.ai/create/</a>（多了个斜杠），发现可以访问了，因此猜测是 nginx 配置问题。之前一访问就直接跳转了，其实可以用 <code>curl -i https://testweb.iruca.ai/create</code> 可以查看跳转前的内容，显示为 301 Moved Permanently（最好用这个来测，由于浏览器有缓存，更改 nginx 后并不能马上在浏览器上看到结果，还以为修改的无效呢！）。配置 Nginx 将 try_files 行中的 <code>$uri/</code> 替换成了 <code>$uri/index.html</code>，问题就被解决了。</p>
</li>
<li>
<p><a href=https://juejin.cn/post/7099052604654616607>Nginx二级子路径请求，如何去掉尾部多余的"/&ldquo;以及避免301重定向请求</a>：导致 301 是 Nginx 默认行为——当访问URI时，如果访问资源为一个目录，并且URI没有以正斜杠（/）结尾，Nginx 服务就会返回一个301跳转，目标地址就是加一个正斜杠。</p>
</li>
<li>
<p><a href=https://medium.com/web-design-zone/%E6%90%9E%E6%87%82%E5%89%8D%E7%AB%AF%E6%8A%80%E8%A1%93%E5%90%8D%E8%A9%9E-ssr%E8%88%87spa-450563784c47>搞懂前端技術名詞 SSR與SPA</a>：这次部署的就是 SPA 应用，特点是生成的 index.html 文件的主要内容是挂载点 <code>&lt;div id="__nuxt">&lt;/div></code>，部署的特点是始终返回这个 index.html，nuxt 生成的静态文件中，pages下的页面都单独一个目录，目录中都是内容完全一样的 index.html。</p>
</li>
<li>
<p><a href=https://graffino.com/til/0eMuXQOXzb-prepare-nuxtjs-for-static-deployment>Prepare NuxtJS for static deployment • Today I Learned</a>：Nuxt SPA 部署的 Nginx 配置可以参考这个。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-nginx data-lang=nginx><span style=color:#66d9ef>location</span> <span style=color:#e6db74>/.</span>
{
    <span style=color:#75715e># Remove trailing slash and redirect it
</span><span style=color:#75715e></span>    <span style=color:#f92672>rewrite</span> <span style=color:#e6db74>^(.+)/+</span>$ $1 <span style=color:#e6db74>permanent</span>;

    <span style=color:#75715e># Redirect index.html
</span><span style=color:#75715e></span>    <span style=color:#f92672>rewrite</span> <span style=color:#e6db74>^(.+)/index.html</span>$ $1 <span style=color:#e6db74>permanent</span>;

    <span style=color:#75715e># Serve folder path via index.html
</span><span style=color:#75715e></span>    <span style=color:#f92672>try_files</span> $uri $uri/index.html =<span style=color:#ae81ff>404</span>;

    <span style=color:#75715e># Serve a custom static error page
</span><span style=color:#75715e></span>    <span style=color:#f92672>error_page</span> <span style=color:#ae81ff>404</span> <span style=color:#e6db74>/404.html</span>;
}
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p>Nginx</p>
<ul>
<li><a href=https://github.com/dunwu/nginx-tutorial>Nginx 极简教程</a></li>
<li><a href=https://juejin.cn/post/6844904129987526663>连前端都看得懂的《Nginx 入门指南》</a>：代理其实就是一个中介，A和B本来可以直连，中间插入一个C，C就是中介。刚开始的时候，代理多数是帮助内网client访问外网server用的（比如HTTP代理），从内到外 . 后来出现了反向代理，&ldquo;反向"这个词在这儿的意思其实是指方向相反，即代理将来自外网client的请求forward到内网server，从外到内。</li>
<li><a href=https://www.cnblogs.com/fps2tao/p/9958009.html>增加nginx虚拟主机配置文件(conf.d)</a>：<code>域名.conf</code> 只是一个用于区分的名字而已。</li>
<li><a href=https://xuexb.com/post/nginx-url-rewrite.html>nginx配置url重写</a></li>
<li><a href=https://www.v2ex.com/t/232977>Nginx 的正确发音是？</a>：恩静克思 <code>[ˈendʒɪnks]</code></li>
<li><a href=https://segmentfault.com/a/1190000021771733>Nginx的server_name和location配置</a></li>
</ul>
</li>
<li>
<p><a href=https://zh.javascript.info>现代 JavaScript 教程</a></p>
</li>
</ul>
<h2 id=20230731>20230731<a hidden class=anchor aria-hidden=true href=#20230731>#</a></h2>
<ul>
<li>维基百科有一个 <a href=https://simple.wikipedia.org/wiki/Main_Page>Simple English 的版本</a>，用最常用的单词解释各种事情。</li>
<li>coinphd 的 admin 项目的路由，不是那种固定的路由，不像 nuxt 或 uniapp 那样，在 pages 目路下的路径就是路由路径，uniapp 还需要修改 manifest.json，而 nuxt 则是完全不需要了。admin 项目是根据调用 api 返回的路由数组，在<a href=https://router.vuejs.org/zh/guide/advanced/navigation-guards.html>全局前置守卫</a>中动态地添加对应的路由。总的来说，路由方便程度 nuxt(web) > uniapp(mobie) > vite(admin)，路由安全程度及自由程度 vite(admin) > uniapp(mobie) > nuxt(web)。</li>
<li>不论是前端、后端还是运维，掌握程序运行流程是开发的前提，一个是你要知道如何看现有的代码，一个是你要知道到哪里去改代码。就前端来说，运行流程就是路由，你在浏览器上输入网址，网址对应具体的页面，而该页面就是执行特定的代码文件所产生的，而你的任务就是根据网址找到对应的执行文件；像 Nuxt、Next 这种，网址的路径对应 pages 下的路径，就比较简单直接；像 uniapp、antd 这种，网址与执行文件由路由配置来进行映射，这种关键就是找到路由配置文件。就后端来说，与前端基本上一致，像 Nest 这种，路由就自动对应着 routes 目录下 controller 文件；像 PHP 这种，默认路由就是在 controller 目录下的路径，但是也可以通过配置文件来进行配置。就运维来说，执行文件变成了运行的 docker，你的任务，就是根据特定的域名，找到对应的docker容器，将来自互联网的请求交予它处理。掌握了路由后，你就可以在路由的某个阶段，或者某个路由中添加东西了，进行开发了。万事开头难，掌握了第一步后，接下来的就简单了。你看图灵机，程序的本质，就是按照顺序执行一个又一个的任务的，面向过程、面向对象、函数式等编程方法，还有各种框架，各种工具辅助等等，本质还是按照顺序执行一个又一个的任务，而要去理解，也就是自己去按照顺序执行一个又一个的任务。</li>
<li><a href=https://juejin.cn/post/7254572706536734781>项目中前端如何实现无感刷新 token！</a>：评论很有意思。
<ul>
<li>第一种，accessToken + refreshToken：accessToken的特点是使用频繁但有效期短。使用频繁是因为它会在每个请求中传输，所以它更容易泄露。refreshToken的特点是有效期长，但使用频率很低。它长期存在本地，不会随着每个请求传输，所以不容易泄露，但又能延长真正的过期时间。所以两个token的搭配，既保证了用户可以长时间不退出，又尽量降低了token泄漏的风险。</li>
<li>第二种，单token后端动态延长有效期：当用户一直在操作页面调用接口且当前token没过期时，后端统一在拦截器中自动续时确保token永远不会过期，这样就可以避免突然让用户去登录。当用户长时间未操作页面token失效时，拦截器返回401跳转登录。也起到使用token鉴权的目的。</li>
</ul>
</li>
</ul>
<h2 id=20230729>20230729<a hidden class=anchor aria-hidden=true href=#20230729>#</a></h2>
<ul>
<li><a href=https://v2ex.com/t/960393>2023 年香港手机卡完全攻略</a>：hahasim</li>
<li><a href=https://zhuanlan.zhihu.com/p/53660090>程序员劳动法赔偿 101</a></li>
<li>WARP：旨在确保您的数据在传输过程中得到保护，不是用来让你访问受地理限制的内容的。
<ul>
<li><a href=https://blog.cloudflare.com/zh-cn/announcing-warp-plus-zh-cn/>WARP现已问世</a></li>
<li><a href=https://ednovas.xyz/2021/10/05/warp+/>WARP+ 刷无限流量</a></li>
</ul>
</li>
<li>aircrack-ng 破解 WIFI 密码: <a href=https://github.com/conwnet/wpa-dictionary>https://github.com/conwnet/wpa-dictionary</a></li>
<li><a href=https://zhuanlan.zhihu.com/p/619120794>Stable Diffusion 新手入门手册</a>：像素图片模型 <a href=https://civitai.com/models/43820/pixel-art-style>Pixel art style</a></li>
<li>xLog
<ul>
<li><a href=https://song.xlog.app/5m-zh>五分钟拥有一个区块链和 IPFS 上的去中心化博客</a></li>
<li><a href=https://lenband.com/Cryptocurrency>从 xLog 到加密币：区块链小白的购币指南</a></li>
</ul>
</li>
<li>Coursera（<code>/kɔːrsˈɛrə/</code>）</li>
<li><a href=https://zhuanlan.zhihu.com/p/29704017>如何用3个月零基础入门「机器学习」？</a></li>
<li><a href=https://www.zhihu.com/question/20721233/answer/55306609>网易公开课vs网易云课堂</a>：网易公开课能学到幸福是什么、公正的意义等等具有普世价值的形而上层面的内容，而云课堂则更加入世，直接教你谋生的技能。两者的部分免费课程有重叠，但是凡事免费内容，都可以在BiliBili 找到的。</li>
</ul>
<h2 id=20230726>20230726<a hidden class=anchor aria-hidden=true href=#20230726>#</a></h2>
<ul>
<li>如果发现 vscode 报错 Cannot find module，但是 tsconfig.json 确实配置好了的，可以考虑重启 vscode，这样就行了。</li>
<li><a href=https://github.red/talking-about-eventstream/>聊聊 EventStream 服务器端推送</a></li>
<li><a href=https://juejin.cn/post/6844903790739456013>JS 中的 Reflect 和 Proxy</a></li>
<li><a href=https://www.zhangxinxu.com/wordpress/2020/06/css-gap-history/>CSS gap属性进化史</a></li>
<li><a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/String/split>String.prototype.split()</a> 是支持正则表达式的。</li>
<li><a href=https://learn.microsoft.com/zh-cn/>Microsoft Learn</a>：Microsoft 的教程！
<ul>
<li><a href=https://learn.microsoft.com/zh-cn/training/paths/ethereum-blockchain-development/>区块链开发入门</a></li>
<li><a href=https://learn.microsoft.com/zh-cn/training/modules/introduction-to-machine-learning/>机器学习简介</a></li>
</ul>
</li>
<li>Blockchain
<ul>
<li><a href=https://github.com/pseudoyu/blockchain-guide>区块链入门指南</a></li>
<li><a href=https://github.com/Eternaldeath/blockchainHome>blockchainHome</a></li>
</ul>
</li>
</ul>
<h2 id=20230725>20230725<a hidden class=anchor aria-hidden=true href=#20230725>#</a></h2>
<ul>
<li>PHP 部署问题
<ul>
<li>file_put_contents (/chat/server/runtime/cache/&mldr;): Failed to open stream: No such file or directory
<ul>
<li><a href=https://www.php.net/manual/zh/function.file-put-contents.php>file_put_contents</a>：没有文件就创建前提是——你资源路径得存在，并且有权限</li>
<li>在docker-compose.yaml中，<code>./server</code> 目录是 mount 到容器的 <code>chat/server/</code>，因此实际是问题是 <code>./server/runtime/</code> 不存在或者没有权限，解决办法就是创建或者加权限</li>
<li>还是没有仔细的看报错，而是去试各种方法期望能幸运地解决问题，对 PHP 有一种新人的恐惧，停留在不知道、不了解的心理状态，失去了对 PHP 的深入学习的动力。</li>
</ul>
</li>
<li>SQLSTATE php_network_getaddresses: getaddrinfo failed: Temporary failure in name resolution：原因是没有添加 .env 文件，也就没有提供 mysql host。</li>
<li><a href=https://stackoverflow.com/a/9617644>Turning expose_php OFF in php.ini</a>：the <code>X-Powered-By</code> header.</li>
<li>关键文件：server 即为 thinkphp 项目根目录，被直接 mount 到 docker 中
<ul>
<li>/server/.env 环境变量</li>
<li>/server/runtime <a href=https://juejin.cn/s/runtime%E6%96%87%E4%BB%B6%E5%A4%B9%E7%9A%84%E4%BD%9C%E7%94%A8>应用的运行时目录</a>，是一个存储程序运行时生成的临时文件的地方。通常，它包含了缓存文件、日志文件、临时文件等，这些文件不是程序的核心部分，但是却非常重要。在程序运行过程中，这些文件可以被动态生成和更新，以满足程序的运行需求。当程序关闭后，这些文件通常会被删除，因此它们不会对系统造成永久性的影响。</li>
<li>/server/public/uploads 上传或者生成的图片等资源</li>
<li>/server/public/debug.txt <code>file_put_contents('debug.txt', 'info')</code> 输出位置</li>
</ul>
</li>
</ul>
</li>
<li>Nested CSS was detected, but CSS nesting has not been configured correctly：uniapp 项目，给 <code>&lt;style></code> 添加上 <code>lang="scss"</code> 属性就行了——<code>&lt;style lang="scss"></code></li>
<li><a href=https://huang-jerryc.com/2017/05/21/talk-about-pixel-and-rpx/>谈谈像素以及微信小程序的 rpx</a></li>
<li><a href=https://juejin.cn/post/6844904149897723917>TypeScript 中的代码清道夫：非空断言操作符</a>：ts变量函数后面的感叹号有什么用处？</li>
</ul>
<h2 id=20230722>20230722<a hidden class=anchor aria-hidden=true href=#20230722>#</a></h2>
<ul>
<li>
<p>OAuth2</p>
<ul>
<li>
<p><a href=https://www.ruanyifeng.com/blog/2014/05/oauth_2_0.html>理解OAuth 2.0</a>：在前后端分离的项目中，客户端是前后端的整体，具体某个步骤由前端执行还是后端执行，在不同的实现之中并不相同。</p>
<ul>
<li>流程如下：
<ol>
<li>用户访问客户端，后者将前者导向认证服务器。（client_id）</li>
<li>用户选择是否给予客户端授权。</li>
<li>假设用户给予授权，认证服务器将用户导向客户端事先指定的"重定向URI&rdquo;（redirection URI），同时附上一个授权码。</li>
<li>客户端收到授权码，附上早先的"重定向URI&rdquo;，向认证服务器申请令牌。这一步是在客户端的后台的服务器上完成的，对用户不可见。（client_secret）</li>
<li>认证服务器核对了授权码和重定向URI，确认无误后，向客户端发送访问令牌（access token）和更新令牌（refresh token）。</li>
</ol>
</li>
<li>实现方式：要理清，就需要抓住关键的输入参数，分别是 client_id、client_secret、redirect_uri，这些参数由前端给还是后端给，就导致实现的不同。
<ul>
<li>前后端交互 OAuth 认证：参见前<a href=https://www.cnblogs.com/zlt2000/p/12509004.html>后端分离基于Oauth2的SSO单点登录怎样做？</a>图示。这种方式，前端用 client_id 去获取授权码 code，redirect_uri指向前端，然后前端将 code 传给后端，后端用 client_secret 去获取 access_token，最后生成 token 给前端。</li>
<li>后端 OAuth2 认证：例如 <a href=https://www.passportjs.org/packages/passport-google-oauth20/>passport-google-oauth20</a>。在这种方式中，前端只需要添加一个指向后端链接，剩下的所有操作都由后端完成；redirect_uri 指向后端，后端通过 client_id 和 client_secret 去获取授权码 code 与 access_token，最后生成 token 给前端。</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://stackoverflow.com/a/70215450>How to send JWT to front end server after successful login for storage on localStorage?</a>：在后端 OAuth2 认证认证方式中，所有操作都在后端执行，后面就有一个向前端发送 token 的问题。可以参考文章 <a href=http://gregtrowbridge.com/node-authentication-with-google-oauth-part2-jwts/>NODE AUTHENTICATION WITH GOOGLE OAUTH: PART 2 (JWTS)</a></p>
<ul>
<li>redirect 到前端，token 放在 url 中，如果 CDN 缓存了 token，会导致安全问题。</li>
<li>redirect 到前端，url 中放一个一次性的 code，前端再去 code 请求 token。</li>
<li>同域直接种植 Cookie，然后 redirect 到前端。</li>
<li>window.open & window.postMessage 方式：<a href=https://www.jianshu.com/p/da54bad42b30>前后端分离下的第三方登陆处理</a>（最优）
<ul>
<li>
<p><a href=https://stackoverflow.com/a/65696276>Why does JavaScript &ldquo;window.postMessage&rdquo; create duplicate messages?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>receiveMessage</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>event</span>)=&gt; {
  window.<span style=color:#a6e22e>removeEventListener</span>(<span style=color:#e6db74>&#39;message&#39;</span>, <span style=color:#a6e22e>receiveMessage</span>, <span style=color:#66d9ef>false</span>);
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>data</span>)
  <span style=color:#75715e>// do something else
</span><span style=color:#75715e></span>}
window.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;message&#39;</span>, <span style=color:#a6e22e>receiveMessage</span>, <span style=color:#66d9ef>false</span>);
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/65955688>Specifying multiple targetOrigin uris in postMessage</a>：postMessage 不支持多个域名，只能重复发送了</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>targetWindow</span>.<span style=color:#a6e22e>postMessage</span>(<span style=color:#a6e22e>message</span>, <span style=color:#e6db74>&#34;https://domain1.com&#34;</span>);
<span style=color:#a6e22e>targetWindow</span>.<span style=color:#a6e22e>postMessage</span>(<span style=color:#a6e22e>message</span>, <span style=color:#e6db74>&#34;https://domain2.com&#34;</span>);
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/11384018>Open a URL in a new tab (and not a new window)</a>: <code>window.open(url, '_blank').focus();</code></p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://www.jianshu.com/p/c7c8f51713b6>移花接木：针对OAuth2的CSRF攻击</a>：加入了 state 后，攻击者需要被攻击者的 cookie，攻击者的 Authorization Code，随机的 state 才能攻击进入被攻击者的第三方账户。</p>
</li>
</ul>
</li>
<li>
<p>CORS</p>
<ul>
<li><a href=https://cloud.tencent.com/developer/article/1838491>Cors跨域(一)：深入理解跨域请求概念及其根因</a></li>
<li><a href=https://cloud.tencent.com/developer/article/1838493>Cors跨域(二)：实现跨域Cookie共享的三要素</a>：服务器要向不同域名的网站种植 Cookie，要求服务器 Access-Control-Allow-Credentials为true、客户端请求withCredentials为true。</li>
<li><a href=https://cloud.tencent.com/developer/article/1838494>Cors跨域(三)：Access-Control-Allow-Origin多域名？</a></li>
<li><a href=https://cloud.tencent.com/developer/article/1843991>Cors跨域(四)：解决方案对决JSONP vs CORS</a></li>
</ul>
</li>
<li>
<p><a href=https://towait.com/blog/1900/>PHP使用OAuth2实现Google登录</a>：从前端获取授权码</p>
</li>
</ul>
<h2 id=20230721>20230721<a hidden class=anchor aria-hidden=true href=#20230721>#</a></h2>
<ul>
<li><a href=https://www.jianshu.com/p/f61a83945659>setTimeout 与 setInterval —— 实现优雅轮询</a>：使用 setTimeout 做轮询比 setInterval 更好。</li>
<li><a href=https://mp.weixin.qq.com/s/61jhFYtZwOkEN3nrD7Ojpw>5000 多字，让你一文掌握 TS 枚举</a>：可以直接打印 enum 看看数据结构是怎么样的；要遍历 ts enum，要么用字符串枚举，要么通过 <code>isNaN(Number(item))</code> 过滤掉数字枚举数字；但是<a href=https://segmentfault.com/q/1010000043351542>不推荐使用在运行时代码逻辑里</a>，因为 enum 用于类型定义，只不过由于TS设计的特殊性它混入了运行时。</li>
<li><a href=https://mp.weixin.qq.com/s/Ebvjy132eRDOmcIL5cmxJw>socket 到底是个啥</a></li>
</ul>
<h2 id=20230720>20230720<a hidden class=anchor aria-hidden=true href=#20230720>#</a></h2>
<ul>
<li>Safari Reader 打印 PDF。
<ul>
<li>腾讯云开发者社区的文章很适合打印的。</li>
<li>对于 51CTO，主要是行号导致的问题，通过代码删除：<code>document.querySelectorAll('.pre-numbering').forEach(item => item.parentElement.removeChild(item))</code></li>
</ul>
</li>
<li><a href=https://www.51cto.com/article/705609.html>微前端究竟是什么？微前端核心技术揭秘！</a></li>
</ul>
<h2 id=20230719>20230719<a hidden class=anchor aria-hidden=true href=#20230719>#</a></h2>
<ul>
<li>
<p><a href=https://promptart.cc>PromptArt</a> 图片提示词优化</p>
</li>
<li>
<p><a href=https://www.macaify.com>Mac-AI-fy</a> 智能化操作</p>
</li>
<li>
<p><a href=https://superuser.com/a/1312389>Can HTTrack download a subdirectory?</a>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>httrack www.example.com/subdirectory/ -D -O <span style=color:#e6db74>&#34;C:\Users\subdirectory&#34;</span>
</code></pre></div><p>-D makes it so the process &ldquo;can only go down into subdirs&rdquo;。注意 subdirectory 要带反斜杠，即 subdirectory/</p>
</li>
<li>
<p><a href=https://tool.oschina.net/uploads/apidocs/jquery/regexp.html>表达式全集</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/22704387>grep -P no longer works on MacOS.</a>: <code>brew install grep</code></p>
</li>
</ul>
<h2 id=20230718>20230718<a hidden class=anchor aria-hidden=true href=#20230718>#</a></h2>
<ul>
<li>
<p>Mobile （uniapp）写的多语言选择没有显示出来（why？），在本地测试是有的啊！草！经过查找发现是 GitHub PAT 过期了，报错 <code>Support for password authentication was removed on August 13, 2021.</code>。</p>
</li>
<li>
<p>博客：<a href=https://ericfu.me>Eric Fu</a></p>
</li>
<li>
<p>0xaaiapiphp</p>
<ul>
<li>
<p><a href=https://www.bjjii.com/273/>Error: php@7.4 has been disabled because it is a versioned formula!</a>: 原因是php7.4已经不在维护，可通过第三方源安装（注意，下面都是用 docker 进行开发，其实是不需要安装 php 的）</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>brew tap shivammathur/php
brew install shivammathur/php/php@7.4
</code></pre></div></li>
<li>
<p><a href=https://docs.orbstack.dev/quick-start>OrbStack</a>：替代 Docker Desktop。项目整体用 docker 来开发测试，后面也直接通过此方式来部署。项目是直接将源文件 mount 到容器中，所以更改之后能够立马测试。若说 redis 与 mysql 可以远程，但是 php-fpm 与 nginx 则是必须的，所以直接本地开发还是比较麻烦的。通过看 docker-compose.yml 来了解项目是怎样运行的，核心是 nginx 的配置，root 指向 ThinkPHP 的入口文件；php-fpm 用的likeshop/php:8.0.22-fpm镜像，这个镜像在 Google 中搜不出来，需要到 Docker Hub 中先搜索 likeshop 仓库，然后进入 likeshop/php 镜像页面中选择 tag。</p>
</li>
<li>
<p>Clash 启用自定义DNS后，系统本地的hosts文件解析被绕过了：<a href=https://github.com/yichengchen/clashX#change-default-system-ignore-list>Change default system ignore list</a></p>
</li>
<li>
<p>Mysql docker container keeps restarting: 是因为下面这一句，docker 容器将 lib 目录挂在在了系统目录上，我以为是我需要配置的，因此是直接复制过来的，但实际是容器本身的内容给挂载出来。我的系统是 arm，服务器是 amd4，因此不断重启。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#ae81ff>./config/mysql/mysql5.7.29/lib:/var/lib/mysql</span>
</code></pre></div></li>
<li>
<p><a href=https://lter.github.io/LTER-core-metabase/dbeaver.html#restore-a-database-from-a-sql-export>DBeaver Restore a database from a SQL export</a>:</p>
<ul>
<li>Right-click the database and click Tools > Execute script.</li>
<li><a href=https://bytefreaks.net/applications/dbeaver-native-client-is-not-specified-for-connection>dbeaver: native client is not specified for connection</a>: &ldquo;Local Client …&rdquo; => &ldquo;Browse …&rdquo; => mysqldump executable</li>
<li><a href=https://cloud.tencent.com/developer/article/1126898>Mac OS X 快速访问根目录的4种方法</a>：使用快捷键 Command + Shift + G 快速激活“前往文件夹”功能</li>
<li><a href=https://stackoverflow.com/a/54787376>Install only mysqldump on macOS</a>: <code>brew install mysql-client</code></li>
<li><a href=https://github.com/dbeaver/dbeaver/issues/7501#issuecomment-621381981>Can&rsquo;t connect to local MySQL server through socket &lsquo;/tmp/mysql.sock&rsquo;</a>: Changing host from localhost to 127.0.0.1 helped.</li>
<li><a href=https://dba.stackexchange.com/a/273040>&lsquo;Access denied; you need (at least one of) the PROCESS privilege(s) for this operation&rsquo; when trying to dump tablespaces</a>: <code>--no-tablespaces</code></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://cloud.tencent.com/developer/article/1941013>Javascript中对象如何检查key（键）是否存在</a>：in操作符、hasOwnProperty方法。</p>
</li>
<li>
<p><a href=https://docs.omniinfer.io>Omniinfer</a>: Fast and cheap AI image generation API.</p>
</li>
<li>
<p>PhpStorm：</p>
<ul>
<li><a href=https://intellij-support.jetbrains.com/hc/en-us/community/posts/206379169/comments/360002114400>Single Click To Open File</a>：project 的设置图标
<ul>
<li>Enable Preview Tab</li>
<li>Always Select Opened File</li>
<li>Presss Ctrl+R or select Edit | Find | Replace from the main menu to open the Replace in File window.</li>
</ul>
</li>
<li><a href=https://segmentfault.com/q/1010000042851033>升级 macos 13 后 intellij 系列编辑器闪屏?</a>：在 Help | Edit Custom VM Options 添加配置项目 <code>-Dsun.java2d.metal=false</code></li>
<li><a href=https://stackoverflow.com/a/75719236>How to use directly function key (F1 - F9) instead of pressing fn + function key in IDE in OSX?</a>: Preferences > Keyboard > Shortcuts > Function Keys，之后用 <code>fn</code> + <code>function key</code> 方式来调亮度与声音等。</li>
<li><a href=https://www.w3schools.io/editor/intellij-convert-upper-lowercase/>IntelliJ - Upper|Lower</a>: ⌘ + Shift + U</li>
<li>全局查找文件：Shift + Shift</li>
<li>全局查找文件内容：Command + Shift + F</li>
<li>IDEA 如何快速跳到下一行：Command + Shift + Enter</li>
</ul>
</li>
</ul>
<h2 id=20230717>20230717<a hidden class=anchor aria-hidden=true href=#20230717>#</a></h2>
<ul>
<li><a href=https://zhuanlan.zhihu.com/p/47746984>Paypal怎么用？Paypal使用教程详解</a></li>
<li><a href="https://baijiahao.baidu.com/s?id=1711980254945752884">一起学Docker</a></li>
<li><a href=https://www.zhangxinxu.com/wordpress/2019/08/js-url-urlsearchparams/>JS URL()和URLSearchParams() API接口详细介绍</a></li>
<li><a href=https://juejin.cn/post/6971268824288985118>【前端开发技巧】npm install xxxx &ndash;legacy-peer-deps到底做了些什么？</a></li>
<li><a href=https://juejin.cn/post/7076340796361801759>彻底搞懂Vue中的Mixin混入（保姆级教程）</a></li>
<li><a href=https://zhuanlan.zhihu.com/p/72916219>教你如何实现单卡iPhone实现双卡双待。</a>
<ul>
<li>移动卡：无忧行（打电话、收短信）+和飞信（发短信）</li>
<li>两台 iPhone：iMessage 短信转发+呼叫转移</li>
</ul>
</li>
<li><a href=https://www.c114.com.cn/news/16/a1132715.html>折磨人的携号转网：看清楚这4点再动手！</a>：携号转网每个运营商 App 都有通道并且有教程。
<ul>
<li>CXXZ#用户姓名#证件号码 发送至拟转出的运营商（电信10001，移动10086，联通10010）</li>
<li>SQXZ#用户姓名#证件号码 申请授权码</li>
</ul>
</li>
<li><a href=https://www.sohu.com/a/540185697_120633500>携号转网，用不完的话费余额怎么办？</a></li>
<li><a href=https://www.bilibili.com/read/cv6626483/>iCloud账号转区教程</a></li>
<li><a href=https://zhuanlan.zhihu.com/p/514751508>2022最全美版Paypal注册教程（绑定美版Apple ID+如何解除风控+注意事项）</a></li>
</ul>
<h2 id=20230715>20230715<a hidden class=anchor aria-hidden=true href=#20230715>#</a></h2>
<ul>
<li><a href=https://www.jianshu.com/p/c4dc22699a42>CGI是什么</a></li>
<li><a href=https://www.digitalocean.com/community/tutorials/how-to-install-php-7-4-and-set-up-a-local-development-environment-on-ubuntu-20-04>How To Install PHP 7.4 and Set Up a Local Development Environment on Ubuntu20.04</a>：~~其实可以直接通过 docker 运行，这样就可以不考虑平台了。~~只用于部署的话，docker很合适，但是用于开发的话，就不大方便了，但不是不行。</li>
<li><a href=https://blog.devsense.com/2022/develop-php-in-docker>How to develop PHP inside a Docker Container using VS Code</a>：核心是 devcontainer.json，不过要考虑到 apple m1 是 arm 而不是 amd64，这个可能导致问题，arm 服务器并不是主流。</li>
<li><a href=https://learnku.com/>LearnKu</a>：<a href=https://learnku.com/articles/28735>LearnKu 诞生的故事</a></li>
<li><a href=https://zhuanlan.zhihu.com/p/329962624>Python常用魔术方法</a>：魔术方法在类或对象的某些事件出发后会自动执行，让类具有神奇的“魔力”。如果希望根据自己的程序定制自己特殊功能的类，那么就需要对这些方法进行重写。</li>
<li><a href=https://zhuanlan.zhihu.com/p/615554635>压缩即泛化，泛化即智能</a></li>
<li><a href=https://zhuanlan.zhihu.com/p/47999705>关于SIM和eSIM，看这一篇就够啦！</a></li>
<li><a href=https://moe.mwulu.com/digitalocean-feiyong/>DigitalOcean是如何计算费用</a></li>
<li><a href=https://www.cnblogs.com/azhqiang/p/11024705.html>DNS域名解析中A、AAAA、CNAME、MX、NS、TXT、SRV、SOA、PTR各项记录的作用</a></li>
<li><a href=https://ayw.ink/2642.html>Azure免费服务用量注意点集合，避免扣费暗坑</a></li>
</ul>
<h2 id=20230714>20230714<a hidden class=anchor aria-hidden=true href=#20230714>#</a></h2>
<ul>
<li>如果是 PC 跳到 web.iruca.ai，如果是 Mobile 跳到 m.iruca.ai：方法就是加一个判断，然后跳转；可以在服务端判断，也可以在客户端判断；可以用 UserAgent 判断，也可以通过 viewport 尺寸来判断。
<ul>
<li>
<p><a href=http://detectmobilebrowsers.com>Detect Mobile Browsers</a></p>
</li>
<li>
<p><a href=https://juejin.cn/post/6844904127823085575>VUE判断当前设备是PC还是移动端</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>useWebSelection</span>() {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>pcDomain</span> <span style=color:#f92672>=</span>
        <span style=color:#66d9ef>import</span>.<span style=color:#a6e22e>meta</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>VITE_PC_DOMAIN</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;&lt;https://testweb.iruca.ai/&gt;&#39;</span>
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mobileRegex</span> <span style=color:#f92672>=</span>
        <span style=color:#e6db74>/(phone|pad|pod|iPhone|iPod|ios|iPad|Android|Mobile|BlackBerry|IEMobile|MQQBrowser|JUC|Fennec|wOSBrowser|BrowserNG|WebOS|Symbian|Windows Phone)/i</span>
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isMobile</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>navigator</span>.<span style=color:#a6e22e>userAgent</span>.<span style=color:#a6e22e>match</span>(<span style=color:#a6e22e>mobileRegex</span>)
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>isWide</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>matchMedia</span>(<span style=color:#e6db74>&#39;(min-width: 1200px)&#39;</span>).<span style=color:#a6e22e>matches</span>
    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>isMobile</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>isWide</span>) {
        window.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>pcDomain</span>
    }
}
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230713>20230713<a hidden class=anchor aria-hidden=true href=#20230713>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://apifox.com>Apifox</a>：API 文档、API 调试、API Mock、API 自动化测试</li>
<li>Mac 配置
<ul>
<li>安装 Xcode Command Line Tools，包含 git：<code>xcode-select --install</code></li>
<li>安装 <a href=https://github.com/Fndroid/clash_for_windows_pkg/>Clash for Windows</a> 或 <a href=https://github.com/yichengchen/clashX/>ClashX/ClashX Pro</a>：否则无法安装 Homebrew。推荐 ClashX Pro 搭配 Clash Premium 开启 Enhanced Mode （tun 模式）使用。</li>
<li>安装 <a href=https://brew.sh>Homebrew</a>：<code>/bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"</code></li>
<li>开启 openssh server：<a href=https://osxdaily.com/2022/07/08/turn-on-ssh-mac/>How to Turn On SSH on Mac</a></li>
<li>安装 <a href=https://intelliscapesolutions.com/apps/caffeine>Caffeine</a>: Don&rsquo;t let your Mac fall asleep.</li>
<li>复制配置文件：.oh-my-zsh、.zshrc、.zprofile、.npmrc、.ssh、.vimrc</li>
<li>安装开发 GUI 工具：item2、visual-studio-code、google-chrome、firefox、tailscale、postman、dbeaver-community、another-redis-desktop-manager</li>
<li>安装开发 CLI 工具：node@16、yarn、rust、openjdk@11</li>
<li>克隆公司仓库：coinphd、iruca</li>
<li>克隆个人仓库：dishizhihui-codes、dishizhihui-logs</li>
<li>安装其他软件：lark、wpsoffice、shottr、adrive、vlc、keyboardcleantool、neteasemusic</li>
<li>复制目录 Movies；备份 Projects</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230712>20230712<a hidden class=anchor aria-hidden=true href=#20230712>#</a></h2>
<ul>
<li>
<p><a href=https://superuser.com/a/367303>How to copy with cp to include hidden files and hidden directories and their contents?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 将 dir1 复制到 dir2 下，即 dir2/dir1</span>
cp -av dir1 dir2

<span style=color:#75715e># 将 dir1 的内容复制到 dir2 目录下</span>
cp -av dir1/. dir2
cp -av dir1/ dir2
</code></pre></div></li>
<li>
<p>COINPHD 项目技术栈</p>
<ul>
<li>
<p><a href=https://cn.vuejs.org>Vue3</a></p>
<ul>
<li>
<p><a href=https://www.liujiangblog.com/course/Vue3/303>组合式API</a></p>
</li>
<li>
<p><a href=https://segmentfault.com/a/1190000042266418>6 个你必须明白 Vue3 的 ref 和 reactive 问题（入门篇）</a></p>
</li>
<li>
<p><a href=https://vuejs.org/guide/introduction.html>Vue.js Guide</a></p>
<ul>
<li><a href=https://vuejs.org/guide/essentials/reactivity-fundamentals.html>Reactivity</a>
<ul>
<li><a href=https://vuejs.org/guide/essentials/class-and-style.html>Class and Style Bindings</a></li>
<li><a href=https://vuejs.org/guide/essentials/watchers.html>Watchers</a>: <code>watch(source, (newValue, oldValue) => {}, config)</code></li>
</ul>
</li>
<li><a href=https://vuejs.org/guide/essentials/component-basics.html>Components</a>
<ul>
<li>
<p><a href=https://vuejs.org/api/built-in-special-elements.html#template><code>&lt;template></code></a>: .vue 顶层 <code>&lt;template></code> 下的 <code>&lt;template></code> 不会直接显示，需要带有指令来控制其怎样显示 <code>&lt;template v-if="true"></code></p>
</li>
<li>
<p><a href=https://vuejs.org/guide/components/props.html>Props</a>：</p>
<ul>
<li><a href=https://vuejs.org/guide/components/props.html#prop-passing-details>Binding Multiple Properties Using an Object</a>：在 React 中是 <code>&lt;CustomComponent {...propsObject} /></code>，而在 Vue 中是 <code>&lt;CustomComponent v-bind="propsObject" /></code></li>
<li>设置多个类型与默认
<ul>
<li>
<p><a href=https://vuejs.org/guide/components/props.html#prop-validation>Prop Validation</a>/<a href=https://stackoverflow.com/a/70577354>How can I set the local default value in defineProps?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>props</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>defineProps</span>({
    <span style=color:#a6e22e>index</span><span style=color:#f92672>:</span> {
        <span style=color:#a6e22e>type</span><span style=color:#f92672>:</span> [String, Number],
        <span style=color:#a6e22e>required</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
        <span style=color:#66d9ef>default</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>
    }
})
</code></pre></div></li>
<li>
<p><a href=https://vuejs.org/api/sfc-script-setup.html#default-props-values-when-using-type-declaration>withDefaults</a>/<a href=https://github.com/vuejs/core/issues/4294#issuecomment-970861525>How to import interface for defineProps</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>props</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>withDefaults</span>(
    <span style=color:#a6e22e>defineProps</span><span style=color:#f92672>&lt;</span>{
        <span style=color:#a6e22e>msg</span><span style=color:#f92672>?:</span> <span style=color:#a6e22e>string</span>
        <span style=color:#a6e22e>labels</span><span style=color:#f92672>?:</span> <span style=color:#a6e22e>string</span>[]
    }<span style=color:#f92672>&gt;</span>(),
    {
        <span style=color:#a6e22e>msg</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;hello&#39;</span>,
        <span style=color:#a6e22e>labels</span><span style=color:#f92672>:</span> () =&gt; [<span style=color:#e6db74>&#39;one&#39;</span>, <span style=color:#e6db74>&#39;two&#39;</span>]
    }
)
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://vuejs.org/guide/components/events.html>Events</a></p>
</li>
<li>
<p><a href=https://vuejs.org/guide/components/v-model.html>v-model</a></p>
</li>
<li>
<p><a href=https://vuejs.org/guide/components/slots.html>Slots</a>：</p>
<ul>
<li>Named Slots 可以在指定 slots 位置渲染</li>
<li>Scoped Slots 让父组件访问子组件状态。列子如 <a href=https://stackoverflow.com/a/67738743>How to handle a slot&rsquo;s onClick event in VueJS</a>。</li>
</ul>
</li>
<li>
<p><a href=https://vuejs.org/guide/essentials/template-refs.html>Template Refs</a></p>
</li>
</ul>
</li>
<li><a href=https://vuejs.org/guide/reusability/plugins.html>Plugins</a></li>
<li>API
<ul>
<li>
<p><a href=https://vuejs.org/api/component-instance.html#nexttick>$nextTick()</a>: <code>await nextTick()</code></p>
</li>
<li>
<p><a href=https://vuejs.org/api/component-instance.html#forceupdate>$forceUpdate()</a>: <a href=https://stackoverflow.com/a/68108173>example</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>script</span> <span style=color:#a6e22e>setup</span> <span style=color:#a6e22e>lang</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;ts&#34;</span><span style=color:#f92672>&gt;</span>
<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>getCurrentInstance</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;vue&#39;</span>
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>instance</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>getCurrentInstance</span>();
<span style=color:#a6e22e>instance</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>proxy</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>$forceUpdate</span>();
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/script&gt;</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Vue i18n</p>
<ul>
<li><a href=https://github.com/intlify/vue-i18n-next>vue-i18n@9</a>(Vue3 i18n)/<a href=https://github.com/kazupon/vue-i18n>vue-i18n</a>(Vue2 i18n)
<ul>
<li><a href=https://vue-i18n.intlify.dev/guide/>Getting started</a>：大致用法</li>
<li><a href=https://vue-i18n.intlify.dev/guide/essentials/scope.html>Scope and Locale Changing</a></li>
<li><a href=https://vue-i18n.intlify.dev/guide/advanced/composition.html>Composition API</a>：Vue3 的选项式 API。</li>
</ul>
</li>
<li><a href=https://medium.com/hypefactors/add-i18n-and-manage-translations-of-a-vue-js-powered-website-73b4511ca69c>Add i18n and manage translations of a Vue.js powered website</a>：不同于 lingui，vue-i18 是可以翻译变量的。</li>
<li><a href=https://github.com/intlify/bundle-tools/tree/main/packages/unplugin-vue-i18n>@intlify/unplugin-vue-i18n</a> for vite4，安装后可以使用 json 文件作为 message</li>
</ul>
</li>
<li>
<p><a href=https://vitejs.dev>Vite</a></p>
<ul>
<li><a href=https://vitejs.dev/guide/env-and-mode.html>Env Variables and Modes</a>: <code>import.meta.env.VITE_SOME_KEY</code></li>
<li><a href=https://vitejs.dev/guide/features.html#glob-import>Glob Import</a>: <code>const modules = import.meta.glob('./dir/*.js', { eager: true })</code></li>
<li><a href=https://vitejs.dev/guide/assets.html>Static Asset Handling</a></li>
<li><a href=https://github.com/vbenjs/vite-plugin-svg-icons>vite-plugin-svg-icons</a>：把 svg 处理为组件的库，需要重启以生效新 svg</li>
<li><a href=https://github.com/nicolasbeauvais/vue-social-sharing>vue-social-sharing</a>：社交媒体分享组件，同 react-share
<ul>
<li>nuxt 下报错 <a href=https://github.com/nicolasbeauvais/vue-social-sharing/issues/338>Cannot read properties of undefined (reading &lsquo;Index&rsquo;)</a></li>
</ul>
</li>
<li><a href=https://github.com/rstacruz/nprogress>nprogress</a>: progress bars</li>
</ul>
</li>
<li>
<p><a href=https://nuxt.com/docs/getting-started/introduction>Nuxt</a>: Vue.js Web Framework</p>
<ul>
<li>
<p><a href=https://nuxt.com/docs/getting-started/configuration>nuxt.config.ts</a></p>
<ul>
<li><a href=https://nuxt.com/docs/getting-started/styling#the-css-property>The CSS Property</a></li>
<li><a href=https://nuxt.com/docs/guide/concepts/modules#the-modules-property>The modules Property</a></li>
<li><a href=https://nuxt.com/docs/api/composables/use-runtime-config>useRuntimeConfig</a></li>
</ul>
</li>
<li>
<p><a href=https://nuxt.com/docs/getting-started/routing>Routing</a>:</p>
<ul>
<li><a href=https://nuxt.com/docs/api/composables/use-route>useRoute</a></li>
<li><a href=https://nuxt.com/docs/api/composables/use-router>useRouter</a></li>
<li><a href=https://nuxt.com/docs/api/utils/navigate-to>navigateTo</a>：跳外站要用 <code>navigateTo(url, { external: true })</code></li>
</ul>
</li>
<li>
<p><a href=https://nuxt.com/docs/getting-started/data-fetching>Data fetching</a>: useFetch, useAsyncData and $fetch</p>
<ul>
<li><a href=https://github.com/unjs/ofetch>ofetch</a>: Works on node, browser and workers. nuxt 用于发送 ajax 请求的库。</li>
</ul>
</li>
<li>
<p><a href=https://nuxt.com/docs/getting-started/deployment>Deployment</a></p>
</li>
<li>
<p><a href=https://nuxt.com/docs/guide/directory-structure/components>Components Directory</a>: Nuxt automatically imports any components in your components/ directory（同 uniapp，Nuxt <code>@/components</code> 下组件也是自动引用与注册的）</p>
</li>
<li>
<p><a href=https://nuxt.com/docs/api/composables/use-state>useState</a></p>
</li>
<li>
<p><a href=https://nuxt.com/docs/api/utils/refresh-nuxt-data>refreshNuxtData</a>：类似 useSWR 的 mutate，重新请求 API，只限于当前页面。</p>
</li>
<li>
<p><a href=https://github.com/nuxt-community/device-module>device-module</a>: detecting device type.</p>
</li>
<li>
<p><code>process.server</code> and <code>process.client</code>：用于判断是否是 SSR，文档中没有相关词条，但是在别的词条的例子中有使用。</p>
<ul>
<li>
<p><a href=https://github.com/nuxt/nuxt/issues/6629>Set process.server and process.client in nuxt.config.js</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/72645416>How can I get window.location.href in Nuxtjs V3</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>client</span>) {
      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(window.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span>)
}
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://image.nuxtjs.org>Nuxt Image</a>：<code>&lt;nuxt-img></code> 只支持 public 下的图片；使用原生 <code>&lt;img></code>，可以使用 vue + vite 项目的各种特性。</p>
<ul>
<li><a href=https://nuxt.com/docs/getting-started/assets>Assets</a>：因为 assets/ 下的资源需要对应 build tool，因此 <code>&lt;img src="@/assets/img/nuxt.png" /></code> 方式可以访问，<code>&lt;img :src="imagePath" /></code>中即使 <code>imagePath='@/assets/img/nuxt.png'</code> 依旧不可以访问。</li>
<li><a href=https://vitejs.dev/guide/assets.html>Static Asset Handling</a>/<a href=https://stackoverflow.com/a/45116994>How to import and use image in a Vue single file component?</a>
<ul>
<li>
<p><a href=https://vitejs.dev/guide/assets.html#importing-asset-as-url>Importing Asset as URL</a>：直接 import png 文件</p>
</li>
<li>
<p><a href=https://vitejs.dev/guide/assets.html#importing-asset-as-url>new URL(url, import.meta.url)</a>/<a href=https://stackoverflow.com/a/75218761>Nuxt dynamic image - Require is not defined</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>imgUrl</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>png</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) =&gt; {
    <span style=color:#66d9ef>return</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>URL</span>(<span style=color:#e6db74>`../../assets/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>png</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>, <span style=color:#66d9ef>import</span>.<span style=color:#a6e22e>meta</span>.<span style=color:#a6e22e>url</span>).<span style=color:#a6e22e>href</span>
}
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://v2.nuxt.com/docs/concepts/nuxt-lifecycle>Nuxt Lifecycle</a>：client 中，plugin 在 middleware 之前进行处理，要根据设备类型跳转到指定网址，那么我认为放在 plugin 比放在 middleware 更合适，原则是在跳转前执行最少的步骤。</p>
<ul>
<li><a href=https://nuxt.com/docs/guide/going-further/hooks#app-hooks-runtime>Lifecycle Hooks</a>/<a href=https://nuxt.com/docs/guide/directory-structure/plugins>Plugins Directory</a></li>
<li><a href=https://nuxt.com/docs/guide/directory-structure/middleware>Middleware Directory</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://v8.i18n.nuxtjs.org>nuxt/i18n</a></p>
<ul>
<li><a href=https://v8.i18n.nuxtjs.org/getting-started/basic-usage>Basic Usage</a>：使用 <code>const { locale } = useI18n()</code> 报错 <code>Cannot find name 'useI18n'.</code>，原因是因为要从 &lsquo;#i18n&rsquo; 导入而非 &lsquo;#imports&rsquo; 导入，而这些就定义在 tsconfig.json 的 paths 属性中，这表明自己对 ts 并不熟悉啊！</li>
<li><a href=https://v8.i18n.nuxtjs.org/guide/routing-strategies>Routing & Strategies</a>：为多语言添加路由前缀。Strategies 如果是 no_prefix，要用 <code>@click="setLocale(code)"</code> 方式以保存 cookie，如果是包含 prefix 方式，那么要用 <code>&lt;NuxtLink :to="switchLocalePath(code)"></code> 方式。</li>
<li><a href=https://v8.i18n.nuxtjs.org/guide/browser-language-detection>Browser language detection</a>：检测浏览器语言并存入 cookie。本地开发没有看到存的 cookie 键值对，但是上线后确实看到了 cookie 键值对。</li>
<li><a href=https://v8.i18n.nuxtjs.org/guide/lazy-load-translations>Lazy-load translations</a>：通过目录 lang 下的 json 加载多语言。写在 i18n.config.ts 找不到 message，写在 nuxt.config.js 正常运行</li>
<li><a href=https://v8.i18n.nuxtjs.org/guide/lang-switcher>Lang Switcher</a>
<ul>
<li><code>Property 'code' does not exist on type 'string | LocaleObject'.</code>，在返回的时候 computed 断言返回类型 <code>locales.value as LocaleObject[]</code>，从 <code>'#i18n'</code> 中导入。</li>
<li>这个会直接更改 Browser language detection 初始化的 i18n_redirected cookie 值。</li>
</ul>
</li>
<li><a href=https://v8.i18n.nuxtjs.org/guide/locale-fallback>Locale fallback</a></li>
<li><a href=https://v8.i18n.nuxtjs.org/guide/per-component-translations>Per-component translations</a>：可以从 useI18n() 中解构出 t 函数，让后通过 <code>watch(locale, () => t('key'))</code> 在<code>&lt;script></code> 中翻译。</li>
<li><a href=https://v8.i18n.nuxtjs.org/api/composables>Composables</a>: <code>useCookieLocale</code></li>
</ul>
</li>
<li>
<p><a href=https://element-plus.org/en-US/>Element Plus</a>: Vue 3 based component library</p>
<ul>
<li><a href=https://element-plus.org/en-US/component/dropdown.html>Dropdown</a></li>
<li><a href=https://element-plus.org/en-US/component/dialog.html>Dialog</a>：多数组件库的 dialog 都是在 body 下，跟框架的根目录同级，这样就可以不用z-index了。</li>
<li><a href=https://element-plus.org/en-US/component/drawer.html>Drawer</a></li>
<li><a href=https://element-plus.org/en-US/component/popover.html>Popover</a></li>
</ul>
</li>
<li>
<p><a href=https://sass-lang.com>scss</a></p>
</li>
<li>
<p><a href=https://zh.uniapp.dcloud.io>uni-app</a>：uniapp 的文档不怎么好，定位是参考手册而非教程，不适合通过直接阅读来学习；它要求拥有 vue 基础，适合在编写项目过程中，通过解决各种问题来学习如何使用。uni-app 的 api 都是适用于多端的 api，因此最好使用它的提供的 api，而非原生的 h5 等 api；除非实在没有，那么就通过条件编译分别调用各平台 API。</p>
<ul>
<li>
<p><a href=https://uniapp.dcloud.net.cn/tutorial/>教程</a></p>
<ul>
<li><a href=https://uniapp.dcloud.net.cn/tutorial/page.html>页面</a>：
<ul>
<li>每次新建页面，均需在pages.json中配置pages列表。</li>
<li>onLoad生命周期函数: 其回调函数的参数为上个页面传递的数据</li>
<li>onReachBottom、onPageScroll、getCurrentPages()</li>
</ul>
</li>
<li><a href=https://zh.uniapp.dcloud.io/tutorial/page-component.html>互相引用</a>：通过 <a href=https://zh.uniapp.dcloud.io/collocation/pages.html#easycom>easycom</a>，组件只要安装在项目根目录的components目录下，就可以不用引用、注册，直接在页面中使用。也不能去引用，比如 lang-switch 可以手动导入，lang-switcher 却提示找不到。这也将导致无法快速跳到组件定义文件。自定义配置查看 package.json 下 easycom</li>
<li><a href=https://uniapp.dcloud.net.cn/tutorial/platform.html>条件编译处理多端差异</a>：可以指定某部分代码只编译到特定的终端平台。</li>
</ul>
</li>
<li>
<p><a href=https://uniapp.dcloud.net.cn/component/>组件</a></p>
<ul>
<li><a href=https://uniapp.dcloud.net.cn/component/view.html>view</a>：替代 div，设置 p-3 后，会发现 div 右边没有 padding；<code>h-full</code> 无效，用 <code>h-screen</code> 代替。</li>
<li><a href=https://uniapp.dcloud.net.cn/component/text.html>text</a>：有些平台无法在<code>&lt;view></code>组件包裹文本。</li>
<li><a href=https://uniapp.dcloud.net.cn/component/input.html>input</a>：有个 placeholder-class 属性</li>
<li><a href=https://uniapp.dcloud.net.cn/component/image.html>image</a>: mode <code>widthFix</code> 是最常用的。</li>
</ul>
</li>
<li>
<p><a href=https://uniapp.dcloud.net.cn/api/>API</a></p>
<ul>
<li><a href=https://uniapp.dcloud.net.cn/api/request/request.html>网络</a></li>
<li><a href=https://uniapp.dcloud.net.cn/api/router.html>页面和路由</a>
<ul>
<li><a href=https://zh.uniapp.dcloud.io/api/router.html#navigateto>uni.navigateTo(OBJECT)</a>：要打开web url，参考 <a href=https://github.com/dcloudio/hello-uniapp/blob/master/components/u-link/u-link.vue>u-link</a></li>
<li><a href=https://www.npmjs.com/package/uniapp-router-next>uniapp-router-next</a>
<ul>
<li>适用于 uniapp 的 vue3 router，提供 <code>router-navigate</code> 组件用于路由。</li>
<li>使用 <code>useRoute()</code> 替代 <a href=https://www.jianshu.com/p/edea03b1fe52>getCurrentPages()</a> ，更方便地获取当前的路由信息。</li>
</ul>
</li>
<li><a href=https://www.lervor.com/archives/140/>uni-app 页面应用内跳转与应用外跳转的实现方式</a>：即 <a href=https://zh.uniapp.dcloud.io/component/web-view.html#web-view>web-view</a> 方式</li>
<li><a href=https://github.com/SilurianYang/uni-simple-router>uni-simple-router</a>：支持路由别名 aliasPath</li>
</ul>
</li>
<li><a href=https://uniapp.dcloud.net.cn/api/storage/storage.html>数据缓存</a>
<ul>
<li><a href=https://ask.dcloud.net.cn/question/59320>非 H5 端不支持自动保持 cookie</a>，服务器应避免验证 cookie。</li>
</ul>
</li>
<li>设备
<ul>
<li><a href=https://uniapp.dcloud.net.cn/api/system/clipboard.html>剪贴板</a>: <code>uni.setClipboardData(OBJECT)</code></li>
</ul>
</li>
<li><a href=https://uniapp.dcloud.net.cn/api/ui/prompt.html>界面</a>
<ul>
<li><a href=https://zh.uniapp.dcloud.io/api/ui/prompt.html#showtoast>uni.showToast(OBJECT)</a></li>
<li><a href=https://uniapp.dcloud.net.cn/api/ui/prompt.html#showloading>uni.showLoading(OBJECT)</a>: <code>uni.setClipboardData(OBJECT)</code></li>
<li><a href=https://uniapp.dcloud.net.cn/api/ui/intersection-observer.html>uni.createIntersectionObserver()</a>：观察者模式 api，用例 <a href=https://gitee.com/vk-uni/vk-uview-ui/blob/master/uni_modules/vk-uview-ui/components/u-lazy-load/>u-lazy-load</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://www.npmjs.com/package/vk-uview-ui>vk-uview-ui</a>/<a href=https://vkuviewdoc.fsq.pub>uView</a>：UI 库，组件都以 <code>u-*</code> 开头。</p>
<ul>
<li><a href=https://vkuviewdoc.fsq.pub/components/image.html>Image</a>
<ul>
<li><a href=https://vkuviewdoc.fsq.pub/components/loading.html>Loading</a></li>
<li><a href=https://vkuviewdoc.fsq.pub/components/empty.html>Empty</a>：自动居中展示。</li>
</ul>
</li>
<li><a href=https://vkuviewdoc.fsq.pub/components/select.html>Select</a>：从底部滑出菜单。本来想用 Dropdown，但是没有显示item的内容。</li>
<li><a href=https://vkuviewdoc.fsq.pub/components/tabs.html>Tabs</a></li>
<li><a href=https://vkuviewdoc.fsq.pub/components/waterfall.html>Waterfall</a>
<ul>
<li><a href=https://vkuviewdoc.fsq.pub/components/button.html>Button</a>：要设置 <code>:hair-line="false"</code>，否则显示 CJK 字体右侧空白与边框没对齐</li>
<li><a href=https://vkuviewdoc.fsq.pub/components/icon.html>Icon</a></li>
<li><a href=https://vkuviewdoc.fsq.pub/components/loadMore.html>LoadMore</a></li>
<li><a href=https://vkuviewdoc.fsq.pub/components/backTop.html>BackTop</a></li>
</ul>
</li>
<li><a href=https://vkuviewdoc.fsq.pub/components/card.html>Card</a>：只展示主题内容 <code>:showHead="false"</code></li>
<li><a href=https://vkuviewdoc.fsq.pub/components/lazyLoad.html>LazyLoad</a>
<ul>
<li>表现为不能显示默认的 loadingImg 和 errorImg。只有 Safari，原因是 <a href=https://stackoverflow.com/a/32357343>Safari 不会渲染字符数不能被 4 整除的 base64 图像</a>。我将base64转为png图片再替代。</li>
<li>表现为首次进入页面高度很高，与宽度不成比例，过一会儿宽高成比例。Chrome 遇到几次，很快恢复正常；Safari 是每次，并且刷新才正常。（Safari即前端地狱）
<ul>
<li><a href=https://ask.dcloud.net.cn/question/7507>原因是先使用默认高度450rpx，之后再用 widthFix 计算的高度值</a>。尝试用 <code>height: auto</code>，Safari 直接不显示图片，因为 Safari 的 height默认值为 0，Chrome 为图片高度。</li>
<li>要解决 Safari 中 height 默认值为 0，就必须给出具体的 height 值。通过获取容器宽度与图片的宽高，依照图片宽高比例计算出容器的高度。
<ul>
<li><a href=https://ask.dcloud.net.cn/question/97285>console.log 在safari中调试不显示</a>：用console.debug代替console.log来解决</li>
<li><a href=https://uniapp.dcloud.net.cn/api/media/image.html#getimageinfo>uni.getImageInfo(OBJECT)</a>：获取图片比例</li>
<li><a href=https://uniapp.dcloud.net.cn/api/ui/nodes-info.html>uni.createSelectorQuery()</a>：获取容器宽度</li>
<li>在 Safari 中不 height 能用 rpx，会转换成 rem，导致图片变形，必须使用 px 才能正确够显示。</li>
<li>参见 <a href=codes/uniapp/lazy-load.vue>lazy-load.vue</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href=https://vkuviewdoc.fsq.pub/components/popup.html>Popup</a>：可从上下左右四个方向弹出。
<ul>
<li><a href=https://vkuviewdoc.fsq.pub/components/grid.html>Grid</a></li>
<li><a href=https://vkuviewdoc.fsq.pub/components/layout.html>Layout</a>：12 分栏</li>
</ul>
</li>
<li><a href=https://vkuviewdoc.fsq.pub/components/field.html>Field</a>: <code>type="textarea"</code> 使用文本框；默认label占有宽度，可以设置 <code>:label-width="0"</code> 以使输入框占据全部宽度</li>
<li><a href=https://vkuviewdoc.fsq.pub/components/tabs.html>tabs</a>：不能用 v-show 控制要显示的组件，因为会导致第二个组件宽度不对，与 <a href=https://vkuviewdoc.fsq.pub/components/swipeAction.html>SwipeAction</a> 会导致其不能显示按钮（草，这里浪费了好多时间），应该用 v-if。</li>
</ul>
</li>
<li>
<p><a href=https://github.com/SmileZXLee/uni-z-paging>uni-z-paging</a>：下拉刷新、上拉加载</p>
</li>
</ul>
</li>
<li>
<p><a href=https://www.thinkphp.cn>ThinkPHP</a>：编程语言是编程的基础，必须要整体学一下；框架则只需要看基础部分，剩下的用到哪些就看哪些，毕竟光看是学不会，也是很枯燥的；总之，判断的标准就是能不能开始写东西了，可以了就说明可以通过遇到问题来学习知识。</p>
<ul>
<li>
<p><a href=https://www.php.net/manual/zh/>PHP 手册</a>：官方教程部分没有翻译完，并且讲的太细，适合做参考手册，并不适合新人的教程。</p>
<ul>
<li><a href=https://www.php.net/manual/zh/install.unix.php>Unix 系统下的安装</a></li>
<li><a href=https://www.php.net/manual/zh/language.constants.magic.php>魔术常量</a>：<code>__DIR__</code> 当前文件所在的目录。</li>
<li><a href=https://www.php.net/manual/en/function.implode.php>implode</a>：同 js 的 Array.prototype.join() 方法。</li>
</ul>
</li>
<li>
<p><a href=https://laravelacademy.org/books/php-tutorial>PHP 入门到实战教程</a>：非常好的入门教程，看完之后完全可以开始写东西了。</p>
</li>
<li>
<p><a href=https://laravelacademy.org/books/phpstorm-tutorial>玩转 PhpStorm 系列</a></p>
<ul>
<li><a href=https://laravelacademy.org/post/21867>基于 Xdebug 进行代码调试</a></li>
</ul>
</li>
<li>
<p><a href=https://www.kancloud.cn/manual/thinkphp6_0>ThinkPHP6.0完全开发手册</a></p>
<ul>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037484>配置目录</a>：
<ul>
<li><code>use think\facade\Config;</code></li>
<li>相同的数组名，下面的 <code>[ArrayName]</code> 定义会覆盖了上面定义，不会自动合并，因此要写在一起。</li>
</ul>
</li>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037485>架构</a>：至少看这部分，知道怎么个执行的流程（路由），如果要写，要在哪里加东西。
<ul>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037487>入口文件</a>：这个与 PHP 应用部署相关。PHP 的运行方式与 node 项目不同，node 需要 build，PHP 是动态解释型语言，无须编译即可执行，可以直接当作 html 来用，配置 nginx 就指向 php 文件就可以访问了，<code>root /chat/server/public;</code></li>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037488>URL访问</a>：<code>http://serverName/index.php/应用/控制器/操作/参数/值...</code></li>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037493>中间件</a>：中间件主要用于拦截或过滤应用的HTTP请求，并进行必要的业务处理。</li>
</ul>
</li>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037579>模型</a>：即数据表的定义与操作</li>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037618>调试模式</a>
<ul>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037619>Trace调试</a></li>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037621>变量调试</a>：内置了一个对浏览器友好的dump方法，用于输出变量的信息到浏览器查看。单个 api 可以直接输入 url 在浏览器中查看；对于复杂联动的api，在web端，可以在浏览器中选择对应的请求，然后选择 Preview 查看。</li>
</ul>
</li>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037634>缓存</a>：Redis</li>
<li><a href=https://www.kancloud.cn/manual/thinkphp6_0/1037637>多语言</a>：
<ul>
<li><code>allow_lang_list</code> 写的是全称，如 en-US，那么即使客户端 Accept-Language 为 en，依旧可以被识别为 en-US。</li>
<li><code>Accept-Language</code> 先于 use_cookie，但是最好还是一开始就设定好 cookie 的值，而不是去改变 Accept-Language。</li>
</ul>
</li>
<li>Libraries
<ul>
<li><a href=https://github.com/liliuwei/thinkphp-social>thinkphp-social</a>：社会化登录扩展</li>
<li><a href=https://github.com/orhanerday/open-ai>orhanerday/open-ai</a>Z: OpenAI PHP SDK</li>
<li><a href=https://github.com/stripe/stripe-php>stripe/stripe-php</a></li>
</ul>
</li>
<li><a href=https://yangweijie.github.io/thinkphp-lts/index_tp6_0.html>ThinkPHP 6.0 速查表</a></li>
</ul>
</li>
<li>
<p><a href=https://www.kancloud.cn/thinkphp/composer>Composer中文文档</a></p>
</li>
<li>
<p><a href=https://www.kancloud.cn/manual/think-template>ThinkTemplate开发指南</a></p>
<ul>
<li><a href=https://stackoverflow.com/a/3352615>How do I embed PHP code in JavaScript?</a>: 可以使用原生php代码 <code>var my_var = &lt;?php echo json_encode($my_var); ?>;</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://support.apple.com/en-us/HT212749>Erase your Mac and reset it to factory settings</a>: Erase All Content and Settings</p>
</li>
</ul>
<h2 id=20230711>20230711<a hidden class=anchor aria-hidden=true href=#20230711>#</a></h2>
<ul>
<li><a href=https://sspai.com/post/43155>把查词做到极致的 macOS 原生词典，其实很好用</a>：可以开启三指轻点快速翻译</li>
<li><a href=https://docs.freebsd.org/en/articles/rc-scripting/>Practical rc.d scripting in BSD</a>: <a href=codes/devOps/rc.d.template.sh>rc.d.template.sh</a></li>
</ul>
<h2 id=20230710>20230710<a hidden class=anchor aria-hidden=true href=#20230710>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://cloud.tencent.com/developer/article/1628679>什么是回归测试？</a></p>
</li>
<li>
<p><a href=https://cloud.tencent.com/developer/article/2161650>ZeroTier实现内网穿透、异地组网</a></p>
<ul>
<li>
<p>FreeBSD：ZeroTier 不需要开放端口</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo pkg install zerotier
sudo service zerotier enable <span style=color:#75715e># 自带 service，Nice！</span>
sudo service zerotier start
sudo zerotier-cli join 233ccaac270f677c
</code></pre></div></li>
<li>
<p><a href=https://github.com/zerotier/ZeroTierOne/issues/157#issuecomment-88646805>How can zerotier on OSX be paused?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># You can stop the service with:</span>
sudo launchctl unload /Library/LaunchDaemons/com.zerotier.one.plist

<span style=color:#75715e># It will start on next boot or:</span>
sudo launchctl load /Library/LaunchDaemons/com.zerotier.one.plist
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://cloud.tencent.com/developer/article/2210453>利用frp工具实现内网穿透、随时随地访问内网服务</a></p>
</li>
<li>
<p><a href=https://zhuanlan.zhihu.com/p/69267020>Syncthing - P2P文件同步工具</a>：</p>
<ul>
<li>
<p><a href=https://docs.syncthing.net/>Syncthing Docs</a></p>
<ul>
<li>首先看一下 <a href=https://docs.syncthing.net/intro/getting-started>Getting Started</a></li>
<li>然后在 <a href=https://docs.syncthing.net/users/contrib>Community Contributions</a> 中找到要安装的平台的安装包</li>
<li>最后设置防火墙 <a href=https://docs.syncthing.net/users/firewall>Firewall Setup</a>：要打开 22000/TCP、22000/UDP、21027/UDP</li>
</ul>
</li>
<li>
<p>Ubuntu 参考 <a href=https://www.linuxfordevices.com/tutorials/ubuntu/syncthing-install-and-setup>Syncthing – Install and Setup Syncthing on Ubuntu/Debian</a>：两个命令就安装好了</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo apt install syncthing
sudo systemctl enable syncthing@username.service
</code></pre></div></li>
<li>
<p>MacOS</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># Install</span>
brew install syncthing
<span style=color:#75715e># Test</span>
/opt/homebrew/opt/syncthing/bin/syncthing -no-browser -no-restart
<span style=color:#75715e># Run as serivce</span>
brew services start syncthing
<span style=color:#75715e># Access the GUI via the following URL: http://127.0.0.1:8384/</span>
</code></pre></div></li>
<li>
<p>FreeBSD：需要打开对应的端口</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo pkg install syncthing
sudo sh -c <span style=color:#e6db74>&#34;echo &#39;pass in proto tcp from ue0:network to port 22000&#39; &gt;&gt; /etc/pf.conf&#34;</span>
sudo pfctl -f /etc/pf.conf
sudo crontab -e
  @reboot kurome:kurome sleep 60;/usr/local/bin/syncthing&amp;
</code></pre></div></li>
<li>
<p>Tips:</p>
<ul>
<li>在连接设置中，只打开了本地发现；传输速度受限于路由设备（随身 WIFI，不到 5MB/s）</li>
<li>只需要在一个设备添加文件夹就可以了，不需要两个设备同时添加，分享后就是双向同步的了</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://wiki.freebsd.org/PkgPrimer>Pkg Primer</a>: pkg search -f packageName 展示 remote package info；pkg info packageName 展示 installed packageName。</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230707>20230707<a hidden class=anchor aria-hidden=true href=#20230707>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>VS Code Remote Development</p>
<ul>
<li>
<p><a href=https://code.visualstudio.com/docs/remote/ssh-tutorial>Remote via SSH</a></p>
</li>
<li>
<p><a href=https://aka.ms/vscode-server-doc>The VS Code Server</a></p>
</li>
<li>
<p><a href=https://coder.com/docs/code-server/latest>coder-server</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -fsSL https://code-server.dev/install.sh | sh
sed -i.bak <span style=color:#e6db74>&#39;s/auth: password/auth: none/&#39;</span> ~/.config/code-server/config.yaml
sudo systemctl restart code-server@$USER
ssh -N -L 8080:127.0.0.1:8080 <span style=color:#f92672>[</span>user<span style=color:#f92672>]</span>@&lt;instance-ip&gt;
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://www.cyberciti.biz/faq/how-to-configure-static-ip-address-on-freebsd/>How to configure static IP Address on FreeBSD</a></p>
</li>
<li>
<p>JS 反调试</p>
<ul>
<li><a href=https://x-c3ll.github.io/posts/javascript-antidebugging/>JavaScript AntiDebugging Tricks</a></li>
<li><a href=https://segmentfault.com/a/1190000021459140>JS禁止打开控制台</a></li>
</ul>
</li>
<li>
<p><a href=https://thiscute.world/posts/nixos-and-flake-basics/>NixOS 与 Nix Flakes 新手入门</a>：NixOS 与 Flakes 一份非官方的新手指南</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230706>20230706<a hidden class=anchor aria-hidden=true href=#20230706>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://12factor.net/zh_cn/>The Twelve-Factor App</a></p>
</li>
<li>
<p><a href=https://lxchuan12.gitee.io/dotenv/>面试官：项目中常用的 .env 文件原理是什么？如何实现？</a></p>
</li>
<li>
<p><a href=https://www.cnblogs.com/stulzq/p/8971531.html>使用 JMeter 进行压力测试</a></p>
</li>
<li>
<p><a href=http://github.yanhaixiang.com/jest-tutorial>Jest 实践指南</a>：很好的教程</p>
</li>
<li>
<p>整合 Line 登录：Line 注册要手机号，国内手机号不支持</p>
<ul>
<li>
<p><a href=https://developers.line.biz/en/docs/line-login/integrate-line-login/>Integrating LINE Login with your web app</a></p>
</li>
<li>
<p><a href=https://www.passportjs.org/packages/passport-line-auth/>passport-line-auth</a>：Line 的 Strategies 比较少，这个最近一年内更新了的，实际测试可用</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/29560210>nodejs/passport - Error: OAuthStrategy requires session support</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// Authentication configuration
</span><span style=color:#75715e></span><span style=color:#a6e22e>app</span>.<span style=color:#a6e22e>use</span>(<span style=color:#a6e22e>session</span>({
  <span style=color:#a6e22e>resave</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
  <span style=color:#a6e22e>saveUninitialized</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
  <span style=color:#a6e22e>secret</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;bla bla bla&#39;</span>
}));
</code></pre></div></li>
</ul>
</li>
<li>
<p>整合 Apple 登录：Apple 登录需要开发者账号，开发者账号要钱</p>
<ul>
<li><a href=https://blog.devgenius.io/how-to-implement-apple-login-with-nestjs-in-seconds-b88f05abe847>How to implement Apple Login with Nestjs in seconds</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230705>20230705<a hidden class=anchor aria-hidden=true href=#20230705>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://www.zhihu.com/question/25302832/answer/275403130>iPhone 怎么复制短信中的部分内容？</a>：选择转发，就可以在编辑栏再复制部分短信了。</li>
<li><a href=https://www.hostinger.com/tutorials/pr_end_of_file_error>How to Fix PR_END_OF_FILE_ERROR: 3 Methods That Work</a>：我配置 Firefox 的 Proxy DNS when using SOCKsv5 解决了访问 Gooogle 产生 Secure onnection failed 这个问题。</li>
<li><a href=https://nextjs.org/docs/app/building-your-application/deploying/static-exports>Static Exports</a>：Next.js 是可以来写静态博客部署到 Github Pages 的。</li>
<li><a href=https://superuser.com/a/134711>How can I keep the code formatted as original source when I paste them to vim?</a>: <code>:set paste</code>, then after <code>:set nopaste</code></li>
<li><a href=https://kejiweixun.com/note/202304240838>静态博客全文搜索简单调查</a></li>
<li><a href=https://droidwin.com/safari-translation-not-working-on-mac-ventura-fix/>Safari Translation Not Working On Mac/IPhone: How To Fix</a>: Download Language for Offline Translation. System Settings > General > Language & Region.</li>
</ul>
</li>
</ul>
<h2 id=20230704>20230704<a hidden class=anchor aria-hidden=true href=#20230704>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://juejin.cn/post/6844903688469741576>CSS实现footer“吸底”效果</a></li>
<li><a href=https://juejin.cn/post/7106738165083275277>冷知识：不起眼但有用的String.raw方法</a></li>
<li><a href=https://www.cyberciti.biz/tips/freebsd-timeclock-synchronization-with-ntp-server.html>How to set up NTP Clock Synchronization on FreeBSD with ntpd</a></li>
<li><a href=https://fmartingr.com/blog/2022/08/12/using-ssh-config-match-to-connect-to-a-host-using-multiple-ip-or-hostnames/>Using ssh_config Match to connect to a host using multiple IP or Hostnames</a></li>
<li><a href=https://github.com/marketplace/actions/hugo-setup>Hugo setup</a>：用 Github Action 部署 hugo 博客</li>
<li><a href=https://github.com/gohugoio/hugo/issues/1659#issuecomment-200051556>Hugo quietly builds empty index.html files</a>: FreeBSD 上使用从 gihub release 上下载的 hugo 遇到此问题，没有报错，就是不 build content 下的博客，搞了一晚上都没有解决，最终通过 pkg install gohugo 解决，这个版本也是 <a href=https://gohugo.io/installation/bsd/#freebsd>freebsd hugo 的 extended edition</a>，这在 github release 上是没有的。具体思路就是尝试 hugo 的 quick start 教程看看能不能正常运行，结果不能，主题报错，要求 extended edition。这也告诉我们，像 FreeBSD 这样本身更新很及时的，没有特殊需求，最好就用包管理安装软件。</li>
</ul>
</li>
</ul>
<h2 id=20230703>20230703<a hidden class=anchor aria-hidden=true href=#20230703>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://www.luyouqi.com/shezhi/12139.html>如何修改Mac电脑默认视频播放软件</a></p>
<ol>
<li>在Mac电脑中找出并选中要播放的视频</li>
<li>点击键盘按键command+I，打开文件简介</li>
<li>在文件简介窗口，找到打开方式一栏里单击下拉框，选择想要修改的程序</li>
<li>选择好后点选下面的“全部更改”在弹出的窗口中，点击“继续”即可完成。</li>
</ol>
</li>
<li>
<p>视频直播方案</p>
<ul>
<li><a href=https://www.cnblogs.com/haibindev/archive/2013/01/30/2880764.html>HTTP Live Streaming直播(iOS直播)技术分析与实现</a></li>
<li><a href=https://www.cnblogs.com/haibindev/archive/2011/12/29/2305712.html>C++实现RTMP协议发送H.264编码及AAC编码的音视频</a></li>
<li><a href=https://www.cnblogs.com/haibindev/p/8427503.html>MP4大文件虚拟HLS分片技术，避免点播服务器的文件碎片</a></li>
</ul>
</li>
<li>
<p><a href=https://stackoverflow.com/a/1676690>What&rsquo;s a quick way to comment/uncomment lines in Vim?</a></p>
<ol>
<li>First, go to the first line you want to comment, press <code>Ctrl``V</code>. This will put the editor in the <code>VISUAL BLOCK</code> mode.</li>
<li>Then using the arrow key and select until the last line</li>
<li>Now press <code>Shift``I</code>, which will put the editor in <code>INSERT</code> mode and then press <code>#</code>. This will add a hash to the first line.</li>
<li>Then press <code>Esc</code> (give it a second), and it will insert a <code>#</code> character on all other selected lines.</li>
</ol>
</li>
<li>
<p><a href=https://discourse.gohugo.io/t/cant-access-hugo-localhost/3838/8>Can’t access Hugo @ localhost</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>hugo server --theme<span style=color:#f92672>=</span>hugo_theme_robust --buildDrafts --bind <span style=color:#e6db74>&#34;0.0.0.0&#34;</span> --baseURL <span style=color:#e6db74>&#34;http://192.168.1.10:1313&#34;</span>
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230701>20230701<a hidden class=anchor aria-hidden=true href=#20230701>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://stackoverflow.com/a/26738019>A link to GitHub for downloading a file in the latest release</a>: <a href="https://docs.github.com/en/rest/releases/releases?apiVersion=2022-11-28#get-the-latest-release">Get the latest release</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -s https://api.github.com/repos/boxbilling/boxbilling/releases/latest | grep browser_download_url | cut -d <span style=color:#e6db74>&#39;&#34;&#39;</span> -f <span style=color:#ae81ff>4</span>
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/36518510>crontab @reboot does not execute bash script when server is rebooted</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>@reboot root:wheel sleep 60;/home/kurome/clash/clash.sh
@reboot root:wheel sleep 60;/home/kurome/bhyve/bhyve.sh
</code></pre></div></li>
<li>
<p><a href="https://bbs.archlinux.org/viewtopic.php?id=37888#17">How to disable &ldquo;screen blackening&rdquo;</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>  <span style=color:#75715e># !/bin/bash</span>

  <span style=color:#75715e># screenblank - Toggle screen blanking/powersaving on/off</span>

  XBLANKTEXT<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>xset -q | grep timeout | awk <span style=color:#e6db74>&#39;{printf $2}&#39;</span><span style=color:#66d9ef>)</span>
  DPMSTEST<span style=color:#f92672>=</span><span style=color:#66d9ef>$(</span>xset -q | grep <span style=color:#e6db74>&#34;  DPMS is Enabled&#34;</span><span style=color:#66d9ef>)</span>

  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[[</span> <span style=color:#e6db74>&#34;</span>$XBLANKTEXT<span style=color:#e6db74>&#34;</span> -gt <span style=color:#ae81ff>0</span> <span style=color:#f92672>]]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>[[</span> -n <span style=color:#e6db74>&#34;</span>$DPMSTEST<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]]</span>; <span style=color:#66d9ef>then</span>
    xset s off; xset -dpms
    echo <span style=color:#e6db74>&#34; Disabled screen blanking and powersaving&#34;</span>; 
  <span style=color:#66d9ef>else</span>
    xset s on; xset +dpms
    echo <span style=color:#e6db74>&#34; Enabled screen blanking and powersaving&#34;</span>
  <span style=color:#66d9ef>fi</span>
</code></pre></div><p>或者直接添加到 .xinitrc</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>xset -dpms
xset s off
</code></pre></div></li>
<li>
<p><a href=https://forums.FreeBSD.org/threads/using-define-in-xdefaults.25930/post-145211>Using &ldquo;#define&rdquo; in .Xdefaults?</a></p>
<ul>
<li>Try using xrdb(1) (it runs cpp(1)) in ~/.xinitrc, e.g. <code>xrdb -merge ~/.Xdefaults</code></li>
<li>And make sure macros are substituted, e.g. <code>xrdb -query | egrep '(fore|back)ground'</code></li>
</ul>
</li>
<li>
<p><a href=https://stackoverflow.com/a/35092005>How can I convert .svg files to a font?</a></p>
</li>
<li>
<p><a href=https://github.com/ohmyzsh/ohmyzsh/tree/master/plugins/tmux>ohmyzsh tmux plugin</a></p>
</li>
<li>
<p><a href=https://wiki.archlinux.org/title/Xinit#Autostart_X_at_login>Autostart X at login</a></p>
</li>
<li>
<p><a href="https://marketplace.visualstudio.com/items?itemName=telesoho.vscode-markdown-paste-image">VSCode Extension: Markdown Paste</a>: Command + Alt + V</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230630>20230630<a hidden class=anchor aria-hidden=true href=#20230630>#</a></h2>
<ul>
<li>任务
<ul>
<li>
<p><a href=https://www.jianshu.com/p/e4eacb7ff8e7>JavaScript 媒体查询</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>isDesktop</span>, <span style=color:#a6e22e>setIsDeskop</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#66d9ef>true</span>)

<span style=color:#a6e22e>useEffect</span>(() =&gt; {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>mql</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>matchMedia</span>(<span style=color:#e6db74>&#39;(max-width: 1024px)&#39;</span>)

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleMediaChange</span> <span style=color:#f92672>=</span> () =&gt; {
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>mql</span>.<span style=color:#a6e22e>matches</span>) {
      <span style=color:#75715e>// console.log(&#39;match&#39;)
</span><span style=color:#75715e></span>      <span style=color:#a6e22e>setIsDeskop</span>(<span style=color:#66d9ef>false</span>)
    } <span style=color:#66d9ef>else</span> {
      <span style=color:#75715e>// console.log(&#39;unmatch&#39;)
</span><span style=color:#75715e></span>      <span style=color:#a6e22e>setIsDeskop</span>(<span style=color:#66d9ef>true</span>)
    }
  }

  <span style=color:#a6e22e>handleMediaChange</span>() <span style=color:#75715e>// 首次查询
</span><span style=color:#75715e></span>
  <span style=color:#a6e22e>mql</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;change&#39;</span>, <span style=color:#a6e22e>handleMediaChange</span>)

  <span style=color:#66d9ef>return</span> () =&gt; {
    <span style=color:#a6e22e>mql</span>.<span style=color:#a6e22e>removeEventListener</span>(<span style=color:#e6db74>&#39;change&#39;</span>, <span style=color:#a6e22e>handleMediaChange</span>)
  }
}, [])
</code></pre></div></li>
<li>
<p><a href=https://blog.csdn.net/ws19900201/article/details/123905368>设置锚点居页面顶部距离</a>：页面滚动高度 = 元素到页面顶部高度 - 固定导航栏高度</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>toAnchor</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) =&gt; {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>el</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#a6e22e>id</span>)
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>el</span>) {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>react</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>getBoundingClientRect</span>()
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>win</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>el</span>.<span style=color:#a6e22e>ownerDocument</span>.<span style=color:#a6e22e>defaultView</span>
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>win</span>) {
      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>offset</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>react</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>win</span>.document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>scrollTop</span>
      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>headerEl</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#39;desktop-header&#39;</span>)
      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>headerEl</span>) {
        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;header height&#39;</span>, <span style=color:#a6e22e>headerEl</span>.<span style=color:#a6e22e>offsetHeight</span>)
        window.document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>scrollBehavior</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;smooth&#39;</span>
        window.document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>scrollTop</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>offset</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>headerEl</span>.<span style=color:#a6e22e>offsetHeight</span>
      }
    }
  }
}
</code></pre></div><ul>
<li>
<p>其他方法：<a href=https://blog.csdn.net/qq_31005257/article/details/105469113>锚点定位被顶部固定导航栏遮住的解决方案</a></p>
</li>
<li>
<p><a href=https://juejin.cn/post/7127145483495014413>JS中各种距离</a>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>scrollTop</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>documentElement</span>.<span style=color:#a6e22e>scrollTop</span> <span style=color:#f92672>||</span> window.<span style=color:#a6e22e>pageYOffset</span> <span style=color:#f92672>||</span> document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>scrollTop</span>
</code></pre></div></li>
<li>
<p><a href=https://www.cnblogs.com/caijinghong/p/15662513.html>详解a标签中href=&ldquo;javascript:&ldquo;的几种用法</a>：在a中调用js函数最适当的方法推荐使用</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;javascript:void(0);&#34;</span> <span style=color:#a6e22e>onclick</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;js_method()&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#960050;background-color:#1e0010>/a&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;javascript:;&#34;</span> <span style=color:#a6e22e>onclick</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;js_method()&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#960050;background-color:#1e0010>/a&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>a</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;#&#34;</span> <span style=color:#a6e22e>onclick</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;js_method();return false;&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#960050;background-color:#1e0010>/a&gt;</span>
</code></pre></div></li>
<li>
<p><a href=https://juejin.cn/post/6844903834406354957>jQuery源码解析之offset()</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>p</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;pTwo&#34;</span>);
  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>rect</span><span style=color:#f92672>=</span><span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>getBoundingClientRect</span>()
  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>win</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>p</span>.<span style=color:#a6e22e>ownerDocument</span>.<span style=color:#a6e22e>defaultView</span>;
  <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>offsetObj</span><span style=color:#f92672>=</span>{
    <span style=color:#a6e22e>top</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>rect</span>.<span style=color:#a6e22e>top</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>win</span>.<span style=color:#a6e22e>pageYOffset</span>,
    <span style=color:#a6e22e>left</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>rect</span>.<span style=color:#a6e22e>left</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>win</span>.<span style=color:#a6e22e>pageXOffset</span>
  }
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>offsetObj</span>,<span style=color:#e6db74>&#39;win18&#39;</span>)
</code></pre></div></li>
</ul>
</li>
<li>
<p>FFMPEG</p>
<ul>
<li><a href=https://stackoverflow.com/a/47512301>ffmpeg - Convert MP4 to WebM, poor results</a></li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>ffmpeg -i input.mp4 -c:v libvpx-vp9 -crf <span style=color:#ae81ff>30</span> -b:v <span style=color:#ae81ff>0</span> -b:a 128k -c:a libopus output.webm
</code></pre></div><ul>
<li>
<p><a href=https://trac.ffmpeg.org/wiki/Encode/AV1>AV1 Video Encoding Guide</a></p>
</li>
<li>
<p><a href=https://blog.foresta.me/posts/convert_mp4_to_hls_with_ffmpeg/>ffmpeg を使って mp4 を HLS に変換する</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>ffmpeg -i video.mp4 -c:v copy -c:a copy -f hls -hls_time <span style=color:#ae81ff>9</span> -hls_playlist_type vod -hls_segment_filename <span style=color:#e6db74>&#34;video%3d.ts&#34;</span> video.m3u8
ffplay ./video.m3u8
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://alienzhou.github.io/fe-performance-journey/5-subresources/video.html>视频优化</a></p>
<ul>
<li>合适的视频格式：WebM(VP9) 相较于 MPEG-4(x264) 来说会更小</li>
<li>视频压缩：<a href=https://handbrake.fr>HandBrake</a></li>
<li><a href=https://medium.com/@HoseungJang/video-streaming-with-node-js-9401213a04e7>Video Streaming with Node.js / HLS</a>
<ul>
<li>
<p><a href=https://github.com/video-dev/hls.js/#alternative-setup>HLS.js</a></p>
</li>
<li>
<p>example</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>useEffect</span>(() =&gt; {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>hlsVideoSrc</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;/videos/hls/chathomeai.m3u8&#39;</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>videoEl</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>videRef</span>.<span style=color:#a6e22e>current</span>
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>videoEl</span>) {
    <span style=color:#a6e22e>videoEl</span>.<span style=color:#a6e22e>muted</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>true</span>
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>videoEl</span>.<span style=color:#a6e22e>canPlayType</span>(<span style=color:#e6db74>&#39;application/vnd.apple.mpegurl&#39;</span>)) {
      <span style=color:#a6e22e>videoEl</span>.<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>hlsVideoSrc</span>
      <span style=color:#a6e22e>videoEl</span>.<span style=color:#a6e22e>onloadeddata</span> <span style=color:#f92672>=</span> () =&gt; {
        <span style=color:#a6e22e>videoEl</span>.<span style=color:#a6e22e>play</span>()
      }
    } <span style=color:#66d9ef>else</span> <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>Hls</span>.<span style=color:#a6e22e>isSupported</span>()) {
      <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>hls</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>Hls</span>()
      <span style=color:#a6e22e>hls</span>.<span style=color:#a6e22e>loadSource</span>(<span style=color:#a6e22e>hlsVideoSrc</span>)
      <span style=color:#a6e22e>hls</span>.<span style=color:#a6e22e>attachMedia</span>(<span style=color:#a6e22e>videoEl</span>)
      <span style=color:#a6e22e>hls</span>.<span style=color:#a6e22e>on</span>(<span style=color:#a6e22e>Hls</span>.<span style=color:#a6e22e>Events</span>.<span style=color:#a6e22e>MANIFEST_PARSED</span>, () =&gt; {
        <span style=color:#a6e22e>videoEl</span>.<span style=color:#a6e22e>play</span>()
      })
    } <span style=color:#66d9ef>else</span> {
      <span style=color:#a6e22e>setIsSupportHls</span>(<span style=color:#66d9ef>false</span>)
    }
  }
}, [])
</code></pre></div></li>
<li>
<p>报错 <code>SyntaxError: Unexpected keyword or identifier.</code>，则需要在 tsconfig.json、.eslintignore 和 .prettierignore 中将 HLS ts 文件忽略。</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230629>20230629<a hidden class=anchor aria-hidden=true href=#20230629>#</a></h2>
<ul>
<li>
<p>经验</p>
<ul>
<li>
<p><a href=https://stackoverflow.com/a/48480452>Curl to grab remote filename after following location</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># Specify --remote-header-name / -J</span>
curl -O -J -L $url
curl --remote-name --remote-header-name --location $url

<span style=color:#75715e># If you can use wget instead of curl:</span>
wget --content-disposition $url
</code></pre></div></li>
<li>
<p><a href="https://www.reddit.com/r/unix/comments/kl15ow/comment/gh65tpv/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button">解压 Arch 的 pkg.tar.zst</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>unzstd filename.pkg.tar.zst
tar -xvf filename.pkg.tar
</code></pre></div></li>
<li>
<p><a href=https://superuser.com/a/899688>How to untar an archive without the root folder, but keeping the full hierarchy inside it?</a>: Easy. Just use <code>tar --strip-components=1</code> on the archive.</p>
</li>
<li>
<p><a href="https://www.reddit.com/r/freebsd/comments/hzc5aj/comment/fzin88w/?utm_source=share&utm_medium=web3x&utm_name=web3xcss&utm_term=1&utm_content=share_button">FreeBSD Touchpad configuration</a>：参考 <a href=https://wiki.archlinux.org/title/Libinput>libinput</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ sysctl hw.psm.elantech_support<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>
$ sysctl kern.evdev.rcpt_mask<span style=color:#f92672>=</span><span style=color:#ae81ff>12</span>
$ cat /usr/local/etc/X11/xorg.conf.d/30-touchpad.conf
  Section <span style=color:#e6db74>&#34;InputClass&#34;</span>
    Identifier <span style=color:#e6db74>&#34;touchpad&#34;</span>
    MatchIsTouchpad <span style=color:#e6db74>&#34;true&#34;</span>
    MatchDriver <span style=color:#e6db74>&#34;libinput&#34;</span>
    Option <span style=color:#e6db74>&#34;AccelSpeed&#34;</span> <span style=color:#e6db74>&#34;0.1&#34;</span>
    Option <span style=color:#e6db74>&#34;ClickMethod&#34;</span> <span style=color:#e6db74>&#34;clickfinger&#34;</span> <span style=color:#75715e># 用点击的手指代替触摸板实际的按键</span>
    Option <span style=color:#e6db74>&#34;DisableWhileTyping&#34;</span> <span style=color:#e6db74>&#34;on&#34;</span>
    Option <span style=color:#e6db74>&#34;HorizontalScrolling&#34;</span> <span style=color:#e6db74>&#34;off&#34;</span>
    Option <span style=color:#e6db74>&#34;LeftHanded&#34;</span> <span style=color:#e6db74>&#34;off&#34;</span>
    Option <span style=color:#e6db74>&#34;NaturalScrolling&#34;</span> <span style=color:#e6db74>&#34;true&#34;</span>
    Option <span style=color:#e6db74>&#34;ScrollMethod&#34;</span> <span style=color:#e6db74>&#34;twofinger&#34;</span>
    Option <span style=color:#e6db74>&#34;Tapping&#34;</span> <span style=color:#e6db74>&#34;on&#34;</span> <span style=color:#75715e># tap-to-click</span>
    Option <span style=color:#e6db74>&#34;TappingButtonMap&#34;</span> <span style=color:#e6db74>&#34;lrm&#34;</span> <span style=color:#75715e># 1/2/3 指对应 left/right/middle 按键</span>
  EndSection
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://forums.FreeBSD.org/threads/bspwm-problem.54795/post-487934>bspwm 没有创建 desktop，不能切换 desktop</a>: bspwmrc 本质就是 shell 脚本，需要执行权限 <code>chmod +x bspwmrc</code></p>
</li>
</ul>
<h2 id=20230628>20230628<a hidden class=anchor aria-hidden=true href=#20230628>#</a></h2>
<ul>
<li>经验
<ul>
<li>next env
<ul>
<li>
<p><a href=https://nextjs.org/docs/pages/building-your-application/configuring/environment-variables>Environment Variables</a></p>
</li>
<li>
<p>next.config.js Options</p>
<ul>
<li><a href=https://nextjs.org/docs/app/api-reference/next-config-js/env>env</a></li>
<li><a href=https://nextjs.org/docs/app/api-reference/next-config-js/runtime-configuration>Runtime Config</a></li>
</ul>
</li>
<li>
<p><a href=https://www.iconfont.cn/>Iconfont</a>：图标库</p>
</li>
<li>
<p><a href=https://www.iconfinder.com>ICONFINDER</a>：图标库</p>
</li>
<li>
<p><a href=https://seeklogo.com>seeklogo</a>：图标库</p>
</li>
<li>
<p><a href=codes/react/ShareButtons.tsx>ShareButtons</a> 关于图标对齐</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// 如下两个不对齐，后面的比前面的矮一点，但是实际并没有 margin 或 padding 存在
</span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>button</span> 
  <span style=color:#a6e22e>aria</span><span style=color:#f92672>-</span><span style=color:#a6e22e>label</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>singleService</span>} 
  <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>singleService</span>} 
  <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cursor-pointer bg-yellow-500 text-white rounded-full mx-1&#39;</span>
<span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>copyUrl</span>} <span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>i</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;fas fa-link w-8&#39;</span> <span style=color:#f92672>/&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/button&gt;</span>

<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>button</span> 
  <span style=color:#a6e22e>aria</span><span style=color:#f92672>-</span><span style=color:#a6e22e>label</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>singleService</span>} 
  <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>singleService</span>} 
  <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;cursor-pointer bg-yellow-500 text-white rounded-full mx-1&#39;</span>
<span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> 
    <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>copyUrl</span>} 
    <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;w-8 h-8 flex justify-center items-center&#34;</span> <span style=color:#75715e>// 为了居中 icon 用 flex
</span><span style=color:#75715e></span>  <span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>LinkIcon</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span>{<span style=color:#ae81ff>24</span>} <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span>{<span style=color:#ae81ff>24</span>} <span style=color:#f92672>/&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/button&gt;</span>

<span style=color:#75715e>// 后面的用如下写法则对齐
</span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>button</span>
  <span style=color:#a6e22e>aria</span><span style=color:#f92672>-</span><span style=color:#a6e22e>label</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>singleService</span>}
  <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>singleService</span>}
  <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;cursor-pointer bg-yellow-500 text-white rounded-full mx-1&#34;</span>
<span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>copyUrl</span>}<span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>LinkIcon</span> <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span>{<span style=color:#ae81ff>32</span>} <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span>{<span style=color:#ae81ff>32</span>} <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;p-1&#34;</span> <span style=color:#f92672>/&gt;</span> <span style=color:#75715e>// 利用 padding 居中 icon
</span><span style=color:#75715e></span>  <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/button&gt;</span>
</code></pre></div></li>
<li>
<p>内容整体要水平居中，内容间要对齐：包一层</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;flex flex-col justify-start items-center&#34;</span>&gt;
  &lt;<span style=color:#f92672>div</span>&gt;
    &lt;<span style=color:#f92672>p</span>&gt;a very long sentence&lt;/<span style=color:#f92672>p</span>&gt;
    &lt;<span style=color:#f92672>p</span>&gt;a word&lt;/<span style=color:#f92672>p</span>&gt;
  &lt;/<span style=color:#f92672>div</span>&gt;
&lt;/<span style=color:#f92672>div</span>&gt;
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230627>20230627<a hidden class=anchor aria-hidden=true href=#20230627>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>iphone frame：iPhone 边框</p>
</li>
<li>
<p><a href=https://www.imooc.com/article/12794>关于css position定位 top百分比的问题</a>：css设置绝对定位后 top,bottom,设置百分比定位是按父元素的高度来计算的，同样left,right,设置百分比定位是按父元素的宽度度来计算的。</p>
</li>
<li>
<p><a href=http://new.xfengcloud.com/user/web.php>XFengCloud-小逢云</a>：免费一天试用，可以看有哪些用户使用，感觉靠谱，openvpn 方式免流了 90%，shadowsocket 方式免流了 30%，价格10元/月，还行。</p>
</li>
<li>
<p><a href=https://fanzhi.org/wiki/openvpn/>OpenVPN 简明手册</a></p>
<ul>
<li>
<p><a href=https://blog.chenxiaosheng.com/posts/2013-09-08/windows-openvpn-remember-password.html>Windows OpenVPN GUI记住用户名和密码</a>：在ovpn配置文件里增加 <code>auth-user-pass pass.txt</code>，之后在ovpn配置文件所在目录建立一个pass.txt的文件，第一行为用户名，第二行为密码即可。</p>
</li>
<li>
<p><a href=https://github.com/OpenVPN/openvpn-gui/issues/381#issuecomment-856059530>failed to negotiate cipher with server.</a>：很多时候，把第一个错误解决了，剩下的错误都会消失（即所有剩下的错误都是由于第一个错误的产生而存在的）</p>
<pre tabindex=0><code class=language-opvn data-lang=opvn>cipher none
# 在 data-ciphers 最后加上 cipher 指定的加密算法，即 none
data-ciphers AES-256-GCM:AES-128-GCM:CHACHA20-POLY1305:none
</code></pre></li>
</ul>
</li>
<li>
<p><a href=https://linuxconfig.org/how-to-use-curl-to-get-public-ip-address>How to use curl to get public IP address</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl ifconfig.me
curl icanhazip.com
curl ipecho.net/plain
curl ipinfo.io/ip
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230626>20230626<a hidden class=anchor aria-hidden=true href=#20230626>#</a></h2>
<ul>
<li>经验
<ul>
<li>CFW 开启 TUN 模式后，homebrew 报错 <a href=https://stackoverflow.com/a/51544596><code>LibreSSL SSL_connect: SSL_ERROR_SYSCALL in connection to github.com:443</code></a>。原因是有些地址解析到了 ipv6，但是 clash 设置中没有打开 ipv6，开启就好了。</li>
<li>CFW 开启 TUN 模式后，git clone 报错 <a href=https://github.com/vernesong/OpenClash/issues/1960#issuecomment-1019112885><code>kex_exchange_identification: Connection closed by remote host</code></a>。添加规则 <code>- DST-PORT,22,DIRECT</code>，或<a href=https://github.com/vernesong/OpenClash/issues/1960#issuecomment-1115732292>改成通过443端口</a></li>
</ul>
</li>
</ul>
<h2 id=20230625>20230625<a hidden class=anchor aria-hidden=true href=#20230625>#</a></h2>
<ul>
<li>经验
<ul>
<li>如果不想配置，<a href=https://github.com/agalwood/Motrix>Motrix</a> 是替代 aria2 的一个好选择</li>
<li><a href=https://www.ptt.cc/bbs/index.html>批踢踢實業坊</a>：一个台湾bbs</li>
</ul>
</li>
</ul>
<h2 id=20230621>20230621<a hidden class=anchor aria-hidden=true href=#20230621>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://stackoverflow.com/a/45078604>Paste a rectangular block in Visual Studio</a>: Click to the beginning of what you want to copy, press and hold Shift+Alt (Mac: Shift + Option) then click to the end of what you want to copy. Then release the keys and copy. When pasting, do the same for the column you want to insert.（快速翻译：首先选择并复制冒号后值为空的键放入Google进行翻译翻译，翻译后的文本做为值，之后利用块复制粘贴为值添加键，先放置值再放置键就可以保证同一个column实现块粘贴）</li>
<li><a href=https://stackoverflow.com/a/47024020>Visual studio code - how to copy search results?</a>
<ol>
<li>CTRL + F</li>
<li>Type your search string</li>
<li>CTRL + SHIFT + L to select all occurrences found (max. 999)</li>
<li>ESC (or close search dialog with top-right X)</li>
<li>CTRL + I to select whole lines</li>
<li>CTRL + C</li>
<li>Open new file</li>
<li>CTRL + V</li>
</ol>
</li>
<li><a href=https://www.cnblogs.com/BlackStorm/p/6359005.html>\u3000 是全角的空白符</a></li>
<li><a href=https://www.cnblogs.com/leftJS/p/11074694.html>JS给数字加千位分隔符</a>: <code>numObj.toLocaleString([locales [, options]])</code></li>
</ul>
</li>
</ul>
<h2 id=20230620>20230620<a hidden class=anchor aria-hidden=true href=#20230620>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://www.cnblogs.com/leftJS/p/11074694.html>JS给数字加千位分隔符</a></li>
</ul>
</li>
</ul>
<h2 id=20230619>20230619<a hidden class=anchor aria-hidden=true href=#20230619>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href="https://www.reddit.com/r/MacOS/comments/13q9spd/comment/jldt7z9/?utm_source=share&utm_medium=web2x&context=3">&ldquo;You must be an administrator to delete this job&rdquo;</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>cancel -a -x
</code></pre></div></li>
<li>
<p>整合 Google 登录：其他的 OAuth2 认证基本类似。具体流程是，访问 api/google controller 执行 google.strategy 进行 Google 登录；获取信息后 validate 成功后 redirect 到 api/google/redirect controller，首先先通过 upsert 将用户信息保存到数据库，然后根据信息生成 token 放入 cookie 中，最后 redirect web 页面，web 页面使用 axios request interceptor，读取 cookie 中的token。</p>
<ul>
<li>
<p><a href=https://dev.to/imichaelowolabi/how-to-implement-login-with-google-in-nest-js-2aoa>How to Implement Login with Google in Nest JS</a>：<code>done</code> callback should not be used in <code>validate</code> method, because it is invoked internally by nestjs/passport. It is better to just return user object from validate.</p>
</li>
<li>
<p><a href="https://developers.google.com/workspace/guides/create-credentials?hl=zh-cn#oauth-client-id">OAuth 客户端 ID 凭据</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/11485644>Error: redirect_uri_mismatch</a>: The redirect URI (where the response is returned to) has to be registered in the APIs console, and the error is indicating that you haven&rsquo;t done that, or haven&rsquo;t done it correctly.</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/72392743>Access to fetch at https://accounts.google.com/o/oauth2/v2/auth has been blocked by CORS</a>: The authentication flow must happen in a visible browsing context, not with a fetch request. In other words: You must navigate the current tab to (or open a new tab at) <a href=http://localhost:8000/api/mail/login>http://localhost:8000/api/mail/login</a>.</p>
</li>
<li>
<p><a href=https://github.com/jaredhanson/passport-google-oauth2/issues/64>InternalOAuthError: Failed to obtain access token 0</a>：原因是在 <code>google/redirect</code> controller 中执行没有正确返回，用的 <code>return { url: 'https://testweb.chathome.ai'}</code>，之后参考 <a href=https://stackoverflow.com/a/37760690>Send a set-cookie header to a redirect url in node.js</a>，就成功了</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>cookie</span>(<span style=color:#e6db74>&#39;access_token&#39;</span>, <span style=color:#a6e22e>token</span>, {
  <span style=color:#a6e22e>maxAge</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>24</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span>,
  <span style=color:#a6e22e>sameSite</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
  <span style=color:#a6e22e>secure</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
})
<span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>redirect</span>(<span style=color:#ae81ff>302</span>, <span style=color:#e6db74>&#39;https://testweb.chathome.ai&#39;</span>);
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/43052288>Attach Authorization header for all axios requests</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// Add a request interceptor
</span><span style=color:#75715e></span><span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>use</span>(<span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>config</span>) {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>token</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>store</span>.<span style=color:#a6e22e>getState</span>().<span style=color:#a6e22e>session</span>.<span style=color:#a6e22e>token</span>;
    <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>headers</span>.<span style=color:#a6e22e>Authorization</span> <span style=color:#f92672>=</span>  <span style=color:#a6e22e>token</span>;

    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>config</span>;
});
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230617>20230617<a hidden class=anchor aria-hidden=true href=#20230617>#</a></h2>
<ul>
<li>
<p>经验</p>
<ul>
<li>
<p>ssh connection speed</p>
<ul>
<li>
<p><a href=https://lateweb.info/how-to-check-the-speed-of-your-ssh-connection/>pv</a>: test transfer speed</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>yes | pv | ssh remote_host <span style=color:#e6db74>&#34;cat &gt;/dev/null&#34;</span>
</code></pre></div><ul>
<li><a href=https://linux.cn/article-6734-1.html>如何使用 pv 命令监控 linux 命令的执行进度</a>：数据量，花费的时间，传输速率，进度条，进度的百分比，以及剩余的时间。</li>
<li><a href=https://www.cnblogs.com/youxin/p/3582175.html>Linux命令之yes</a>：重复输出字符串</li>
</ul>
</li>
<li>
<p><a href=https://serverfault.com/a/865082><strong>sshping</strong></a>: <a href=https://github.com/spook/sshping/issues/23#issuecomment-948938674>MacOS - linking help with libssh?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff><span style=color:#a6e22e>+CFLAGS=-I /opt/homebrew/include -I ext -L /opt/homebrew/lib -lssh
</span><span style=color:#a6e22e></span>
<span style=color:#f92672>-bin/sshping: src/sshping.cxx /usr/include/libssh/libssh.h
</span><span style=color:#f92672>- g++ -Wall -I ext/ -o bin/sshping src/sshping.cxx -lssh
</span><span style=color:#f92672></span><span style=color:#a6e22e>+bin/sshping: src/sshping.cxx
</span><span style=color:#a6e22e>+ g++ -Wall -I ext/ -o bin/sshping $(CFLAGS) src/sshping.cxx -lssh
</span></code></pre></div></li>
<li>
<p><a href="https://www.alecjacobson.com/weblog/?p=635">Test ssh connection speed</a>: scp transfer speed</p>
</li>
</ul>
</li>
<li>
<p><a href=https://www.ruanyifeng.com/blog/2019/10/tmux.html>Tmux 使用教程</a></p>
<ul>
<li>
<p><a href=https://unix.stackexchange.com/a/113768>How can I set my default shell to start up tmux</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#66d9ef>if</span> command -v tmux &amp;&gt; /dev/null <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$PS1<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[[</span> ! <span style=color:#e6db74>&#34;</span>$TERM<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span>~ screen <span style=color:#f92672>]]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[[</span> ! <span style=color:#e6db74>&#34;</span>$TERM<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>=</span>~ tmux <span style=color:#f92672>]]</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span>$TMUX<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
  <span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$SSH_CLIENT<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$SSH_TTY<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
    exec tmux new-session -A -s <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>USER<span style=color:#e6db74>}</span><span style=color:#e6db74>0&#34;</span>
  <span style=color:#66d9ef>fi</span>
<span style=color:#66d9ef>fi</span>
</code></pre></div><ul>
<li>
<p><a href=https://www.linuxcool.com/command>command命令 – 调用并执行指定的命令</a>: -v 搜索命令信息但是不执行</p>
</li>
<li>
<p><a href=https://unix.stackexchange.com/a/176885>How to start tmux with attach if a session exists</a>: The -A flag makes new-session behave like attach-session if session-name already exists; in this case, -D behaves like -d to attach-session.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>tmux new-session -A -s main
</code></pre></div></li>
<li>
<p><a href=https://serverfault.com/a/506267>How to determine if I&rsquo;m logged in via SSH?</a></p>
<ul>
<li>If one of the variables <code>SSH_CLIENT</code> or <code>SSH_TTY</code> is defined, it&rsquo;s an ssh session.</li>
<li>The login shell&rsquo;s parent process can be checked with <code>ps -o comm= -p $PPID</code>. If it is <code>sshd</code>, it&rsquo;s an ssh session.</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#66d9ef>if</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$SSH_CLIENT<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span> <span style=color:#f92672>||</span> <span style=color:#f92672>[</span> -n <span style=color:#e6db74>&#34;</span>$SSH_TTY<span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>; <span style=color:#66d9ef>then</span>
  SESSION_TYPE<span style=color:#f92672>=</span>remote/ssh
<span style=color:#66d9ef>else</span>
  <span style=color:#66d9ef>case</span> <span style=color:#66d9ef>$(</span>ps -o comm<span style=color:#f92672>=</span> -p $PPID<span style=color:#66d9ef>)</span> in
    sshd|*/sshd<span style=color:#f92672>)</span> SESSION_TYPE<span style=color:#f92672>=</span>remote/ssh;;
  <span style=color:#66d9ef>esac</span>
<span style=color:#66d9ef>fi</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://unix.stackexchange.com/a/77278>How to append multiple lines to a file</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># possibility 2:</span>
echo <span style=color:#e6db74>&#34;line 1
</span><span style=color:#e6db74>line 2&#34;</span> &gt;&gt; greetings.txt

<span style=color:#75715e># possibility 3:</span>
cat <span style=color:#e6db74>&lt;&lt;EOT &gt;&gt; greetings.txt
</span><span style=color:#e6db74>line 1
</span><span style=color:#e6db74>line 2
</span><span style=color:#e6db74>EOT</span>
<span style=color:#e6db74>``</span>

</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://docs.github.com/zh/authentication/connecting-to-github-with-ssh/working-with-ssh-key-passphrases>使用 SSH 密钥密码</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>ssh-keygen -p -f ~/.ssh/id_rsa

echo <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>AddKeysToAgent yes
</span><span style=color:#e6db74>UseKeychain yes&#39;</span> &gt;&gt; ~/.ssh/config
</code></pre></div></li>
<li>
<p>重新生成公钥：<a href=https://serverfault.com/a/52287>Create a public SSH key from the private key?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>ssh-keygen -f ~/.ssh/id_rsa -y &gt; ~/.ssh/id_rsa.pub
</code></pre></div></li>
<li>
<p><a href=https://aws.amazon.com/cn/blogs/china/talking-about-network-optimization-from-the-flow-control-algorithm/>从流量控制算法谈网络优化 – 从 CUBIC 到 BBRv2 算法</a>：是拥塞控制算法。作用是决定发送方应该以多快的速度发送数据，并同时适应网络的变化。BBRv1 对带宽延迟积大、丢包率高的网络非常有效，能保持一个不错的吞吐量数字。</p>
<ul>
<li>
<p><a href=https://wiki.crowncloud.net/?How_to_enable_BBR_on_Ubuntu_20_04>How to enable BBR on Ubuntu 20.04</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>echo <span style=color:#e6db74>&#39;
</span><span style=color:#e6db74>net.core.default_qdisc=fq
</span><span style=color:#e6db74>net.ipv4.tcp_congestion_control=bbr&#39;</span> &gt;&gt; /etc/sysctl.conf
sysctl -p
sysctl net.ipv4.tcp_congestion_control
</code></pre></div></li>
<li>
<p><a href=https://b.awei.pub/2022/03/freebsd_bbr/>给VPS上的FreeBSD开启BBR</a>：要编译内核</p>
</li>
</ul>
</li>
<li>
<p><a href=https://cloud.tencent.com/developer/article/1964393>KCP协议：从TCP到UDP家族QUIC/KCP/ENET</a>：KCP是一个快速可靠协议，能以比 TCP浪费10%-20%的带宽的代价，换取平均延迟降低 30%-40%，且最大延迟降低三倍的传输效果。</p>
</li>
<li>
<p><a href=http://project.altservice.com/issues/838>Problem With Transmission Receive Buffer on FreeBSD</a></p>
<ul>
<li>
<p>临时</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sysctl kern.ipc.maxsockbuf<span style=color:#f92672>=</span><span style=color:#ae81ff>5242880</span>
sysctl net.inet.udp.recvspace<span style=color:#f92672>=</span><span style=color:#ae81ff>4194304</span>
</code></pre></div></li>
<li>
<p>永久：添加到 /etc/sysctl.conf</p>
</li>
</ul>
</li>
<li>
<p><a href=https://github.com/91yun/serverspeeder>serverspeeder/LotServer/锐速</a></p>
<ul>
<li>virt-what：检测VPS是Openvz还是KVM还是Xen，<code>apt install -y virt-what; virt-what</code></li>
</ul>
</li>
<li>
<p><a href=https://kiku.vip/2021/10/13/VPS%20%E5%9F%BA%E7%A1%80%E9%85%8D%E7%BD%AE/>VPS 初体验（一）基础配置</a></p>
<ul>
<li><a href=https://github.com/teddysun/across/blob/master/bench.sh>bench.sh</a>：测试传输速度 <code>wget -qO- bench.sh | bash</code></li>
</ul>
</li>
<li>
<p>教程：<a href=https://github.com/dz2904/Linux>记录 Linux 的点滴</a></p>
</li>
<li>
<p><a href=https://forums.freebsd.org/threads/bhyve-started-from-tmux.69472/>Bhyve started from tmux</a>：Start a virtual machine in background，在后台运行 bhyve 虚拟机，如下部分脚本只适用于 freebsd</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># start</span>
bhyveload -m 8G -S -d /vm/freebsd/freebsd1.img freebsd1
sleep <span style=color:#ae81ff>8</span>
/usr/local/bin/tmux new-session -d -s freebsd1 <span style=color:#e6db74>&#39;bhyve -S -m 8G -c 8 -AHP -s 0,hostbridge -s 1,lpc -s 2:0,ahci-hd,/vm/freebsd/freebsd1.img -s 5:0,passthru,132/0/0 -s30,xhci,tablet -l com1,stdio freebsd1&#39;</span>

<span style=color:#75715e># stop</span>
pkill bhyve
sleep <span style=color:#ae81ff>10</span>
bhyvectl --destroy --vm<span style=color:#f92672>=</span>freebsd1
tmux kill-server
</code></pre></div></li>
<li>
<p><a href=https://github.com/apachecn/apachecn-linux-zh>ApacheCN Linux 译文集</a></p>
</li>
<li>
<p><a href=https://www.cnblogs.com/tcicy/p/10193611.html>KVM总结-KVM性能优化之CPU优化</a>：绑定物理 CPU 到虚拟 CPU。</p>
<ul>
<li><a href=https://github.com/kdlucas/byte-unixbench>unixbench</a></li>
</ul>
</li>
</ul>
<h2 id=20230616>20230616<a hidden class=anchor aria-hidden=true href=#20230616>#</a></h2>
<ul>
<li>经验
<ul>
<li>ForbiddenException: Forbidden resource 产生的原因来自于 guard。</li>
<li><a href=https://kapeli.com/cheat_sheets/Oh-My-Zsh_Git.docset/Contents/Resources/Documents/index>Oh-My-Zsh Git</a>: Git Aliases</li>
<li><a href=https://arctype.com/blog/postgres-nestjs/>Build a real-time chat application with Nestjs and PostgreSQL</a></li>
</ul>
</li>
</ul>
<h2 id=20230615>20230615<a hidden class=anchor aria-hidden=true href=#20230615>#</a></h2>
<ul>
<li>经验
<ul>
<li>博客：<a href=https://pjchender.dev/>PJCHENder</a>：<a href=https://tw.alphacamp.co/blog/interview-with-pj-react>當前端工程師是想幫助更多人：PJ 陳柏融的技術寫作之路</a></li>
</ul>
</li>
</ul>
<h2 id=20230614>20230614<a hidden class=anchor aria-hidden=true href=#20230614>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://www.zhangxinxu.com/study/201306/pseudo-elements-to-style-type-number.html>伪元素改变number类型input框的默认样式实例页面</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>.<span style=color:#a6e22e>deal</span>::<span style=color:#a6e22e>-webkit-textfield-decoration-container</span> {
    <span style=color:#66d9ef>background-color</span>: <span style=color:#ae81ff>#f0f3f9</span>; 
}
.<span style=color:#a6e22e>deal</span>::<span style=color:#a6e22e>-webkit-inner-spin-button</span> {
    <span style=color:#66d9ef>-webkit-</span><span style=color:#66d9ef>appearance</span>: <span style=color:#66d9ef>none</span>;
}
.<span style=color:#a6e22e>deal</span>::<span style=color:#a6e22e>-webkit-outer-spin-button</span> {
    <span style=color:#66d9ef>-webkit-</span><span style=color:#66d9ef>appearance</span>: <span style=color:#66d9ef>none</span>; <span style=color:#75715e>/*有无看不出差别*/</span>
}
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/6182519>How can I do Base64 encoding in Node.js?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#34;Hello World&#34;</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;base64&#39;</span>) <span style=color:#75715e>// encode
</span><span style=color:#75715e></span><span style=color:#a6e22e>Buffer</span>.<span style=color:#a6e22e>from</span>(<span style=color:#e6db74>&#34;SGVsbG8gV29ybGQ=&#34;</span>, <span style=color:#e6db74>&#39;base64&#39;</span>).<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;ascii&#39;</span>) <span style=color:#75715e>// decode
</span></code></pre></div></li>
<li>
<p><a href=https://www.zhangxinxu.com/wordpress/2018/08/js-base64-atob-btoa-encode-decode/>原来浏览器原生支持JS Base64编码解码</a>：就是 window 的方法 atob 和 btoa</p>
</li>
<li>
<p><a href=https://zhuanlan.zhihu.com/p/599156184>踩坑日记：如何修复“System limit for number of file watchers reached”错误</a></p>
<ul>
<li>
<p>执行如下命令</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo sysctl fs.inotify.max_user_watches<span style=color:#f92672>=</span><span style=color:#ae81ff>524288</span>
echo fs.inotify.max_user_watches<span style=color:#f92672>=</span><span style=color:#ae81ff>524288</span> | sudo tee -a /etc/sysctl.conf
sudo sysctl -p
</code></pre></div></li>
<li>
<p><a href=https://github.com/coder/code-server/issues/628#issuecomment-519600926>Increase fs.inotify.max_user_watches in docker container</a>: Docker mounts /proc as read-only since many of its knobs are global. If you run that same command on the host, the container will transparently inherit the new setting.</p>
</li>
</ul>
</li>
<li>
<p><a href=https://stackoverflow.com/a/60700527>how to make non root user as sudo user in docker alpine image?</a></p>
<ul>
<li>
<p>command: <code>docker exec -it --user root mycontainer sh</code></p>
</li>
<li>
<p>dockerfile:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Dockerfile data-lang=Dockerfile><span style=color:#66d9ef>USER</span><span style=color:#e6db74> root</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Run root operation here</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#75715e># Change user back to cassandra</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>USER</span><span style=color:#e6db74> cassandra</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> whoami<span style=color:#960050;background-color:#1e0010>
</span></code></pre></div></li>
</ul>
</li>
<li>
<p>node中__dirname、__filename、process.cwd()、process.chdir()表示的路径</p>
<ul>
<li>__dirname 表示__dirname所在文件所在的目录的绝对路径</li>
<li>__filename 表示__filename所在文件的绝对路径</li>
<li>module.filename ==== __filename 等价</li>
<li>process.cwd() 返回Node.js 进程执行时的工作目录的路径</li>
<li>process.chdir() 改变工作目录。</li>
</ul>
</li>
<li>
<p><a href=https://gofrp.org/docs/features/common/monitor/>frp</a> 将内网服务穿透到公网，可以在公网访问内网服务；<a href=https://tailscale.com>tailscale</a> 是 VPN，组件虚拟局域网，局域网内的设备可以相互访问。两者都通过公网路线访问，区别在于 frp 是暴露在公网，任何人都可以访问服务，tailscale是成员可以访问服务。就个人需求来说，当然是两者都用，一些服务能暴露到公网，一些服务只能成员访问。</p>
<ul>
<li><a href=https://docs.freebsd.org/en/books/handbook/advanced-networking/#_configuring_ipv6>Configuring IPv6</a>：FreeBSD 自己添加的 wlan0 并没有自动启用 ipv6</li>
<li><a href=https://hax.co.id/ipv6-to-ipv4/>Pv4 Gateway to access IPv6</a>：有的路由器并没有支持或开启 ipv6，frp 报错 no route to host，可以利用 hax 的 share ipv4 端口来连接 frps 服务</li>
<li>woiden.id 变为 non-renewable 的了，总比永远抢不到服务的好，现在至少能用3天，用来测试也够了。</li>
<li><a href=https://gofrp.org/docs/features/common/network/network/#%E6%94%AF%E6%8C%81-kcp-%E5%8D%8F%E8%AE%AE>支持 KCP 协议</a>：降低延迟。报错 i/o deadline reached，用不了啊，quic 也一样。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230613>20230613<a hidden class=anchor aria-hidden=true href=#20230613>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://juejin.cn/post/7053990336820936712>Node+Puppeteer生成海报</a>：其实就是利用 chrome 的 Capture node screenshot 将 node 节点内容转为图片</li>
<li>自定义二维码：了解<a href=https://zuthub.com/archives/qrcode-de-jie-gou-yuan-li-yu-shi-zhan>QrCode的结构原理与实战</a>
<ul>
<li>添加 Logo
<ul>
<li>二维码挡住哪些部分，不会影响扫描识别？：只要四角的定位符（就是那个方形的黑色粗线框）没有被挡住就行，剩下的其他地方与纠错级别相关，纠错级别越高，可被覆盖的地方越多。</li>
<li><a href=https://juejin.cn/post/6844903640272994312>前端如何优雅的制作带LOGO的二维码</a>：用 canvas 将 logo 绘制到二维码上。</li>
</ul>
</li>
<li>添加背景图：<a href=https://juejin.cn/post/6971701254271533092>纯前端实现自定义二维码背景图</a>，方法是把二维码黑色的部分数据拿到，然后将黑色的部分按照对应的背景图的颜色进行填充。</li>
<li><a href=https://github.com/zpao/qrcode.react>qrcode.react</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230612>20230612<a hidden class=anchor aria-hidden=true href=#20230612>#</a></h2>
<ul>
<li>经验
<ul>
<li>Prisma 给数据库填充初始数据: <a href=https://www.prisma.io/docs/guides/migrate/seed-database>Seeding your database</a>
<ul>
<li>upsert是一种数据库操作，如果表中已存在指定值，则更新现有行，如果指定值不存在，则插入新行。</li>
</ul>
</li>
<li><a href=https://github.com/prisma/prisma/discussions/18246#discussioncomment-5248794>Prisma Models: autoincrement() optionnally starting at 0 ?</a>: It&rsquo;s not possible from the schema directly but you can modify the migration file to achieve this.</li>
<li><a href=https://einverne.github.io/post/2020/02/self-hosted-services-collection.html>我有一台服务器能做什么：自架的服务整理</a> / <a href=https://github.com/awesome-selfhosted/awesome-selfhosted>Awesome-Selfhosted</a>：免费或便宜的小鸡做打洞，实际服务在家里电脑中。</li>
</ul>
</li>
</ul>
<h2 id=20230610>20230610<a hidden class=anchor aria-hidden=true href=#20230610>#</a></h2>
<ul>
<li>
<p>FreeBSD 最重要的信息还是安装软件后的 pkg message，这个是最适用的：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>pkg info -D pkgname
</code></pre></div></li>
<li>
<p>wpa_supplicant/wpa_cli</p>
<ul>
<li>
<p><a href=https://man.freebsd.org/cgi/man.cgi?wpa_supplicant.conf(5)>wpa_supplicant.conf</a></p>
</li>
<li>
<p><a href=https://man.freebsd.org/cgi/man.cgi?wpa_cli>wpa_cli</a></p>
</li>
<li>
<p><a href=https://raspberrypi.stackexchange.com/a/63402>wpa_cli error &ldquo;Could not connect to wpa_supplicant: wlan0 - re-trying&rdquo;?</a></p>
</li>
<li>
<p><a href=https://developer.apple.com/forums/thread/695059>在 MacOS 上查看 BSSID</a>：如果多个 Wi-Fi 具有相同的 SSID，或者连接隐藏 SSID 的 Wi-Fi，则 FreeBSD 需要指定具体的 BSSID，在 FreeBSD 上可直接通过 <code>ifconfig wlan0 scan</code> 查看，在 Mac 上通过如下命令查看</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo /System/Library/PrivateFrameworks/Apple80211.framework/Versions/Current/Resources/airport -I | grep BSSID
</code></pre></div></li>
<li>
<p>注意：用 wpa_passphrase 生成的 psk 可能导致 FreeBSD 无法连接 wifi，可尝试使用原本的 psk</p>
</li>
</ul>
</li>
<li>
<p><a href=https://www.micski.dk/2021/04/10/how-to-mount-exfat-formatted-sd-memory-card-on-freebsd/>How to mount exFAT formatted SD memory card on FreeBSD.</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>pkg install fusefs-exfat
sysrc kld_list<span style=color:#f92672>+=</span>fusefs
reboot
mount.exfat /dev/da0s1 /mnt
umount /mnt
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/questions/229551/how-to-check-if-a-string-contains-a-substring-in-bash>How to check if a string contains a substring in Bash</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 1</span>
<span style=color:#f92672>[[</span> $string <span style=color:#f92672>==</span> *<span style=color:#e6db74>&#34;My long&#34;</span>* <span style=color:#f92672>]]</span>

<span style=color:#75715e># 2</span>
<span style=color:#f92672>[</span> -z <span style=color:#e6db74>&#34;</span><span style=color:#e6db74>${</span>string##*$reqsubstr*<span style=color:#e6db74>}</span><span style=color:#e6db74>&#34;</span> <span style=color:#f92672>]</span>
</code></pre></div></li>
<li>
<p><a href=https://docs.freebsd.org/en/books/handbook/virtualization/#virtualization-host-bhyve>BHyVe</a></p>
<ul>
<li>
<p><a href=https://www.cyberciti.biz/faq/how-to-install-linux-vm-on-freebsd-using-bhyve-and-zfs/>How to install Linux VM on FreeBSD using bhyve and ZFS</a>：wlan0 与 tap0 组成 bridge0 后，vm 无法访问网络，因为只能用 wlan0，因此考虑 nat 模式；一般认同使用 zfs 比 truncate 可以获取更高的磁盘性能。另一篇文章<a href=https://www.daemon-security.com/blog/bhyve-centos-0110/>RUNNING CENTOS WITH BHYVE</a></p>
</li>
<li>
<p><a href=https://blog.kykvit.com/article/virtualization/freeBSD_bhyve_wireless_NAT>bhyve wireless NAT vm setup</a>：nat 依托于防火墙，即 PF</p>
<ul>
<li><a href=https://docs.freebsd.org/en/books/handbook/firewalls/#firewalls-pf>PF</a>：
<ul>
<li><a href=https://www.twbsd.org/cht/book/new/ch12.htm>以 PF 架設 NAT 路由器及防火牆</a>
<ul>
<li>em1:network 相当于 em1 的局域网，但是不支持变量</li>
</ul>
</li>
</ul>
</li>
<li>需要为 VM 设置 static ip 和 gateway
<ul>
<li>
<p><a href=https://www.freecodecamp.org/news/setting-a-static-ip-in-ubuntu-linux-ip-address-tutorial/>Setting a Static IP in Ubuntu – Linux IP Address Tutorial</a></p>
</li>
<li>
<p><a href=https://linuxhint.com/set-default-gateway-ubuntu/>How to Set the Default Gateway on Ubuntu</a></p>
</li>
<li>
<p>编辑 <code>/etc/netplan/00-installer-config.yaml</code>，然后运行 <code>netplan try</code> 以应用配置</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># </span>
<span style=color:#75715e># This is the network config written by &#39;subiquity&#39;</span>
network:
  ethernets:
    enp0s2:
      dhcp4: no
      addresses: <span style=color:#f92672>[</span>10.0.0.2/24<span style=color:#f92672>]</span>
      nameservers:
        addresses: <span style=color:#f92672>[</span>114.114.114.114<span style=color:#f92672>]</span>
      routes:
      - to: default
        via: 10.0.0.1
  version: <span style=color:#ae81ff>2</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://forums.freebsd.org/threads/resize-truncated-bhyve-img-file.73925/>resize truncated bhyve .img file</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo pkg install e2fsprogs

truncate -s&lt;newsize&gt; ubuntu.img
mdconfig ubuntu.img
gpart show md0
gpart recover md0 <span style=color:#75715e># in case of GPT you should run this before resizing</span>
gpart resize -iN md0   <span style=color:#75715e># N - the partition index</span>
resize2fs /dev/md0sN   <span style=color:#75715e># could be md0pN in case of GPT scheme</span>
mdconfig -d -u0
</code></pre></div></li>
<li>
<p><a href=https://linux.die.net/man/5/sudoers>sudo</a>: &lsquo;&lsquo;who where = (as_whom) what&rsquo;&rsquo;</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230609>20230609<a hidden class=anchor aria-hidden=true href=#20230609>#</a></h2>
<ul>
<li>经验
<ul>
<li>在部署的时候，GRPC 服务的 GRPC_CHATBOT=host:port 不能写在 .env 之中，否则报错 No connection established，写在 docker-compose.yaml 的 environment 中则可以正常连接。查看 Dockerfile 得知，<code>COPY .env ./</code> 在 <code>RUN yarn build</code> 之后，这是报错原因。</li>
<li><a href=https://redis.io/resources/tools/>Tools for managing and deploying Redis</a>：<a href=https://github.com/qishibo/AnotherRedisDesktopManager>AnotherRedisDesktopManager</a> 替代收费的 RedisDesktopManager</li>
<li><a href=https://www.cnblogs.com/xishuai/p/rabbitmq-cli-rabbitmqadmin.html>RabbitMQ CLI 管理工具 rabbitmqadmin（管理和监控）</a></li>
</ul>
</li>
</ul>
<h2 id=20230608>20230608<a hidden class=anchor aria-hidden=true href=#20230608>#</a></h2>
<ul>
<li>
<p>IPFS</p>
<ul>
<li><a href=https://learnblockchain.cn/2018/12/12/what-is-ipfs>站在Web3.0 理解IPFS是什么</a></li>
<li><a href=https://learnblockchain.cn/2018/12/25/use-ipfs>IPFS 使用入门</a></li>
<li><a href=https://zu1k.com/posts/tutorials/p2p/ipfs/>IPFS 新手指北</a></li>
<li><a href=https://zu1k.com/posts/tutorials/p2p/ipfs-easy-use/>IPFS 日用优化指南</a>：在发布内容后，马上通过公开的 IPFS 网关访问，通常会很慢很慢，甚至到超时都无法访问，这是由 IPFS 的寻址过程导致的。随着访问内容的用户越来越多，他们的 IPFS 节点上会缓存你内容的数据，这个时候新节点再访问同一份内容，通常就会很快。这就是 IPFS 的特性，就跟 BT 下载的原理类似，数据在网络中存在的副本越多，就越能利用 P2P 网络的性能。</li>
</ul>
</li>
<li>
<p><a href=https://zealdocs.org/>Zeal</a>/Dash: offline documentation browser for software developers.</p>
</li>
<li>
<p>博客：<a href=https://aandds.com/>https://aandds.com/</a></p>
</li>
</ul>
<h2 id=20230607>20230607<a hidden class=anchor aria-hidden=true href=#20230607>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://www.ruanyifeng.com/blog/2014/05/restful_api.html>RESTful API 设计指南</a></li>
<li><a href=https://yeasy.gitbook.io/docker_practice/image/dockerfile/entrypoint>Docker ENTRYPOINT 入口点</a>：实际执行时，将变为 <code>&lt;ENTRYPOINT> "&lt;CMD>"</code>。</li>
<li><a href=http://kaito-kidd.com/2021/10/15/what-is-the-multi-site-high-availability-design/>搞懂异地多活，看这篇就够了</a></li>
</ul>
</li>
</ul>
<h2 id=20230606>20230606<a hidden class=anchor aria-hidden=true href=#20230606>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>MailGun 同一个账号的 APIKEY 是一样的，但是 DOMAIN（ses.chatfo.ai） 可以不一样。</p>
</li>
<li>
<p><a href=https://www.51cto.com/article/672563.html>MySQLDump的备份小技巧</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/12243188>Easiest way to copy a table from one database to another?</a>：跨 mysql server 复制数据表</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>mysqldump --user<span style=color:#f92672>=</span>user1 --password<span style=color:#f92672>=</span>password1 database1 table1 <span style=color:#ae81ff>\
</span><span style=color:#ae81ff></span>| mysql --user<span style=color:#f92672>=</span>user2 --password<span style=color:#f92672>=</span>password2 database2
</code></pre></div></li>
<li>
<p><a href=https://zhuanlan.zhihu.com/p/33504555>腾讯工程师带你深入解析 MySQL binlog</a>：二进制日志，主要用来达到 master-slave 数据一致的目的。</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230605>20230605<a hidden class=anchor aria-hidden=true href=#20230605>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://tobebetterjavaer.com/gongju/DBeaver.html>DBeaver：干掉付费的 Navicat，操作所有数据库就靠它了！</a>：DBeaver 好用！可以格式化查看数据内容。</p>
</li>
<li>
<p><a href=https://docs.konghq.com/gateway/latest/admin-api/>Kong Admin API</a>: <a href=https://docs.konghq.com/gateway/latest/admin-api/#supported-content-types>Supported Content Types</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/905161>sed changing all occurrences in a folder</a>/<a href=https://tecadmin.net/how-to-limit-directory-depth-with-find-command/>How to limit directory depth with find command</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>find . -maxdepth <span style=color:#ae81ff>2</span> -type f -exec sed -i.bak <span style=color:#e6db74>&#34;s/foo/bar/g&#34;</span> <span style=color:#f92672>{}</span> <span style=color:#ae81ff>\;</span>
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/9366940>sed fails with &ldquo;unknown option to `s'&rdquo; error</a>: The problem is with slashes: your variable contains them and the final command will be something like sed &ldquo;s/string/path/to/something/g&rdquo;, containing way too many slashes.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>replacement<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;/my/path&#34;</span>
sed --expression <span style=color:#e6db74>&#34;s@pattern@</span>$replacement<span style=color:#e6db74>@&#34;</span>
</code></pre></div></li>
<li>
<p><a href=https://wangchujiang.com/reference/index.html>Quick Reference</a>: 英文版 <a href=https://github.com/Fechin/reference>Reference</a> 的中文版本</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230602>20230602<a hidden class=anchor aria-hidden=true href=#20230602>#</a></h2>
<ul>
<li>经验
<ul>
<li>Jenkins 有个 View，用于对 Jobs 分组。</li>
<li><a href=https://gamedebug.github.io/5-ways-to-generate-a-random-strong-password-in-linux-terminal/>Linux终端下生成随机复杂密码的五种姿势</a>：最通用的，能在 ubuntu & macOS 都可使用的，且不需要安装软件的是 <code>openssl rand -base64 14</code></li>
<li>Safari 阅读模式可以替代 Chrome 的 Reader View：Command + Shift + R</li>
<li>ChatGPT: <a href=https://aimappro.com/index.html>AiMapPro.com - 轻松探索 AI 世界</a></li>
<li><a href=https://ued.party/>我的职业是前端工程师</a></li>
<li><a href=http://c.biancheng.net/view/2625.html>MySQL Workbench使用教程</a>：MacOS Monterney M1 上使用 Select Rows–Limit 1000 来编辑表中的数据就会闪退。</li>
</ul>
</li>
</ul>
<h2 id=20230601>20230601<a hidden class=anchor aria-hidden=true href=#20230601>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://stackoverflow.com/a/6507078>Replace all whitespace characters</a>: You want <a href=https://developer.mozilla.org/en-US/docs/Web/JavaScript/Guide/Regular_expressions/Character_classes>\s</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/1144788>How do I replace all occurrences of a string in JavaScript?</a>: <code>str.replace(/abc/g, '')</code> or <code>str.replaceAll('abc', '')</code></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/29964395>how do I check whether its a jpg/png/gif?</a>: There is a comprehensive table of magic numbers <a href=https://en.wikipedia.org/wiki/List_of_file_signatures>here</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>var</span> <span style=color:#a6e22e>magic</span> <span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>jpg</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ffd8ffe0&#39;</span>,
    <span style=color:#a6e22e>png</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;89504e47&#39;</span>,
    <span style=color:#a6e22e>gif</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;47494638&#39;</span>
};

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>buffer</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>Buffer</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>file</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>Express</span>.<span style=color:#a6e22e>Multer</span>.<span style=color:#a6e22e>File</span>).<span style=color:#a6e22e>buffer</span>
<span style=color:#a6e22e>buffer</span>.<span style=color:#a6e22e>toString</span>(<span style=color:#e6db74>&#39;hex&#39;</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>4</span>) <span style=color:#f92672>===</span> <span style=color:#a6e22e>magic</span>.<span style=color:#a6e22e>jpg</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>doSomeThing</span>()
</code></pre></div></li>
<li>
<p><a href=https://masteringjs.io/tutorials/node/buffer-to-string>Using the Buffer <code>toString()</code> Function in Node.js</a>: <code>buf.toString([encoding[, start[, end]]])</code> 是 node 的 api，非 js 原生的 toString(radix)</p>
</li>
<li>
<p><a href=https://www.nodejs.red/#/nodejs/modules/fs-file-exists-check>如何在 Node.js 中判断一个文件/文件夹是否存在？</a>：不用fs.exists，因为不是错误优先的回调函数，以及会产生竞态条件</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>private</span> <span style=color:#66d9ef>async</span> <span style=color:#a6e22e>makeDirExist</span>(<span style=color:#a6e22e>dir</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>accessAsync</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>promisify</span>(<span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>access</span>)
  <span style=color:#66d9ef>try</span> {
    <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>accessAsync</span>(<span style=color:#a6e22e>dir</span>, <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>constants</span>.<span style=color:#a6e22e>W_OK</span>)
  } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>e</span>) {
    <span style=color:#a6e22e>fs</span>.<span style=color:#a6e22e>mkdirSync</span>(<span style=color:#a6e22e>dir</span>, { <span style=color:#a6e22e>recursive</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span> })
  }
}
</code></pre></div></li>
<li>
<p><a href=https://segmentfault.com/a/1190000016720505>util.promisify 的那些事儿</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230531>20230531<a hidden class=anchor aria-hidden=true href=#20230531>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>问题：正式版，PDF Steam web 端无法显示。原因：通过 devtool 查看，发现数据正确返回了，对比 <code>www.chathome.jp</code> 与 <code>chathome.jp</code>，发现 <code>www.chathome.jp</code> api 调用都多了一个 preflight请求。解决：在部署环境中注释掉 env 中的 <code>NEXT_PUBLIC_WEB_API_DOMAIN=https://chathome.jp</code> 环境变量，让 api 调用自动使用相应的域名，从而不产生 preflight请求。经过排查，发现是 <code>response.headers['content-disposition'].split['='](1)</code> 报错 <code>error TypeError: Cannot read properties of undefined (reading 'split')</code>，因为 <code>www.chathome.jp</code> 的 response header 只有 <code>content-type: "application/force-download"</code>，这里可以将 split 放在 try&mldr;catch 块中。为什么只返回改 header 字段呢？因为后台在跨域下只允许了特定的 header 可以被访问：<code>allowedHeaders: [...allowedHeaders, 'content-type', 'Authorization'],</code>。</p>
</li>
<li>
<p><a href=https://www.zhihu.com/question/454558712>为啥JavaScript里，数组正常的索引不能用负数呢？</a>：因为JS的Array实际是个Object，并不是真的array，<code>arr[-1] = 'a'</code>，但可以反向索引 <code>arr.reverse()[1]</code> 或 使用 <code>arr.at(-1)</code></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230530>20230530<a hidden class=anchor aria-hidden=true href=#20230530>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://www.cnblogs.com/penghuwan/p/12053775.html>聊聊JS的二进制家族：Blob、ArrayBuffer和Buffer</a></p>
</li>
<li>
<p><a href=https://github.com/Tencent/vConsole/blob/dev/README_CN.md>vConsole</a>：针对手机网页的前端开发者调试面板。</p>
</li>
<li>
<p><a href=https://github.com/mozilla/pdf.js>PDF.js</a></p>
<ul>
<li><a href=https://www.mulianju.com/pdf-to-image/>如何用js实现pdf文件转图片</a></li>
<li><a href=https://github.com/mozilla/pdf.js/issues/12066#issuecomment-1432808593>Setting up fake worker failed</a></li>
</ul>
</li>
<li>
<p>User-Agent</p>
<ul>
<li><a href=https://www.jianshu.com/p/c5cf6a1967d1>HTTP请求头之User-Agent</a></li>
<li><a href=https://www.npmjs.com/package/ua-parser-js>UAParser.js</a></li>
<li><a href=https://juejin.cn/s/app%E5%86%85%E7%BD%AE%E6%B5%8F%E8%A7%88%E5%99%A8%E6%98%AF%E4%BB%80%E4%B9%88>app内置浏览器是什么</a>：App内置浏览器指的是一个手机应用程序内部包含的浏览器功能，可以让用户在应用程序内部直接浏览网页，而不需要跳转到手机自带的浏览器应用程序中。在技术上，应用程序内置浏览器通常是基于WebView技术实现的。</li>
<li><a href=https://cloud.tencent.com/developer/article/1654149>解决微信内置浏览器不能下载文件</a>：判断用户的浏览器是否为微信内置浏览器，如果是弹出一个图层，提示用户点击在默认浏览器中打开。<a href=https://juejin.cn/post/7122744808023687182>判断主流内嵌浏览器userAgent</a>：</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>webView</span> <span style=color:#f92672>=</span> () =&gt; {
  <span style=color:#66d9ef>return</span> <span style=color:#e6db74>/Feishu|DingTalk|MicroMessenger|Bytedance|NewsArticle|Zhihu|Weibo|AlipayClient|MQQBrowser/gi</span>.<span style=color:#a6e22e>test</span>(window.<span style=color:#a6e22e>navigator</span>.<span style=color:#a6e22e>userAgent</span>);
};
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230529>20230529<a hidden class=anchor aria-hidden=true href=#20230529>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>生产环境的配置里面都不要用 10 开头的 ip 地址，10 开头的是虚拟lan 地址，依赖于 tailscale 服务器，万一这个服务器出问题了，会有影响；但是在本地运行 api 项目的时候，需要使用 10 开头的 ip 地址，例如 <code>ClusterAllFailedError: Failed to refresh slots cache.</code> 问题就是用 192 开头 ip 没有连接上 redis。</p>
</li>
<li>
<p>PDF stream：</p>
<ul>
<li>后台：<a href=https://docs.nestjs.com/techniques/streaming-files>Streaming files</a>：用 file stream 替代之前的 pdf url，解决安全隐患，防盗链，防爬虫遍历 static pdf 文件。</li>
<li>前台：
<ul>
<li><a href=https://juejin.cn/post/7023005155595386910>前端如何下载文件流</a>：注意 a 标签的 <code>download="filename.pdf"</code>，Safari 没这个下载为 Unknow.pdf。结果是 IOS QQ浏览器无法显示无法下载；IOS Chrome 可以显示，可以下载到本地 Chrome 目录；Safari 可以显示，点击下载后打开新页面，新页面可以选择 save to files ；IOS Firefox 可以显示，点击下载后打开新页面，无法下载；IOS Lark 打开的内嵌网页可以显示，点击下载无反应。</li>
<li><a href=https://juejin.cn/post/7117521871221817375>这将是你看到过最全的pdf预览解决方案</a>：使用的是 iframe 来预览，在 chrome 浏览器开发者工具中选择手机端 device 后无法预览 pdf，但在 IOS 的 Safari 可以直接预览。</li>
<li><a href=https://www.npmjs.com/package/file-saver>file-saver</a>: Due to restrictions in iOS saveAs opens in a new window instead of downloading。IOS 下无法实现点击直接下载文件，除了 Safari 开发者没有解决办法。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230526>20230526<a hidden class=anchor aria-hidden=true href=#20230526>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://www.geekpark.net/news/219044>5 款 iOS Safari 广告拦截插件横评——看完你就知道用哪个了</a>： Adblock 最有用，但还需要设定语言，才会下载对应语言的规则。</li>
</ul>
</li>
</ul>
<h2 id=20230525>20230525<a hidden class=anchor aria-hidden=true href=#20230525>#</a></h2>
<ul>
<li>经验
<ul>
<li>useSWR 如果验证没变，那么返回的应该是 304（作用于 GET，用的 etag 字段），如果是重新请求成功，POST 是 201，GET 是 200.</li>
<li><a href="https://twitter.com/jacksonwuuu/status/1661069115749191680?s=20">Jackson Wu</a>：研究某个复杂软件的源代码是一件很难的事情，推荐的做法是看它最早期版本，比如说 Linux Kernel，别看它现在有千万行代码，但其实它的核心设计在它只有几万行的时候就确定了。另一个推荐的做法是卡马克说的，自己尝试着去克隆某个项目，做一个玩具版的 xx，这样就能深刻理解它的运行原理。(<a href=https://github.com/aosabook/500lines>500 Lines or Less</a>)</li>
</ul>
</li>
</ul>
<h2 id=20230524>20230524<a hidden class=anchor aria-hidden=true href=#20230524>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://juejin.cn/post/7230348908382601275>1-1评审了20份前端简历，其实每个人都有亮点</a>：简历美化</li>
<li><a href="https://mashelluo.com/?p=1889">伟大的公司需要多少人</a>：不融资，不追求团队规模，更关注公司盈利能力</li>
<li><a href=https://blog.csdn.net/weixin_56775476/article/details/118492498>ip 地址怎么到 kong 服务？</a>：在域名解析只能解析到服务器的ip地址，不能具体指定到某一个端口，只有域名默认解析到 80 端口。要使用 kong 网关，需要将 80 端口转发到 kong 服务的 8000 端口，如果 kong 是通过 docker 运行，则有端口映射 <code>0.0.0.0:80->8000/tcp, :::80->8000/tcp, 0.0.0.0:443->8443/tcp, :::443->8443/tcp</code>。</li>
<li>Next Image 以 width 为主，height 是等比例缩放的，高度值其实可以是任意值的，完全不会影响 width。</li>
</ul>
</li>
</ul>
<h2 id=20230523>20230523<a hidden class=anchor aria-hidden=true href=#20230523>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>扇形进度条：<a href=https://stackoverflow.com/a/35655355>Filling circle sector in CSS</a></p>
<ul>
<li>
<p>原理是，渐变函数相当于画一个圆，这个圆一半为红色，一半为透明色；两个渐变函数就是画两个这样的圆叠起来，透明重叠的部分即为小扇形，红色重叠部分即为大扇形。面积大的扇形用渐变函数涂，面积小的扇形用背景色。</p>
</li>
<li>
<p>代码如下</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>radius</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>180</span>) {
    <span style=color:#66d9ef>return</span> (
      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span>
        <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;h-5 w-5 rounded-full border-2 border-solid border-[#6fba2c] bg-[#6fba2c]&#34;</span>
        <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span>{{
          <span style=color:#a6e22e>backgroundImage</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`linear-gradient(</span><span style=color:#e6db74>${</span><span style=color:#ae81ff>90</span><span style=color:#e6db74>}</span><span style=color:#e6db74>deg, #fff 50%, transparent 50%), linear-gradient(</span><span style=color:#e6db74>${</span>
            <span style=color:#a6e22e>radius</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>90</span>
          <span style=color:#e6db74>}</span><span style=color:#e6db74>deg, #fff 50%, transparent 50%)`</span>,
        }}
      <span style=color:#f92672>&gt;&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
    )
  } <span style=color:#66d9ef>else</span> {
    <span style=color:#66d9ef>return</span> (
      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span>
        <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;h-5 w-5 rounded-full border-2 border-solid border-[#6fba2c] bg-white&#34;</span>
        <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span>{{
          <span style=color:#a6e22e>backgroundImage</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`linear-gradient(</span><span style=color:#e6db74>${</span><span style=color:#f92672>-</span><span style=color:#ae81ff>90</span><span style=color:#e6db74>}</span><span style=color:#e6db74>deg, #6fba2c 50%, transparent 50%), linear-gradient(</span><span style=color:#e6db74>${</span>
            (<span style=color:#a6e22e>radius</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>90</span>) <span style=color:#f92672>%</span> <span style=color:#ae81ff>360</span>
          <span style=color:#e6db74>}</span><span style=color:#e6db74>deg, #6fba2c 50%, transparent 50%)`</span>,
        }}
      <span style=color:#f92672>&gt;&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
    )
  }
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://springdoc.cn/>Spring 中文文档</a></p>
</li>
<li>
<p><a href=https://davidisaksson.dev/posts/closing-stale-ssh-connections/>Closing a stale SSH connection</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230522>20230522<a hidden class=anchor aria-hidden=true href=#20230522>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://www.teamviewer.com/apac/documents/#multipleaccordion-9a85485ad4-item-b1a2e248dc>How to Use TeamViewer Remote</a></li>
<li>小课堂：
<ul>
<li>举个例子，给你 1000块钱，100一张 ，10张，这10张100的，有没区别？从价值角度来说，没区别，因为都是100的，这个就是同质化的；从防伪角度来说，是不是一样的，不是，每个100的纸币，都有防伪码，唯一不可篡改的编码，这个就是非同质化。明白了吗？非同质化代币，对于区块链网络来说，就是在区块链上，不同编号的币，你先这么理解。</li>
<li>RAW，real assets wrod ，他的目的是引入真实世界的资产到虚拟世界。在股票市有一个名词：资产证券化，和这个比较接近。例如你有一个价值100w的房子，你抵押给银行，银行给你 80万人民币。这个就可以理解为你把真的房子的资产映射到了金融世界。因为从物理角度来说，房子和钱币来说属于两个世界，raw 在区块链世界，就是你抵押你的房子，给你虚拟世界的资产，例如比特币。抵押给银行了，这个动作发生在真实世界，在虚拟世界就不能抵押，虚拟世界也没有真实世界的房子。但是你抵押给银行了，可以在虚拟世界，给你虚拟世界的账户，打一笔钱，这样你房子的价值，是不是映射到虚拟世界了。明白了吗？记住是价值映射，raw 本质就是价值传导</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230521>20230521<a hidden class=anchor aria-hidden=true href=#20230521>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://juejin.cn/post/7226185606828015671>负责淘宝业务前端开发9年，聊聊我的心得</a>：第一步做好本职工作——既快又好（保质保量）的完成业务需求，并尝试做些改变（纯粹造个轮子、换个理念重新实现轮子、尝试前端领域一些新特性或者新框架）。</li>
<li><a href=https://wind13.github.io/post/2020/software-develop-improve/>软件开发团队如何高质量、高效率？</a>：软件开发要达到高质量、高效率，就需要在代码可读性、可维护性和可扩展性等多方面都达到较好的水平才可以。“代码编程”是软件开发中最关键的环节。首先要保证质量，才能提升进度。遵照“权限编程”的实践思路来进行培养高水平的开发人员（其实就是大佬轮流带队，向大佬学习）</li>
<li>技术的广度与深度：我提这个问题，目标是提升自己在就业大军中的竞争优势
<ul>
<li><a href=https://www.ruanyifeng.com/blog/2021/09/weekly-issue-174.html>全能程序员 vs 特长程序员</a>：&ldquo;绝大多数成熟的程序员都专攻某一个技术栈，因为这样更容易找到工作。 一些专家甚至认为，在不同的技术栈中工作是简历的污点。"（以公司角度）</li>
<li><a href=https://www.ruanyifeng.com/blog/2021/09/weekly-issue-175.html>知识广度 vs 知识深度</a>：知识的广度能告诉你什么是正确的方向，知识的深度则可以让你在该方向上快速前进。雇主愿意为知识深度买单。因为你克服了技术难题，才有机会来领导团队。（以各自优势为角度）</li>
<li><a href=https://cloud.tencent.com/developer/article/1697491>技术的深度与广度，该如何取舍？</a>：取决于你的屁股坐在哪一边。如果你的职业规划是在企业里步步高升，那么专注某个领域，并且努力成为那个领域的专家，会更符合企业对人才的要求。而如果你的志向在于体制之外，则各方面都懂一点，眼观六路耳听八方，时刻保持警惕，才是在残酷的大自然中繁衍生息的不二法则。（以人的不同位置为角度）</li>
<li><a href=https://www.zhihu.com/question/434344849/answer/1649753818>对于一个领域，深度重要还是广度重要？（可以拿自己所在领域举例，为后来人提供一些经验）?</a>：初期的广度重要，“选择大于努力”；中期的深度重要，“高端人才永远短缺，初级人才永远内卷”；成熟期又变成广度重要。（以人发展的不同时期为角度）</li>
<li><a href=https://www.zhihu.com/question/19764337/answer/13700129>如何平衡知识结构广度与深度？</a>：知识的广度往往并不会产生直接的自我增值，知识广度本身是附着在某一个专业深度上的。（以学习的先后顺序为角度，先深后广）</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230520>20230520<a hidden class=anchor aria-hidden=true href=#20230520>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>对于服务端来说，params 是动态路由，定义如 <code>/test/:key</code>，如果实际 url 为 <code>/test/value</code>，则 params 对象为 <code>{ key: value }</code>，query 是查询参数，url 为 <code>/test?key1=value1&test2=value2</code>，则 query 对象为 <code>{ key1: value1, key2: value2 }</code>；对于客户端来说，查询参数就是 params，即 url ? 后面的部分。</p>
</li>
<li>
<p>next.js 下 css modules 选择器 <code>.privacypolicy > p:first-child</code> 不起作用，经过测试，我的写法是有效的，最后解决办法是不使用伪类，用 <code>.privacypolicy > nav</code> 。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/57389355>How can I get (query string) parameters from the URL in Next.js?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>router</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRouter</span>()
<span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>query</span>);
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230519>20230519<a hidden class=anchor aria-hidden=true href=#20230519>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://stackoverflow.com/a/71607012>Property &lsquo;scrollTop&rsquo; does not exist on type &lsquo;EventTarget&rsquo;</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>st</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>HTMLElement</span>).<span style=color:#a6e22e>scrollTop</span>;
</code></pre></div></li>
<li>
<p><a href=https://zhuanlan.zhihu.com/p/164844013>JavaScript 中那些不会冒泡的事件</a>： 滚动事件不会冒泡，需要在捕获阶段或者直接在该滚动元素上完成委托。</p>
</li>
<li>
<p><a href=https://juejin.cn/post/7010291315455819812>vscode在自动填充后失去常规代码提示的问题（连续自动补充失效）</a>:</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#e6db74>&#34;editor.suggest.snippetsPreventQuickSuggestions&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#66d9ef>false</span><span style=color:#960050;background-color:#1e0010>,</span>
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230518>20230518<a hidden class=anchor aria-hidden=true href=#20230518>#</a></h2>
<ul>
<li>任务</li>
<li>经验
<ul>
<li><a href=https://segmentfault.com/a/1190000040202198>vue中使用setInterval()循环定时器的注意事项</a></li>
<li>问题：pinia 没有在多页面共享状态
<ul>
<li>解决方案：使用 vue router 的 <code>&lt;router-link></code> 组件</li>
<li>问题分析：vue 或 react 的 store 作用是在多页面共享状态，都是在页面不 reload 下生效的，而 a 标签会 reload 页面，因此需要第三方 router 库的路由组件来路由，防止页面 reload。</li>
</ul>
</li>
<li><a href=https://gaocarri.top/post/vue%E5%85%B3%E4%BA%8Edata%E4%B8%BA%E4%BB%80%E4%B9%88%E6%98%AF%E5%87%BD%E6%95%B0%E8%BF%99%E4%BB%B6%E4%BA%8B/>Vue关于data为什么是函数这件事</a></li>
<li><a href=https://juejin.cn/post/6844903989088092174>轻松理解JS 原型原型链</a>：JS 只有对象，关键就在于清楚 <code>.__proto__</code>、<code>.prototype</code> 和 <code>.constructor</code> 变量的指向。</li>
<li><a href=https://www.zhihu.com/question/53175578/answer/133836407>前端们，贺老 Live 面试你了！</a>：会一个知识点不能代表你牛逼，只能代表你知道，所以还需要继续考察，但要是你不会，三言两语就学会了，那你肯定牛逼了。</li>
<li><a href=https://superuser.com/a/540882>rar/unrar for macOS</a>: <code>brew install rar; unrar x filename</code></li>
</ul>
</li>
</ul>
<h2 id=20230517>20230517<a hidden class=anchor aria-hidden=true href=#20230517>#</a></h2>
<ul>
<li>任务</li>
<li>经验
<ul>
<li>
<p><a href=https://blog.csdn.net/NN_nan/article/details/55045562>div内显示两行或三行，超出部分用省略号显示</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=color:#f92672>overflow</span><span style=color:#f92672>:</span> <span style=color:#f92672>hidden</span><span style=color:#f92672>;</span>
<span style=color:#f92672>text-overflow</span><span style=color:#f92672>:</span> <span style=color:#f92672>ellipsis</span><span style=color:#f92672>;</span>
<span style=color:#f92672>display</span><span style=color:#f92672>:</span> <span style=color:#f92672>-webkit-box</span><span style=color:#f92672>;</span>
<span style=color:#f92672>-webkit-box-orient</span><span style=color:#f92672>:</span> <span style=color:#f92672>vertical</span><span style=color:#f92672>;</span>
<span style=color:#f92672>-webkit-line-clamp</span><span style=color:#f92672>:</span> <span style=color:#f92672>2</span><span style=color:#f92672>;</span>
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/36558267>How to listen for specific property changes in Redux store after an action is dispatched</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>unsubscribe</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>store</span>.<span style=color:#a6e22e>subscribe</span>(() =&gt; <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;State after dispatch: &#39;</span>, <span style=color:#a6e22e>store</span>.<span style=color:#a6e22e>getState</span>().<span style=color:#a6e22e>additon</span>))
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/60007614>How can you replace entire state in Redux Toolkit reducer?</a>: <code>return action.payload</code></p>
</li>
<li>
<p><a href=https://www.jianshu.com/p/fabbcc385ee6>vue3.0+vite (二) vite.config.js基本配置</a>：主要是 Vue Vite 解决 CORS 部分，官方文档 <a href=https://vitejs.dev/config/server-options.html#server-proxy>server.proxy</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>server</span><span style=color:#f92672>:</span> {
  <span style=color:#a6e22e>cors</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 默认启用并允许任何源
</span><span style=color:#75715e></span>  <span style=color:#a6e22e>open</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 在服务器启动时自动在浏览器中打开应用程序
</span><span style=color:#75715e></span>  <span style=color:#75715e>//反向代理配置，注意rewrite写法，开始没看文档在这里踩了坑
</span><span style=color:#75715e></span>  <span style=color:#a6e22e>proxy</span><span style=color:#f92672>:</span> {
    <span style=color:#e6db74>&#39;/api&#39;</span><span style=color:#f92672>:</span> {
      <span style=color:#a6e22e>target</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;http://192.168.99.223:3000&#39;</span>,   <span style=color:#75715e>//代理接口
</span><span style=color:#75715e></span>      <span style=color:#a6e22e>changeOrigin</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
      <span style=color:#a6e22e>rewrite</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>path</span>) =&gt; <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/^\/api/</span>, <span style=color:#e6db74>&#39;&#39;</span>)
    }
  }
}
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230516>20230516<a hidden class=anchor aria-hidden=true href=#20230516>#</a></h2>
<ul>
<li>经验
<ul>
<li>form 的 action 属性，就是 api 的路径，比如 <code>action='/api/v1/i'</code></li>
<li><a href=https://www.cnblogs.com/Sky-seeker/p/15836871.html>电信光猫F450——破解超级密码并配置无线IPTV</a></li>
<li><a href=https://masteringjs.io/tutorials/fundamentals/filter-key>How to Filter an Object by Key in JavaScript</a></li>
</ul>
</li>
</ul>
<h2 id=20230515>20230515<a hidden class=anchor aria-hidden=true href=#20230515>#</a></h2>
<p><a href=https://github.com/megaease/Remembering-Haoel>纪念左耳朵耗子</a></p>
<h2 id=20230512>20230512<a hidden class=anchor aria-hidden=true href=#20230512>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>问题：受控的 input checkbox 选中后，依次点击浏览器后退、前进，会发现该 checkbox 值是 false，但是 ui 还是选中状态，点击两次该 checkbox ui 会变为非选中状态。原因：如果该页面是通过正常的路由进行访问的，而不是直接输入地址访问，则会正确的卸载与重建。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/41262933>Getting HTML form values</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getData</span>(<span style=color:#a6e22e>form</span>) {
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>formData</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>FormData</span>(<span style=color:#a6e22e>form</span>);

  <span style=color:#75715e>// iterate through entries...
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>pair</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>formData</span>.<span style=color:#a6e22e>entries</span>()) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>pair</span>[<span style=color:#ae81ff>0</span>] <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;: &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>pair</span>[<span style=color:#ae81ff>1</span>]);
  }

  <span style=color:#75715e>// ...or output as an object
</span><span style=color:#75715e></span>  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(Object.<span style=color:#a6e22e>fromEntries</span>(<span style=color:#a6e22e>formData</span>));
}

document.<span style=color:#a6e22e>getElementById</span>(<span style=color:#e6db74>&#34;myForm&#34;</span>).<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#34;submit&#34;</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>e</span>) {
  <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>preventDefault</span>();
  <span style=color:#a6e22e>getData</span>(<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>target</span>);
});
</code></pre></div></li>
<li>
<p>使用 <code>for ... of</code> 报错：<code>Type 'IterableIterator&lt;number>' can only be iterated through when using the '--downlevelIteration' flag or with a '--target' of 'es2015' or higher</code>，<a href=https://stackoverflow.com/a/74266946>解决</a>。</p>
</li>
<li>
<p><a href=https://redux.js.org>Redux</a> 变化很大。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/8205709>Array() vs new Array()</a>: The <a href=https://www.ecma-international.org/ecma-262/5.1/#sec-15.4.1>spec</a> says: When Array is called as a function rather than as a constructor, it creates and initialises a new Array object. Thus the function call Array(…) is equivalent to the object creation expression new Array(…) with the same arguments.</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/71795600>How to access all the direct children of a div in tailwindcss?</a>: <code>[&>*]:text-gray-200</code> or <code>[&>*:hover]:text-blue-500</code></p>
</li>
<li>
<p><a href=https://www.zhihu.com/question/37472407>乌苏啤酒为什么被称为夺命大乌苏？</a>：归根结底就是酿酒工艺差，杂醇多，导致上头感强，后劲极大，第二天醒来生不如死。</p>
</li>
<li>
<p><a href=https://juejin.cn/user/2242659450890733/posts>27岁转行风雨路</a></p>
<ul>
<li>私活：国内的程序员客栈/飞援，国外的电鸭/upwork（更好）。（接私活不仅是赚钱，也能将学习的知识用于实际、增长经验）</li>
<li>经验：封装api/封装store/封装路由/封装公共方法，这四个大块做好了，其他的就是基本的页面逻辑，根据设计图填充就行了。</li>
<li>产品：原型——设计——开发，三个环节缺一不可。</li>
</ul>
</li>
<li>
<p><a href=https://moderncss.dev/pure-css-custom-checkbox-style/>Pure CSS Custom Checkbox Style</a></p>
</li>
<li>
<p><a href=https://www.jianshu.com/p/e984c3619019>FormData使用方法详解</a></p>
</li>
<li>
<p><a href=https://juejin.cn/post/7225206098692407355>因为写不出拖拽移动效果，我恶补了一下Dom中的各种距离</a></p>
</li>
<li>
<p><a href=https://zhuanlan.zhihu.com/p/20597452>redux middleware 详解</a></p>
</li>
<li>
<p>问题：整个页面都是表单，数量非常多，考虑要在前进、后退中保存表单状态，使用了redux，但是非常繁琐。解决方案：考虑使用 keep alive 保存整个页面的状态，使用 form 的 onSubmit 自动获取表单数据。</p>
<ul>
<li><a href=https://juejin.cn/post/7154309586671894542>React状态保存（Keep-Alive）实现方式概览</a></li>
<li>Next.js 适合用 <a href=https://github.com/CJY0208/react-activation/blob/master/README_CN.md>React Activation</a>，但<a href=https://github.com/CJY0208/react-activation/issues/200>不能使用 React.StrictMode 模式了</a></li>
</ul>
</li>
<li>
<p><a href=https://www.cnblogs.com/goloving/p/8485623.html>浅析Number.EPSILON及JavaScript中的数值误差问题</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230511>20230511<a hidden class=anchor aria-hidden=true href=#20230511>#</a></h2>
<ul>
<li>经验
<ul>
<li><code>margin: 0 auto;</code> 水平居中条件
<ul>
<li>父元素有剩余空间</li>
<li>目标子元素为块级元素</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230510>20230510<a hidden class=anchor aria-hidden=true href=#20230510>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>职场上好的沟通是生存优势。</p>
</li>
<li>
<p>代码不是先想好了再写，而是一边写一边想好。一个组件不知道怎么写，哪怕是看了文章后，虽然有思路，但是还是不知道具体怎么写，这是因为没有动手写，而不是你不会写。</p>
</li>
<li>
<p>double range slider input</p>
<ul>
<li>
<p>看<a href=https://www.zhangxinxu.com/wordpress/2021/02/range-input/>巧用两个type=range input实现区域范围选择</a>的说明</p>
</li>
<li>
<p>看<a href=https://segmentfault.com/a/1190000042658020>js使用input实现双向slider</a>的实际代码</p>
</li>
<li>
<p>了解<a href=https://www.zhangxinxu.com/wordpress/2011/12/css3-pointer-events-none-javascript/>CSS3 pointer-events:none应用举例及扩展</a></p>
</li>
<li>
<p>通过<a href=https://www.smashingmagazine.com/2021/12/create-custom-range-input-consistent-browsers/>Creating A Custom Range Input That Looks Consistent Across All Browsers</a>了解 range input 自定义样式相关选择器</p>
</li>
<li>
<p><a href=https://segmentfault.com/a/1190000002405897>JS基础篇&ndash;了解JS的clientX、pageX、screenX等方法来获取鼠标坐标详解</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/31520106>React&rsquo;s mouseEvent doesn&rsquo;t have offsetX/offsetY</a>: Get it from <code>e.nativeEvent.offsetX</code>.</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/11832950>How to round to at most 2 decimal places, if necessary</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>Math.<span style=color:#a6e22e>round</span>(<span style=color:#a6e22e>num</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>100</span>
Math.<span style=color:#a6e22e>round</span>((<span style=color:#a6e22e>num</span> <span style=color:#f92672>+</span> Number.<span style=color:#a6e22e>EPSILON</span>) <span style=color:#f92672>*</span> <span style=color:#ae81ff>100</span>) <span style=color:#f92672>/</span> <span style=color:#ae81ff>100</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://vant-ui.github.io/vant/#/zh-CN/>Vant</a>：轻量、可定制的移动端 Vue 组件库</p>
</li>
<li>
<p><a href=https://manateelazycat.github.io/think/2023/05/10/developer-focus.html>谈研发人员怎么专注</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230509>20230509<a hidden class=anchor aria-hidden=true href=#20230509>#</a></h2>
<ul>
<li>经验
<ul>
<li>文章：<a href=https://cangsdarm.github.io/illustrate/quic>图解 QUIC 连接</a></li>
<li>文章：<a href=https://www.bilibili.com/read/cv20992052/>Next.js小记</a></li>
</ul>
</li>
</ul>
<h2 id=20230508>20230508<a hidden class=anchor aria-hidden=true href=#20230508>#</a></h2>
<ul>
<li>经验
<ul>
<li>Chatfo 分享到微信：在桌面浏览器与不支持的手机浏览器中将展示二维码；在支持的手机浏览器上利用原生分享组件直接跳转：
<ul>
<li>
<p><a href=https://blog.fooleap.org/share-to-wechat.html>为博客添加分享到微信功能</a>：使用<a href=https://www.npmjs.com/package/qrcode>qrcode</a>展示二维码</p>
</li>
<li>
<p><a href=https://github.com/fa-ge/NativeShare>JS 调用浏览器的原生分享组件</a></p>
<ul>
<li><a href=https://stackoverflow.com/a/66932490>Reference Error:Navigator not defined with nextjs</a>: Browser objects like window , navigator etc should be define in useEffect first before use. Window it&rsquo;s browser object, and the hook will run after it&rsquo;s loaded, that&rsquo;s why it will work.</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>useEffect</span>(() =&gt; {
  <span style=color:#75715e>// @ts-ignore TYPE NEEDS FIXING
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>import</span>(<span style=color:#e6db74>&#39;nativeshare&#39;</span>).<span style=color:#a6e22e>then</span>((<span style=color:#a6e22e>res</span>) =&gt; {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>nativeShare</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>res</span>.<span style=color:#66d9ef>default</span>()
    <span style=color:#a6e22e>nativeShare</span>.<span style=color:#a6e22e>setShareData</span>({
      <span style=color:#a6e22e>icon</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span>window.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>origin</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/icons/icon-192x192.png`</span>,
      <span style=color:#a6e22e>link</span><span style=color:#f92672>:</span> window.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span>,
      <span style=color:#a6e22e>title</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`问题 </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>qid</span><span style=color:#e6db74>}</span><span style=color:#e6db74> | 佛说 AI`</span>,
      <span style=color:#a6e22e>desc</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;佛说，AI智能平台。&#39;</span>,
    })
    <span style=color:#a6e22e>setNativeShare</span>(<span style=color:#a6e22e>nativeShare</span>)
  })
}, [<span style=color:#a6e22e>qid</span>])
</code></pre></div></li>
<li>
<p><a href=https://pjchender.dev/webapis/webapis-web-share/>Web Share API 的使用 - navigator.share</a></p>
</li>
<li>
<p><a href=https://github.com/nygardk/react-share>react-share</a>：社交媒体分享组件，同 vue-social-sharing</p>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230506>20230506<a hidden class=anchor aria-hidden=true href=#20230506>#</a></h2>
<h2 id=20230505>20230505<a hidden class=anchor aria-hidden=true href=#20230505>#</a></h2>
<ul>
<li>任务
<ul>
<li><input checked disabled type=checkbox> 群发邮件的api + UI接口，做到管理后台（要一个邮件模版）
<ul>
<li>Mailgun
<ul>
<li><a href=https://qing.su/article/131.html>奇技淫巧——整合Gmail与Mailgun实现免费域名邮箱</a></li>
<li><a href=https://help.mailgun.com/hc/en-us/articles/203068874-How-Do-I-Send-the-Same-Message-to-Multiple-Users-Using-Mailgun->How Do I Send the Same Message to Multiple Users Using Mailgun?</a>
<ul>
<li><a href=https://github.com/mailgun/mailgun.js#recipient-variables>Batch Sending</a></li>
<li>Mailing Lists</li>
</ul>
</li>
</ul>
</li>
<li>中后台前端
<ul>
<li><a href=https://pro.ant.design/zh-CN/docs/overview>Ant Design Pro</a>
<ul>
<li><a href=https://pro.ant.design/zh-CN/docs/new-page>新增页面</a></li>
<li><a href=https://umijs.org/docs/introduce/introduce>Umi</a>
<ul>
<li><a href=https://umijs.org/docs/guides/routes>路由</a></li>
<li><a href=https://umijs.org/docs/guides/proxy>代理</a></li>
</ul>
</li>
<li><a href=https://pro.ant.design/zh-CN/docs/environment-manage/>环境变量</a></li>
</ul>
</li>
<li><a href=https://procomponents.ant.design>ProComponents</a>：ProComponents 是 antd 的超集，但文档没有 antd 细。
<ul>
<li><a href=https://procomponents.ant.design/components/page-container>PageContainer</a></li>
<li><a href=https://procomponents.ant.design/components/table>ProTable</a></li>
<li><a href=https://procomponents.ant.design/components/form>ProForm</a></li>
<li><a href=https://procomponents.ant.design/components/field-set>ProFormFields</a></li>
</ul>
</li>
<li><a href=https://ant.design/index-cn>Ant Design</a>
<ul>
<li><a href=https://ant.design/docs/react/recommendation-cn>社区精选组件</a>：富文本编辑器 <a href=https://github.com/zenoamaro/react-quill>react-quill</a>，修改样式参考 codepen 中的例子，基本上是通过类选择器来调整样式的。</li>
<li><a href=https://ant.design/components/pagination-cn>Pagination分页</a>：ProTable 的分页设置</li>
<li><a href=https://ant.design/docs/react/i18n-cn>国际化</a>：首先，需要写对 language code，这样才能自动为支持的语言添加图标；其次就是修改一下locales根目录的ts文件的导入</li>
</ul>
</li>
</ul>
</li>
<li>HTML Email Template
<ul>
<li><a href=https://webdesign.tutsplus.com/articles/build-an-html-email-template-from-scratch--webdesign-12770>Build an HTML Email Template From Scratch</a></li>
<li><a href=https://www.smashingmagazine.com/2017/01/introduction-building-sending-html-email-for-web-developers/#comments-introduction-building-sending-html-email-for-web-developers>An Introduction To Building And Sending HTML Email For Web Developers</a></li>
<li><a href=https://www.ruanyifeng.com/blog/2013/06/html_email.html>HTML Email 编写指南</a></li>
<li><a href=https://www.twblogs.net/a/5d2c0bb3bd9eee1ede074a58>mjml - 如何快速編寫響應式電子郵件？</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230428>20230428<a hidden class=anchor aria-hidden=true href=#20230428>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>ubuntu 自动更新导致 docker 服务全宕机：<a href=https://linuxnightly.com/how-to-disable-automatic-updates-in-ubuntu/>How to Disable Automatic Updates in Ubuntu</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ sudo nano /etc/apt/apt.conf.d/20auto-upgrades
APT::Periodic::Update-Package-Lists <span style=color:#e6db74>&#34;0&#34;</span>;
APT::Periodic::Download-Upgradeable-Packages <span style=color:#e6db74>&#34;0&#34;</span>;
APT::Periodic::AutocleanInterval <span style=color:#e6db74>&#34;0&#34;</span>;
APT::Periodic::Unattended-Upgrade <span style=color:#e6db74>&#34;0&#34;</span>;
</code></pre></div></li>
<li>
<p><a href=https://zhuanlan.zhihu.com/p/27944503>「入坑指南」老司机带你玩转PSN账号</a>：国服机器，外服需要备份还原大法，国服直接登录就行。</p>
<ul>
<li><a href=https://bbs.a9vg.com/thread-8761563-1-1.html>求助备份添加账号的问题</a></li>
<li><a href="https://www.zhihu.com/tardis/zm/art/299231957?source_id=1003">备份还原：让国行PS4主机用上港服账号</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230427>20230427<a hidden class=anchor aria-hidden=true href=#20230427>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://cn.vuejs.org/guide/built-ins/transition.html#nested-transitions-and-explicit-transition-durations>Vue深层级过渡与显式过渡时长</a>：要在在深层级的元素上触发过渡效果，关键在于传入 duration prop 来显式指定过渡。</li>
<li>通过项目驱动来学习技术，这里的项目不是指学习者从零开始自己写一个项目，对于新人来说，这太难了，而且很容易走错方向，这个项目指的是现有的需求类似的项目，学习者这参照这个项目从头来实现，在实现的过程中，学习其写法、添加自己的想法等，最终实现自己的需求、学会这套技术栈。</li>
<li><a href=https://manuals.playstation.net/document/cs/ps4/index.html>PlayStation®4用户指南</a></li>
</ul>
</li>
</ul>
<h2 id=20230426>20230426<a hidden class=anchor aria-hidden=true href=#20230426>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://stackoverflow.com/a/59574283>How can I accept all current changes in VSCode at once?</a>: Its very easy just go to vs code and press <code>Ctrl</code>+<code>shift</code>+<code>p</code> (command palette) or go to view and open command palette manually and type &ldquo;merge&rdquo; in your command palette, now you can see the Accept all current changes.</li>
</ul>
</li>
</ul>
<h2 id=20230425>20230425<a hidden class=anchor aria-hidden=true href=#20230425>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>[module not defined in Vue Project](<a href=https://stackoverflow.com/a/73353382>https://stackoverflow.com/a/73353382</a>: Add this to <code>.eslintrc.cjs</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>env</span><span style=color:#f92672>:</span> {
  <span style=color:#a6e22e>node</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
},
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/45512552>How can I import a svg file to a Vue component?</a></p>
<ul>
<li>
<p>一种安装包 <a href=https://www.npmjs.com/package/vue-svg-loader>vue-svg-loader</a>，把 svg 处理为组件</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>SomeIcon</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;./assets/some-icon.svg&#39;</span>;

<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>SomeIcon</span> <span style=color:#66d9ef>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;icon&#34;</span> <span style=color:#f92672>/&gt;</span>
</code></pre></div></li>
<li>
<p>一种是直接导入，不需要安装任何包</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>template</span><span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>img</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;@/assets/my-svg-file.svg&#34;</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/template&gt;</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://cyber.dabamos.de/unix/tethering/>Using USB tethering on FreeBSD with Android</a></p>
</li>
<li>
<p><a href=https://srobb.net/fbsdquickwireless.html>FreeBSD Wireless Quickstart</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230424>20230424<a hidden class=anchor aria-hidden=true href=#20230424>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://stackoverflow.com/a/73618982>NextJS Image component with fixed witdth and auto height</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Image</span>
    <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>img1</span>}
    <span style=color:#a6e22e>width</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span>
    <span style=color:#a6e22e>height</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;0&#34;</span>
    <span style=color:#a6e22e>sizes</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;100vw&#34;</span>
    <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;w-full h-auto&#34;</span>
<span style=color:#960050;background-color:#1e0010>/&gt;</span>
</code></pre></div></li>
<li>
<p>Vue 报错 <code>Virtual script not found, may missing &lt;script lang="ts"> / "allowJs": true / jsconfig.json</code>，在 tsconfig.json 或 jsconfig.json 中加入如下内容</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>{
  <span style=color:#e6db74>&#34;compilerOptions&#34;</span><span style=color:#f92672>:</span> {
    <span style=color:#e6db74>&#34;allowJs&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>
  }
}
</code></pre></div><p>作用是在 ts 中导入 js 模块：<a href=https://www.typescriptlang.org/tsconfig#allowJs>Allow JS</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/44186374>Vue: How do I call multiple functions with @click?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>v</span><span style=color:#f92672>-</span><span style=color:#a6e22e>on</span><span style=color:#f92672>:</span><span style=color:#a6e22e>click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;firstFunction(); secondFunction();&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
<span style=color:#75715e>// or
</span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#960050;background-color:#1e0010>@</span><span style=color:#a6e22e>click</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;firstFunction(); secondFunction();&#34;</span><span style=color:#f92672>&gt;&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
</code></pre></div></li>
<li>
<p><a href=https://www.cnblogs.com/huqiuwei/p/6401851.html>关于vue ，v-on 绑定事件时，函数名加括号和不加括号的区别</a></p>
</li>
<li>
<p><a href=https://www.jianshu.com/p/2a1089a636ec>vue.js中的data和props的区别</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230423>20230423<a hidden class=anchor aria-hidden=true href=#20230423>#</a></h2>
<ul>
<li>经验
<ul>
<li>写后端 api 不仅是后端的事情，前端也需要根据自己的需要来向后端提供需求，帮助其完善 api。前端最好再自己画 UI 之前，把需要的 api 列表交给后端，这样前端 UI 与后端 api 可以同步进行。</li>
</ul>
</li>
</ul>
<h2 id=20230421>20230421<a hidden class=anchor aria-hidden=true href=#20230421>#</a></h2>
<ul>
<li>经验
<ul>
<li>公司自动化流程是：GitHub =webhook=> Jenkins =ssh=> Shell 脚本 => Kong 服务。一般先写脚本，脚本是核心，当脚本能够正确运行了，再添加到 Jenkins，配置 kong 服务的等。</li>
</ul>
</li>
</ul>
<h2 id=20230420>20230420<a hidden class=anchor aria-hidden=true href=#20230420>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://js-lingui-git-next.lingui-js.vercel.app/ref/cli.html>Lingui 删除多余 message</a>：<code>lingui extract --clean --overwrite</code></p>
</li>
<li>
<p>Prisma 存储中文字符串到 Mysql 后，通过命令行在 Mysql 查看，会发现中文显示为<code>?????????????</code>，这是因为默认用的 latin1 显示，参考<a href=https://blog.csdn.net/S0001100/article/details/105892444>两步解决MySQL无法显示中文</a>即可解决</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>show variables like <span style=color:#e6db74>&#39;%character%&#39;</span>;
set character_set_client<span style=color:#f92672>=</span>utf8mb3;
set character_set_results<span style=color:#f92672>=</span>utf8mb3;
</code></pre></div></li>
<li>
<p><a href=https://www.cnblogs.com/chrischennx/p/6623610.html>Java Unicode编码 及 Mysql utf8 utf8mb3 utf8mb4 的区别与utf8mb4的过滤</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/70500932>TypeError: (intermediate value)(intermediate value)(intermediate value) is not iterable</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// 错误原因 You cannot destruct array value from undefined
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>filterValues</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>undefined</span>
<span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>startDate</span>, <span style=color:#a6e22e>endDate</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>filterValues</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>dateRange</span>

<span style=color:#75715e>// 解决方案一
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>startDate</span>, <span style=color:#a6e22e>endDate</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>filterValues</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>dateRange</span> <span style=color:#f92672>??</span> []

<span style=color:#75715e>// 解决方案二
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>dateRange</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>filterValues</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>dateRange</span>
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>startDate</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dateRange</span><span style=color:#f92672>?</span>.[<span style=color:#ae81ff>0</span>]
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>endDate</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dateRange</span><span style=color:#f92672>?</span>.[<span style=color:#ae81ff>1</span>]
</code></pre></div></li>
<li>
<p><a href=https://juejin.cn/s/typescript%20%E5%8F%8C%E9%97%AE%E5%8F%B7>TypeScript里的空值合并运算符(双问号)用法</a>：当左侧操作数为 null 或 undefined 时，其返回右侧的操作数，否则返回左侧的操作数。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/49786588>Bearer token in postman</a>: You can just manually add an Authorization Request Header with a <code>Bearer &lt;my_token></code> value.</p>
</li>
<li>
<p><a href=https://blog.csdn.net/u014745069/article/details/106319526>MySQL高级 —— 查询性能优化</a>：查询性能低下最根本的原因是访问的数据太多。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/69943634>get full type on prisma client</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>Prisma</span>, <span style=color:#a6e22e>PrismaClient</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#34;@prisma/client&#34;</span>;

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>prisma</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>PrismaClient</span>();

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>userInclude</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Prisma</span>.<span style=color:#a6e22e>validator</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Prisma</span>.<span style=color:#a6e22e>UserInclude</span><span style=color:#f92672>&gt;</span>()({
  <span style=color:#a6e22e>cars</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
});

<span style=color:#a6e22e>type</span> <span style=color:#a6e22e>UserWithCars</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Prisma</span>.<span style=color:#a6e22e>UserGetPayload</span><span style=color:#f92672>&lt;</span>{
  <span style=color:#a6e22e>include</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>userInclude</span>;
}<span style=color:#f92672>&gt;</span>;

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>usersWithCars</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>prisma</span>.<span style=color:#a6e22e>user</span>.<span style=color:#a6e22e>findMany</span>({
  <span style=color:#a6e22e>include</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>userInclude</span>,
});
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230419>20230419<a hidden class=anchor aria-hidden=true href=#20230419>#</a></h2>
<ul>
<li>
<p>经验</p>
<ul>
<li>
<p>部署：正向合并 main => test => dev，反向合并 dev => test => main。</p>
</li>
<li>
<p>Github PAT</p>
<ul>
<li><a href=https://docs.github.com/zh/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token>创建个人访问令牌</a></li>
<li><a href=https://docs.github.com/zh/organizations/managing-programmatic-access-to-your-organization/reviewing-and-revoking-personal-access-tokens-in-your-organization>查看和撤销组织中的个人访问令牌</a></li>
</ul>
</li>
<li>
<p>可以通过爱思助手将音乐导入 iphone apple music 中，如果提示有重复文件，就选择覆盖，否则可能出现音乐图片与音乐不匹配的情况，虽然我确实是删除了的。</p>
</li>
<li>
<p>待定的地方用 <code>###</code> 填位置，也方便搜索。</p>
</li>
<li>
<p>如果页面分别写了手机端与电脑端的页面，且页面差异较大，在客户端用媒体查询切换非常不自然，那么可以通过 <a href=https://nextjs.org/docs/advanced-features/middleware>Next Middleware</a> 实现在服务端切换 UI，如：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// middleware.ts
</span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#a6e22e>type</span> { <span style=color:#a6e22e>NextRequest</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;next/server&#39;</span>
<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>NextResponse</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;next/server&#39;</span>
<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>UAParser</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;ua-parser-js&#39;</span>

<span style=color:#75715e>// This function can be marked `async` if using `await` inside
</span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>middleware</span>(<span style=color:#a6e22e>request</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>NextRequest</span>) {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>locale</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>nextUrl</span>.<span style=color:#a6e22e>locale</span>
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ua</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>headers</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;user-agent&#39;</span>)

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>uap</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>UAParser</span>(<span style=color:#a6e22e>ua</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;&#39;</span>)
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>uap</span>.<span style=color:#a6e22e>device</span>.<span style=color:#a6e22e>type</span>
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>type</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>type</span>.<span style=color:#a6e22e>toLowerCase</span>() <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;mobile&#39;</span>) {
    <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>locale</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>locale</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;en&#39;</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>locale</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;default&#39;</span>) {
      <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>NextResponse</span>.<span style=color:#a6e22e>redirect</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>URL</span>(<span style=color:#e6db74>&#39;/mobile&#39;</span>, <span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>url</span>))
    }

    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>NextResponse</span>.<span style=color:#a6e22e>redirect</span>(<span style=color:#66d9ef>new</span> <span style=color:#a6e22e>URL</span>(<span style=color:#e6db74>`/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>locale</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/mobile`</span>, <span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>url</span>))
  }

  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>NextResponse</span>.<span style=color:#a6e22e>next</span>()
}

<span style=color:#75715e>// See &#34;Matching Paths&#34; below to learn more
</span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>config</span> <span style=color:#f92672>=</span> {
  <span style=color:#a6e22e>matcher</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/&#39;</span>,
}
</code></pre></div></li>
<li>
<p><a href=https://www.cnblogs.com/flydean/p/15292400.html>密码学系列之:bcrypt加密算法详解</a></p>
</li>
<li>
<p><a href=https://chihokyo.com/post/35/>彻底搞清楚JS的模块化import/export/require&mldr;问题</a></p>
</li>
<li>
<p>大部分 require 改写 import，需安装 @types/bcrypt</p>
</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// require 写法
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>bcrypt</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;bcrypt&#39;</span>)

<span style=color:#75715e>// 对应的 import 写法
</span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> <span style=color:#f92672>*</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>bcrypt</span> <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;bcrypt&#39;</span>
</code></pre></div></li>
</ul>
<h2 id=20230418>20230418<a hidden class=anchor aria-hidden=true href=#20230418>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>写 api 的时候，要想着，如果要换一个产品，那么当下产品哪些东西可以轻松地复用，而无关的东西可以轻松的删除掉，即，要把所有功能解耦合，这样才能在各个产品中方便地复用各种功能。</p>
</li>
<li>
<p>不论是写 api 还是看 api，都是通过 client 请求到 server 处理的流程来进行的。在 nest 中，就是先写 controller，在写 service，然后再不断完善相关的东西。比如写用户登录api也是如此，先添在 controller 中添加 register 的路由，在 service 中实现 register，先只考虑操作数据库，然后加上参数验证、验证码之类的东西。总之，先从简单的开始写起来，然后再在基础上不断添加东西。</p>
</li>
<li>
<p>nest.js grpc 遇到一个天坑</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// 写法一：这样写无法调用 grcp 服务
</span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grpcMailService</span>.<span style=color:#a6e22e>sendMail</span>({ <span style=color:#a6e22e>from</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#a6e22e>to</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>captchaDto</span>.<span style=color:#a6e22e>email</span>, ...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getMailContent</span>(<span style=color:#a6e22e>code</span>) })
<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>redis</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>code</span>, <span style=color:#e6db74>&#39;EX&#39;</span>, <span style=color:#ae81ff>3</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span>)

<span style=color:#75715e>// 写法二：这样写可以调用对应的 grpc 服务
</span><span style=color:#75715e></span><span style=color:#66d9ef>await</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>redis</span>.<span style=color:#a6e22e>set</span>(<span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>code</span>, <span style=color:#e6db74>&#39;EX&#39;</span>, <span style=color:#ae81ff>3</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>60</span>)
<span style=color:#66d9ef>return</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grpcMailService</span>.<span style=color:#a6e22e>sendMail</span>({ <span style=color:#a6e22e>from</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>, <span style=color:#a6e22e>to</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>captchaDto</span>.<span style=color:#a6e22e>email</span>, ...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getMailContent</span>(<span style=color:#a6e22e>code</span>) })
</code></pre></div><p>参照 <a href=https://github.com/nestjs/nest/issues/3710>How to get non-Observable response when calling service from gRPC client?</a>，原因是 sendMail 定义的返回类型是 <code>Promise&lt;SendMailResponse></code>，实际的返回类型是 <code>Observable</code>，如果按照写法一来写，那么就不会等待 sendMail 执行完成就直接返回了。下面这样写就没问题了。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>firstValueFrom</span>(
  <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>grpcMailService</span>.<span style=color:#a6e22e>sendMail</span>({
    <span style=color:#a6e22e>from</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
    <span style=color:#a6e22e>to</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>captchaDto</span>.<span style=color:#a6e22e>email</span>,
    ...<span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>getMailContent</span>(<span style=color:#a6e22e>code</span>),
  }) <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>unknown</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>Observable</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>unknown</span><span style=color:#f92672>&gt;</span>,
)
<span style=color:#66d9ef>await</span> <span style=color:#a6e22e>result</span>
</code></pre></div><p>这也表明 js 根本不知道数据的实际类型，也不回去检查。</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230417>20230417<a hidden class=anchor aria-hidden=true href=#20230417>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>Lingui.js 在 React Component 之外使用翻译</p>
<ul>
<li>
<p><a href=https://github.com/aralroca/next-translate/issues/329#issuecomment-729770722>Question: Can I use Translation outside react component ?</a>: The t function uses the React context to know the available language and namespaces to use during the translation. Then, you can use the t function outside components as long as you pass the t function（这位其实已经给了思路，但是在不同项目中，细节是不同的。这里的 t 在我司项目里其实指的是 const { i18n } = useLingui() 中的 i18n）</p>
</li>
<li>
<p><a href=https://lingui.dev/tutorials/javascript#localizing-your-app>Localizing your app</a></p>
</li>
<li>
<p>最终结果</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>
<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>I18n</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@lingui/core&#39;</span>
<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>t</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@lingui/macro&#39;</span>

<span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>translate</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>i18n</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>I18n</span>) =&gt; {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>result</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>i18n</span>.<span style=color:#a6e22e>_</span>(<span style=color:#a6e22e>t</span><span style=color:#e6db74>`The Buddha said, AI intelligent platform.`</span>)
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>result</span>)
  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>result</span>
}
</code></pre></div></li>
</ul>
</li>
<li>
<p>部署的时候，如果是网页应用，则只需要部署 test 与 prod，dev 相当前端本地起的服务，网页应用两个端口交替使用。如果是后端 api，则是需要部署 dev、test 与 prod，dev 用于前端本地起的服务使用，api 只需要一个端口。</p>
</li>
<li>
<p><a href=https://cloud.tencent.com/developer/article/1747307>花了三天时间终于搞懂 Docker 网络了</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230414>20230414<a hidden class=anchor aria-hidden=true href=#20230414>#</a></h2>
<ul>
<li>
<p>经验</p>
<ul>
<li>
<p>问题：本地开发即使开了代理也无法访问 openai api，但是服务器可以正常访问</p>
<ul>
<li>
<p>chatbot 服务：建立一个 chatbot 服务，部署在服务器端，处理 openai api 相关的请求（唐伟现在使用的）</p>
<ul>
<li><a href=https://juejin.cn/post/7219847723092115514>搭建 OpenAI 代理</a>（成功的解决方案）: Express + http-proxy-middleware 进行反向代理</li>
</ul>
</li>
<li>
<p>代理 <a href=https://tinyproxy.github.io>TinyProxy</a>（无效）</p>
<ul>
<li>
<p><a href=https://stackoverflow.com/a/43788772>Unauthorized connection</a>：在于 Allow host，要么注释允许所有，要么正确设置</p>
</li>
<li>
<p><a href=https://gist.github.com/alienlebarge/10260853>Node.js behind a proxy</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>npm config set proxy http://10.2.0.10:8888
npm config set https-proxy http://10.2.0.10:8888
</code></pre></div></li>
<li>
<p><a href=https://community.openai.com/t/since-yesterday-i-get-this-error-when-i-use-gpt-3-5-turbo-and-i-live-in-china/84480/16>axios proxy</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>post</span>(<span style=color:#a6e22e>url</span>, <span style=color:#a6e22e>data</span>, {
  <span style=color:#a6e22e>proxy</span><span style=color:#f92672>:</span> {
      <span style=color:#a6e22e>host</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;127.0.0.1&#34;</span>,
      <span style=color:#a6e22e>port</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>7890</span>,
      <span style=color:#a6e22e>protocol</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;http&#34;</span>
  }
})
</code></pre></div></li>
<li>
<p>运行命令</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>docker run --rm --name tinyproxy -p 8888:8888  -e <span style=color:#e6db74>&#34;ALLOWED=10.2.0.9&#34;</span> ajoergensen/tinyproxy
curl --proxy 10.2.0.10:8888 -k https://www.google.com/
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://code.visualstudio.com/docs/remote/ssh>Remote Development using SSH</a></p>
</li>
</ul>
</li>
<li>
<p>Docker compose global level logging</p>
<ul>
<li>
<p><a href=https://stackoverflow.com/a/39497562>配置 Dockerfile</a></p>
<ul>
<li>
<p>YAML anchor</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#34;2&#34;</span>

<span style=color:#f92672>services</span>:

  <span style=color:#f92672>proxy</span>:
    <span style=color:#f92672>build</span>: <span style=color:#ae81ff>proxy</span>
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>kinoulink/proxy</span>
    <span style=color:#f92672>ports</span>:
      - <span style=color:#ae81ff>80</span>:<span style=color:#ae81ff>80</span>
      - <span style=color:#ae81ff>443</span>:<span style=color:#ae81ff>443</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>/var/run/docker.sock:/var/run/docker.sock:ro</span>
    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>ktv_manager_proxy</span>
    <span style=color:#f92672>environment</span>:
        - <span style=color:#ae81ff>HTTP_AUTH_PASSWORD=$KTV_MANAGER_PASSWORD</span>
    <span style=color:#f92672>logging</span>: <span style=color:#75715e>&amp;logging</span>
      <span style=color:#f92672>driver</span>: <span style=color:#e6db74>&#34;awslogs&#34;</span>
      <span style=color:#f92672>options</span>:
      <span style=color:#f92672>awslogs-region</span>: <span style=color:#ae81ff>eu-west-1</span>
      <span style=color:#f92672>awslogs-group</span>: <span style=color:#ae81ff>docker</span>

  <span style=color:#f92672>rancher</span>:
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>rancher/server:v1.1.3</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>rancher_mysql:/var/lib/mysql</span>
      - <span style=color:#ae81ff>rancher_cattle:/var/lib/cattle</span>
    <span style=color:#f92672>labels</span>:
      <span style=color:#f92672>ktv.infra.proxy.domain</span>: <span style=color:#e6db74>&#39;rancher&#39;</span>
      <span style=color:#f92672>ktv.infra.proxy.port</span>: <span style=color:#e6db74>&#39;8080&#39;</span>
    <span style=color:#f92672>logging</span>:
      <span style=color:#f92672>&lt;&lt;</span>: <span style=color:#75715e>*logging</span>
</code></pre></div></li>
<li>
<p>Extension field</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>version</span>: <span style=color:#e6db74>&#34;3.4&#34;</span>

<span style=color:#f92672>x-logging</span>:
      <span style=color:#75715e>&amp;default-logging</span>
      <span style=color:#f92672>driver</span>: <span style=color:#e6db74>&#34;awslogs&#34;</span>
      <span style=color:#f92672>options</span>:
      <span style=color:#f92672>awslogs-region</span>: <span style=color:#ae81ff>eu-west-1</span>
      <span style=color:#f92672>awslogs-group</span>: <span style=color:#ae81ff>docker</span>

<span style=color:#f92672>services</span>:
<span style=color:#f92672>proxy</span>:
    <span style=color:#f92672>build</span>: <span style=color:#ae81ff>proxy</span>
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>kinoulink/proxy</span>
    <span style=color:#f92672>ports</span>:
      - <span style=color:#ae81ff>80</span>:<span style=color:#ae81ff>80</span>
      - <span style=color:#ae81ff>443</span>:<span style=color:#ae81ff>443</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>/var/run/docker.sock:/var/run/docker.sock:ro</span>
    <span style=color:#f92672>container_name</span>: <span style=color:#ae81ff>ktv_manager_proxy</span>
    <span style=color:#f92672>environment</span>:
        - <span style=color:#ae81ff>HTTP_AUTH_PASSWORD=$KTV_MANAGER_PASSWORD</span>
    <span style=color:#f92672>logging</span>: <span style=color:#75715e>*default-logging</span>

  <span style=color:#f92672>rancher</span>:
    <span style=color:#f92672>image</span>: <span style=color:#ae81ff>rancher/server:v1.1.3</span>
    <span style=color:#f92672>volumes</span>:
      - <span style=color:#ae81ff>rancher_mysql:/var/lib/mysql</span>
      - <span style=color:#ae81ff>rancher_cattle:/var/lib/cattle</span>
    <span style=color:#f92672>labels</span>:
      <span style=color:#f92672>ktv.infra.proxy.domain</span>: <span style=color:#e6db74>&#39;rancher&#39;</span>
      <span style=color:#f92672>ktv.infra.proxy.port</span>: <span style=color:#e6db74>&#39;8080&#39;</span>
    <span style=color:#f92672>logging</span>: <span style=color:#75715e>*default-logging</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://stackoverflow.com/a/57705061>配置 Daemon configuration file</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#ae81ff>cat &lt;&lt;EOF &gt; /etc/docker/daemon.json</span>
{
  <span style=color:#f92672>&#34;log-driver&#34;: </span><span style=color:#e6db74>&#34;json-file&#34;</span>,
  <span style=color:#f92672>&#34;log-opts&#34;: </span>{
    <span style=color:#f92672>&#34;max-size&#34;: </span><span style=color:#e6db74>&#34;10m&#34;</span>,
    <span style=color:#f92672>&#34;max-file&#34;: </span><span style=color:#e6db74>&#34;3&#34;</span>
  }
}
<span style=color:#ae81ff>EOF</span>
<span style=color:#ae81ff>systemctl restart docker</span>
</code></pre></div></li>
<li>
<p>其他</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 在重启 docker 前记住哪些容器是启动的，重启后对比一下（唐伟）</span>
docker container ls | awk <span style=color:#e6db74>&#39;{print $1, $2}&#39;</span> &gt; ~/containers
<span style=color:#75715e># 在配置好后通过如下命令验证</span>
docker inspect 89c551bd7ca0 | grep -i LogConfig -A <span style=color:#ae81ff>5</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p>openai api stream</p>
<ul>
<li>
<p><a href=https://github.com/openai/openai-node/issues/18#issuecomment-1369996933>How to use stream: true?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>try</span> {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>res</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>openai</span>.<span style=color:#a6e22e>createCompletion</span>({
        <span style=color:#a6e22e>model</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;text-davinci-002&#34;</span>,
        <span style=color:#a6e22e>prompt</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;It was the best of times&#34;</span>,
        <span style=color:#a6e22e>max_tokens</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>100</span>,
        <span style=color:#a6e22e>temperature</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>0</span>,
        <span style=color:#a6e22e>stream</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
    }, { <span style=color:#a6e22e>responseType</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;stream&#39;</span> });

    <span style=color:#a6e22e>res</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;data&#39;</span>, <span style=color:#a6e22e>data</span> =&gt; {
        <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lines</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>toString</span>().<span style=color:#a6e22e>split</span>(<span style=color:#e6db74>&#39;\n&#39;</span>).<span style=color:#a6e22e>filter</span>(<span style=color:#a6e22e>line</span> =&gt; <span style=color:#a6e22e>line</span>.<span style=color:#a6e22e>trim</span>() <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;&#39;</span>);
        <span style=color:#66d9ef>for</span> (<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>line</span> <span style=color:#66d9ef>of</span> <span style=color:#a6e22e>lines</span>) {
            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>line</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#e6db74>/^data: /</span>, <span style=color:#e6db74>&#39;&#39;</span>);
            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>message</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;[DONE]&#39;</span>) {
                <span style=color:#66d9ef>return</span>; <span style=color:#75715e>// Stream finished
</span><span style=color:#75715e></span>            }
            <span style=color:#66d9ef>try</span> {
                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>parsed</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>message</span>);
                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>parsed</span>.<span style=color:#a6e22e>choices</span>[<span style=color:#ae81ff>0</span>].<span style=color:#a6e22e>text</span>);
            } <span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>error</span>) {
                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;Could not JSON parse stream message&#39;</span>, <span style=color:#a6e22e>message</span>, <span style=color:#a6e22e>error</span>);
            }
        }
    });
} <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>error</span>) {
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>response</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>status</span>) {
        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>status</span>, <span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>message</span>);
        <span style=color:#a6e22e>error</span>.<span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;data&#39;</span>, <span style=color:#a6e22e>data</span> =&gt; {
            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>message</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>toString</span>();
            <span style=color:#66d9ef>try</span> {
                <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>parsed</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>JSON</span>.<span style=color:#a6e22e>parse</span>(<span style=color:#a6e22e>message</span>);
                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;An error occurred during OpenAI request: &#39;</span>, <span style=color:#a6e22e>parsed</span>);
            } <span style=color:#66d9ef>catch</span>(<span style=color:#a6e22e>error</span>) {
                <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;An error occurred during OpenAI request: &#39;</span>, <span style=color:#a6e22e>message</span>);
            }
        });
    } <span style=color:#66d9ef>else</span> {
        <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>error</span>(<span style=color:#e6db74>&#39;An error occurred during OpenAI request&#39;</span>, <span style=color:#a6e22e>error</span>);
    }
}
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/71534399>HTTP Stream using Axios (Node JS)</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>response</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>axios</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;https://stream.example.com&#39;</span>, {
    <span style=color:#a6e22e>headers</span><span style=color:#f92672>:</span> {<span style=color:#a6e22e>Authorization</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`Bearer </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>token</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
    <span style=color:#a6e22e>responseType</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;stream&#39;</span>
});

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>stream</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>response</span>.<span style=color:#a6e22e>data</span>;

<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;data&#39;</span>, <span style=color:#a6e22e>data</span> =&gt; {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>data</span>);
});

<span style=color:#a6e22e>stream</span>.<span style=color:#a6e22e>on</span>(<span style=color:#e6db74>&#39;end&#39;</span>, () =&gt; {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;stream done&#34;</span>);
});
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://docs.nestjs.com>Nestjs Docs</a></p>
<ul>
<li><a href=https://docs.nestjs.com/techniques/configuration>Configuration</a>：管理自定义配置</li>
<li><a href=https://docs.nestjs.com/techniques/http-module#using-axios-directly>HTTP module</a>：用的 axiosInstance，返回的是 Observable</li>
<li><a href=https://docs.nestjs.com/techniques/cookies>Cookies</a>：在服务端，需要通过多语言调用 chatgpt api，那么可以通过 cookies 获取客户端选择的语言，客户端应该尽量将语言存储到 cookies 中。</li>
<li><a href=https://docs.nestjs.com/recipes/prisma>Prisma</a>：数据库
<ul>
<li><a href=https://docs.nestjs.com/fundamentals/circular-dependency>Circular dependency</a></li>
</ul>
</li>
<li><a href=https://docs.nestjs.com/microservices/redis>Redis</a>：缓存
<ul>
<li><a href=https://github.com/liaoliaots/nestjs-redis>@liaoliaots/nestjs-redis</a>。</li>
</ul>
</li>
<li><a href=https://docs.nestjs.com/microservices/rabbitmq>RabbitMQ</a>：消息队列
<ul>
<li><a href=https://www.npmjs.com/package/@types/amqplib>@types/amqplib</a></li>
<li><a href=https://docs.nestjs.com/fundamentals/lifecycle-events>Lifecycle Events</a>：Consume 在 onMountInit 中调用</li>
</ul>
</li>
<li><a href=https://docs.nestjs.com/security/authentication>Authentication</a>：使用 JWT 作认证
<ul>
<li>
<p><a href=https://docs.nestjs.com/recipes/passport>Passport</a></p>
</li>
<li>
<p><a href=https://docs.nestjs.com/techniques/validation>Validation</a>：Dto 添加参数验证，支持类型自动转换</p>
</li>
<li>
<p><a href=https://docs.nestjs.com/exception-filters>Exception filters</a>：过滤 Exception</p>
</li>
<li>
<p><a href=https://docs.nestjs.com/microservices/grpc>gRPC</a>：通过 grpc 调用 mail microserver。</p>
<ul>
<li>
<p><a href=https://docs.nestjs.com/cli/monorepo#assets>Assets</a>：通过在 nest-cli.json 添加如下配置，自动将 .proto 文件复制到 dist 目录下</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>{
  <span style=color:#e6db74>&#34;compilerOptions&#34;</span><span style=color:#f92672>:</span> {
    <span style=color:#e6db74>&#34;assets&#34;</span><span style=color:#f92672>:</span> [{ <span style=color:#e6db74>&#34;include&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;**/*.proto&#34;</span>, <span style=color:#e6db74>&#34;outDir&#34;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#34;dist/src&#34;</span> }],
    <span style=color:#e6db74>&#34;watchAssets&#34;</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>
  }
}
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://docs.nestjs.com/security/rate-limiting>Rate Limiting</a>：限流</p>
</li>
<li>
<p><a href=https://docs.nestjs.com/guards>Guards</a>：</p>
<ul>
<li>JwtGuard 或者 RoleGuard。</li>
<li>注意 SetMetadata 只作用于特定的请求，不能作用于整个的 controller。</li>
</ul>
</li>
</ul>
</li>
<li><a href=https://docs.nestjs.com/interceptors>Interceptors</a>：用于自定定义返回格式，如 <code>{ code: 1, message: 'ok', data }</code></li>
<li><a href=https://docs.nestjs.com/openapi/introduction>Swagger</a>：
<ul>
<li>自动生成 api 文档，方便测试 api，可替代 postman</li>
<li>使用 DTO 和 <code>@ApiProperty()</code>；如果是可选参数，参考 <a href=https://github.com/nestjs/swagger/issues/30>Automatically detect optional @Query</a>，应该使用 swagger 的 <code>@ApiPropertyOptional()</code> 而非 class-validator 的 <code>@IsOptional()</code></li>
<li><a href=https://docs.nestjs.com/openapi/security#bearer-authentication>Bearer authentication</a>：在 swagger 中测试需要认证的 api</li>
</ul>
</li>
<li><a href=https://docs.nestjs.com/security/cors>CORS</a>：允许特定域名跨域资源共享，设置在跨域下哪些 headers、methods 可以使用，详细配置查阅 <a href=https://github.com/expressjs/cors#configuration-options>Configuration Options</a></li>
<li><a href=https://docs.nestjs.com/techniques/file-upload>File upload</a>：文件上传。如果包含多个字段，只能用 FileFieldsInterceptor。</li>
</ul>
</li>
<li>
<p><a href=https://denghao.me/index.php/archives/language-detection.html>前端js如何根据文字识别语种？</a></p>
</li>
<li>
<p><a href=https://www.biaodianfu.com/simhash.html>文本内容相似度计算方法：simhash</a></p>
</li>
<li>
<p><a href=https://segmentfault.com/q/1010000005115279>redis可以多key对应一个value吗？</a>：以手机号可以直接查询用户数据（mobile->hash），如使用身份证的话，先找出对应的手机号（id->mobile），再根据手机号取hash数据；</p>
</li>
</ul>
</li>
<li>
<p>Prisma：<a href=https://github.com/prisma/prisma/issues/10771#issuecomment-998185822>The table (not available) does not exist in the current database</a>：执行package.json中如下命令</p>
<ul>
<li><a href=https://www.prisma.io/docs/concepts/components/prisma-client/working-with-prismaclient/generating-prisma-client>Generating the client</a>：在本地生成 <code>node_modules/.prisma/client</code></li>
<li><a href=https://www.prisma.io/docs/concepts/components/prisma-migrate/db-push>Prototype your schema</a>：会创建、修改相应的数据库（危险）</li>
</ul>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#e6db74>&#34;generate&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#e6db74>&#34;prisma format &amp;&amp; prisma generate&#34;</span><span style=color:#960050;background-color:#1e0010>,</span>
<span style=color:#e6db74>&#34;dbpush&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#e6db74>&#34;yarn generate &amp;&amp; prisma db push&#34;</span>
</code></pre></div></li>
</ul>
<h2 id=20230413>20230413<a hidden class=anchor aria-hidden=true href=#20230413>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>后续技术组的所有docker文件，都加上log的最大限制</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>logging</span>:
  <span style=color:#f92672>options</span>:
    <span style=color:#f92672>max-size</span>: <span style=color:#ae81ff>10m </span>
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230412>20230412<a hidden class=anchor aria-hidden=true href=#20230412>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://www.freecodecamp.org/chinese/news/how-to-flush-dns-on-mac-macos-clear-dns-cache/>清除 Mac DNS 缓存</a>：<code>sudo dscacheutil -flushcache; sudo killall -HUP mDNSResponder</code></p>
</li>
<li>
<p>lark 基于现有表格建立新表格：右键表格tab栏，选择 dulicate，然后在新表格中最左侧勾选选择全部checkbox，删除即可。</p>
</li>
<li>
<p>多语言不能存储在 state 中，否则更新不及时，如果要为多语言文本设置相关状态，可以用数组下标来对应</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>prompts</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>usePrompts</span>() <span style=color:#75715e>// 多语言内容
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>initSelectedPrompts</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>prompts</span>.<span style=color:#a6e22e>map</span>(() =&gt; ({ <span style=color:#a6e22e>selected</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span> })) <span style=color:#75715e>// 对应的状态
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>selectedPrompts</span>, <span style=color:#a6e22e>setSelectedPrompts</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#a6e22e>initSelectedPrompts</span>) <span style=color:#75715e>// 对应的状态用于 state
</span><span style=color:#75715e></span>
<span style=color:#a6e22e>selectedPrompts</span>
  .<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>item</span>, <span style=color:#a6e22e>index</span>) =&gt; ({ <span style=color:#a6e22e>prompt</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>prompts</span>[<span style=color:#a6e22e>index</span>], <span style=color:#a6e22e>selected</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>selected</span> }))
  .<span style=color:#a6e22e>filter</span>((<span style=color:#a6e22e>item</span>) =&gt; <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>selected</span>)
  .<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>item</span>) =&gt; <span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>prompt</span>)
  .<span style=color:#a6e22e>join</span>(<span style=color:#e6db74>&#39;, &#39;</span>) <span style=color:#75715e>// 处理
</span></code></pre></div></li>
<li>
<p><a href=https://juejin.cn/post/6844904196383195144>138 张图带你 MySQL 入门</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230411>20230411<a hidden class=anchor aria-hidden=true href=#20230411>#</a></h2>
<ul>
<li>任务
<ul>
<li><input checked disabled type=checkbox> 看接口实现
<ul>
<li>RabbitMQ
<ul>
<li><a href=https://developer.aliyun.com/article/769883>超详细的RabbitMQ入门，看这篇就够了！</a></li>
<li><a href=https://github.com/Vibing/node-rabbitmq-demo>nodejs使用rabbitmq示例</a></li>
</ul>
</li>
<li>Redis
<ul>
<li><a href=https://developer.aliyun.com/article/942317>Redis入门，这一篇就够了</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>经验
<ul>
<li>chatfo-mail
<ul>
<li>用于发送验证码，没有自建邮件服务器，而是使用 <a href=https://www.mailgun.com>Mailgun</a>，可通过 post 或 grpc 调用。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230410>20230410<a hidden class=anchor aria-hidden=true href=#20230410>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://juejin.cn/post/6856574401408679944>多种方式实现前端图片下载</a></li>
</ul>
</li>
</ul>
<h2 id=20230407>20230407<a hidden class=anchor aria-hidden=true href=#20230407>#</a></h2>
<ul>
<li>任务
<ul>
<li><input checked disabled type=checkbox> <a href=work/SEO.md>chatfo SEO</a>：
<ul>
<li>
<p>参考 FreeFrom 及如下文章做 SEO（只考虑技术性 SEO）</p>
<ul>
<li>
<p><a href=https://juejin.cn/post/6844903907898966023>Next.js SEO相关知识总结</a></p>
</li>
<li>
<p><a href=https://meishizaolunzi.com/zh-Hant/nextjs-seo-settings/>網站 SEO 優化</a></p>
<ul>
<li><a href=https://github.com/garmeeh/next-seo>next-seo</a>：实现 Meta 标签内容多语言关键点——NextSEO 和 DefaultSEO 類似，這裡提供的信息可以覆蓋掉 DefaultSEO 內相同種類的結果。</li>
<li><a href=https://zhuanlan.zhihu.com/p/36072541>什么是 Open Graph 标签？不懂你还做什么社交营销优化？</a>
<ul>
<li><a href=https://www.opengraph.xyz/>Preview and Generate Open Graph Meta Tags</a></li>
</ul>
</li>
<li><a href=https://z3388638.medium.com/%E4%BD%BF%E7%94%A8-json-ld-%E8%99%95%E7%90%86-seo-%E4%B8%A6%E8%AE%93-google-%E9%87%9D%E5%B0%8D%E4%B8%8D%E5%90%8C%E5%BD%A2%E5%BC%8F%E7%B6%B2%E7%AB%99%E5%81%9A%E7%8D%A8%E7%89%B9%E7%9A%84%E6%90%9C%E5%B0%8B%E7%B5%90%E6%9E%9C%E5%91%88%E7%8F%BE-9c74783c017a>使用 JSON-LD 處理 SEO</a>
<ul>
<li><a href=https://json-ld.org>JSON for Linking Data</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://lwlgo.com/article/23>NEXTJS添加 Google Analytics</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Script</span>
    <span style=color:#a6e22e>strategy</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;afterInteractive&#34;</span>
    <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span>{<span style=color:#e6db74>`https://www.googletagmanager.com/gtag/js?id=</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>GOOGLE_ANALYTICS_TRACKING_ID</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>}
<span style=color:#960050;background-color:#1e0010>/&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Script</span>
    <span style=color:#a6e22e>id</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;gtag-init&#34;</span>
    <span style=color:#a6e22e>strategy</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;afterInteractive&#34;</span>
    <span style=color:#a6e22e>dangerouslySetInnerHTML</span><span style=color:#f92672>=</span>{{
    <span style=color:#a6e22e>__html</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`
</span><span style=color:#e6db74>        window.dataLayer = window.dataLayer || [];
</span><span style=color:#e6db74>        function gtag(){dataLayer.push(arguments);}
</span><span style=color:#e6db74>        gtag(&#39;js&#39;, new Date());
</span><span style=color:#e6db74>        gtag(&#39;config&#39;, &#39;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>GOOGLE_ANALYTICS_TRACKING_ID</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#39;, {
</span><span style=color:#e6db74>        page_path: window.location.pathname,
</span><span style=color:#e6db74>        });
</span><span style=color:#e6db74>    `</span>,
    }}
<span style=color:#960050;background-color:#1e0010>/&gt;</span>
</code></pre></div></li>
<li>
<p>提交 sitemap.xml & robots.txt</p>
<ul>
<li>
<p><a href=https://www.guohuawei.com/archives/these-things-need-to-know-when-generate-sitemap-for-website.html>为站点生成 sitemap 要注意这 4 件事</a></p>
</li>
<li>
<p><a href=https://developers.google.com/search/docs/crawling-indexing/robots/robots_txt>Google 如何解读 robots.txt 规范</a></p>
</li>
<li>
<p><a href=https://www.npmjs.com/package/next-sitemap>next-sitemap</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>siteUrl</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>NEXT_PUBLIC_WEB_API_DOMAIN</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;http://localhost:3000&#39;</span>

<span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
  <span style=color:#a6e22e>siteUrl</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>siteUrl</span>,
  <span style=color:#a6e22e>priority</span><span style=color:#f92672>:</span> <span style=color:#ae81ff>1.0</span>,
  <span style=color:#a6e22e>alternateRefs</span><span style=color:#f92672>:</span> [
    {
      <span style=color:#a6e22e>href</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>siteUrl</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/en`</span>,
      <span style=color:#a6e22e>hreflang</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;en&#39;</span>,
    },
    {
      <span style=color:#a6e22e>href</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>siteUrl</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/ja`</span>,
      <span style=color:#a6e22e>hreflang</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ja&#39;</span>,
    },
    {
      <span style=color:#a6e22e>href</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>siteUrl</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/zh_CN`</span>,
      <span style=color:#a6e22e>hreflang</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;zh-CN&#39;</span>,
    },
    {
      <span style=color:#a6e22e>href</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>siteUrl</span><span style=color:#e6db74>}</span><span style=color:#e6db74>/zh_TW`</span>,
      <span style=color:#a6e22e>hreflang</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;zh-TW&#39;</span>,
    },
    {
      <span style=color:#a6e22e>href</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>siteUrl</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>,
      <span style=color:#a6e22e>hreflang</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;x-default&#39;</span>,
    },
  ],
  <span style=color:#a6e22e>generateIndexSitemap</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span>,
  <span style=color:#a6e22e>generateRobotsTxt</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>,
  <span style=color:#a6e22e>robotsTxtOptions</span><span style=color:#f92672>:</span> {
    <span style=color:#a6e22e>policies</span><span style=color:#f92672>:</span> [
      {
        <span style=color:#a6e22e>userAgent</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;*&#39;</span>,
        <span style=color:#a6e22e>allow</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/&#39;</span>,
        <span style=color:#a6e22e>disallow</span><span style=color:#f92672>:</span> [<span style=color:#e6db74>&#39;/*.js&#39;</span>, <span style=color:#e6db74>&#39;/*?*&#39;</span>],
      },
      ],
    },
  }

</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p>了解 SEO：</p>
<ul>
<li><a href=https://ahrefs.com/zh/seo>The Beginner’s Guide to SEO</a></li>
<li><a href="https://developers.google.com/search/docs/fundamentals/seo-starter-guide?hl=zh-cn">搜索引擎优化 (SEO) 新手指南</a></li>
<li><a href=https://www.dragonmetrics.cn/baidu-seo-guide/>百度搜索引擎优化指南</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>经验
<ul>
<li>
<p><a href=https://stackoverflow.com/a/62000172>Error response from daemon: conflict: unable to delete &mldr; (must be forced)</a>: Both images have the same IMAGE ID. You can remove the image by its name instead of its ID</p>
</li>
<li>
<p>node 的环境变量写在 .env 文件中而非 docker-compose.yaml 中，万一构建失败，就可以使用原来的镜像，而不需要添加环境变量了。</p>
</li>
<li>
<p><a href=https://github.com/prisma/prisma/issues/11583>EACCES: permission denied, unlink &lsquo;/app/node_modules/.prisma/client/index.js&rsquo;</a>：原因在于混合使用 npm 与 yarn，全部使用 yarn 即可解决。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># RUN npm i -g @nestjs/cli</span>
RUN yarn global add @nestjs/cli
<span style=color:#75715e>#RUN npx prisma generate</span>
RUN yarn generate
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230406>20230406<a hidden class=anchor aria-hidden=true href=#20230406>#</a></h2>
<ul>
<li>任务
<ul>
<li><input checked disabled type=checkbox> 帮忙迁移服务器：整体参考<a href=https://www.51cto.com/article/650560.html>Docker容器迁移到其他服务器的5种方法</a>
<ul>
<li>
<p>一个一个地备份：用 docker commit、save 备份运行中的容器，参考<a href=https://zhuanlan.zhihu.com/p/152219012>docker：export/save/commit谁才是你心中那个她</a>；然后备份相应的 volume，参考<a href=https://www.quanxiaoha.com/docker/docker-volume-backup.html>Docker 使用数据卷容器备份、恢复、迁移数据卷</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 备份容器</span>
docker commit container-hash image-name
docker save image-hash &gt; image-name.tar

<span style=color:#75715e># 恢复容器</span>
cat image-name.tar | docker load 

<span style=color:#75715e># 备份数据卷</span>
docker run --volumes-from volume-name -v <span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span>:/backup image-name tar cvf /backup/backup.tar /volume-moutpoint

<span style=color:#75715e># 恢复数据卷</span>
docker run -v /volume-moutpoint --name volume-name image-name /bin/bash <span style=color:#75715e># 创建一个空数据卷</span>
docker run --volumes-from volume-name -v <span style=color:#66d9ef>$(</span>pwd<span style=color:#66d9ef>)</span>:/backup busybox tar xvf /backup/backup.tar
</code></pre></div></li>
<li>
<p><a href=https://cloud.tencent.com/developer/article/2020334>迁移整个 /var/lib/docker</a>：</p>
<ul>
<li>stat /var/lib/docker/overlay2/f7e0: no such file or directory：与镜像层有关，删除对应的容器与镜像</li>
<li>failed to create rwlayer：docker 残留影响的，执行一下 docker 清理 <code>docker system prune</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>经验
<ul>
<li>
<p><a href=https://www.simplified.guide/ssh/copy-public-key>How to copy an SSH public key to a server</a>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 生成密钥对</span>
ssh-keygen -t rsa -C <span style=color:#e6db74>&#34;ubuntu@test&#34;</span>

<span style=color:#75715e># 拷贝公钥</span>
<span style=color:#75715e>## 方法一</span>
ssh-copy-id -i ~/.ssh/other_key.pub user@remote-host
<span style=color:#75715e>## 方法二</span>
cat ~/.ssh/id_rsa.pub | ssh user@remote-host <span style=color:#e6db74>&#39;cat &gt;&gt; ~/.ssh/authorized_keys&#39;</span> 
</code></pre></div></li>
<li>
<p><a href=https://unix.stackexchange.com/a/727500><code>sudo sshd -T</code></a> 输出有效 sshd_config 配置</p>
</li>
<li>
<p><a href=https://serverfault.com/a/424659>Is a central location for authorized_keys a good idea?</a>: Simply set up the sshd_config file like this: <code>AuthorizedKeysFile /etc/ssh/authorized_keys/%u</code></p>
</li>
<li>
<p><a href=https://blog.csdn.net/alibert/article/details/54800037>Linux ps 命令查看进程启动及运行时间</a>：<code>ps -eo pid,lstart,etime |grep pid</code></p>
</li>
<li>
<p><a href=https://www.jianshu.com/p/afd657191142>top命令之TIME+</a>：指的进程所使用的CPU时间，不是进程启动到现在的时间</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230405>20230405<a hidden class=anchor aria-hidden=true href=#20230405>#</a></h2>
<ul>
<li>经验
<ul>
<li><a href=https://www.zhihu.com/question/264370798>后端开发除了增删改查还有什么？</a>：使用某种技术的目的，是为了解决问题、满足需求。对于平凡公司的平凡工人，我觉得提升自我的一个方法就是自己创造需求，只有喜欢钻研折腾的人，才能深挖技术。关键是你要有兴趣，去做了，才会遇到问题，去查了，才会学习成长。</li>
<li><a href=https://juejin.cn/post/7211358106629750841>重学 TS</a></li>
<li>一个项目并不是独立的，而是各种库、框架有机结合而成的。项目学习法，是以解决某个问题、满足某个需求为导向的，而不是以学会某个库、框架为导向的。因此，项目学习法，首先是去看能解决该问题、满足该需求的现有的项目；其次，是使其运行起来，有个直观感受；然后在阅读代码过程中，不断去学习相关的知识，使自己能够读懂代码；最后是，动手写一写代码，使其满足自己的具体需求、解决具体问题。（纯粹地阅读学习效果很不好，不仅没有学会、用不起来，而且还很容易枯燥，导致削减了学习兴趣，打击了学习热情）</li>
<li>独立博客：<a href=https://jspang.com/>JSPang</a>，技术胖</li>
<li><a href=https://zhuanlan.zhihu.com/p/110007033>二十行代码，搞懂 Observable</a></li>
<li><a href=https://stackoverflow.com/a/19274215>How do you grep a file and get the next 5 lines</a>: <code>grep -A 5 '19:55' file</code></li>
<li><a href=https://stackoverflow.com/a/7147320>Hard reset of a single file</a>:
<ul>
<li><code>git checkout HEAD -- my-file.txt</code></li>
<li>The special &ldquo;option&rdquo; &ndash; means &ldquo;treat every argument after this point as a file name, no matter what it looks like.&rdquo; This is not Git-specific, it&rsquo;s a general Unix command line convention. e.g. <code>rm -- -f</code> deletes a file named &ldquo;-f&rdquo;.<a href=https://stackoverflow.com/a/6561160>ref</a></li>
<li><a href=https://juejin.cn/post/6978436693485420575>06.Git从放弃到入门： 命令checkout图解</a>: <code>git checkout -- ./</code> 回滚整个项目到最近一次的暂存或提交状态。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230404>20230404<a hidden class=anchor aria-hidden=true href=#20230404>#</a></h2>
<ul>
<li>任务
<ul>
<li><input checked disabled type=checkbox> 解决 chatfo 头像缩略图：公司使用 node:16 作为基础 docker 镜像，要求在该 docker 中可以方便使用的方案。
<ul>
<li><a href=https://www.npmjs.com/package/webp-converter>webp-converter</a>
<ul>
<li>优点：自带 precompiled executables of WebP，无需额外 linux 包</li>
<li>缺点：只能压缩图片大小（KB），而非缩小图片尺寸（200x200）</li>
<li>替代：
<ul>
<li>
<p>可以更改尺寸的 <a href=https://github.com/jimp-dev/jimp>Jimp</a>，使用纯 JS 实现。</p>
<ul>
<li>
<p><a href=https://stackoverflow.com/a/60709994>How convert jimp object to image buffer in node?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>Jimp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>require</span>(<span style=color:#e6db74>&#39;jimp&#39;</span>);

<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Jimp</span>.<span style=color:#a6e22e>read</span>(<span style=color:#e6db74>&#39;img.png&#39;</span>);

<span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>getBuffer</span>(<span style=color:#a6e22e>Jimp</span>.<span style=color:#a6e22e>MIME_PNG</span>, (<span style=color:#a6e22e>err</span>, <span style=color:#a6e22e>buffer</span>) =&gt; {
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>buffer</span>);
});
</code></pre></div></li>
<li>
<p><a href=https://github.com/jimp-dev/jimp/issues/153>maxMemoryUsageInMB limit exceeded by at least 217MB</a>：使用的时候遇到这个问题，还未解决，<strong>巨坑</strong>。</p>
</li>
</ul>
</li>
<li>
<p>压缩大小的 <a href=https://github.com/GoogleChromeLabs/squoosh>Squoosh!</a>/<a href=https://github.com/imagemin/imagemin>imagemin</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li><a href=https://www.npmjs.com/package/gm>gm</a>：参考<a href=https://juejin.cn/post/6865262565288198158>nodejs使用graphicsmagick生成缩略图</a>
<ul>
<li>优点：使用业界知名的处理库，功能比较全</li>
<li>缺点：额外依赖 linux 包 ImageMagick 或 GraphicsMagick</li>
<li>替代：
<ul>
<li>
<p>同样知名的 <a href=https://github.com/lovell/sharp><strong>sharp</strong></a> ，自带编译好了的 libvips，next.js 同样推荐使用 <a href=https://nextjs.org/docs/messages/sharp-missing-in-production>Sharp Missing In Production</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>let</span> <span style=color:#a6e22e>useThumb</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>thumbPrefer</span>
<span style=color:#66d9ef>let</span> <span style=color:#a6e22e>thumbUrl</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;&#39;</span>
<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>thumbPrefer</span>) {
  <span style=color:#66d9ef>try</span> {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>thumbFile</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>path</span>.<span style=color:#a6e22e>join</span>(<span style=color:#a6e22e>uploadPath</span>, <span style=color:#e6db74>`</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>fileNameWithoutExt</span><span style=color:#e6db74>}</span><span style=color:#e6db74>_thumb.</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>ext</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>img</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>sharp</span>(<span style=color:#a6e22e>fileFullPath</span>)
    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>width</span>, <span style=color:#a6e22e>height</span> } <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>metadata</span>()
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>thumbSize</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>this</span>.<span style=color:#a6e22e>configService</span>.<span style=color:#a6e22e>get</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>number</span><span style=color:#f92672>&gt;</span>(<span style=color:#e6db74>&#39;upload.thumbSize&#39;</span>)
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>thumbSize</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>height</span> <span style=color:#f92672>&gt;</span> <span style=color:#a6e22e>thumbSize</span>) {
      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>height</span>) {
        <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>resize</span>({ <span style=color:#a6e22e>width</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>thumbSize</span> }).<span style=color:#a6e22e>toFile</span>(<span style=color:#a6e22e>thumbFile</span>)
      } <span style=color:#66d9ef>else</span> {
        <span style=color:#66d9ef>await</span> <span style=color:#a6e22e>img</span>.<span style=color:#a6e22e>resize</span>({ <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>thumbSize</span> }).<span style=color:#a6e22e>toFile</span>(<span style=color:#a6e22e>thumbFile</span>)
      }
    } <span style=color:#66d9ef>else</span> {
      <span style=color:#a6e22e>useThumb</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>false</span>
    }
    <span style=color:#a6e22e>thumbUrl</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>URL</span>(<span style=color:#a6e22e>thumbFile</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#a6e22e>uploadConfig</span>.<span style=color:#a6e22e>rootPath</span>, <span style=color:#e6db74>&#39;&#39;</span>), <span style=color:#a6e22e>uploadConfig</span>.<span style=color:#a6e22e>staticUrl</span>).<span style=color:#a6e22e>href</span>
  } <span style=color:#66d9ef>catch</span> (<span style=color:#a6e22e>e</span>) {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;Sharp: &#39;</span>, <span style=color:#a6e22e>e</span>)
  }
}
</code></pre></div></li>
<li>
<p><a href=https://github.com/Automattic/node-canvas>node-canvas</a>canvas 也可以生成缩略图</p>
</li>
</ul>
</li>
</ul>
</li>
<li><a href=https://github.com/h2non/imaginary>imaginary</a>: image processing microservice。
<ul>
<li>优点：本身是微服务，还有 <a href=https://github.com/h2non/node-imaginary>node-imaginary</a> 作为 client 搭配使用。</li>
<li>替代：<a href=https://github.com/yanue/nginx-lua-GraphicsMagick>nginx-lua-GraphicsMagick</a>，这个就很复杂了。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>经验
<ul>
<li><a href=https://juejin.cn/post/7215153930472996925>VisBug：助力前端开发的浏览器插件</a></li>
<li>gRPC：
<ul>
<li>首先了解 gRPC 是什么：[gRPC初探——概念介绍以及如何构建一个简单的gRPC服务](<a href=https://www.cnblogs.com/takumicx/p/10059448.html%EF%BC%89>https://www.cnblogs.com/takumicx/p/10059448.html）</a></li>
<li>然后了解怎么在 node 中使用 gRPC：<a href=https://juejin.cn/post/6972430337548746766>开发基于 gRPC 协议的 Node 服务</a></li>
<li>最后把项目运行起来，使之可以用 bloomRPC 测试：[gRpc接口调试工具BloomRpc](<a href=https://juejin.cn/post/7129414359419191303%EF%BC%89>https://juejin.cn/post/7129414359419191303）</a></li>
</ul>
</li>
<li>Prisma
<ul>
<li><a href=http://www.ruanyifeng.com/blog/2019/02/orm-tutorial.html>ORM 实例教程</a></li>
<li><a href=https://www.cnblogs.com/cangqinglang/p/15419469.html>精读《Prisma 的使用》</a></li>
<li><a href=https://stackoverflow.com/a/67796697>Environment variable not found: DATABASE_URL.</a>
<ol>
<li>
<p>add <code>.env</code> file</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#a6e22e>DATABASE_URL</span><span style=color:#f92672>=</span><span style=color:#e6db74>mysql://root:0xAGroupu7e3@10.2.0.2:6306/chatfo-chatbot</span>
<span style=color:#a6e22e>GRPC_CHATBOT</span><span style=color:#f92672>=</span><span style=color:#e6db74>10.2.0.2:51151</span>
<span style=color:#a6e22e>GRPC_MAIL</span><span style=color:#f92672>=</span><span style=color:#e6db74>10.2.0.2:51052</span>
<span style=color:#a6e22e>REDIS_NODE1_HOST</span><span style=color:#f92672>=</span><span style=color:#e6db74>10.2.0.2</span>
<span style=color:#a6e22e>REDIS_NODE1_PORT</span><span style=color:#f92672>=</span><span style=color:#e6db74>7001</span>
<span style=color:#a6e22e>REDIS_NODE2_HOST</span><span style=color:#f92672>=</span><span style=color:#e6db74>10.2.0.2</span>
<span style=color:#a6e22e>REDIS_NODE2_PORT</span><span style=color:#f92672>=</span><span style=color:#e6db74>7002</span>
<span style=color:#a6e22e>REDIS_NODE3_HOST</span><span style=color:#f92672>=</span><span style=color:#e6db74>10.2.0.2</span>
<span style=color:#a6e22e>REDIS_NODE3_PORT</span><span style=color:#f92672>=</span><span style=color:#e6db74>7003</span>
<span style=color:#a6e22e>STATIC_URL</span><span style=color:#f92672>=</span><span style=color:#e6db74>https://teststatic.chatfo.ai</span>
<span style=color:#a6e22e>URL</span><span style=color:#f92672>=</span><span style=color:#e6db74>http://10.2.0.2:9188</span>
</code></pre></div></li>
<li>
<p>run <code>yarn generate</code></p>
</li>
</ol>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230403>20230403<a hidden class=anchor aria-hidden=true href=#20230403>#</a></h2>
<ul>
<li>
<p>经验</p>
<ul>
<li>
<p>前端组件讲究复用，但 api 讲究调用次数越少越好，能一次返回就一次性返回。</p>
</li>
<li>
<p><a href=https://developer.school/snippets/react/localstorage-is-not-defined-nextjs>How to Fix &ldquo;localStorage is not defined&rdquo; in Next.js</a>: Next.js performs a server render before the client render.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>if</span> (<span style=color:#66d9ef>typeof</span> window <span style=color:#f92672>!==</span> <span style=color:#e6db74>&#39;undefined&#39;</span>) {
  <span style=color:#75715e>// Perform localStorage action
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>item</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>localStorage</span>.<span style=color:#a6e22e>getItem</span>(<span style=color:#e6db74>&#39;key&#39;</span>)
}
</code></pre></div></li>
<li>
<p><a href=https://segmentfault.com/a/1190000022235530>你真的知道 Cookie 吗？ SameSite 、 Secure 、 HttpOnly</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/69198602>&mldr;expression of type string cannot be used to index&mldr;</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>someObj</span><span style=color:#f92672>:</span><span style=color:#a6e22e>ObjectType</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>data</span>;
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>field</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;username&#39;</span>;

<span style=color:#75715e>// This gives an error
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>someObj</span>[<span style=color:#a6e22e>field</span>];

<span style=color:#75715e>// Solution 1: When the type of the object is known
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>someObj</span>[<span style=color:#a6e22e>field</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>keyof</span> <span style=color:#a6e22e>ObjectType</span>]

<span style=color:#75715e>// Solution 2: When the type of the object is not known
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>temp</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>someObj</span>[<span style=color:#a6e22e>field</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>keyof</span> <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>someObj</span>]
</code></pre></div></li>
<li>
<p><a href=https://www.cnblogs.com/morango/p/15185442.html>js判断当前系统语言、浏览器语言</a>：</p>
<ul>
<li>
<p>需求是：</p>
<ul>
<li>分享的时候，根据 url 链接中语言参数来选择语言；（通过 router.locale 来判断）</li>
<li>初次使用自动加载浏览器默认语言；可以通过语言选择按钮切换语言。（通过 cookie 来判断）</li>
<li>总结：路由中的 locale > cookie 中的语言选择 > 浏览器语言偏好 > 默认英文</li>
</ul>
</li>
<li>
<p>解决方案：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>useEffect</span>(() =&gt; {
  <span style=color:#66d9ef>async</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>load</span>(<span style=color:#a6e22e>locale</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) {
    <span style=color:#75715e>// @ts-ignore TYPE NEEDS FIXING
</span><span style=color:#75715e></span>    <span style=color:#a6e22e>i18n</span>.<span style=color:#a6e22e>loadLocaleData</span>(<span style=color:#a6e22e>locale</span>, { <span style=color:#a6e22e>plurals</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>plurals</span>[<span style=color:#a6e22e>locale</span>.<span style=color:#a6e22e>split</span>[<span style=color:#e6db74>&#39;_&#39;</span>](<span style=color:#ae81ff>0</span>)] })

    <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>messages</span> } <span style=color:#f92672>=</span> <span style=color:#66d9ef>await</span> <span style=color:#66d9ef>import</span>(<span style=color:#e6db74>`@lingui/loader!./../../locales/</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>locale</span><span style=color:#e6db74>}</span><span style=color:#e6db74>.json?raw-lingui`</span>)
    <span style=color:#a6e22e>i18n</span>.<span style=color:#a6e22e>load</span>(<span style=color:#a6e22e>locale</span>, <span style=color:#a6e22e>messages</span>)
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>locale</span>)
    <span style=color:#a6e22e>i18n</span>.<span style=color:#a6e22e>activate</span>(<span style=color:#a6e22e>locale</span>)
  }

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>LANG_TO_LANG</span> <span style=color:#f92672>=</span> {
    <span style=color:#e6db74>&#39;zh-CN&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;zh_CN&#39;</span>,
    <span style=color:#e6db74>&#39;zh-TW&#39;</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;zh_TW&#39;</span>,
    <span style=color:#a6e22e>ja</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;ja&#39;</span>,
  }

  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>defaultLanguage</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>LANG_TO_LANG</span>[<span style=color:#a6e22e>navigator</span>.<span style=color:#a6e22e>language</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>keyof</span> <span style=color:#66d9ef>typeof</span> <span style=color:#a6e22e>LANG_TO_LANG</span>]

  <span style=color:#75715e>// 路由中的 locale 参数
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>locale</span>) {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>localeCache</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>Cookies</span>.<span style=color:#a6e22e>get</span>(<span style=color:#e6db74>&#39;NEXT_LOCALE&#39;</span>)
    <span style=color:#66d9ef>if</span> (Object.<span style=color:#a6e22e>values</span>(<span style=color:#a6e22e>LANG_TO_LANG</span>).<span style=color:#a6e22e>includes</span>(<span style=color:#a6e22e>locale</span>)) {
      <span style=color:#66d9ef>if</span> (<span style=color:#f92672>!</span><span style=color:#a6e22e>localeCache</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>localeCache</span> <span style=color:#f92672>!==</span> <span style=color:#a6e22e>locale</span>) {
        <span style=color:#a6e22e>Cookies</span>.<span style=color:#a6e22e>set</span>(<span style=color:#e6db74>&#39;NEXT_LOCALE&#39;</span>, <span style=color:#a6e22e>locale</span>, {
          <span style=color:#a6e22e>sameSite</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;lax&#39;</span>,
        })
      }
      <span style=color:#a6e22e>load</span>(<span style=color:#a6e22e>locale</span>)
    } <span style=color:#66d9ef>else</span> {
      <span style=color:#75715e>// cookie 中的 locale 设定
</span><span style=color:#75715e></span>      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>localeCache</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;en&#39;</span>) {
        <span style=color:#a6e22e>load</span>(<span style=color:#e6db74>&#39;en&#39;</span>)
      } <span style=color:#66d9ef>else</span> {
        <span style=color:#75715e>// 浏览器中的语言偏好
</span><span style=color:#75715e></span>        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>defaultLanguage</span>) {
          <span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>replace</span>(<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>asPath</span>, <span style=color:#66d9ef>undefined</span>, { <span style=color:#a6e22e>locale</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>defaultLanguage</span> })
        } <span style=color:#66d9ef>else</span> {
          <span style=color:#75715e>// 默认语言
</span><span style=color:#75715e></span>          <span style=color:#a6e22e>load</span>(<span style=color:#e6db74>&#39;en&#39;</span>)
        }
      }
    }
  } <span style=color:#66d9ef>else</span> {
    <span style=color:#a6e22e>load</span>(<span style=color:#e6db74>&#39;en&#39;</span>)
  }
}, [<span style=color:#a6e22e>locale</span>, <span style=color:#a6e22e>router</span>])
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://www.npmjs.com/package/js-cookie>js-cookie</a>: A simple, lightweight JavaScript API for handling cookies</p>
</li>
</ul>
<h2 id=20230401>20230401<a hidden class=anchor aria-hidden=true href=#20230401>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://stackoverflow.com/a/67886607>使用 next/image 的理由</a></p>
<ul>
<li>自动优化图片的格式、大小</li>
<li>延迟（lazy）加载</li>
<li>利于 Google 搜索的 SEO</li>
</ul>
</li>
<li>
<p><a href=https://blog.csdn.net/zhangvalue/article/details/99641505>Mac中Chrome全屏模式工具栏和书签栏消失如何解决</a></p>
<ul>
<li>shift+command+f</li>
<li>在视图中勾“选在全屏模式下始终显示工具栏”</li>
</ul>
</li>
<li>
<p><a href=https://blog.csdn.net/genius_yym/article/details/81508654>Mac 固定窗口顺序方法</a>：点击左上角的小苹果=>选择系统偏好设置=>选择调度中心=>进入调度中心界面（Mission Control），去掉“根据最近使用情况自动重新排列空间”选项即可。</p>
</li>
<li>
<p><a href=https://swr.vercel.app>useSWR 文档</a>：useSWR 适合 Get 方法获取数据，不适合 post 调用传输数据，因为其要写在顶层，不能写在回调函数之中。</p>
<ul>
<li><a href=https://swr.bootcss.com/docs/pagination#%E8%BF%94%E5%9B%9E%E5%80%BC>分页 useSWRInfinite</a>：<a href=https://swr.vercel.app/docs/pagination#global-mutate-with-useswrinfinite>Global Mutate with useSWRInfinite</a>，使用时需注意 getKey 函数的 <code>if (previousPageData && !previousPageData.length) return null</code> 行，因为不同接口放回的数据不一样，比如 previousPageData 不是数组，previousPageData.data 是数组，导致调用失败。</li>
<li><a href=https://swr.bootcss.com/docs/advanced/understanding>理解 SWR</a>
<ul>
<li><a href=https://swr.bootcss.com/docs/advanced/understanding#%E7%BB%93%E5%90%88-isloading-%E5%92%8C-isvalidating-%E4%BB%A5%E8%8E%B7%E5%BE%97%E6%9B%B4%E5%A5%BD%E7%9A%84%E7%94%A8%E6%88%B7%E4%BD%93%E9%AA%8C>isLoading 和 isValidating</a>
<ul>
<li>无论数据是否已加载，只要有一个正在进行中的请求，isValidating 都会变为 true 。</li>
<li>当数据尚未加载并且有一个正在进行的请求时，isLoading 会变为 true 。</li>
</ul>
</li>
</ul>
</li>
<li><a href=https://www.jianshu.com/p/ca38ba9ac30e>基于SWR的应用与实践</a></li>
<li>用 useSWR 实现轮询(Polling)，这种方式比使用 setInterval 来手写轮询要简单得多得多啊！
<ul>
<li>
<p>函数方式</p>
<ul>
<li><a href="https://codesandbox.io/s/swr-polling-m1jyrs?file=/src/use-polling.ts">swr-polling</a></li>
<li><a href=https://stackoverflow.com/a/75084207>useSWR successfully fetches , but data returns undefined</a>：要直接返回 axios 的 res，但是项目用了 interceptors 处理</li>
</ul>
</li>
<li>
<p>整数方式</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>useImage</span>(<span style=color:#a6e22e>aid</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>) {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>refreshInterval</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>(<span style=color:#ae81ff>100</span>)
  <span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>error</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useSWR</span>(<span style=color:#a6e22e>image</span>(<span style=color:#a6e22e>aid</span>), <span style=color:#a6e22e>getImage</span>, {
    <span style=color:#a6e22e>refreshInterval</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>refreshInterval</span>.<span style=color:#a6e22e>current</span>,
    <span style=color:#a6e22e>onSuccess</span><span style=color:#f92672>:</span> (<span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>key</span>, <span style=color:#a6e22e>config</span>) =&gt; {
      <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>data</span>) {
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>data</span>.<span style=color:#a6e22e>image</span> <span style=color:#f92672>===</span> <span style=color:#e6db74>&#39;&#39;</span>) {
          <span style=color:#a6e22e>refreshInterval</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>100</span>
        } <span style=color:#66d9ef>else</span> {
          <span style=color:#a6e22e>refreshInterval</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span>
        }
      }
    },
  })
  <span style=color:#66d9ef>return</span> { <span style=color:#a6e22e>data</span>, <span style=color:#a6e22e>error</span> }
}
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://juejin.cn/post/7126544229370691592>上拉加载和下拉刷新是什么，如何实现，一文看懂</a></p>
</li>
<li>
<p><a href=https://github.com/vercel/next.js/discussions/36723>Prevent back navigation out of the app and redirect to home page instead.</a>：如果直接通过 URL 访问 app 某个页面，后退会跳出 app 到浏览器首页，期望是跳到 app 首页。解决办法是：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>getServerSideProps</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>GetServerSideProps</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>async</span> (<span style=color:#a6e22e>context</span>) =&gt; {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>previousRoute</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>req</span>.<span style=color:#a6e22e>headers</span><span style=color:#f92672>?</span>.<span style=color:#a6e22e>referer</span> <span style=color:#f92672>||</span> <span style=color:#e6db74>&#39;/&#39;</span>
  <span style=color:#66d9ef>return</span> {
    <span style=color:#a6e22e>props</span><span style=color:#f92672>:</span> {
      <span style=color:#a6e22e>previousRoute</span>,
    },
  }
}
</code></pre></div></li>
<li>
<p><a href=https://nextjs.org/learn/basics/dynamic-routes/dynamic-routes-details>Dynamic Router</a> 的 [id] 可以是任意大小的数字，但是实际上并没有那么多的页面，因此，对于超过范围的页面，需要跳到 404。解决办法参考 <a href=https://reacthustle.com/blog/redirect-to-404-nextjs-dynamic-routes>How to Redirect to 404 Page in NextJS When Using Dynamic Routes</a>，在 getServerSideProps 添加如下内容：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>flag</span> <span style=color:#f92672>=</span> Number(<span style=color:#a6e22e>context</span>.<span style=color:#a6e22e>query</span>.<span style=color:#a6e22e>flag</span>)
<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>flag</span>) {
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>flag</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>0</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>flag</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>5</span>) {
    <span style=color:#66d9ef>return</span> {
      <span style=color:#a6e22e>notFound</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>true</span>, <span style=color:#75715e>// 关键部分
</span><span style=color:#75715e></span>    }
  }
}
</code></pre></div></li>
<li>
<p><a href=https://www.zhangxinxu.com/wordpress/2019/07/html-audio-api-guide/>HTML audio基础API完全使用指南</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230331>20230331<a hidden class=anchor aria-hidden=true href=#20230331>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://www.ruanyifeng.com/blog/2021/01/clipboard-api.html>剪贴板操作 Clipboard API 教程</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>await</span> <span style=color:#a6e22e>navigator</span>.<span style=color:#a6e22e>clipboard</span>.<span style=color:#a6e22e>writeText</span>(<span style=color:#e6db74>&#39;Text&#39;</span>);
</code></pre></div></li>
<li>
<p>所有文章链接尽量写进日记中，这样也方便搜索，文件搜的话还是不怎么方便。</p>
</li>
<li>
<p><a href=https://segmentfault.com/a/1190000018959389>可能这些是你想要的H5软键盘兼容方案</a></p>
</li>
<li>
<p><a href=https://linuxhint.com/github-clone-with-oauth-access-token/>GitHub Clone With OAuth Access Token</a>: <code>https://oauth2:&lt;token>@github.com/&lt;Username>/&lt;repository>.git</code>。</p>
</li>
<li>
<p><a href=https://www.zhangxinxu.com/wordpress/2018/10/scroll-behavior-scrollintoview-%E5%B9%B3%E6%BB%91%E6%BB%9A%E5%8A%A8/>CSS scroll-behavior和JS scrollIntoView让页面滚动平滑</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=color:#f92672>scroll-behavior</span><span style=color:#f92672>:</span> <span style=color:#f92672>smooth</span><span style=color:#f92672>;</span>
</code></pre></div></li>
<li>
<p><a href=https://juejin.cn/post/7126544229370691592>上拉加载和下拉刷新是什么，如何实现，一文看懂</a></p>
</li>
<li>
<p><a href=http://rcaj.whfgxx.org.cn:8081/dxbysZn>武汉人才安居</a>：这个可以先申请资格，而不是一申请就需要去租一个房子，而是在需要的、合适的时候用在上面找房子。</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230330>20230330<a hidden class=anchor aria-hidden=true href=#20230330>#</a></h2>
<ul>
<li>任务
<ul>
<li>
<p>在手机上调试（访问 macbook 上开启的 node 服务）</p>
<ul>
<li>手机访问，加 http，因为默认是 https，可能访问不了</li>
<li>打开关闭飞行模式</li>
<li>关闭移动网络</li>
</ul>
</li>
<li>
<p>课堂：</p>
<ul>
<li>
<p>域名 => DNS解析 => IP（服务器）</p>
<ul>
<li>域名（web） => Kong Router (Path 规则 /) => Service (web) => Host:Port</li>
<li>域名（api） => Kong Router (Path 规则 /api/v1) => Service (api) => Host:Port</li>
<li>细节：
<ul>
<li>
<p>Router 通过 Path 规则将不同域名请求分配给对应的 service 处理，而 service 对应实际的服务。</p>
</li>
<li>
<p>主要关注 Service 的 Host 与 Port（容器宿主机 ip 与 port），Router 的 Hosts 与 Paths（域名与 path）</p>
<ul>
<li>Router 需关闭 Strip path（默认开启），作用是将 /api/v1/hello 改为 /hello</li>
<li><a href=https://github.com/pantsel/konga/issues/258#issuecomment-412941960>Unable to add a Route to a Service</a>：不是普通的输入框，输入内容后需按 Enter</li>
</ul>
</li>
<li>
<p>每一个正式发布都需要<a href=https://www.jiyik.com/w/git/git-tag>给源码打一个 tag(v1.0.0)</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 列出标签</span>
git tag
<span style=color:#75715e># 新增本地标签</span>
git tag -a v1.0.0 -m <span style=color:#e6db74>&#34;v1.0.0&#34;</span>
<span style=color:#75715e># 删除本地标签</span>
git tag -d &lt;tag_name&gt;
<span style=color:#75715e># 推送标签到远程</span>
git push origin --tags
<span style=color:#75715e># 列出远程标签</span>
git ls-remote --tags origin
<span style=color:#75715e># 删除远程标签</span>
git push --delete origin tagname
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p>如果 svg 图标显示不全，可以尝试清除 <code>id</code> 属性和 <code>&lt;defs></code> 与 <code>&lt;mask></code> 元素，如果不能删除的考虑修改 <code>id</code> 属性名称，保持不冲突。实在不行，就使用其他图标替代掉。</p>
</li>
<li>
<p>团队合作注意多沟通，编写页面时看看某个部分是否有在多个页面使用，考虑某一个人编写，其他人使用。</p>
</li>
</ul>
</li>
<li>
<p><a href=https://stackoverflow.com/a/15432718>grep display filename before matching line</a>: Try this little trick to coax grep into thinking it is dealing with multiple files, so that it displays the filename</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>grep <span style=color:#e6db74>&#39;pattern&#39;</span> file /dev/null
</code></pre></div></li>
<li>
<p><a href=https://nextjs.org/docs/api-reference/next/image#remote-patterns>&ldquo;url&rdquo; parameter is not allowed next.js</a>：为了保护您的应用程序免受恶意用户的侵害，需要进行配置才能使用外部图像。如果用 domain 的话，就不能指定 pathname，对于在子路径中的图片，可能会报错。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>module</span>.<span style=color:#a6e22e>exports</span> <span style=color:#f92672>=</span> {
  <span style=color:#a6e22e>images</span><span style=color:#f92672>:</span> {
    <span style=color:#a6e22e>remotePatterns</span><span style=color:#f92672>:</span> [
      {
        <span style=color:#a6e22e>protocol</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;https&#39;</span>,
        <span style=color:#a6e22e>hostname</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;example.com&#39;</span>,
        <span style=color:#a6e22e>port</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;&#39;</span>,
        <span style=color:#a6e22e>pathname</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/account123/**&#39;</span>,
      },
    ],
  },
}
</code></pre></div></li>
<li>
<p><a href=https://blog.51cto.com/u_15352876/3775503>原创 | 微服务网关 Kong 科普</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230328>20230328<a hidden class=anchor aria-hidden=true href=#20230328>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>安装新 npm 包，需要 yarn build 看能否打包，否则就不使用。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/60619061>React Hooks: useEffect() is called twice even if an empty array is used as an argument</a>：<code>useEffect(() => {}, [])</code> 执行了两次，原因是因为启用了 React.StrictMode，对生产环境无影响。</p>
<blockquote>
<p>StrictMode renders components twice (on dev but not production) in order to detect any problems with your code and warn you about them (which can be quite useful).</p>
</blockquote>
</li>
<li>
<p><a href=https://www.sourcetreeapp.com>Sourcetree</a>：查看 Git 代码树</p>
</li>
<li>
<p>变量以 $ 符号结尾，可能他是<a href=https://stackoverflow.com/a/37928549>写 angular 来的</a>。</p>
<blockquote>
<p><strong>$ suffix</strong> (popularized by <a href=https://cycle.js.org/>Cycle.js</a>) is used to indicate that the variable is an <a href=https://angular.io/guide/observables><strong>Observable</strong></a>. It could make it to the official style guide too but it&rsquo;s not there yet</p>
</blockquote>
</li>
<li>
<p><a href=https://react-hot-toast.com>React Hot Toast</a>：一个 Toast 库，主要还是改 <a href=https://react-hot-toast.com/docs/styling>Styling</a></p>
</li>
<li>
<p><a href=https://www.cnblogs.com/sweet22353/p/9481217.html>du 命令计算隐藏文件夹或文件</a>：<code>du -sh *.[^.]*</code></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230327>20230327<a hidden class=anchor aria-hidden=true href=#20230327>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://stackoverflow.com/a/43052288>Attach Authorization header for all axios requests</a>：</p>
<ul>
<li>
<p>Login 成功后，存储 token 在本地并设置默认 Heaer</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>localStorage</span>.<span style=color:#a6e22e>setItem</span>(<span style=color:#e6db74>&#39;token&#39;</span>, <span style=color:#e6db74>`Bearer </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>result</span>.<span style=color:#a6e22e>token</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>)
<span style=color:#a6e22e>axiosInstance</span>.<span style=color:#a6e22e>defaults</span>.<span style=color:#a6e22e>headers</span>.<span style=color:#a6e22e>common</span>[<span style=color:#e6db74>&#39;Authorization&#39;</span>] <span style=color:#f92672>=</span> <span style=color:#e6db74>`Bearer </span><span style=color:#e6db74>${</span><span style=color:#a6e22e>result</span><span style=color:#e6db74>}</span><span style=color:#e6db74>`</span>
</code></pre></div></li>
<li>
<p>页面刷新后，需从本地重新取回 token</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>axiosInstance</span>.<span style=color:#a6e22e>interceptors</span>.<span style=color:#a6e22e>request</span>.<span style=color:#a6e22e>use</span>((<span style=color:#a6e22e>config</span>) =&gt; {
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>localStorage</span>.<span style=color:#a6e22e>getItem</span>(<span style=color:#e6db74>&#39;token&#39;</span>)) {
    <span style=color:#a6e22e>config</span>.<span style=color:#a6e22e>headers</span>.<span style=color:#a6e22e>Authorization</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>localStorage</span>.<span style=color:#a6e22e>getItem</span>(<span style=color:#e6db74>&#39;token&#39;</span>)
  }
  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>config</span>
})          
</code></pre></div></li>
</ul>
</li>
<li>
<p>接口要考虑别人使用，不要只考虑自己用着方便。</p>
<ul>
<li>
<p>返回类型要写全，不要只写自己需要的部分。例如</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>export</span> <span style=color:#a6e22e>type</span> <span style=color:#a6e22e>UserInfoType</span> <span style=color:#f92672>=</span> {
  <span style=color:#a6e22e>id</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>
  <span style=color:#a6e22e>email</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>
  <span style=color:#a6e22e>username</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>
  <span style=color:#a6e22e>createdAt</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>
}
</code></pre></div></li>
<li>
<p>像这种信息可以存储在全局，而不是每次都需要获取。</p>
</li>
</ul>
</li>
<li>
<p><a href=https://www.cnblogs.com/minjh/p/14542367.html>React 滚动到底部加载数据</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>DataInfo</span>() {
    <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>dom</span>, <span style=color:#a6e22e>setDom</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#a6e22e>HTMLDivElement</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>null</span>);
    <span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>logData</span>, <span style=color:#a6e22e>setLogData</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#e6db74>&#39;&#39;</span>);

    <span style=color:#75715e>// 获取数据的方法
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>getLogPages</span> () {
        ...
    }

    <span style=color:#75715e>// 监听页面滚动
</span><span style=color:#75715e></span>    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleOnScroll</span> <span style=color:#f92672>=</span> () =&gt; {
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>dom</span>) {
            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>contentScrollTop</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dom</span>.<span style=color:#a6e22e>scrollTop</span>; <span style=color:#75715e>//滚动条距离顶部
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>clientHeight</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dom</span>.<span style=color:#a6e22e>clientHeight</span>; <span style=color:#75715e>//可视区域
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>scrollHeight</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>dom</span>.<span style=color:#a6e22e>scrollHeight</span>; <span style=color:#75715e>//滚动条内容的总高度
</span><span style=color:#75715e></span>            <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>contentScrollTop</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>clientHeight</span> <span style=color:#f92672>&gt;=</span> <span style=color:#a6e22e>scrollHeight</span>) {
                <span style=color:#a6e22e>getLogPages</span>();    <span style=color:#75715e>// 获取数据的方法
</span><span style=color:#75715e></span>            }
        }
    };
    <span style=color:#66d9ef>return</span> (
      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span>  <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;modal-body logHeight&#34;</span>
            <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span>{{ <span style=color:#a6e22e>height</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;480px&#39;</span> }}
            <span style=color:#a6e22e>ref</span><span style=color:#f92672>=</span>{(<span style=color:#a6e22e>dom</span>) =&gt; {
                      <span style=color:#a6e22e>setDom</span>(<span style=color:#a6e22e>dom</span>);
                  }}
            <span style=color:#a6e22e>onScrollCapture</span><span style=color:#f92672>=</span>{() =&gt; <span style=color:#a6e22e>handleOnScroll</span>()}
            <span style=color:#f92672>&gt;</span>
            {<span style=color:#a6e22e>logData</span>}
      <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;    </span>
　　)
}
</code></pre></div></li>
<li>
<p><a href=https://zenn.dev/gashi/articles/20211209-article013>React keyboard 事件</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>keyDownHandler</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>KeyboardEvent</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>HTMLDivElement</span><span style=color:#f92672>&gt;</span>) =&gt; {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>key</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>code</span>;
}
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/33352604>How to create an array containing 1&mldr;N</a>: <code>Array.from(Array(10).keys())</code></p>
</li>
<li>
<p><a href=https://www.npmjs.com/package/react-simple-pull-to-refresh>react-simple-pull-to-refresh</a>：下拉更新组件</p>
</li>
<li>
<p>CSS loaders and Spinners</p>
<ul>
<li><a href=https://loading.io/css/>Pure CSS Loaders</a></li>
<li><a href=https://mhnpd.github.io/react-loader-spinner/>React Spinners</a></li>
</ul>
</li>
</ul>
</li>
<li>ChatGPT: <a href=https://sspai.com/post/79190>AI提示词玩家</a></li>
</ul>
<h2 id=20230325>20230325<a hidden class=anchor aria-hidden=true href=#20230325>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://www.cnblogs.com/sweet22353/p/9481217.html>du 命令计算隐藏文件夹或文件</a>：<code>du -sh * .[^.]*</code></p>
</li>
<li>
<p><a href=https://blog.csdn.net/YanLong_Lin/article/details/106795610>web查看当前是哪个元素触发了滚动</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>function</span> <span style=color:#a6e22e>findscroller</span>(<span style=color:#a6e22e>element</span>){
  <span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>onscroll</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>function</span> () {
      <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>element</span>)
  }
  Array.<span style=color:#a6e22e>from</span>(<span style=color:#a6e22e>element</span>.<span style=color:#a6e22e>children</span>).<span style=color:#a6e22e>forEach</span>(<span style=color:#a6e22e>findscroller</span>)
}
<span style=color:#a6e22e>findscroller</span>(document.<span style=color:#a6e22e>body</span>)
</code></pre></div></li>
<li>
<p><a href=https://blog.csdn.net/ftell/article/details/122815694>getServerSideProps 函数</a>：与 getStaticProps 只在build时生成一遍静态页面，或者定期重新生成页面不同，使用getServerSideProps，页面在每接收到一条传入请求就重新生成一遍。因为每次请求都是从数据库读数据重新生成页面，页面加载速度会变慢。但是使用getServerSideProps 可以访问 request 对象。如果页面不是需要每秒更新几次，或者不需要访问 request 对象，那么使用 getStaticProps 函数更好。getStaticProps 和 getServerSideProps 不能同时使用，参见 <a href=https://github.com/vercel/next.js/discussions/11424>Use getStaticProps and getServerSideProps together</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230324>20230324<a hidden class=anchor aria-hidden=true href=#20230324>#</a></h2>
<ul>
<li>经验
<ul>
<li>记住，不要好逸恶劳，要生产自己的价值，要被人需要。</li>
<li>小课堂：
<ul>
<li>后端接口还没好，依旧要考虑接口，模拟接口返回数据，考虑全，后面可以直接改个链接。</li>
<li>在 fetcher.js，不知道接口请求参数、返回数据类型，可以用对象，方便添加内容。</li>
<li>付费的 <a href=https://github.com/features/copilot>copilot</a> 与免费的 <a href=https://codeium.com>codeium</a>：这个真的超赞，如果没人教的话，不知道怎么写，那么这个会给你一个范例。</li>
</ul>
</li>
<li>公司的部署流程：本地项目 push 到 Github => 触发 Github hooks => Jenkins 执行宿主机脚本 => 脚本拉取 Github 源码、build docker 镜像、运行镜像 => 其他（Kong服务、域名绑定等）。每一个 web 服务拥有两个端口，新的端口用起来后，停用旧端口，保证服务可用性。</li>
</ul>
</li>
</ul>
<h2 id=20230323>20230323<a hidden class=anchor aria-hidden=true href=#20230323>#</a></h2>
<ul>
<li>经验
<ul>
<li>适配任意尺寸方法
<ul>
<li>宽度不写死，100% 宽度（<code>w-full</code>），然后加一个最大宽度（<code>max-w-</code>），加 padding 调整间距。</li>
<li>高度不写死，内容撑高，然后加一个最大高度（<code>max-h-</code>），加 padding 调整间距，文本框还可用 row。</li>
<li>不能说为了 UI 而写死，也要考虑程序的写法。</li>
</ul>
</li>
<li>整个页面高度为 100vh，最后一个元素占据剩余空间，其仅有的子元素占据所有高度，子元素内容如果超过高度，则出现滚动条。
<ul>
<li><a href=https://stackoverflow.com/a/24979148>最后一个元素占满剩余可用高度</a>：用 <code>flex-grow: 1</code>，其他元素为 <code>flex-grow: 0</code></li>
<li>还需要在父元素上添加 <code>overflow: hidden;</code>，子元素添加 <code>overflow-y: auto;</code>。即 <a href=https://stackoverflow.com/a/49107669>How to make child div scrollable when it exceeds parent height?</a></li>
</ul>
</li>
<li><a href=https://stackoverflow.com/a/72679789>navigator.clipboard.writeText() not working on specific IOS devices</a>：There are security limitations on this API in (Mobile) Safari, one of which is it has to be executed on a site secured with https, so will not work on localhost.</li>
<li><a href="https://ithelp.ithome.com.tw/articles?tab=ironman">iT 邦幫忙::一起幫忙解決難題，拯救 IT 人的一天</a>：有不错的系列中文文章。</li>
</ul>
</li>
</ul>
<h2 id=20230322>20230322<a hidden class=anchor aria-hidden=true href=#20230322>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://segmentfault.com/q/1010000007801503>获取焦点时移除placeholder，失去焦点重新获得placeholder内容</a></p>
<ul>
<li>
<p>css</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=color:#75715e>/*WebKit browsers*/</span>
<span style=color:#f92672>input</span>:<span style=color:#a6e22e>focus</span>::<span style=color:#a6e22e>-webkit-input-placeholder</span> { <span style=color:#66d9ef>color</span>:<span style=color:#66d9ef>transparent</span>; }

<span style=color:#75715e>/*Mozilla Firefox 4 to 18*/</span>
<span style=color:#f92672>input</span>:<span style=color:#a6e22e>focus</span>:<span style=color:#a6e22e>-moz-placeholder</span> { <span style=color:#66d9ef>color</span>:<span style=color:#66d9ef>transparent</span>; }

<span style=color:#75715e>/*Mozilla Firefox 19+*/</span>
<span style=color:#f92672>input</span>:<span style=color:#a6e22e>focus</span>::<span style=color:#a6e22e>-moz-placeholder</span> { <span style=color:#66d9ef>color</span>:<span style=color:#66d9ef>transparent</span>; }

<span style=color:#75715e>/*Internet Explorer 10+*/</span>
<span style=color:#f92672>input</span>:<span style=color:#a6e22e>focus</span>:<span style=color:#a6e22e>-ms-input-placeholder</span> { <span style=color:#66d9ef>color</span>:<span style=color:#66d9ef>transparent</span>; }
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://www.npmjs.com/package/lodash.shuffle>lodash.shuffle</a>：将数组打乱顺序</p>
</li>
<li>
<p><a href=https://github.com/garmeeh/next-seo#title-template>Next SEO - Title Template</a></p>
<ul>
<li>在 seo.ts：<code>{ titleTemplate = 'Next SEO | %s'; }</code></li>
<li>在某个页面：&lt;NextSeo title={i18n._(t<code>This is my title</code>)} /></li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230321>20230321<a hidden class=anchor aria-hidden=true href=#20230321>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><code>md:</code> 作为 Desktop 与 Mobile 的短点比 <code>sm:</code> 要好。</p>
</li>
<li>
<p><a href=https://nextjs.org/docs/messages/no-document-viewport-meta><code>Viewport meta tags should not be used in _document.js's &lt;Head></code></a></p>
<ul>
<li>
<p>Set your viewport meta tag in pages/_app.js</p>
</li>
<li>
<p>Next.js 暴露了一个内置组件 Head，用于将 HTML 标签添加到页面的 head 中。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>Head</span>&gt;
  &lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;viewport&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no&#34;</span> /&gt;
&lt;/<span style=color:#f92672>Head</span>&gt;
</code></pre></div></li>
</ul>
</li>
<li>
<p>禁止 IOS 移动端缩放</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>lastTouchEnd</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span>(<span style=color:#ae81ff>0</span>)
<span style=color:#a6e22e>useEffect</span>(() =&gt; {

  <span style=color:#75715e>// 双指缩放
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleTouchstart</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TouchEvent</span>) =&gt; {
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>touches</span>.<span style=color:#a6e22e>length</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1</span>) {
      <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>preventDefault</span>()
    }
  }

  <span style=color:#75715e>// 双击缩放
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleTouchend</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>event</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>TouchEvent</span>) =&gt; {
    <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>now</span> <span style=color:#f92672>=</span> Date.<span style=color:#a6e22e>now</span>()
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>now</span> <span style=color:#f92672>-</span> <span style=color:#a6e22e>lastTouchEnd</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>300</span>) {
      <span style=color:#a6e22e>event</span>.<span style=color:#a6e22e>preventDefault</span>()
    }
    <span style=color:#a6e22e>lastTouchEnd</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>now</span>
  }

  document.<span style=color:#a6e22e>documentElement</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;touchstart&#39;</span>, <span style=color:#a6e22e>handleTouchstart</span>, { <span style=color:#a6e22e>passive</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span> })
  document.<span style=color:#a6e22e>documentElement</span>.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;touchend&#39;</span>, <span style=color:#a6e22e>handleTouchend</span>, <span style=color:#66d9ef>false</span>)

  <span style=color:#66d9ef>return</span> () =&gt; {
    document.<span style=color:#a6e22e>documentElement</span>.<span style=color:#a6e22e>removeEventListener</span>(<span style=color:#e6db74>&#39;touchstart&#39;</span>, <span style=color:#a6e22e>handleTouchstart</span>, <span style=color:#66d9ef>false</span>)
    document.<span style=color:#a6e22e>documentElement</span>.<span style=color:#a6e22e>removeEventListener</span>(<span style=color:#e6db74>&#39;touchend&#39;</span>, <span style=color:#a6e22e>handleTouchend</span>, <span style=color:#66d9ef>false</span>)
  }
}, [])
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230320>20230320<a hidden class=anchor aria-hidden=true href=#20230320>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://support.apple.com/zh-cn/guide/mac-help/mchleab3a043/mac>Apple Cannot Check It for Malicious Software</a>：在 Finder 中右键打开就行。</p>
</li>
<li>
<p>首先考虑移动端怎么做，移动端优先；用 devTool 开手机模式，然后可以拖放检查。</p>
</li>
<li>
<p>daisyUI 可以选主题，可以配置主题，在 tailwindcss.config 中 daisyui 部分修改。</p>
</li>
<li>
<p>Tailwinds 有 vscode 插件 Tailwind CSS IntelliSense。可以看到像素对应的 tailwind css 类，选择最近似的就行。</p>
</li>
<li>
<p><a href=https://www.runoob.com/css/css-dropdowns.html>Dropdown CSS 代码</a>是看的懂得吧！</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>style</span>&gt;
.<span style=color:#a6e22e>dropdown</span> {
  <span style=color:#66d9ef>position</span>: <span style=color:#66d9ef>relative</span>;
  <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>inline-block</span>;
}
.<span style=color:#a6e22e>dropdown-content</span> {
  <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>none</span>;
  <span style=color:#66d9ef>position</span>: <span style=color:#66d9ef>absolute</span>;
  <span style=color:#66d9ef>background-color</span>: <span style=color:#ae81ff>#f9f9f9</span>;
  <span style=color:#66d9ef>min-width</span>: <span style=color:#ae81ff>160</span><span style=color:#66d9ef>px</span>;
  <span style=color:#66d9ef>box-shadow</span>: <span style=color:#ae81ff>0</span><span style=color:#66d9ef>px</span> <span style=color:#ae81ff>8</span><span style=color:#66d9ef>px</span> <span style=color:#ae81ff>16</span><span style=color:#66d9ef>px</span> <span style=color:#ae81ff>0</span><span style=color:#66d9ef>px</span> rgba(<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0</span>,<span style=color:#ae81ff>0.2</span>);
  <span style=color:#66d9ef>padding</span>: <span style=color:#ae81ff>12</span><span style=color:#66d9ef>px</span> <span style=color:#ae81ff>16</span><span style=color:#66d9ef>px</span>;
}
.<span style=color:#a6e22e>dropdown</span>:<span style=color:#a6e22e>hover</span> .<span style=color:#a6e22e>dropdown-content</span> {
  <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>block</span>;
}
&lt;/<span style=color:#f92672>style</span>&gt;
&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dropdown&#34;</span>&gt;
  &lt;<span style=color:#f92672>span</span>&gt;鼠标移动到我这！&lt;/<span style=color:#f92672>span</span>&gt;
  &lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;dropdown-content&#34;</span>&gt;
    &lt;<span style=color:#f92672>p</span>&gt;菜鸟教程&lt;/<span style=color:#f92672>p</span>&gt;
    &lt;<span style=color:#f92672>p</span>&gt;www.runoob.com&lt;/<span style=color:#f92672>p</span>&gt;
  &lt;/<span style=color:#f92672>div</span>&gt;
&lt;/<span style=color:#f92672>div</span>&gt;
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230318>20230318<a hidden class=anchor aria-hidden=true href=#20230318>#</a></h2>
<ul>
<li>任务
<ul>
<li><input checked disabled type=checkbox> 调查google登录和apple登录的整合登录情况
<ul>
<li>使用 <a href=https://www.passportjs.org/packages/><strong>passport</strong></a></li>
<li>使用 Bass：<a href="https://firebase.google.com/docs/auth?hl=zh-cn">Firebase Authentication</a>/<a href=https://ithelp.ithome.com.tw/articles/10205404>Day26 前端福音(1/4): Firebase-介紹 & 建立專案</a></li>
<li>使用第三方库：
<ul>
<li><a href=https://juejin.cn/post/7155514465591984136>使用 NextAuth.js 给 Next.js 应用添加鉴权与认证</a></li>
<li><a href=https://github.com/justauth/JustAuth>JustAuth</a></li>
</ul>
</li>
<li>使用官方库手动整合：<a href=https://developers.google.com/identity/oauth2/web/guides/overview>Google Identity Services</a>/<a href=https://developer.apple.com/documentation/sign_in_with_apple/sign_in_with_apple_js/configuring_your_webpage_for_sign_in_with_apple>Configuring your webpage for Sign in with Apple</a></li>
</ul>
</li>
</ul>
</li>
<li>经验
<ul>
<li>
<p>开发规范</p>
<ul>
<li>git 使用技巧
<ul>
<li>git rebase 合并 commit，p 选择该 commit，s 向上合并，注意只能 rebase 没有 push 的 commit；</li>
<li>git commit —amend 修改 commit message；</li>
<li>git add -p 进入 patch mode ，让我们可以挑选一部分改动进行提交。</li>
</ul>
</li>
<li>对开发的新功能，则命名为 <code>feat-[功能名称]</code>；对修复的bug，则命名为 <code>fix-[bug描述]</code>；命名时使用 <code>-</code> 减号来分割单词。</li>
<li>从dev上开新分支，完成后，合并dev分支到功能分支上，解决冲突（如果有）后提交PR到dev上。</li>
<li>在框架自动生成的多语言内容时，如果对应语言没有翻译内容，则不提交该文件。如果需要添加翻译内容，则运行yarn lingui让程序重新补充未翻译的内容。</li>
<li>网站内的路由跳转，使用链接（Next Link 标签）的方式跳转，而非 onClick 和 router.push，利于 SEO。站外链接统一用 &ldquo;_blank&rdquo; 方式打开。</li>
<li>可以使用 yarn lingui 生产对应的条目，git push 时需删除没有翻译的条目。</li>
</ul>
</li>
<li>
<p>headlessui 写的手机端<a href=https://stackoverflow.com/a/69050818>菜单侧滑动画</a>，关键在于清楚 CSS 的 transition 和 transform，不要被 tailwindcss 迷惑了。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Transition</span> <span style=color:#a6e22e>show</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>isShow</span>} <span style=color:#a6e22e>as</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>Fragment</span>}<span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>classNames</span>(<span style=color:#e6db74>&#39;fixed left-0 top-0 h-full w-full&#39;</span>, <span style=color:#a6e22e>maskClass</span>)} <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>onMaskClick</span>}<span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Transition</span>.<span style=color:#a6e22e>Child</span>
      <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>classNames</span>(<span style=color:#e6db74>&#39;relative h-full w-1/2 bg-white&#39;</span>, <span style=color:#a6e22e>menuClass</span>)}
      <span style=color:#a6e22e>style</span><span style=color:#f92672>=</span>{{ <span style=color:#a6e22e>marginLeft</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>reverse</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;auto&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;0&#39;</span> }}
      <span style=color:#a6e22e>enter</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;transition ease-out duration-100&#34;</span>
      <span style=color:#a6e22e>enterFrom</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>reverse</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;translate-x-full&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;-translate-x-full&#39;</span>}
      <span style=color:#a6e22e>enterTo</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;translate-x-0&#34;</span>
      <span style=color:#a6e22e>leave</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;transition ease-in duration-90&#34;</span>
      <span style=color:#a6e22e>leaveFrom</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;translate-x-0&#34;</span>
      <span style=color:#a6e22e>leaveTo</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>reverse</span> <span style=color:#f92672>?</span> <span style=color:#e6db74>&#39;translate-x-full&#39;</span> <span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;-translate-x-full&#39;</span>}
      <span style=color:#a6e22e>as</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;div&#34;</span>
      <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>handleClick</span>}
    <span style=color:#f92672>&gt;</span>
      {<span style=color:#a6e22e>children</span>}
    <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/Transition.Child&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/Transition&gt;</span>
</code></pre></div></li>
<li>
<p><a href=https://www.learnbestcoding.com/post/70/re-render-on-browser-re-size-in-react-js>监听 window 的 resize 事件</a>，如果调整窗口大于1280 (preWidth &lt; 1280 && width >= 1280) 或小于 1280 (preWidth > 1280 && width &lt;= 1280)，则 <a href=https://stackoverflow.com/a/3715123>reload</a> 一次页面。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>width</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useWindowSize</span>()
<span style=color:#66d9ef>const</span> <span style=color:#a6e22e>preWidth</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>usePrevious</span>(<span style=color:#a6e22e>width</span>)
<span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>preWidth</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>width</span>) {
  <span style=color:#66d9ef>if</span> ((<span style=color:#a6e22e>preWidth</span> <span style=color:#f92672>&gt;</span> <span style=color:#ae81ff>1280</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>&lt;=</span> <span style=color:#ae81ff>1280</span>) <span style=color:#f92672>||</span> (<span style=color:#a6e22e>preWidth</span> <span style=color:#f92672>&lt;</span> <span style=color:#ae81ff>1280</span> <span style=color:#f92672>&amp;&amp;</span> <span style=color:#a6e22e>width</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>1280</span>)) {
    window.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>reload</span>()
  }
}
</code></pre></div></li>
<li>
<p>next/image 要求固定的 width 和 height，可通过一下方式实现 <a href=https://stackoverflow.com/a/66330921>next/image 响应式改变大小</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;relative w-16 h-16 shrink-0&#34;</span><span style=color:#f92672>&gt;</span>
    <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Image</span> <span style=color:#a6e22e>src</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>avatar</span> <span style=color:#f92672>||</span> <span style=color:#a6e22e>DEFAULT_AVATAR</span>} <span style=color:#a6e22e>alt</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;avatar&#34;</span> <span style=color:#a6e22e>fill</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;object-cover rounded-full&#34;</span> <span style=color:#f92672>/&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
</code></pre></div></li>
<li>
<p>在 React 中，不再 useEffect 中<a href=https://stackoverflow.com/a/53090848>清除 timerID</a>，通过 useRef 实现。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>timer</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>NodeJS</span>.<span style=color:#a6e22e>Timeout</span><span style=color:#f92672>&gt;</span>()
<span style=color:#a6e22e>timer</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>setTimeout</span>(() =&gt; {}, <span style=color:#a6e22e>delay</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>);
<span style=color:#a6e22e>clearTimeout</span>(<span style=color:#a6e22e>timer</span>.<span style=color:#a6e22e>current</span> <span style=color:#a6e22e>as</span> <span style=color:#a6e22e>number</span> <span style=color:#f92672>|</span> <span style=color:#66d9ef>undefined</span>)
</code></pre></div></li>
<li>
<p><a href=https://www.mdui.org/design/>Material Design 指南中文版</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/58290739>Prevent scroll when modal is open</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>useEffect</span>(() =&gt; {
  <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>isShow</span>) {
    document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>overflow</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;hidden&#39;</span>
    <span style=color:#66d9ef>return</span> () =&gt; {
      document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>style</span>.<span style=color:#a6e22e>overflow</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;auto&#39;</span>
    }
  }
}, [<span style=color:#a6e22e>isShow</span>])
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230317>20230317<a hidden class=anchor aria-hidden=true href=#20230317>#</a></h2>
<ul>
<li>经验
<ul>
<li>有问题，一定要说出来，就不是自己的锅了，而是大家的。</li>
<li>产品问题找产品负责人，技术问题找技术负责人，但最终所有问题都属于产品问题，由产品负责人负责。</li>
<li>所有问题（UI、产品、测试）都汇总在一个表格之中，解决后@负责人。</li>
<li>编写代码后，本地测试通过，自测通过后合并需再测试，总之，在所有问题解决之前，不要说完成了，不要部署到正式服务器。</li>
</ul>
</li>
</ul>
<h2 id=20230316>20230316<a hidden class=anchor aria-hidden=true href=#20230316>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://dev.to/nazanin_ashrafi/how-to-darken-an-image-with-css-4f5h>How to Darken an Image with CSS</a>：影响最小、符合预期的是使用图片的线性渐变</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css><span style=color:#f92672>background-image</span><span style=color:#f92672>:</span> <span style=color:#f92672>linear-gradient</span><span style=color:#f92672>(</span><span style=color:#f92672>rgba</span><span style=color:#f92672>(</span><span style=color:#f92672>0</span><span style=color:#f92672>,</span> <span style=color:#f92672>0</span><span style=color:#f92672>,</span> <span style=color:#f92672>0</span><span style=color:#f92672>,</span> <span style=color:#f92672>0</span>.<span style=color:#a6e22e>5</span><span style=color:#f92672>),</span><span style=color:#f92672>rgba</span><span style=color:#f92672>(</span><span style=color:#f92672>0</span><span style=color:#f92672>,</span> <span style=color:#f92672>0</span><span style=color:#f92672>,</span> <span style=color:#f92672>0</span><span style=color:#f92672>,</span> <span style=color:#f92672>0</span>.<span style=color:#a6e22e>5</span><span style=color:#f92672>))</span> <span style=color:#f92672>,</span> <span style=color:#f92672>url</span><span style=color:#f92672>(</span><span style=color:#f92672>bg</span>.<span style=color:#a6e22e>jpg</span><span style=color:#f92672>);</span>
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/28191966>How to get a key in a JavaScript object by its value?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>getKeyByValue</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>object</span><span style=color:#f92672>:</span> { [<span style=color:#a6e22e>props</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>]<span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span> }, <span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>) =&gt; {
  <span style=color:#66d9ef>return</span> Object.<span style=color:#a6e22e>keys</span>(<span style=color:#a6e22e>object</span>).<span style=color:#a6e22e>find</span>((<span style=color:#a6e22e>key</span>) =&gt; <span style=color:#a6e22e>object</span>[<span style=color:#a6e22e>key</span>] <span style=color:#f92672>===</span> <span style=color:#a6e22e>value</span>)
}
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230315>20230315<a hidden class=anchor aria-hidden=true href=#20230315>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>要在 Dropdown menu 中使用 Next.js 的 Link 标签，<a href=https://javascript.plainenglish.io/headlessui-menu-part-6-using-next-js-link-component-5c264ec532cd>需要将 Link 标签放在最顶层</a>，并且参考 <a href=https://headlessui.com/react/menu#closing-menus-manually>Closing menus manually</a> 手动关闭。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Menu</span><span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Menu</span>.<span style=color:#a6e22e>Button</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Menu</span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/Menu.Button&gt;</span>

  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Menu</span>.<span style=color:#a6e22e>Items</span><span style=color:#f92672>&gt;</span>
    {<span style=color:#a6e22e>menuItems</span>.<span style=color:#a6e22e>map</span>((<span style=color:#a6e22e>menuItem</span>) =&gt; (
      <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Menu</span>.<span style=color:#a6e22e>Item</span> <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>menuItem</span>.<span style=color:#a6e22e>name</span>}<span style=color:#f92672>&gt;</span>
        {({ <span style=color:#a6e22e>close</span> }) =&gt; ( <span style=color:#75715e>// get close function
</span><span style=color:#75715e></span>          <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Link</span> <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>menuItem</span>.<span style=color:#a6e22e>href</span>} <span style=color:#a6e22e>legacyBehavior</span><span style=color:#f92672>&gt;</span>
            <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>a</span><span style=color:#f92672>&gt;</span>
              <span style=color:#75715e>// Component
</span><span style=color:#75715e></span>              <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>close</span>}<span style=color:#f92672>&gt;</span>{<span style=color:#a6e22e>menuItem</span>.<span style=color:#a6e22e>name</span>}<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
            <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/a&gt;</span>
          <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/Link&gt;</span>
        )}
      <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/Menu.Item&gt;</span>
    ))}
  <span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/Menu.Items&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/Menu&gt;</span>
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/68962312>Using different API url for development and production with React and axios</a>：利用 <code>.env.development</code> 和 <code>.env.production</code> 文件来自动切换生产环境与开发环境的 API 的域名：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>API_ENDPOINT</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>process</span>.<span style=color:#a6e22e>env</span>.<span style=color:#a6e22e>REACT_APP_API_ENDPOINT</span>
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230314>20230314<a hidden class=anchor aria-hidden=true href=#20230314>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p><a href=https://nextjs.org/docs/api-reference/next/router>next/router</a>：路由</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>router</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRouter</span>()
<span style=color:#a6e22e>router</span>.<span style=color:#a6e22e>push</span>(<span style=color:#a6e22e>url</span>)
</code></pre></div></li>
<li>
<p>项目所有 url 都放在 <code>src/config/share_url</code></p>
</li>
<li>
<p><a href="https://www.larksuite.com/hc/zh-CN/categories-detail?category-id=7054521473083392005">Lark 日历使用文档</a></p>
</li>
<li>
<p><a href=https://github.com/garmeeh/next-seo>next-seo</a>：每一个 Page 都需要 <code>&lt;NextSeo title="desc" /></code>，至少要有 title 属性，用于 SEO，具体位置不限——不要求放在最顶层，因为最后其会生成在 head 标签中作为 meta 元素存在。</p>
</li>
<li>
<p>Next Link 链接写法：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Link</span> <span style=color:#a6e22e>legacyBehavior</span> <span style=color:#a6e22e>key</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>key</span>} <span style=color:#a6e22e>href</span><span style=color:#f92672>=</span>{<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>href</span>}<span style=color:#f92672>&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>a</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;underline&#34;</span> <span style=color:#a6e22e>target</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;_blank&#34;</span><span style=color:#f92672>&gt;</span>{<span style=color:#a6e22e>item</span>.<span style=color:#a6e22e>text</span>}<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/a&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/Link&gt;</span>
</code></pre></div><p>我偏向使用原生的 a 标签，没懂这样写是干嘛的。写法具体参考 <a href=https://nextjs.org/docs/api-reference/next/link#if-the-child-is-a-tag>next/link - If the child is a functional component</a>，也就是如果你想使用 Link 组件，必须遵守对应的语法规则。</p>
<p>采用这种写法，可用通过 DevTool 来检查是否生效，可以看到其渲染为普通的带 href 属性的 a 元素，具体缘由参考 <a href=https://stackoverflow.com/a/65086176>Next.JS &ldquo;Link&rdquo; vs &ldquo;router.push()&rdquo; vs &ldquo;a&rdquo; tag</a>——即 Link 生成 a 元素并且不 reload page，单独用 a 元素会 reload page。</p>
</li>
<li>
<p><a href=https://www.fullstacktutorials.com/deploy-react-app-subdirectory-10.html>How to deploy a react app to a subdirectory</a>: 今天张新勇老大遇到个问题，需要将 React App 到服务器 register 子目录，但是一直报错，因为其访问的资源指向根目录，解决办法需要将所有资源引用指向 register 这个子目录，解决方法如下：In package.json add homepage like below</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
<span style=color:#f92672>&#34;homepage&#34;</span>: <span style=color:#e6db74>&#34;https://domain-name.com/directory-name&#34;</span>,

<span style=color:#75715e>//OR
</span><span style=color:#75715e></span>
<span style=color:#f92672>&#34;homepage&#34;</span>: <span style=color:#e6db74>&#34;/directory-name&#34;</span>,
}
</code></pre></div><p>但问题并没有结束，其结果能让静态资源的引用指向 <code>/directory-name</code> 目录（index.html 中引用），但并没有解决超链接跳转问题。该项目使用 react 的类组件，使用 react-router-dom@5 来做路由。主要参考 <a href=https://stackoverflow.com/a/44980228>React Router V4 but on a different homepage in package.json&mldr; fix 404 not found?</a> 这篇文章</p>
<ul>
<li>
<p>方法一：除了要在 package.json 添加 homepage 属性外，还需要在 <code>&lt;BrowserRoter></code> 中添加 basename 属性，即<code>&lt;BrowserRoter basename="/directory-name"</code>，并且将所有 a 标签替换为 react-router-dom 的 Link 标签，因为其自动添加 basename。</p>
</li>
<li>
<p>方法二：使用 <code>&lt;HashRouter></code> 来解决，除了不需要添加 basename 外，其他一样，然后可以如下方式写（马梦圆喜欢这样写😂）</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() =&gt; {
  window.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;#/Privacy_Policy&#34;</span>;
}}
</code></pre></div><p>HashRouter 作用参考 <a href=https://stackoverflow.com/a/36623117>React-router URLs don&rsquo;t work when refreshing or writing manually</a>，即客户端生成的路由，如 &lt;www.example.com/home，服务器是不接受的，利用> hash history，即 &lt;www.example.com/#/home> 就可以绕过这个问题，因为总是请求根域名 &lt;www.example.com。></p>
</li>
</ul>
<p>总之，这些配置基于这样一个目的：在本地（开发环境）下可以直接运行，方便代码编写与调试；打包的时候自动处理从开发环境到生产环境的迁移，例如调整链接、精简代码之类的；打包后可以直接在服务器上部署运行。</p>
</li>
<li>
<p>为了告诉开发环境的服务器去代理任何开发环境中未知的请求到我们自己的api服务器，<a href=https://segmentfault.com/a/1190000014891894>添加一个proxy到package.json的字段</a>，但在 next 中无效，需要使用下面的 next-http-proxy-middleware</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230313>20230313<a hidden class=anchor aria-hidden=true href=#20230313>#</a></h2>
<ul>
<li>经验：
<ul>
<li>
<p><a href=https://blog.csdn.net/tiandaochouqin_1/article/details/121823197>在谷歌浏览器中对颜色进行十六进制、rgba、hsl切换</a>：按住shift键，点击颜色快，即可切换。</p>
</li>
<li>
<p>ESLint</p>
<ul>
<li>
<p><a href=https://www.gcb1988.cn/article/1988_075.html>彻底搞懂ESLint</a></p>
</li>
<li>
<p><a href=https://blog.devgenius.io/eslint-prettier-typescript-and-react-in-2022-e5021ebca2b1>ESLint + Prettier + Typescript and React in 2022</a>：</p>
<ul>
<li>除了需要安装对应的 modules 外，还需要在 vscode 安装对应的插件才能起作用</li>
<li>ESLint：代码检测工具，Prettier：格式化代码。</li>
</ul>
</li>
<li>
<p><a href=https://daveceddia.com/vscode-use-eslintrc/>ESLint + VSCode: How to Format Your Code Using .eslintrc</a>：ESLint 可以将 prettier 作为插件，具备格式化代码的功能，参考 <a href=https://prettier.io/docs/en/integrating-with-linters.html>Integrating with Linters</a>同时如下配置以启用</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json>{
  <span style=color:#f92672>&#34;eslint.format.enable&#34;</span>: <span style=color:#66d9ef>true</span>,
  <span style=color:#f92672>&#34;editor.codeActionsOnSave&#34;</span>: {
    <span style=color:#f92672>&#34;source.fixAll.eslint&#34;</span>: <span style=color:#66d9ef>true</span>
  }
}
</code></pre></div></li>
<li>
<p><a href=https://zhuanlan.zhihu.com/p/80574300>搞懂 ESLint 和 Prettier</a>：eslint-config-prettier 和 eslint-plugin-prettier</p>
</li>
</ul>
</li>
<li>
<p><a href=https://tailwindcss.com/blog/automatic-class-sorting-with-prettier>Automatic Class Sorting with Prettier</a>: <code>yarn add -D prettier-plugin-tailwindcss</code></p>
</li>
<li>
<p><a href=https://tailwindcss.com/docs/gradient-color-stops>Gradient Color</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-react data-lang=react>&lt;<span style=color:#f92672>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;bg-gradient-to-r from-[#9b4ae6] to-[#2b81e4]&#34;</span>/&gt;
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/a/39413342>&lsquo;tsc command not found&rsquo; in compiling typescript</a>: <code>npm install typescript@4.6.2 -g</code>，版本与项目一致</p>
</li>
<li>
<p><a href=https://osxdaily.com/2020/04/27/view-page-source-safari-mac/>How to View Page Source in Safari on Mac</a></p>
<ul>
<li>Choosing “Preferences”, going to “Advanced” and checking the box to enable the developer menu</li>
<li>Press Command + Option + U keyboard combination to view the page source</li>
</ul>
</li>
<li>
<p><a href=https://juejin.cn/post/6958762485054701604>Typescript interface 任意数量的属性</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>interface</span> <span style=color:#a6e22e>Test</span>{
  <span style=color:#a6e22e>name</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>string</span>;
  <span style=color:#a6e22e>age</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>number</span>;
  <span style=color:#75715e>//可有可无
</span><span style=color:#75715e></span>  <span style=color:#a6e22e>sex</span><span style=color:#f92672>?:</span><span style=color:#66d9ef>boolean</span>,
  <span style=color:#a6e22e>hobby</span><span style=color:#f92672>:</span>()=&gt;<span style=color:#a6e22e>string</span>,
  <span style=color:#75715e>//自定义key 任意值
</span><span style=color:#75715e></span>  [<span style=color:#a6e22e>propname</span><span style=color:#f92672>:</span><span style=color:#a6e22e>string</span>]<span style=color:#f92672>:</span><span style=color:#a6e22e>any</span>,
}
</code></pre></div></li>
<li>
<p>Typescript 传递子组建：利用解构赋值将变量重命名为大写</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>SocialMedia</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>FC</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>SocialMediaProps</span><span style=color:#f92672>&gt;</span> <span style=color:#f92672>=</span> ({ <span style=color:#a6e22e>comp</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>SvgIcon</span>, ...<span style=color:#a6e22e>reset</span> }) =&gt; {
  <span style=color:#66d9ef>return</span> <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>SvgIcon</span> {...<span style=color:#a6e22e>reset</span>} <span style=color:#f92672>/&gt;</span>
}
</code></pre></div></li>
<li>
<p><a href=https://juejin.cn/post/6844904143237152781>macOS批量图片处理</a>：例如 resize 图片 <code>sips -Z 256 input --out output</code></p>
</li>
<li>
<p><a href=https://superuser.com/questions/134679/command-line-application-for-converting-svg-to-png-on-mac-os-x>Command-line application for converting SVG to PNG on Mac OS X</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>qlmanage -t -s <span style=color:#ae81ff>1000</span> -o . picture.svg 
</code></pre></div><p>It will produce picture.svg.png that is 1000 pixels wide.（PS：除非必要——文件太大，否则就使用原本的图片）</p>
</li>
<li>
<p><a href=https://www.cnblogs.com/ystrdy/p/9335435.html>通过 <code>// @ts-ignore 提示信息</code> 注释隐藏 .ts 文件中的错误</a></p>
</li>
</ul>
</li>
</ul>
<h2 id=20230311>20230311(🛌)<a hidden class=anchor aria-hidden=true href=#20230311>#</a></h2>
<ul>
<li>
<p><a href=https://linuxone.cloud.marist.edu/>IBM LinuxONE Community Cloud</a>：<a href=https://github.com/linuxone-community-cloud/technical-resources/blob/master/faststart/deploy-virtual-server.md>Virtual Server Deployment Guide</a></p>
<p>成功注册了。很简单，不需要银行卡，就一个 icloud 邮箱，理由写的 “open source“。说是有 120 天的试用，不知道试用时间完了之后怎么说，反正如果邮箱足够的话，是不是有无线使用期限呢？反正我现在有个小鸡使用就行了，也没有什么复杂的需求，也有不了，因为用的 IBM s390x 架构。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>ssh linux1@148.100.79.64
</code></pre></div></li>
<li>
<p><a href=https://www.2daygeek.com/how-to-kill-user-sessions-on-linux/>How to Kill user sessions in Linux</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>pkill -9 -t pts/2
</code></pre></div></li>
<li>
<p><a href=https://superuser.com/a/1654930>Are IPv4 ports separated from IPv6 ports?</a>：是的，在防火墙中需要分别为 IPv4 与 IPv6 设置端口与协议。但是要确定 VPS 的 IPv6 地址是公网地址，不是就没必要设置了。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/52036287>How to curl using IPv6 address?</a>：浏览器也是同样格式</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>curl -g -6 <span style=color:#e6db74>&#39;http://[fe80::3ad1:35ff:fe08:cd%eth0]:80/&#39;</span>
</code></pre></div></li>
</ul>
<h2 id=20230311-1>20230311<a hidden class=anchor aria-hidden=true href=#20230311-1>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>知道一个工具能干什么的比知道该工具具体怎么用更重要，很多教程一上来就讲这样做、那样做就成了，但是没讲我为什么要这样做、那样做。</p>
</li>
<li>
<p>tailscale 是 VPN（虚拟私有网络），作用是让你可以在公开的网络线路上建立一个私有的子网，起连接设备作用。要翻墙需要配合 <a href=https://wiki.archlinux.org/title/List_of_applications#Proxy_servers>proxy server</a>，作用是将客户端请求流量转发到目标网站或应用程序，然后将响应转发回客户端。</p>
</li>
<li>
<p>先有现在，才有未来，先把公司任务完成了，才有机会去学习更多的知识。总之，学习知识和掌握技能不是目的，发挥自己的价值获取报酬才是目的。</p>
</li>
<li>
<p>画 UI 的话，先把内容填上去，然后再逐渐地添加样式，最后添加行为（即先只写 HTML，再写 CSS，最后再写 JS）。</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/51832782>Change Visual Studio Code&rsquo;s title bar color</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-json data-lang=json><span style=color:#e6db74>&#34;workbench.colorCustomizations&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> {
    <span style=color:#f92672>&#34;[Name of the Current Theme you are using]&#34;</span>: {
        <span style=color:#f92672>&#34;titleBar.activeBackground&#34;</span>: <span style=color:#e6db74>&#34;#191919cc&#34;</span>,
        <span style=color:#f92672>&#34;titleBar.activeForeground&#34;</span>:<span style=color:#e6db74>&#34;#ffffff&#34;</span>,
    },
}<span style=color:#960050;background-color:#1e0010>,</span>
<span style=color:#e6db74>&#34;window.titleBarStyle&#34;</span><span style=color:#960050;background-color:#1e0010>:</span> <span style=color:#e6db74>&#34;custom&#34;</span>
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230310>20230310<a hidden class=anchor aria-hidden=true href=#20230310>#</a></h2>
<ul>
<li>任务
<ul>
<li><input checked disabled type=checkbox> 我司流程：Github => CI/CD 工具（调用外部脚本打包并直接启动 web 服务器）</li>
</ul>
</li>
<li>经验
<ul>
<li><a href=https://js.design/>即时设计</a>：类 Figma</li>
<li><a href=https://www.cloudping.info>cloudping.info</a>：测试你的机器 ping 世界各地的亚马逊云服务器的速度。（AWS 云测速，一般需要关闭代理）</li>
<li><a href=https://www.cnblogs.com/yuleicoder/p/10049404.html>利用Docker 实现自动热部署</a>
<img loading=lazy src=images/docker%20depoly.png alt="Docker deploy">
</li>
<li><a href=https://juejin.cn/post/7119759020533448711>『前端进阶』🐳 Docker 部署 —> GitHub Active 自动部署</a></li>
<li><a href=https://www.infrapedia.com/app>世界互联网基础设施地图</a></li>
<li><a href=https://www.printfriendly.com/>printfriendly</a></li>
</ul>
</li>
</ul>
<h2 id=20230309>20230309<a hidden class=anchor aria-hidden=true href=#20230309>#</a></h2>
<ul>
<li>
<p>任务</p>
<ul>
<li>
<p><input checked disabled type=checkbox> 配置 Jenkins 的仓库同步与 docker 构建：关注点 Jenkinfile</p>
<ul>
<li>
<p><a href=https://www.jenkins.io/zh/doc/book/pipeline/>中文文档</a>比较旧，但是接触概念比较快，具体设置应该配合<a href=https://www.jenkins.io/doc/book/>英文文档</a>来看。</p>
</li>
<li>
<p>Pull Repository（Freestyle project 方式）</p>
<ul>
<li>
<p><a href=https://www.jenkins.io/doc/book/using/using-credentials/>credentials</a>: Manage Jenkins > Manage Credentials</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/61105369>How to use Github Personal Access Token in Jenkins</a>：username 随意，password 为 GitHub 的 PAT。（这里花了好长时间）</p>
<ul>
<li>Go to <code>credentials</code> > <code>System</code> > <code>Global credentials</code> > <code>Add credentials</code> a page will open.</li>
<li>In <strong>Kind</strong> drop-down select <strong>Username and password</strong>.</li>
<li>In User put a non-existing username like <code>jenkins-user</code> or <code>user</code>.</li>
<li>Add <code>Personal Access Token</code> in the password field</li>
</ul>
</li>
<li>
<p><a href=https://github.com/jenkinsci/gitlab-plugin/issues/539#issuecomment-797564572>ERROR: Couldn&rsquo;t find any revision to build</a>：master 改为 main</p>
</li>
<li>
<p>例子</p>
<ul>
<li>
<p><a href=https://medium.com/@mar_x10/how-to-use-jenkins-to-sync-your-code-repositories-between-acquia-git-and-github-465ec9008dfe>How to use Jenkins to Sync between your code repository on Acquia and GitHub?</a>：用 <a href=https://stackoverflow.com/a/12472740>cron</a> 做 tigger，即勾选 Poll SCM。</p>
</li>
<li>
<p><a href=https://www.blazemeter.com/blog/how-to-integrate-your-github-repository-to-your-jenkins-project>Jenkins GitHub Integration</a>：用 Webhooks 做 tigger，即勾选 GitHub hook trigger for GITScm polling，需要 <a href=https://plugins.jenkins.io/github/>GitHub Plugin</a>，这样仓库一有 push 就会执行 build 流程。</p>
<ul>
<li>go to your GitHub repository and click on <strong>&lsquo;Settings&rsquo;.</strong></li>
<li>Click on <strong>Webhooks</strong> and then click on <strong>&lsquo;Add webhook&rsquo;</strong></li>
<li>Click on <strong>Webhooks</strong> and then click on **&lsquo;Add webhook&rsquo;**In the <strong>&lsquo;Payload URL&rsquo;</strong> field, paste your Jenkins environment URL.</li>
<li><code>$JENKINS_BASE_URL/github-webhook/</code> — for example: <code>https://ci.example.com/jenkins/github-webhook/</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>Pull Repository（Pipeline 方式）</p>
<ul>
<li>
<p><a href=https://naiveskill.com/jenkins-pipeline-github/>Jenkins Pipeline Github | Complete Tutorial With Example</a></p>
<pre tabindex=0><code class=language-Jenkinfile data-lang=Jenkinfile>pipeline {
    agent any
    stages {
        stage('Build') {
            steps {
                git url: 'https://github.com/naiveskill/devops_cred.git', branch: 'main', credentialsId: 'github_creds'
            }
        }
    }
}
</code></pre></li>
</ul>
</li>
<li>
<p>Build Docker Image（Pipeline 方式）</p>
<ul>
<li>流程
<ul>
<li>
<p>先在本地编写 .dockerignore 与 Dockerfile 并运行通过</p>
<ul>
<li>
<p>.dockeringore</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#a6e22e>.git</span>
<span style=color:#a6e22e>node_modules</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p>然后编写 Jenkinsfile</p>
<pre tabindex=0><code class=language-Jenkinsfile data-lang=Jenkinsfile>docker.withRegistry('https://registry.example.com', 'credentials-id') {
  def customImage = docker.build(&quot;react-app-test&quot;, &quot;-f ${dockerfile} ./dockerfiles&quot;)
  customImage.inside {
    sh 'echo &quot;Stage Build Finished&quot;'
  }
  customImage.push()
}
</code></pre></li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://stackoverflow.com/a/48450294>Docker: Got permission denied while trying to connect to the Docker daemon socket at unix:///var/run/docker.sock</a></p>
<ul>
<li>
<p>The user <code>jenkins</code> needs to be added to the group <code>docker</code>, Then restart Jenkins.</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>sudo usermod -a -G docker jenkins
</code></pre></div></li>
<li>
<p>或者，直接在 Jenkinsfile 中用 sudo（如果可以的话）</p>
<pre tabindex=0><code class=language-Jenkinsfile data-lang=Jenkinsfile>sh 'sudo docker image build -t react-app-test .'
</code></pre></li>
</ul>
</li>
<li>
<p><a href=https://stackoverflow.com/a/39169504>How to tell jenkins not to kill processes after successful execution of job in multijob project?</a>:
<a href=https://wiki.jenkins-ci.org/display/JENKINS/ProcessTreeKiller>Jenkins : ProcessTreeKiller</a>
for pipelines: <code>JENKINS_NODE_COOKIE=dontKillMe /your/mongodb/process</code></p>
</li>
<li>
<p>参考</p>
<ul>
<li><a href=https://www.jenkins.io/doc/book/pipeline/docker/>Using Docker with Pipeline</a></li>
<li><a href=https://tutorials.releaseworksacademy.com/learn/building-your-first-docker-image-with-jenkins-2-guide-for-developers>Building your first Docker image with Jenkins 2: Guide for developers</a></li>
</ul>
</li>
<li>
<p>其他</p>
<ul>
<li>
<p><a href=https://stackoverflow.com/a/8077830>How to restart Jenkins manually?</a></p>
<ul>
<li><code>(jenkins_url)/safeRestart</code> - Allows all running jobs to complete. New jobs will remain in the queue to run after the restart is complete.</li>
<li><code>(jenkins_url)/restart</code> - Forces a restart without waiting for builds to complete.</li>
</ul>
</li>
<li>
<p><a href=https://www.theserverside.com/blog/Coffee-Talk-Java-News-Stories-and-Opinions/Fix-the-expected-a-step-Jenkins-error>Fix the &lsquo;expected a step&rsquo; Jenkins error</a>: Surround all code snippets in a <code>script { }</code> block</p>
</li>
<li>
<p><a href=https://zhuanlan.zhihu.com/p/342725605>10分钟搞定让你困惑的 Jenkins 环境变量</a></p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/8633575>How to keep environment variables when using sudo</a>: <code>-E, --preserve-env</code></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>export HTTP_PROXY<span style=color:#f92672>=</span>foof
sudo -E bash -c <span style=color:#e6db74>&#39;echo $HTTP_PROXY&#39;</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://hub.docker.com/r/jenkins/jenkins>jenkins/jenkins</a>：公司使用的部分</p>
<ul>
<li><a href=https://plugins.jenkins.io/publish-over-ssh/>Publish Over SSH</a>：通过 ssh 执行宿主机脚本</li>
<li><a href=https://hub.docker.com/r/jenkins/ssh-agent>jenkins/ssh-agent</a>：参见 <a href=https://www.jenkins.io/doc/book/using/using-agents/>Using Jenkins agents</a>，用于 Jeinks master 连接、管理 slave。</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>经验：</p>
<ul>
<li>区块链业界新闻：<a href=https://www.odaily.news>ODAILY</a>、<a href=https://www.theblockbeats.info>区块律动</a></li>
</ul>
</li>
</ul>
<h2 id=20230308>20230308<a hidden class=anchor aria-hidden=true href=#20230308>#</a></h2>
<ul>
<li>
<p>经验</p>
<ul>
<li>
<p><a href=https://learnblockchain.cn/article/1356>Hardhat</a>：帮助开发人员管理和自动化构建智能合约和dApp的过程中固有的重复任务。</p>
</li>
<li>
<p>iTerm2 相关问题</p>
<ul>
<li>
<p><a href=https://iterm2.com/documentation-hotkey.html>Dedicated Hotkey Windows</a>：设置系统快捷键 Command + Return 在其他 Window 上打开一个 iTerm Session</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/10628114>iterm2 default window size</a></p>
<p>You have to specify the default window size in rows and columns. The setting can be found in iTerm > Preferences > Profiles > Window. (160 x 35)</p>
</li>
<li>
<p><a href=https://apple.stackexchange.com/a/148514>How to open a new tab in iTerm in the same folder as the one that is open</a></p>
<p>Select &ldquo;Reuse previous session&rsquo;s directory&rdquo; from the preferences of your profile.</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/21360477>How can I set an environment variable only for the duration of the script?</a>
<code>VAR=value</code> 是我想要的， <code>env VAR=value</code> 会 export 到当前环境之中。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>https_proxy<span style=color:#f92672>=</span>http://127.0.0.1:7890 http_proxy<span style=color:#f92672>=</span>http://127.0.0.1:7890 all_proxy<span style=color:#f92672>=</span>socks5://127.0.0.1:7890 sh -c <span style=color:#e6db74>&#34;</span><span style=color:#66d9ef>$(</span>curl -fsSL https://raw.githubusercontent.com/ohmyzsh/ohmyzsh/master/tools/install.sh<span style=color:#66d9ef>)</span><span style=color:#e6db74>&#34;</span>
</code></pre></div></li>
<li>
<p><a href=https://mirrors.tuna.tsinghua.edu.cn/help/ohmyzsh.git/>ohmyzsh Git 镜像</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>git clone https://mirrors.tuna.tsinghua.edu.cn/git/ohmyzsh.git
cd ohmyzsh/tools
REMOTE<span style=color:#f92672>=</span>https://mirrors.tuna.tsinghua.edu.cn/git/ohmyzsh.git sh install.sh
</code></pre></div></li>
<li>
<p><a href=https://a1049145827.github.io/2019/05/15/Mac-%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85%E5%B9%B6%E9%85%8D%E7%BD%AE%E7%BB%88%E7%AB%AF%E7%A5%9E%E5%99%A8-oh-my-zsh/>ohmyzsh plugin</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>git clone --depth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> git@github.com:zsh-users/zsh-autosuggestions.git $ZSH_CUSTOM/plugins/zsh-autosuggestions
git clone --depth<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span> git@github.com:zsh-users/zsh-syntax-highlighting.git $ZSH_CUSTOM/plugins/zsh-syntax-highlighting
</code></pre></div><p>.zshrc</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=color:#a6e22e>plugins</span><span style=color:#f92672>=</span><span style=color:#e6db74>(git macos zsh-autosuggestions zsh-syntax-highlighting)</span>
</code></pre></div></li>
</ul>
</li>
</ul>
</li>
<li>
<p>运维相关</p>
<ul>
<li>
<p>服务器：hp server、orcale server、google cloud、desktop、pi</p>
</li>
<li>
<p>操作系统：Ubuntu</p>
</li>
<li>
<p>mysql/mongodb</p>
</li>
<li>
<p>redis cluster</p>
</li>
<li>
<p>elasticsearch</p>
</li>
<li>
<p>ipfs</p>
</li>
<li>
<p>ribbitmq 消息队列</p>
</li>
<li>
<p>koa/nest.js 服务</p>
</li>
<li>
<p>管理：Portainer、Kong</p>
</li>
<li>
<p>ansible：批量系统配置、批量程序部署、批量运行命令等功能。</p>
</li>
<li>
<p>auditd：审计工具</p>
</li>
<li>
<p>cloud-init：云平台为Linux操作系统的虚拟机做系统初始化配置的开源服务软件。</p>
</li>
<li>
<p><a href=https://tailscale.com>tailscale</a> P2P VPN 工具：</p>
<ul>
<li>
<p>安装配置：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>brew install --cask tailscale
defaults write io.tailscale.ipn.macsys ControlURL http://104.199.128.36:8082
</code></pre></div></li>
<li>
<p>运行tailscale，点击log in，获取类似<code>headscale nodes register --user USERNAME --key nodekey:...</code>命令，发给管理员让他加你进入。</p>
<ul>
<li>注意关闭系统代理。</li>
<li>注意设置防火墙让 tailscale 通过。</li>
<li>如果无网则取消勾选 Use Tailscale DNS Setting。（Mac dns 也在 resolve.conf 中看）</li>
</ul>
</li>
<li>
<p>最后与管理员沟通获取登陆具体服务器的信息，登陆用 VLAN IP。</p>
</li>
<li>
<p>连接之后是可以与 CFW 一起使用的！</p>
</li>
</ul>
</li>
<li>
<p><a href=https://docs.onedev.io>OneDev</a> CI/CD 工具：配置仓库同步（已弃，彭梓旭不喜欢 yaml）</p>
<ul>
<li>获取 <a href=https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token>Github Person Token</a>：就在个人设置的 Developer settings 中。</li>
<li>在面板中 Projects 栏中，点击 Import 导入 Github 仓库，根据提示填入对应内容。</li>
<li>查看 <a href=https://docs.onedev.io/tutorials/cicd/commit-and-push>Commit and Push in Job</a>配置 job secret，并为项目设置一个 checkout step（关键，否则不能 pull push），用 http(s) 认证。</li>
<li>参考在《<a href=https://juejin.cn/post/7093820467823247396>OneDev里配置仓库同步</a>》：
<ul>
<li>添加一个 pull（勾选 force） step（定义做什么），用于拉取 github 仓库。</li>
<li>设定 <a href=http://www.quartz-scheduler.org/documentation/quartz-2.3.0/tutorials/crontrigger.html>Cron Tigger</a> 的 trigger（定义何时运行）。（Bruch update 只适合 push，pull 是不会自动的，除非用 <a href=https://weizhimiao.github.io/2017/02/03/Github%E4%B8%ADwebhooks%E5%BA%94%E7%94%A8/>github webhooks</a>）</li>
<li>编辑后查看 .onedev-buildspec.yml 源文件，添加到项目中并同步到 github。</li>
<li>运行 Job 拉取 github 进行测试。</li>
<li>解释：同时加 push 与 pull step 的并勾选 force （必须，否则不能拉取最新的内容）的话，如果先 push，则会将 github 所有更改删除，先 pull 则会将 onedev 所有修改删除（即 .onedev-buildspec.yml 文件），因此干脆只用一个。</li>
</ul>
</li>
<li>关键点在于 .onedev-buildspec.yml 这个文件。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230307>20230307<a hidden class=anchor aria-hidden=true href=#20230307>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>Mac 与 Windows 传输文件。我尝试了 FileZilla 与 Samba，都没成功，很烦。尝试使用 Snapdrop，体验没有 Aridrop 好（只有 2 MB/s 左右），问题例如：不能刷新，不能开代理，传输大文件中断。最后通过 python3 -m http.server 起个 http server 解决，http 本来就是分享资源的，完全可行。这里有个误区，传输老想着用传输工具，而不是使用现有的能够传输的东西。这里也发现 Mac 默认不开防火墙。</p>
</li>
<li>
<p><a href=https://www.oracle.com/cn/cloud/free/>Orcale 永久免费云服务</a>：很难申请成功。</p>
</li>
<li>
<p>Docker 相关问题：</p>
<ul>
<li>
<p><a href=https://apple.stackexchange.com/a/373914>How do I start the docker daemon on macOS?</a>：</p>
<ul>
<li>我用的 Macbook air 是 arm（M1），安装不了 virtualbox 啊！</li>
<li>用 <code>brew install --cask docker</code> 安装，在桌面启动 docker.app，在 terminal 运行 docker 命令就行了。</li>
</ul>
</li>
<li>
<p><a href=https://www.cnblogs.com/fat-girl-spring/p/14769198.html>Dockerfile RUN，CMD，ENTRYPOINT命令区别</a></p>
</li>
<li>
<p><a href=https://www.cnblogs.com/sparkdev/p/9573248.html>Dockerfile 中的 COPY 与 ADD 命令</a>：COPY 可用于 multistage 场景下，把前一阶段构建的产物拷贝到另一个镜像中；ADD 解压压缩文件并把它们添加到镜像中。</p>
</li>
<li>
<p>常用命令：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=color:#75715e># 创建 image 文件</span>
docker image build -t freefrom -f Dockerfile.hardhat --platform linux/amd64 .

<span style=color:#75715e># 查看镜像元数据，Layers 可看到镜像所有层</span>
docker image inspect hello-world

<span style=color:#75715e># 新建容器，容器的 3000 端口映射到本机的 8000 端口。</span>
docker container run --rm -p 8000:3000 --name container-name -it koa-demo /bin/sh

<span style=color:#75715e># 通过 docker-compose 新建容器</span>
docker-compose up --build -d

<span style=color:#75715e># 查看容器 logs，不论是 running 的还是 stop 的</span>
docker contianer logs 69d1

<span style=color:#75715e># 进入容器</span>
docker container exec -it 11fd20be74b6 sh

<span style=color:#75715e># 清理 image、container、network、build cache</span>
docker system prune -af

<span style=color:#75715e># 查看容器状态</span>
docker container stats b901a13001a0


</code></pre></div></li>
<li>
<p>Puppeteer 报错：<a href=https://pptr.dev>Puppeteer</a> is a Node.js library which provides a high-level API to control Chrome/Chromium over the DevTools Protocol.</p>
<ul>
<li>
<p>问题一：<code>The chromium binary is not available for arm64</code></p>
<p>因该是默认用当前系统架构，改架构用 <a href=https://www.docker.com/blog/multi-arch-images/><code>--platform linux/amd64</code></a>。
但是问题是成功创建了 linux/amd64 镜像后，在 M1 的 Mac 上也运行运行不了啊！</p>
</li>
<li>
<p>问题二：<code>ERROR: Failed to set up Chromium r800071!</code></p>
<p>因为只是测试 node_modules layer，所以暂时通过 <code>--ignore-scripts</code> 跳过。</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p><a href=https://stackoverflow.com/a/30316600>How to copy multiple files in one layer using a Dockerfile?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Dockerfile data-lang=Dockerfile><span style=color:#66d9ef>COPY</span> README.md package.json gulpfile.js __BUILD_NUMBER ./<span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> dir1/* dir2/* ./<span style=color:#960050;background-color:#1e0010>
</span></code></pre></div></li>
<li>
<p>docker build 前端项目的话，每次都需要下载 node_modules，这也太耗费流量了吧。
<a href=https://stackoverflow.com/a/35774741>解决</a>：</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-Dockerfile data-lang=Dockerfile><span style=color:#66d9ef>FROM</span><span style=color:#e6db74> node:16</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> package.json /tmp/package.json<span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>COPY</span> yarn.lock /tmp/yarn.lock<span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> cd /tmp <span style=color:#f92672>&amp;&amp;</span> yarn install --frozen-lockfile<span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>RUN</span> mkdir -p /usr/app <span style=color:#f92672>&amp;&amp;</span> cp -a /tmp/node_modules /usr/app<span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010>
</span><span style=color:#960050;background-color:#1e0010></span><span style=color:#66d9ef>WORKDIR</span><span style=color:#e6db74> /usr/app</span><span style=color:#960050;background-color:#1e0010>
</span></code></pre></div><p><a href=https://segmentfault.com/q/1010000024461294>解析</a>：</p>
<ul>
<li>所有docker 只用在命令“没有变化”时才会用缓存。而且，一但某一条命令没能利用缓存，那么后续的所有命令都不会使用缓存。除了 COPY 跟 ADD，只要 Dockerfile 里的指令行没有变化就认为没有变化。对于 COPY 跟 ADD ，还要比较文件内容跟属性。所以，如果先 COPY 整个项目，那么大多数情况下会有变化（没变化就不需要重打镜像了），于是不能使用缓存。</li>
<li>docker image 是分层的 (layer) ，每一个命令增加一个新的 layer 。打包结束之后，在打包的机器上，dockerfile 每一条命令执行之后“镜像”都存在，只要把相应的 layer 取出来就可以了。dockerfile 指令的执行，其实是先拿到上一个指令生成的镜像，执行当前指令，再把结果保存成一个新的镜像。两次执行 dockerfile ，如果发现执行当前指令的镜像已经存在，就直接拿过来用了，而不会重新执行指令，这就是所谓“缓存”。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230306>20230306<a hidden class=anchor aria-hidden=true href=#20230306>#</a></h2>
<ul>
<li>经验：
<ul>
<li>
<p><a href=https://opensea.io>OpenSea, the largest NFT marketplace</a></p>
</li>
<li>
<p><a href=https://www.payititi.com>帕依提提-人工智能数据集开放平台</a></p>
</li>
<li>
<p><a href=https://unpkg.com/browse/three@0.92.0/>UNPKG - three.js</a></p>
</li>
<li>
<p><a href=https://juejin.cn/post/6940079683740368933>骨骼动画—从基础建模到Threejs渲染</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js>  <span style=color:#a6e22e>loader</span>.<span style=color:#a6e22e>load</span>(<span style=color:#e6db74>&#39;./girl.fbx&#39;</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>fbx</span>) {
            <span style=color:#a6e22e>fbx</span>.<span style=color:#a6e22e>scale</span>.<span style=color:#a6e22e>set</span>(<span style=color:#ae81ff>0.1</span>, <span style=color:#ae81ff>0.1</span>, <span style=color:#ae81ff>0.1</span>);
            <span style=color:#a6e22e>scene</span>.<span style=color:#a6e22e>add</span>(<span style=color:#a6e22e>fbx</span>);
            <span style=color:#a6e22e>loader</span>.<span style=color:#a6e22e>load</span>(<span style=color:#e6db74>&#39;./Walking.fbx&#39;</span>, <span style=color:#66d9ef>function</span> (<span style=color:#a6e22e>anim</span>) {
                <span style=color:#75715e>//创建了一个针对于该模型的混合器
</span><span style=color:#75715e></span>                <span style=color:#a6e22e>mixer</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>THREE</span>.<span style=color:#a6e22e>AnimationMixer</span>(<span style=color:#a6e22e>fbx</span>);
                <span style=color:#75715e>// 动画片段
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>clip</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>anim</span>.<span style=color:#a6e22e>animations</span>[<span style=color:#ae81ff>0</span>]; 
                <span style=color:#75715e>// 使用混合器和动画片段创建一个动画播放器来播放
</span><span style=color:#75715e></span>                <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>action</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>mixer</span>.<span style=color:#a6e22e>clipAction</span>(<span style=color:#a6e22e>clip</span>); 
                <span style=color:#a6e22e>action</span>.<span style=color:#a6e22e>setDuration</span>(<span style=color:#ae81ff>1</span>);
                <span style=color:#a6e22e>action</span>.<span style=color:#a6e22e>play</span>();
            });
        });
  <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>clock</span> <span style=color:#f92672>=</span> <span style=color:#66d9ef>new</span> <span style=color:#a6e22e>THREE</span>.<span style=color:#a6e22e>Clock</span>();
  <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>animate</span>() {
        <span style=color:#75715e>// 向浏览器发送请求我希望你稍后调用函数，默认是每秒调用60次
</span><span style=color:#75715e></span>        <span style=color:#a6e22e>requestAnimationFrame</span>(<span style=color:#a6e22e>animate</span>)

        <span style=color:#66d9ef>var</span> <span style=color:#a6e22e>time</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>clock</span>.<span style=color:#a6e22e>getDelta</span>();
        <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>mixer</span>) {
            <span style=color:#a6e22e>mixer</span>.<span style=color:#a6e22e>update</span>(<span style=color:#a6e22e>time</span>);
        }
  }
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230305>20230305(🛌)<a hidden class=anchor aria-hidden=true href=#20230305>#</a></h2>
<ul>
<li>three.js 关注点（笔记）：
<ul>
<li>render（渲染器） 渲染 scene（场景） 和 camera（相机），scene 中添加 mesh（模型）和 light（光源），mesh 由 geometry（几何体） 和 material（材质） 构成。</li>
<li>OrbitControls 鼠标操作三维场景。</li>
<li>参数widthSegments、heightSegments约束的是球面的精度，球体你可以理解为正多面体，就像圆一样是正多边形，当分割的边足够多的时候，正多边形就会无限接近于圆，球体同样的的道理。</li>
<li>辅助三维坐标系AxisHelper，光源辅助对象SpotLightHelper、PointLightHelper、DirectionalLightHelper，骨骼辅助显示 SkeletonHelper。</li>
<li>漫反射、镜面反射分别对应两个构造函数MeshLambertMaterial()、MeshPhongMaterial()。</li>
<li>类型数组之所以有类型这个定语，就是因为每一个构造函数对应一种 number类型里面细分的数据类型，例如构造函数Int8Array()创建的数组每个元素占据的内存是8位。</li>
<li>对于网格模型Mesh而言，几何体geometry由三个顶点为一组渲染出来的三角形组成。</li>
<li>平行光漫反射简单数学模型：漫反射光的颜色 = 网格模型材质颜色值 x 光线颜色 x 光线入射角余弦值</li>
<li>可以通过 .traverse() 递归遍历的算法去遍历Threejs一个模型对象的所有后代</li>
<li>所谓本地坐标系或者说模型坐标系，就是模型对象相对模型的父对象而言。世界坐标系默认就是对Threejs整个场景Scene建立一个坐标系，一个模型相对世界坐标系的坐标值就是该模型对象所有父对象以及模型本身位置属性.position的叠加。</li>
<li>纹理坐标：以图片左下角为坐标原点，右上角为坐标(1.0,1.0)，图片上所有位置纵横坐标都介于0.0~1.0之间。纹理UV坐标和顶点位置坐标是一一对应关系。</li>
<li>关键帧KeyframeTrack和剪辑AnimationClip两个API来完成关键帧动画，通过操作AnimationAction和混合器AnimationMixer两个API播放已有的帧动画数据。</li>
<li>通过Bone类可以实例化一个骨关节对象，然后通过多个骨关节对象可以构成一个骨骼层级系统；通过Skeleton类可以把所有骨关节对象Bone包含进来；SkinnedMesh类的字面意思就是骨骼网格模型。</li>
<li>导出模型信息：<code>console.log(JSON.stringify(geometry.toJSON()));</code></li>
</ul>
</li>
</ul>
<h2 id=20230304>20230304(🛌)<a hidden class=anchor aria-hidden=true href=#20230304>#</a></h2>
<ul>
<li><a href=https://juejin.cn/post/7196110128038690876>2022大前端总结和2023就业分析</a>：
<ul>
<li>未来：AI 和 Cropto（PS：公司之前为区块链，现在人工智能机器人，完美覆盖啊）</li>
<li>2022年前端主流趋势
<ul>
<li>性能——构建工具：make => Grunt => Gulp => Webpack => Vite => Turbopack</li>
<li>运行时：Node.js、Deno、Bun</li>
<li>体积：SSR
<ul>
<li>通常产品开发都是先实现功能，然后再优化，然后再做周边</li>
<li>当你想提升性能的时候，除了万金油缓存外，减小体积就是最简单的方式</li>
<li>跨度领域：Gluon、Electron、Tauri、Neutralinojs</li>
</ul>
</li>
<li>Rust 写前端基建，是当下趋势</li>
<li>前端垂类，其实是最吃香的部分：比如互动游戏，3d，webrtc，比如可视化编辑器，AFFiNE，QUill，X6</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230303>20230303<a hidden class=anchor aria-hidden=true href=#20230303>#</a></h2>
<ul>
<li>经验
<ul>
<li>在 vscode 中，Command+点击 lingo 组件属性，就可以到类型定义文件 d.ts，然后就可以看到支持哪些属性及其类型，然后见名知意，或查找这些属性都起什么作用。</li>
<li>像 onClick 这样的属性，按照上面操作后定位到类型定义文件后，就可以看其路径，然后在原文件中导入类型就可以使用了。</li>
<li>VSCode 插件 Live Server 解决跨域问题。</li>
</ul>
</li>
<li>任务：
<ul>
<li><input checked disabled type=checkbox> 看完 Lingo3d.js 后，继续学 three.js（我司急需）
<ul>
<li><input checked disabled type=checkbox> <a href=https://github.com/mrdoob/three.js>three.js</a>：首先看《<a href=https://www.jianshu.com/p/563a03703abb>Three.js入门</a>》这篇入门文章，然后以《<a href=http://www.yanhuangxueyuan.com/Three.js/>Three.js零基础入门教程</a>》为主，加上<a href="https://www.bilibili.com/video/BV14r4y1G7h4/?spm_id_from=333.999.0.0&vd_source=db85d1a9d6de9b2fe41031cf5a653095">配套视频教程</a>，以《<a href=https://threejs.org/docs/index.html#manual/zh/introduction/Creating-a-scene>three.js 官方中文文档</a>》为辅（主要用于看最新的API）进行学习。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230302>20230302<a hidden class=anchor aria-hidden=true href=#20230302>#</a></h2>
<ul>
<li>经验
<ul>
<li>lingo3d 关注点：官网可以用来调各种属性，看其作用（不完善且旧）；GitHub 上有以 <code>example-</code> 开头的仓库，都是例子。
<ul>
<li><code>World</code> 组件
<ul>
<li><code>Model</code> 组件：放人物或场景模型
<ul>
<li><code>src</code> 属性：加载模型 fbx 文件，建议使用绝对路径</li>
<li><code>animations</code> 属性：加载自定义动画 fbx 文件</li>
<li><code>animation</code> 属性：使用模型本身包含的动画或自定义动画</li>
<li><code>physics</code> 属性：值为 <code>map</code> 时，<code>src</code> 需要使用相应 scene（场景）模型，否则会发现，人物模型加了<code>physics="character"</code>后，会不断的往下掉</li>
<li><code>ref</code> 属性：控制模型的移动
<ul>
<li><code>ref.current.lookAt()</code> 方法：人物看向目标点</li>
<li><code>ref.current.moveForward(-1)</code> 方法：往自己前方走</li>
<li><code>onLoop</code> 方法：每帧</li>
<li><code>ref.current.lookTo</code> 方法：看向，最后为转向速度</li>
<li><code>ref.current.moveTo</code> 方法：移动，最后为移动速度</li>
<li><code>ref.current.onMoveToEnd</code> 方法：移动结束事件</li>
</ul>
</li>
<li><code>innerY</code> 属性：模型相对于 xyz 中心移动</li>
<li><code>intersectIDs</code> 和 <code>onIntersect</code> 属性：当碰撞 <code>intersectIDs</code> 中指定 id 的模型时，会触发 <code>onIntersect</code> 事件</li>
<li><code>roughnessFactor</code> 属性：粗糙度系数</li>
<li><code>Find</code> 组件：定鼠标瞄准时状态</li>
</ul>
</li>
<li><code>Dummy</code> 组件：官方提供的人体模型</li>
<li><code>Cube</code> 组件：立方体
<ul>
<li><code>x</code> 和 <code>y</code> 和 <code>z</code>/<code>depth</code> 属性: x 轴、y 轴、z 轴</li>
<li><code>id</code> 属性：可用于碰撞检测</li>
<li><code>texture</code> 属性：材质</li>
<li><code>textureRepeat</code> 属性：如果糊的话，就使之重复次数变高</li>
<li><code>onClick</code> 属性：
<ul>
<li><code>e.point</code>：位置（x、y、z）</li>
</ul>
</li>
</ul>
</li>
<li><code>OrbitCamera</code> 组件：使相机按照一定的路径运动
<ul>
<li><code>autoRotate</code>：自动绕y轴旋转</li>
</ul>
</li>
<li><code>ThirdPersonCamera</code> 组件：使相机看向并跟随放入其中的人物模型（Model 是其子元素）
<ul>
<li><code>ative</code> 属性：激活相机</li>
<li><code>mouseControl</code> 属性：鼠标控制</li>
<li><code>innerY</code> 属性：移动内部的相机</li>
<li><code>lockTargetRotation</code> 属性：解决人物不受控制</li>
<li><code>fov</code> 属性：焦距，人眼在 50 左右，焦距越小，中心面越广</li>
</ul>
</li>
<li><code>Skybox</code> 组件：需要360度环绕背景图片（equirectangular），或者 <a href=https://polyhaven.com>Poly Haven</a></li>
<li><code>Keyboard</code> 组件：同 useKeyboard</li>
<li><code>LingoEditor</code> 组件：同 Editor</li>
<li><code>HTML</code> 组件：直接添加 html</li>
<li><code>Editor</code> 组件：需要关闭相机的 active，同失效的 map-debug（放在 Word 外部会在屏幕中间挡住内容）</li>
</ul>
</li>
<li><code>Reticle</code> 组件：准星</li>
<li><code>Setup</code> 组件：代替在 World 组件中设置属性</li>
<li><code>Reflector</code> 组件：反光板</li>
<li><code>useLoop(function, boolean)</code> hook：循环，不断做某事</li>
<li><code>useKeyboard</code> hook：鼠标事件</li>
<li><code>usePreload</code> hook：预加载模型，返回 progress</li>
</ul>
</li>
<li><a href=https://www.mixamo.com>Mixamo</a>：
<ul>
<li>绑好骨骼的模型： with skin 下载（t-pose）</li>
<li>仅动作： without skin 下载，in place 复选框就不往前走（原地走）</li>
</ul>
</li>
<li><code>@xstate/react</code>：状态机（超赞）,<a href=https://www.bilibili.com/video/BV1mL4y157pJ>例子链接</a>，还有 xstate vscode 插件。</li>
<li>VSCode 快捷键
<ul>
<li>Ctrl+鼠标左击：跳到定义</li>
<li>Ctrl+-：返回</li>
<li>Command+i：显示智能补全</li>
<li>Command+.：quick fix</li>
<li>Shift+Option+F：格式化代码</li>
<li>Command+Option+左方括号：折叠代码块</li>
<li>Command+Option+右方括号：展开代码块</li>
<li>Command+/：单行注释</li>
<li>Shift+Option+A：多行注释</li>
</ul>
</li>
<li>typescript 自定义类型：<a href=https://ts.xcatliu.com>TypeScript 入门教程</a>：如果需要看源代码的话，例如 lingo.js 官方文档不全，那么只能通过源码来看如何使用了，这就要求有足够的 typescript 知识。我之前虽然系统学过 typescript，但是在看 lingo 源码还是疑惑 class 即是类又是类型的，经过查找回忆了起来，总结如下
<ul>
<li>在定义 class 的时候会创建同名的实例类型
<ul>
<li>定义：<code>class ClassName {}</code></li>
<li>使用：
<ul>
<li><code>let a: ClassName = new ClassName()</code></li>
<li><code>class ClassNameB extends classNameA</code></li>
</ul>
</li>
</ul>
</li>
<li>interface 定义接口类型
<ul>
<li>定义：<code>interface InterfaceName</code></li>
<li>使用：
<ul>
<li><code>let b: InterfaceName</code></li>
<li><code>class ClassNameB extends classNameA implements InterfaceNameA, InterfaceNameB</code></li>
</ul>
</li>
</ul>
</li>
<li>type 用于类型别名
<ul>
<li>定义：<code>type TypeName = ClassName</code></li>
<li>使用：<code>let c: TypeName</code></li>
</ul>
</li>
<li>declare 声明类型：例如指定某变量为某种类型，用于代码补全、接口提示，多写在 d.ts 类型声明文件中
<ul>
<li>定义：<code>declare let d: ClassName</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230301>20230301<a hidden class=anchor aria-hidden=true href=#20230301>#</a></h2>
<ul>
<li>
<p>文章</p>
<ul>
<li><a href=https://www.zhangxinxu.com/wordpress/2023/02/js-curve-two-points/>任意两个点的曲线连接JS算法</a>：衡量自己Web前端技术的一个简单办法就是，如果让你实现这样一个产品，你能否立刻在脑中形成实现方案，并完成之。</li>
</ul>
</li>
<li>
<p>任务</p>
<ul>
<li><input checked disabled type=checkbox> 学习 <a href=https://github.com/lingo3d/lingo3d>lingo3d</a>
<ul>
<li>官网有点问题，因此以<a href=https://juejin.cn/post/7087730315531141128>别卷了，快来玩 | React+Lingo 实现一个超好玩的3D游戏：美女与龙珠</a>这篇文章做入门，一边看一边做，然后看其参考的<a href=https://space.bilibili.com/1810581995/video>Lingo3D官方B站视频</a>，看一遍，之后根据具体需求，在 Github 上 <a href=https://github.com/lingo3d>lingo3d organizations</a> 的仓库集中选择一个对应场景的 <code>example-</code> 开头的仓库作为例子来学习，最后尝试自己完成一个项目，用到所学习的知识。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230227>20230227<a hidden class=anchor aria-hidden=true href=#20230227>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>VSCode Bookmarks 用于代码间跳转</p>
<ul>
<li>使用 Command+Shift+P 搜索 bookmarks 可以看到所有快捷键</li>
<li>使用 Option+Command+K 为 Toggle</li>
<li>使用 Option+Command+L/J 为跳转</li>
</ul>
</li>
<li>
<p>scrollbar 滚动到底部</p>
<ul>
<li>在 typescript 中，需使用 useRef 并<a href=https://dev.to/busypeoples/notes-on-typescript-react-hooks-28j2>注意类型</a>
<ul>
<li>创建时需要设定初始值范型 <code>const inputEl = useRef&lt;HTMLInputElement>(null);</code></li>
<li>访问时需要在条件语句中 <code>if (inputEl.current) { inputEl.current.focus(); // Works! }</code></li>
</ul>
</li>
<li>可在 componentDidMount/componentDidUpdate 或 useEffect 中调用</li>
<li>作用在父容器，<a href=https://www.jianshu.com/p/4c9e59b84674>滚动到最底部方法</a>为： <code>$div.scrollTop = $div.scrollHeight</code></li>
<li>作用在子元素，可用 <a href=https://blog.csdn.net/learn8more/article/details/108047794>scrollIntoView</a>：<a href=https://segmentfault.com/a/1190000021881842>例子</a></li>
</ul>
</li>
<li>
<p>在 useEffect 中访问之前的状态（<a href=https://stackoverflow.com/a/53446665>How to compare oldValues and newValues on React Hooks useEffect?</a>）：使用 usePrevious</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// modified from https://usehooks.com/usePrevious/
</span><span style=color:#75715e></span><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>default</span> <span style=color:#66d9ef>function</span> <span style=color:#a6e22e>usePrevious</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>T</span><span style=color:#f92672>&gt;</span>(<span style=color:#a6e22e>value</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>T</span>) {
  <span style=color:#75715e>// The ref object is a generic container whose current property is mutable ...
</span><span style=color:#75715e></span>  <span style=color:#75715e>// ... and can hold any value, similar to an instance property on a class
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>ref</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>useRef</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>T</span><span style=color:#f92672>&gt;</span>()

  <span style=color:#75715e>// Store current value in ref
</span><span style=color:#75715e></span>  <span style=color:#a6e22e>useEffect</span>(() =&gt; {
    <span style=color:#a6e22e>ref</span>.<span style=color:#a6e22e>current</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>value</span>
  }, [<span style=color:#a6e22e>value</span>]) <span style=color:#75715e>// Only re-run if value changes
</span><span style=color:#75715e></span>
  <span style=color:#75715e>// Return previous value (happens before update in useEffect above)
</span><span style=color:#75715e></span>  <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>ref</span>.<span style=color:#a6e22e>current</span>
}
</code></pre></div><p><a href=https://zhuanlan.zhihu.com/p/117577458>原理</a>：jsx的渲染比useEffect早，<code>ref.current</code> 是 preState，useEffect 是最新 state</p>
</li>
<li>
<p><a href=https://swr.vercel.app/zh-CN/docs/mutation>Mutation</a>：类似 useState，用来修改更改远程数据及相关缓存</p>
<ul>
<li><code>mutate()</code>/<code>mutate(key)</code>：将数据标记为已过期并触发重新获取(<a href=https://github.com/vercel/swr/discussions/812>revalidate is deprecated</a>)</li>
<li><code>mutate(key, data, options)</code>：修改本地缓存数据，可选是否重新获取</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230226>20230226<a hidden class=anchor aria-hidden=true href=#20230226>#</a></h2>
<ul>
<li>
<p>经验</p>
<ul>
<li>
<p>如果不想在 useEffect 第二个参数数组中加入某个状态，但是在 useEffect 中又需要改变与访问该状态，则可以<a href=https://blog.csdn.net/weixin_44217613/article/details/122348323>将一个返回新状态的函数传递给 setState</a>。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> [<span style=color:#a6e22e>currentState</span>, <span style=color:#a6e22e>setCurrentState</span>] <span style=color:#f92672>=</span> <span style=color:#a6e22e>useState</span>(<span style=color:#a6e22e>defaultState</span>)

<span style=color:#a6e22e>useEffect</span>(() =&gt; {
<span style=color:#75715e>// prevState为上一次的状态(previous)
</span><span style=color:#75715e></span>  <span style=color:#a6e22e>setCurrentState</span>(<span style=color:#a6e22e>prevState</span>) =&gt; {
    <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>newState</span> <span style=color:#f92672>=</span> {
    ...<span style=color:#a6e22e>prevState</span>,
    ...<span style=color:#a6e22e>appendState</span>
    }
    <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>newState</span>
  })
},[])
</code></pre></div></li>
</ul>
</li>
<li>
<p><a href=https://devtrium.com/posts/set-interval-react>setInterval in React</a>：我记得在 React 文档中看到过，但是找不到了。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-react data-lang=react><span style=color:#a6e22e>useEffect</span>(() =&gt; {
  <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>interval</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>setInterval</span>(() =&gt; {
    <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;This will be called every 2 seconds&#39;</span>);
  }, <span style=color:#ae81ff>2000</span>);

  <span style=color:#66d9ef>return</span> () =&gt; <span style=color:#a6e22e>clearInterval</span>(<span style=color:#a6e22e>interval</span>);
}, []);
</code></pre></div></li>
<li>
<p><a href=https://blog.csdn.net/qq_41579104/article/details/120972171>判断数组中是否存在某个元素</a>：indexOf、find、some、includes</p>
</li>
<li>
<p>GitLens 可以增强 VSCode 内置 Git 的功能。例如 commits 搜索，历史记录和显示的代码作者身份</p>
</li>
</ul>
<h2 id=20230225>20230225<a hidden class=anchor aria-hidden=true href=#20230225>#</a></h2>
<ul>
<li>经验
<ul>
<li>
<p>参考<a href=https://github.com/yichengchen/clashX/discussions/717>建议添加以下规则，osx下有可能会导致偷跑流量</a> 添加如下规则</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#ae81ff>DOMAIN-SUFFIX,googletraveladservices.com,DIRECT</span>
- <span style=color:#ae81ff>DOMAIN,dl.google.com,DIRECT</span>
- <span style=color:#ae81ff>DOMAIN,mtalk.google.com,DIRECT</span>
- <span style=color:#ae81ff>DOMAIN,safebrowsing.googleapis.com,DIRECT</span>
</code></pre></div></li>
<li>
<p>最小的屏幕是 280px，Galaxy Fold</p>
</li>
<li>
<p><a href=https://www.cnblogs.com/GeniusLyzh/p/8324811.html>监听动画结束</a></p>
<ul>
<li>transitionEnd事件会在CSS transition动画结束后触发。</li>
<li>当存在多个属性过渡变化时，结束时会多次触发transitionend事件。</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230224>20230224<a hidden class=anchor aria-hidden=true href=#20230224>#</a></h2>
<ul>
<li>
<p>经验</p>
<ul>
<li>
<p>NEXT_PUBLIC_DEFAULT_CHAINID 就是不同的区块链，其是固定的，97 是公司测试链，1 是以太坊</p>
</li>
<li>
<p><a href=https://stackoverflow.com/a/23633266>ETIMEDOUT</a>：This is caused when your request response is not received in given time(by timeout request module option).</p>
</li>
<li>
<p>代理下 git 无法 clone，cfw 可以<a href=https://docs.cfw.lbyczf.com/contents/bypass.html>绕过系统代理</a>，这样就 OK 了，但在 TUN 模式下这个是无效的。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml><span style=color:#f92672>bypass</span>:
  - <span style=color:#e6db74>&#34;github.com&#34;</span> <span style=color:#75715e># 下面字段可不删除</span>
  - <span style=color:#ae81ff>127.0.0.1</span>
  - <span style=color:#ae81ff>...</span>
</code></pre></div><p>更新：这种方式不好，这样用 git 确实是可以 clone 了，但是浏览 github 网页却很慢（即没被代理）——我的需求是，可以 git clone，同时在网页也能快速访问 github，即 git clone 不被代理，github 被代理。
尝试<a href=https://docs.cfw.lbyczf.com/contents/parser.html#%E7%89%88%E6%9C%AC%E8%A6%81%E6%B1%82>配置文件预处理</a> 一直没成功，烦，现在暂时只能在需要 git clone 的时候关闭代理了。
CFW 本身就是用的 clash Premium，因此可以参考<a href=https://blog.hifool.cn/posts/f42b65b0/>clash更新订阅时保留自己的规则</a>，自己写一个带 <code>proxy-providers</code> 的配置文件，然后添加以下 rule 即可</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-yaml data-lang=yaml>- <span style=color:#ae81ff>PROCESS-NAME,git,DIRECT</span>
</code></pre></div></li>
<li>
<p><a href=https://chrome.google.com/webstore/detail/svg-screenshot/nfakpcpmhhilkdpphcjgnokknpbpdllg/related>SVG Screenshot</a>：可以将网页保存为 svg （选择框或视口内容）</p>
</li>
</ul>
</li>
<li>
<p>任务</p>
<ul>
<li><input checked disabled type=checkbox> 除了 UI 图，还有产品文档，还有测试网站。根据产品文档+<del>测试网站</del>开发网站（我觉得应该用开发网站，即用最新的nofar分支，yarn dev 来体验，这是最新的，bug 也是最新的）走通流程，然后去细看 UI 设计+项目代码，快速熟悉。</li>
</ul>
</li>
<li>
<p>观点</p>
<ul>
<li>APP 的价值在于其对用户是有用的，要有用，前提是能用，所以没有 bug ，或者说没有影响正常使用的 bug 至关重要。</li>
<li>没有 bug 比各种新奇或者强大的功能更重要，老话说：”不要没学会走就开始跑“；比现代化、炫酷的 UI 更重要，Linux 上有很对 ui 简陋的工具，但是却是许多人的生活的一部分，</li>
<li>我还是赞同 Polly 总结的：产品没 bug + 很多人知道</li>
</ul>
</li>
</ul>
<h2 id=20230223>20230223<a hidden class=anchor aria-hidden=true href=#20230223>#</a></h2>
<ul>
<li>
<p>经验</p>
<ul>
<li>
<p><code>Error: Run autofix to sort these imports!</code>：与<code>simple-import-sort/imports</code>相关，就是 import 导入顺序问题，需要在 VSCode 中安装 ESLint 插件，并在相关页面用 Command+. 快速 fix。</p>
</li>
<li>
<p>commit 提交需要根据 <a href=https://github.com/conventional-changelog/commitlint/#what-is-commitlint>https://github.com/conventional-changelog/commitlint/#what-is-commitlint</a> 填写信息。例如 <code>git commit -m "feat(官网页面) : 多语言修改"</code></p>
</li>
<li>
<p>可以看《<a href=https://blog.lishunyang.com/2019/08/lingui-js-i18n-review.html>i18n与lingui-js总结</a>》了解国家化原理：1.0 为哈希表，键为原文，值为翻译的文本，通过键取值；2.0 为键为原文，值为函数，通过函数实现支持变量插入；3.0 是引入 babel 实现开发友好。</p>
</li>
<li>
<p><a href=https://blog.csdn.net/weixin_33991418/article/details/86023020>CSS实战&ndash;实现侧边栏滑进滑出</a>：菜单的遮罩层是必要的，这样就可以通过点击遮罩层来隐藏侧边栏菜单了。滑进滑出原理就是利用定位移出元素到视口外。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>.<span style=color:#a6e22e>mask</span> {
  <span style=color:#66d9ef>position</span>: <span style=color:#66d9ef>fixed</span>;
  <span style=color:#66d9ef>left</span>: <span style=color:#ae81ff>0</span>;
  <span style=color:#66d9ef>top</span>: <span style=color:#ae81ff>0</span>;
  <span style=color:#66d9ef>width</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>%</span>;
  <span style=color:#66d9ef>height</span>: <span style=color:#ae81ff>100</span><span style=color:#66d9ef>%</span>;
}
</code></pre></div></li>
<li>
<p>MouseEeventHander 区别于 MouseEvent</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>handleAsideClick</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>e</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>MouseEvent</span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>HTMLElement</span><span style=color:#f92672>&gt;</span>) =&gt; {
  <span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>stopPropagation</span>()
}
</code></pre></div></li>
<li>
<p><a href=https://www.npmjs.com/package/next-http-proxy-middleware>next-http-proxy-middleware</a>：用于在开发环境中测试 api 调用，解决跨域问题。在 next.config.js 中添加</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#66d9ef>async</span> <span style=color:#a6e22e>rewrites</span>() {
  <span style=color:#66d9ef>return</span> [
    {
      <span style=color:#a6e22e>source</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;/api/v1/:path*&#39;</span>,
      <span style=color:#a6e22e>destination</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;http://10.2.0.10:9188/api/v1/:path*&#39;</span>,
    },
  ]
},
</code></pre></div><p>添加还需要重启服务。</p>
</li>
<li>
<p><a href=https://blog.csdn.net/qq_45617555/article/details/107738388>【flex布局】解决view中两个元素一个居左一个居中</a>：其实就是建立第三个元素，其与第一个元素一样宽度，但是没有内容。</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;flex justify-between items-center&#34;</span><span style=color:#f92672>&gt;</span>
 <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>Menu</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;w-[50px]&#34;</span> <span style=color:#f92672>/&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>LogoIcon</span> <span style=color:#f92672>/&gt;</span>
  <span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>className</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;w-[50px]&#34;</span> <span style=color:#f92672>/&gt;</span>
<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
</code></pre></div></li>
</ul>
</li>
<li>
<p>观点：</p>
<ul>
<li>
<p><a href="https://www.zhihu.com/question/381522201?utm_id=0">关于Tailwind CSS是一切堆到class里的歪门邪道这种说法如何评价？</a></p>
<ul>
<li>Tailwind解决了”CSS 类命名“、“样式冲突“、“模块复用”等问题</li>
<li>如果说传统的编程箴言是 <strong>DRY</strong>(Do not repeat yourself)，那 Tailwind CSS 就应该是 <strong>TRY</strong> (Try to repeat yourself)</li>
</ul>
</li>
<li>
<p><a href=https://juejin.cn/post/6930196913119576077>Tailwind CSS （可能）是名过其实的</a>：一大堆类名污染 HTML 结构中的每一个元素</p>
</li>
</ul>
</li>
<li>
<p>问题：</p>
<ul>
<li><a href=https://stackoverflow.com/questions/60815285/is-there-a-difference-between-storing-a-const-value-in-a-variable-vs-in-state>Is there a difference between storing a const value in a variable vs in state?</a>: Runs <code>useState</code> and compares the value with the previous state on every render which is &ldquo;much more expensive&rdquo; than declaring a variable.</li>
</ul>
</li>
</ul>
<h2 id=20230222>20230222<a hidden class=anchor aria-hidden=true href=#20230222>#</a></h2>
<ul>
<li>
<p>经验：</p>
<ul>
<li>
<p>Icon 都在 <code>components/Icon/index.tsx</code> 中</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-react data-lang=react><span style=color:#66d9ef>export</span> <span style=color:#66d9ef>const</span> <span style=color:#a6e22e>AppleIcon</span> <span style=color:#f92672>=</span> (<span style=color:#a6e22e>props</span><span style=color:#f92672>:</span> <span style=color:#a6e22e>React</span>.<span style=color:#a6e22e>ComponentProps</span><span style=color:#f92672>&lt;</span><span style=color:#e6db74>&#39;svg&#39;</span><span style=color:#f92672>&gt;</span>) =&gt; {
  <span style=color:#66d9ef>return</span> (&lt;<span style=color:#f92672>svg</span> {<span style=color:#a6e22e>...props</span>} &gt;&lt;/<span style=color:#f92672>svg</span>&gt;);
}
</code></pre></div><p>这里需要删除原图标的 <code>wedith</code> 与 <code>height</code> 属性，并用 <code>{...props}</code> 代替。还需要将 <code>clip-path</code> 等替换为小驼峰命名方式 <code>clipPath</code>。</p>
</li>
</ul>
<p>- 先完成大致的 UI 与 页面逻辑，细节之后再慢慢调。先完成任务，再把任务完成得好。</p>
<ul>
<li>遇到什么页面问题需要与 UI 沟通调整的，可以先记录在记事本中，之后再在 UI 能回应时处理。</li>
<li>移动 UI 图为 750px，其是 2 倍图，需要除以 2 才等于实际的值，包括元素的宽度与字体大小，反像素值都除以 2。</li>
<li>用 tailwind css 的 <code>last:</code> 与 <code>first:</code> 选取元素。</li>
</ul>
</li>
<li>
<p>问题：</p>
<ul>
<li>
<p><a href=https://stackoverflow.com/questions/68111024/how-to-hide-scroll-bar-in-react-app-with-allowing-scrolling>How to hide scroll bar in react app with allowing scrolling</a></p>
<p>可以在全局 css 样式表 <code>src/styles/index.css</code> 中添加如下内容</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>.<span style=color:#a6e22e>noscrollbar</span> {
  <span style=color:#75715e>/* hide scrollbar for IE, Edge and Firefox */</span>
  <span style=color:#66d9ef>-ms-</span><span style=color:#66d9ef>overflow-style</span>: <span style=color:#66d9ef>none</span>;
  scrollbar-width: <span style=color:#66d9ef>none</span>;
}

.<span style=color:#a6e22e>noscrollbar</span>::<span style=color:#a6e22e>-webkit-scrollbar</span> {
  <span style=color:#66d9ef>display</span>: <span style=color:#66d9ef>none</span>;
}
</code></pre></div></li>
<li>
<p><a href=https://codepen.io/adityajanuardi/pen/YzydaVj>Horizontal Scroll Image Pure CSS</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>.<span style=color:#a6e22e>scroll-container</span>{
  <span style=color:#66d9ef>overflow</span>: <span style=color:#66d9ef>auto</span>;
  <span style=color:#66d9ef>white-space</span>: <span style=color:#66d9ef>nowrap</span>;
}
.<span style=color:#a6e22e>gridscroll</span>{
  <span style=color:#66d9ef>display</span>:<span style=color:#66d9ef>inline-block</span>;
}
.<span style=color:#a6e22e>gridscroll</span> <span style=color:#f92672>img</span> {
  <span style=color:#66d9ef>margin</span>: <span style=color:#ae81ff>0</span> <span style=color:#ae81ff>15</span><span style=color:#66d9ef>px</span>;
}
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230221>20230221<a hidden class=anchor aria-hidden=true href=#20230221>#</a></h2>
<ul>
<li>
<p>任务</p>
<ul>
<li><input checked disabled type=checkbox> 基于 dev 分支开发新 Freefrom 官网。</li>
</ul>
</li>
<li>
<p>经验</p>
<ul>
<li>Figma 导出 3x 图片就很清晰了</li>
<li>svg 可以作为 React 组件，不能作为 img 的 src。使用为 <code>&lt;SvgName className="w-full h-full text-white" /></code></li>
<li>随便点击某个颜色属性，就会弹出color palettes（调色板），其中有 color picker</li>
</ul>
</li>
<li>
<p>前端工具：</p>
<ul>
<li><a href=https://developer.chrome.com/docs/lighthouse/overview/>Lighthouse</a>：可以在 DevTools 中使用 Lighthouse 来审核页面的可访问性并生成报表。</li>
<li><a href=https://www.extfans.com/articles/2716/>Measuremate</a>：页面元素距离检查工具</li>
</ul>
</li>
</ul>
<h2 id=20230220>20230220<a hidden class=anchor aria-hidden=true href=#20230220>#</a></h2>
<ul>
<li>
<p>任务</p>
<ul>
<li><input checked disabled type=checkbox> 翻译NTFTOPSHOW官网内容</li>
<li><input checked disabled type=checkbox> 新建项目，迁移 Freefrom 官网，只要静态页面，不要多语言，能删的都删掉</li>
<li><input checked disabled type=checkbox> 图片要优化，不能太大，考虑webp格式。
<ul>
<li><del>可以使用 <a href=https://convertio.co/>https://convertio.co/</a> 转换</del>要不断切换页面，限制最多转换两个</li>
<li>可以使用 cwebp，<code>brew install webp</code></li>
</ul>
</li>
<li><input checked disabled type=checkbox> 学习优化，如优化工具 <a href=https://www.pingdom.com/>https://www.pingdom.com/</a>。</li>
</ul>
</li>
<li>
<p>经验</p>
<ul>
<li>
<p>使用多语言步骤</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// 引入
</span><span style=color:#75715e></span><span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>t</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@lingui/macro&#39;</span>
<span style=color:#66d9ef>import</span> { <span style=color:#a6e22e>useLingui</span> } <span style=color:#a6e22e>from</span> <span style=color:#e6db74>&#39;@lingui/react&#39;</span>
<span style=color:#75715e>// 使用，需提前在在 locale 添加相应的翻译
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> { <span style=color:#a6e22e>i18n</span> } <span style=color:#f92672>=</span> <span style=color:#a6e22e>useLingui</span>()
{<span style=color:#a6e22e>i18n</span>.<span style=color:#a6e22e>_</span>(<span style=color:#a6e22e>t</span><span style=color:#e6db74>`Translation`</span>)}
</code></pre></div></li>
<li>
<p>简单的库的话，直接看官方文档；大型的如 React 就先看入门教程</p>
</li>
<li>
<p>使用的话优先使用 import 而非 requires，因为有些时候 requires 无报错，但import话就有报错。</p>
</li>
<li>
<p>因为要支持多语言，因此最好不要使用 uppercase 等 text-transfrom 属性</p>
</li>
<li>
<p>公司项目使用的 UI/CSS 库</p>
<ul>
<li><a href=https://www.npmjs.com/package/@fullpage/react-fullpage>@fullpage/react-fullpage</a>: A simple and easy to use library that creates <strong>fullscreen scrolling websites</strong> (also known as single page websites or onepage sites) and adds landscape sliders inside the sections of the site.</li>
<li><a href=https://www.npmjs.com/package/react-responsive>react-responsive</a>: <strong>Media queries</strong> in react for responsive design</li>
<li><a href=https://swiperjs.com/>Swiper</a>: The Most Modern Mobile Touch <strong>Slider</strong>。主要通过看 <a href=https://swiperjs.com/demos>Swiper Demos</a> 来学习使用
<ul>
<li><a href=https://github.com/nolimits4web/Swiper/issues/1486>Safari jumps two slides on mouse-wheel with trackpad or magic-mouse</a>：我也遇到这个问题，无法解决</li>
<li><a href=https://github.com/nolimits4web/swiper/issues/2095#issuecomment-343895880>How to change swiper-slide width?</a>：设置 <code>slidesPerView="auto"</code> 后自适应容器宽度，否则 <code>width: 3.35544e7px;</code></li>
<li><a href=https://stackoverflow.com/a/67794253>How to disable vertical mouse wheel swiper react</a>: <code>forceToAxis: true,</code></li>
</ul>
</li>
<li><a href=https://daisyui.com/>daisyUI <strong>components</strong></a>: Use Tailwind CSS but write fewer class names</li>
<li><a href=https://www.npmjs.com/package/tailwindcss-border-gradient-radius>tailwindcss-border-gradient-radius</a>: <strong>Border Gradients</strong> Plugin for Tailwind CSS based on background-origin and background-image</li>
<li><a href=https://www.npmjs.com/package/@fontsource/dm-sans>@fontsource/dm-sans</a>: The CSS and web font files to easily self-host the “<strong>DM Sans</strong>” font.</li>
<li><a href=https://github.com/bvaughn/react-virtualized>react-virtualized</a>: React components for efficiently <strong>rendering large lists</strong> and tabular data</li>
<li><a href=https://heroicons.com/>heroicons</a>: Beautiful hand-crafted SVG icons（Font icon 可以直接用 svg 代替），图标库</li>
<li><a href=https://www.npmjs.com/package/@headlessui/react>@headlessui/react</a>: UI components for React</li>
<li><a href=https://tailwindcomponents.com>tailwindcomponents</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p>featrues 特色的地方：</p>
<ul>
<li>内容即NFT - 发布内容自动生成NFT，让内容上链，确定权利。</li>
<li>完全去中心化 - 通过集成开放性协议nostr，没有任何平台可以禁止或审查你。你可以控制你的数据和言论。</li>
<li>发帖赚钱 - 通过创造高质量内容获得粉丝的打赏奖励，同时获得平台激励。</li>
<li>DAO社区增强 - 通过团结内容及粉丝来创建自己的去中心化的DAO社区</li>
<li>数字ID - 通过建立DID，创建一个Web3的独特身份，组织自己链上资产建立自己的Profile。</li>
<li>加密私信 - 端到端的加密的私人信息，让大公司远离你的DMs。</li>
</ul>
</li>
<li>
<p>Mac 快捷键</p>
<ul>
<li>切换vscode页面上面的标签 Option+Command+左右方向键</li>
<li>Shift+Command+3 拍摄截屏幕</li>
<li>Shift+Control+Command+3键会在剪贴板里获取整个屏幕的截图</li>
<li>Shift+Command+4 捕捉的屏幕区域，再按下空格键可捕捉窗口</li>
<li>Shift+Control+Command+4键则能使你通过拖动鼠标来截取部分屏幕，并复制图片到剪贴板，再按下空格键可捕捉窗口</li>
<li>退出全屏 Ctrl+Command+F 或 Fn+F</li>
<li>刷新浏览器：Command+R，强制刷新：Command+Shift+R</li>
<li>Option + 方向键左，将光标移动到前一个单词</li>
<li>Option + 方向键右，将光标移动到后一个单词</li>
</ul>
</li>
<li>
<p>问题</p>
<ul>
<li>
<p><a href=https://github.com/alvarotrigo/react-fullpage/issues/391>Property &lsquo;credits&rsquo; is not recognized as an available option</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-react data-lang=react>&lt;<span style=color:#f92672>ReactFullpage</span>
  <span style=color:#a6e22e>licenseKey</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#39;REDACTED&#39;</span>
  <span style=color:#a6e22e>scrollingSpeed</span><span style=color:#f92672>=</span>{<span style=color:#ae81ff>500</span>}
  <span style=color:#a6e22e>credits</span><span style=color:#f92672>=</span>{{ <span style=color:#a6e22e>enabled</span><span style=color:#f92672>:</span> <span style=color:#66d9ef>false</span> }}
</code></pre></div></li>
</ul>
</li>
</ul>
<h2 id=20230218>20230218<a hidden class=anchor aria-hidden=true href=#20230218>#</a></h2>
<ul>
<li>
<p>公司 next.js 项目流程和目录含义</p>
<ul>
<li>首先看 <code>src/layout</code>：布局类</li>
<li>其次看 <code>src/pages</code>：页面，pages 页面对应着路由，<code>src/pages/home/</code> 路由就是 <code>localhost:3000/home/</code>，开发的时候也可以根据浏览器 URL 找对应的页面。</li>
<li>然后看 <code>src/features</code>：每个 pages 对应的组件</li>
<li>tailwind.config.js 有些样式写在这里
<ul>
<li><code>src/styles/index.css</code> 为全局样式表</li>
<li><code>src/src/styles/variables.css</code> 定义全局字体</li>
</ul>
</li>
<li>Typography 组件用来排版的，主要是字体相关的属性</li>
</ul>
</li>
<li>
<p>任务：</p>
<ul>
<li>
<p><input checked disabled type=checkbox> <a href=https://pancakeswap.finance/>https://pancakeswap.finance/</a> 首页的图片，后续我们换成这样会动的，用css的来实现，你研究下他们这个。</p>
<ul>
<li>
<p>首先通过 devtool 的 animation 找到对应的元素为 path.eye。</p>
</li>
<li>
<p>由于页面这个部分不断地跳（好像是不断的重新创建），因此用 command + s 保存离线网页。之后看到</p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-css data-lang=css>.<span style=color:#a6e22e>cSXBDs</span> .<span style=color:#a6e22e>eye</span> {
<span style=color:#66d9ef>animation-delay</span>: <span style=color:#ae81ff>20</span><span style=color:#66d9ef>ms</span>;
}
</code></pre></div><p>实现动画的底层技术就是CSS或JS，这里可以看到用了 css 控制动画时长</p>
</li>
<li>
<p>通过 devtool 的 network 获取 <a href=https://pancakeswap.finance/_next/static/css/1ba6961f93db72ab.css>css 样式表</a>，用 <a href=https://www.cleancss.com/css-beautify/>css fromatter</a> 格式化，找到 @keyframe，但好像都无关动画定义。</p>
</li>
<li>
<p>参考 <a href=https://svg-animation-booklet.vercel.app/chapter1.html#svg-%E5%8A%A8%E7%94%BB>SVG 动画</a> 与 <a href=https://svg-animation-booklet.vercel.app/chapter8.html>SVG 闪烁动画（Blink）</a> 我认为使用 JS 实现的动画可能性更大。而且仔细看 devtool 的 animation 中的动画时长为 280 ms，远大于 animation-delay 的 20ms，而这个类主要用于 JS 控制元素。</p>
</li>
</ul>
</li>
</ul>
</li>
<li>
<p>技巧：</p>
<ul>
<li>
<p>用 <code>flex flex-1 justify-center align-center gap-[74px]</code> 的 gap 来控制两个子元素间距，而非 <code>margin</code></p>
</li>
<li>
<p>尽量不要用 <code>absolute</code> 之类的定位写 ui，尽量让元素在正常文档流之内。</p>
</li>
<li>
<p><a href=https://qiita.com/ikeyansaza/items/600b9f8de3ae3f7a7f0d>React.jsでlocation.hrefを用いた外部URLへの遷移</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span> <span style=color:#a6e22e>onClick</span><span style=color:#f92672>=</span>{() =&gt; {
    window.<span style=color:#a6e22e>location</span>.<span style=color:#a6e22e>href</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://google.com&#34;</span>;
  }}<span style=color:#f92672>&gt;</span><span style=color:#a6e22e>Googleへ</span><span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/questions/12626940/mailto-on-submit-button>Mailto on submit button</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>form</span> <span style=color:#a6e22e>action</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;mailto:youraddr@domain.tld&#34;</span> <span style=color:#a6e22e>method</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;GET&#34;</span>&gt;
    &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;subject&#34;</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;text&#34;</span> /&gt;
    &lt;<span style=color:#f92672>textarea</span> <span style=color:#a6e22e>name</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;body&#34;</span>&gt;&lt;/<span style=color:#f92672>textarea</span>&gt;
    &lt;<span style=color:#f92672>input</span> <span style=color:#a6e22e>type</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;submit&#34;</span> <span style=color:#a6e22e>value</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Send&#34;</span> /&gt;
&lt;/<span style=color:#f92672>form</span>&gt;
</code></pre></div></li>
<li>
<p><a href=https://cloud.tencent.com/developer/article/1802078>Chrome 原生截长图</a></p>
<p>打开浏览器，<code>f12</code> 进入开发者模式，使用快捷键 <code>Ctrl+shift+p</code> 呼出命令面板，输入 <code>full</code> 来过滤命令，找到一个 名叫 <code>Screenshot capture full size screenshot</code> 的那一项，点击后稍等一会就会生成一整图片保存到本地。</p>
</li>
<li>
<p>使用yarn英文官方网站corepack 安装yarn方法在m1上老是失败，报错<code>must be built because it never has been before or the last one failed</code>，如果用普通的 npm -g 则没这个问题。</p>
</li>
</ul>
</li>
</ul>
<h2 id=20230217>20230217<a hidden class=anchor aria-hidden=true href=#20230217>#</a></h2>
<ul>
<li>
<p>数支用到的工具：</p>
<ul>
<li>team task manager：<a href=https://asana.com/?noredirect>asana</a></li>
<li>沟通工具：前端 钉钉，后端 teams（一星期两会）</li>
<li>API：postman</li>
</ul>
</li>
<li>
<p>现公司用</p>
<ul>
<li>沟通工具 Lark（一天一会）</li>
<li>team task manager：Trello</li>
</ul>
</li>
<li>
<p>感悟：</p>
<ul>
<li>我发现如果只是编写简单的 UI 的话，可以直接开个项目，当 UI 编写完毕之后再迁移到原来的项目。因为原项目东西太多，加载运行都非常慢，非常浪费时间，不如直接在简单环境中达到目标，然后再在复杂环境中。</li>
</ul>
</li>
<li>
<p>问题：</p>
<ul>
<li>
<p>冒号垂直对齐：<a href=https://stackoverflow.com/questions/51856535/vertical-align-colon-on-list-of-text>可以使用 table</a></p>
</li>
<li>
<p><a href=https://blog.csdn.net/ftell/article/details/123280095>使用线性渐变使图片变暗</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#a6e22e>backgroundImage</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;linear-gradient(rgba(0, 0, 0, 0.4),rgba(0, 0, 0, 0.4)) , url(/images/home/bg.webp)&#39;</span>
</code></pre></div></li>
<li>
<p><a href=https://upmostly.com/tutorials/react-onhover-event-handling-with-examples>React onHover Event Handling (with Examples)</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-react data-lang=react>&lt;<span style=color:#f92672>button</span>
  <span style=color:#a6e22e>onMouseEnter</span><span style=color:#f92672>=</span>{() =&gt; <span style=color:#a6e22e>setIsShown</span>(<span style=color:#66d9ef>true</span>)}
  <span style=color:#a6e22e>onMouseLeave</span><span style=color:#f92672>=</span>{() =&gt; <span style=color:#a6e22e>setIsShown</span>(<span style=color:#66d9ef>false</span>)}&gt;
  <span style=color:#a6e22e>Hover</span> <span style=color:#a6e22e>over</span> <span style=color:#a6e22e>me</span><span style=color:#f92672>!</span>
&lt;/<span style=color:#f92672>button</span>&gt;
</code></pre></div></li>
</ul>
</li>
<li>
<p>MacOS pkg（例如 node.js）清理工具 <a href=https://www.corecode.io/uninstallpkg/>UninstallPKG</a></p>
</li>
</ul>
<h2 id=20230216>20230216<a hidden class=anchor aria-hidden=true href=#20230216>#</a></h2>
<ul>
<li>
<p>如何学习 <a href=https://tailwindcss.com>Tailwind CSS</a>？</p>
<ul>
<li>针对特定框架<a href=https://tailwindcss.com/docs/installation/framework-guides>安装 Tailwindcss</a></li>
<li>首先看<a href=https://www.tailwindcss.cn/docs/utility-first>Tailwind CSS中文文档核心概念部分</a></li>
<li>再在 <a href=https://tailwindcss.com/docs/installation>Tailwind 英文</a> 直接搜索需要使用的 CSS 属性</li>
</ul>
</li>
<li>
<p>问题</p>
<ul>
<li>
<p><a href=https://stackoverflow.com/questions/70805041/background-image-in-tailwindcss-using-dynamic-url-react-js>Background image in tailwindcss using dynamic url (React.js)</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-react data-lang=react><span style=color:#a6e22e>style</span><span style=color:#f92672>=</span>{{<span style=color:#a6e22e>backgroundImage</span><span style=color:#f92672>:</span> <span style=color:#e6db74>`url(</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>fetchedImgSrc</span><span style=color:#e6db74>}</span><span style=color:#e6db74>)`</span>}}
</code></pre></div></li>
<li>
<p><a href=https://redpixelthemes.com/blog/tailwindcss-background-image/>How to work with background images in Tailwind CSS</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>div</span>
 <span style=color:#a6e22e>class</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;
</span><span style=color:#e6db74>  bg-no-repeat bg-cover bg-center
</span><span style=color:#e6db74>  bg-[url(&#39;../public/images/hero-mobile.jpg&#39;)]
</span><span style=color:#e6db74>  md:bg-none
</span><span style=color:#e6db74>  xl:bg-[url(&#39;../public/images/hero-desktop.jpg&#39;)]
</span><span style=color:#e6db74>&#34;</span>&gt;&lt;/<span style=color:#f92672>div</span>&gt;
</code></pre></div></li>
<li>
<p><a href=https://juejin.cn/s/react%E5%A6%82%E4%BD%95%E5%AE%9A%E4%B9%89%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F>react如何定义全局变量</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-js data-lang=js><span style=color:#75715e>// 定义，例如起一个文件名为globalData.js
</span><span style=color:#75715e></span><span style=color:#a6e22e>global</span>.<span style=color:#a6e22e>全局变量名称</span><span style=color:#f92672>=</span> {
    <span style=color:#a6e22e>aaa</span><span style=color:#f92672>:</span><span style=color:#e6db74>&#39;111&#39;</span>,
    <span style=color:#a6e22e>bbb</span><span style=color:#f92672>:</span>[]<span style=color:#e6db74>&#39;,
</span><span style=color:#e6db74>};
</span><span style=color:#e6db74>
</span><span style=color:#e6db74>// 使用
</span><span style=color:#e6db74>// 方式一
</span><span style=color:#e6db74>import 全局变量名称 from &#39;</span>.<span style=color:#f92672>/</span><span style=color:#a6e22e>globalData</span><span style=color:#960050;background-color:#1e0010>&#39;</span>;
<span style=color:#75715e>// 方式二
</span><span style=color:#75715e></span><span style=color:#f92672>&lt;</span><span style=color:#a6e22e>div</span><span style=color:#f92672>&gt;</span><span style=color:#a6e22e>名称</span><span style=color:#960050;background-color:#1e0010>：</span>{<span style=color:#a6e22e>global</span>.<span style=color:#a6e22e>全局变量名称</span>.<span style=color:#a6e22e>aaa</span>}<span style=color:#f92672>&lt;</span><span style=color:#960050;background-color:#1e0010>/div&gt;</span>
</code></pre></div></li>
<li>
<p><a href=https://www.gearpatrol.com/tech/a695665/factory-reset-apple-devices/>Factory resetting your MacBook</a></p>
<ul>
<li>Click the Apple logo on the top left corner of your screen, and select System Preferences from the dropdown menu.</li>
<li>Click the <strong>System Preferences</strong> option which appears next to the Apple logo in the menu bar and pick <strong>Erase All Contents and Settings</strong> in the dropdown menu*.*</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id=20230215>20230215<a hidden class=anchor aria-hidden=true href=#20230215>#</a></h2>
<ul>
<li>经验：
<ul>
<li>next/image，包装 NextImage</li>
<li>next/config</li>
<li>tsconfig/paths 设置别名后，import 报 <code>Module not found: Error: Can't resolve</code>，如果不设置别名就无此问题，或者用<a href=https://stackoverflow.com/questions/69515474/typescript-path-aliases-in-tsconfig-json-not-found>tsconfig-paths</a></li>
<li><a href=https://israynotarray.com/tailwindcss/20220405/1504568293/>VSCode 噴 Unknown at rule @tailwind 解決方式</a>
TailwindCSS 有使用到一些 TailwindCSS 自己自定義的 CSS 語法，所以在許多編譯器在會無法辨別而導致出現錯誤或警告，而我們本身使用 TailwindCSS 都會搭配 PostCSS，所以就會有一個 postcss.config.js 設定檔，這時候我們只需要替自己的 VSCode 安裝 <a href="https://marketplace.visualstudio.com/items?itemName=csstools.postcss">PostCSS Language Support</a> 套件就可以解決 <code>Unknown at rule @tailwind</code> 的問題囉。</li>
<li><a href=https://snh90100.medium.com/%E5%9C%A8-create-react-app-%E4%B8%AD%E4%BF%AE%E6%94%B9-webpack-%E8%A8%AD%E5%AE%9A-%E4%BB%A5%E8%AA%BF%E6%95%B4-webpack-alias-%E7%82%BA%E4%BE%8B-59fd9eeeffe7>在 Create React App 中修改 Webpack 設定，以調整 Webpack Alias 為例</a></li>
</ul>
</li>
</ul>
<h2 id=20230214>20230214<a hidden class=anchor aria-hidden=true href=#20230214>#</a></h2>
<ul>
<li>
<p>问题：在无法用 export 导出 i18n 的路由</p>
<ul>
<li>方法：
<ul>
<li>用现成解决方案
<ul>
<li><a href=https://dev.to/adrai/static-html-export-with-i18n-compatibility-in-nextjs-8cd>Static HTML Export with i18n compatibility in Next.js</a></li>
<li><a href=https://www.npmjs.com/package/next-export-i18n>next-export-i18n</a></li>
</ul>
</li>
<li>用传统打包</li>
<li>不用 i18n</li>
</ul>
</li>
<li>解决步骤：
<ul>
<li>了解逻辑，大致了解 next.js，linugui</li>
<li>选择破坏或者更改最少的</li>
<li>或许可以使用 <a href=https://nextjs.org/docs/api-reference/next.config.js/exportPathMap>exportMapPath</a></li>
</ul>
</li>
<li>链接：
<ul>
<li><a href=https://nextjs.org/docs/advanced-features/static-html-export>Static HTML Export</a></li>
<li><a href=https://stackoverflow.com/questions/65513435/i18n-support-is-not-compatible-with-next-export-ssr-nextjs-10>i18n support is not compatible with next export. (SSR - NextJS 10)</a></li>
<li><a href=https://github.com/vercel/next.js/discussions/18957>i18n support is not compatible with next export</a></li>
</ul>
</li>
</ul>
</li>
<li>
<p>技能：</p>
<ul>
<li><a href=https://stackoverflow.com/questions/34618383/vscode-regex-find-replace-submatch-math>VSCode regex find & replace submatch math?</a>
Given a regular expression of <code>(foobar)</code> you can reference the first group using <code>$1</code> and so on if you have more groups in the replace input field.</li>
<li><a href=https://stackoverflow.com/questions/20056306/match-linebreaks-n-or-r-n>Match linebreaks - \n or \r\n?</a>
<code>(\r\n|\r|\n)</code> is more correct.（这里正则匹配是一行为单位的，即使可以匹配空白符，也无法匹配多行）</li>
</ul>
</li>
<li>
<p>其他：</p>
<ul>
<li>
<p><a href=https://stackoverflow.com/questions/65487914/error-image-optimization-using-next-js-default-loader-is-not-compatible-with-n>Error: Image Optimization using Next.js default loader is not compatible with <code>next export</code></a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell>$ yarn add akamai
$ vim next.config.js
module.exports <span style=color:#f92672>=</span> <span style=color:#f92672>{</span>
  images: <span style=color:#f92672>{</span>
    loader: <span style=color:#e6db74>&#39;akamai&#39;</span>,
    path: <span style=color:#e6db74>&#39;&#39;</span>,
  <span style=color:#f92672>}</span>,
<span style=color:#f92672>}</span>
</code></pre></div></li>
<li>
<p><a href=https://stackoverflow.com/questions/63518597/how-to-run-next-js-application-build-out-directory>How to run Next Js application build (out) directory?</a></p>
<div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-diff data-lang=diff>{
  &#34;private&#34;: true,
  &#34;scripts&#34;: {
    &#34;dev&#34;: &#34;next&#34;,
    &#34;build&#34;: &#34;next build&#34;,
    &#34;preexport&#34;: &#34;npm run build&#34;,
    &#34;export&#34;: &#34;next export&#34;,
    &#34;prestart&#34;: &#34;npm run export&#34;,
<span style=color:#a6e22e>+    &#34;start&#34;: &#34;serve out&#34;,
</span><span style=color:#a6e22e></span>    &#34;lint&#34;: &#34;next lint&#34;
  },
</code></pre></div></li>
</ul>
</li>
<li>
<p>Meta Mask: table sister month eight offer dentist hair trophy field process define lady</p>
</li>
</ul>
</div>
<footer class=post-footer>
<ul class=post-tags>
<li><a href=https://blog.g7n3.me/tags/dairy/>Dairy</a></li>
</ul>
<nav class=paginav>
<a class=next href=https://blog.g7n3.me/posts/css/>
<span class=title>Next Page »</span>
<br>
<span>CSS教程</span>
</a>
</nav>
</footer>
</article>
</main>
<footer class=footer>
<span>&copy; 2024 <a href=https://blog.g7n3.me/>Sakamoto Kurome</a></span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
</body>
</html>